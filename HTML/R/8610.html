<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>peer</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/639.html#L159'>peer</a>              159 bgpd/bgp_advertise.c   peer_unlock (adj-&gt;peer); /* adj_out peer reference */</span>
<span class='curline'><a href='../S/639.html#L164'>peer</a>              164 bgpd/bgp_advertise.c bgp_adj_out_lookup (struct peer *peer, struct prefix *p,</span>
<span class='curline'><a href='../S/639.html#L170'>peer</a>              170 bgpd/bgp_advertise.c     if (adj-&gt;peer == peer)</span>
<span class='curline'><a href='../S/639.html#L182'>peer</a>              182 bgpd/bgp_advertise.c bgp_advertise_clean (struct peer *peer, struct bgp_adj_out *adj,</span>
<span class='curline'><a href='../S/639.html#L202'>peer</a>              202 bgpd/bgp_advertise.c       bgp_advertise_unintern (peer-&gt;hash[afi][safi], baa);</span>
<span class='curline'><a href='../S/639.html#L216'>peer</a>              216 bgpd/bgp_advertise.c bgp_adj_out_set (struct bgp_node *rn, struct peer *peer, struct prefix *p,</span>
<span class='curline'><a href='../S/639.html#L230'>peer</a>              230 bgpd/bgp_advertise.c 	if (adj-&gt;peer == peer)</span>
<span class='curline'><a href='../S/639.html#L237'>peer</a>              237 bgpd/bgp_advertise.c       adj-&gt;peer = peer_lock (peer); /* adj_out peer reference */</span>
<span class='curline'><a href='../S/639.html#L247'>peer</a>              247 bgpd/bgp_advertise.c     bgp_advertise_clean (peer, adj, afi, safi);</span>
<span class='curline'><a href='../S/639.html#L258'>peer</a>              258 bgpd/bgp_advertise.c     adv-&gt;baa = bgp_advertise_intern (peer-&gt;hash[afi][safi], attr);</span>
<span class='curline'><a href='../S/639.html#L266'>peer</a>              266 bgpd/bgp_advertise.c   FIFO_ADD (&amp;peer-&gt;sync[afi][safi]-&gt;update, &amp;adv-&gt;fifo);</span>
<span class='curline'><a href='../S/639.html#L270'>peer</a>              270 bgpd/bgp_advertise.c bgp_adj_out_unset (struct bgp_node *rn, struct peer *peer, struct prefix *p, </span>
<span class='curline'><a href='../S/639.html#L281'>peer</a>              281 bgpd/bgp_advertise.c     if (adj-&gt;peer == peer)</span>
<span class='curline'><a href='../S/639.html#L289'>peer</a>              289 bgpd/bgp_advertise.c     bgp_advertise_clean (peer, adj, afi, safi);</span>
<span class='curline'><a href='../S/639.html#L300'>peer</a>              300 bgpd/bgp_advertise.c       FIFO_ADD (&amp;peer-&gt;sync[afi][safi]-&gt;withdraw, &amp;adv-&gt;fifo);</span>
<span class='curline'><a href='../S/639.html#L303'>peer</a>              303 bgpd/bgp_advertise.c       BGP_WRITE_ON (peer-&gt;t_write, bgp_write, peer-&gt;fd);</span>
<span class='curline'><a href='../S/639.html#L319'>peer</a>              319 bgpd/bgp_advertise.c 		    struct peer *peer, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/639.html#L325'>peer</a>              325 bgpd/bgp_advertise.c     bgp_advertise_clean (peer, adj, afi, safi);</span>
<span class='curline'><a href='../S/639.html#L332'>peer</a>              332 bgpd/bgp_advertise.c bgp_adj_in_set (struct bgp_node *rn, struct peer *peer, struct attr *attr)</span>
<span class='curline'><a href='../S/639.html#L338'>peer</a>              338 bgpd/bgp_advertise.c       if (adj-&gt;peer == peer)</span>
<span class='curline'><a href='../S/639.html#L349'>peer</a>              349 bgpd/bgp_advertise.c   adj-&gt;peer = peer_lock (peer); /* adj_in peer reference */</span>
<span class='curline'><a href='../S/639.html#L360'>peer</a>              360 bgpd/bgp_advertise.c   peer_unlock (bai-&gt;peer); /* adj_in peer reference */</span>
<span class='curline'><a href='../S/639.html#L365'>peer</a>              365 bgpd/bgp_advertise.c bgp_adj_in_unset (struct bgp_node *rn, struct peer *peer)</span>
<span class='curline'><a href='../S/639.html#L370'>peer</a>              370 bgpd/bgp_advertise.c     if (adj-&gt;peer == peer)</span>
<span class='curline'><a href='../S/639.html#L381'>peer</a>              381 bgpd/bgp_advertise.c bgp_sync_init (struct peer *peer)</span>
<span class='curline'><a href='../S/639.html#L395'>peer</a>              395 bgpd/bgp_advertise.c 	peer-&gt;sync[afi][safi] = sync;</span>
<span class='curline'><a href='../S/639.html#L396'>peer</a>              396 bgpd/bgp_advertise.c 	peer-&gt;hash[afi][safi] = hash_create (baa_hash_key, baa_hash_cmp);</span>
<span class='curline'><a href='../S/639.html#L401'>peer</a>              401 bgpd/bgp_advertise.c bgp_sync_delete (struct peer *peer)</span>
<span class='curline'><a href='../S/639.html#L409'>peer</a>              409 bgpd/bgp_advertise.c 	if (peer-&gt;sync[afi][safi])</span>
<span class='curline'><a href='../S/639.html#L410'>peer</a>              410 bgpd/bgp_advertise.c 	  XFREE (MTYPE_BGP_SYNCHRONISE, peer-&gt;sync[afi][safi]);</span>
<span class='curline'><a href='../S/639.html#L411'>peer</a>              411 bgpd/bgp_advertise.c 	peer-&gt;sync[afi][safi] = NULL;</span>
<span class='curline'><a href='../S/639.html#L413'>peer</a>              413 bgpd/bgp_advertise.c 	if (peer-&gt;hash[afi][safi])</span>
<span class='curline'><a href='../S/639.html#L414'>peer</a>              414 bgpd/bgp_advertise.c 	  hash_free (peer-&gt;hash[afi][safi]);</span>
<span class='curline'><a href='../S/639.html#L415'>peer</a>              415 bgpd/bgp_advertise.c 	peer-&gt;hash[afi][safi] = NULL;</span>
<span class='curline'><a href='../S/632.html#L74'>peer</a>               74 bgpd/bgp_advertise.h   struct peer *peer;</span>
<span class='curline'><a href='../S/632.html#L91'>peer</a>               91 bgpd/bgp_advertise.h   struct peer *peer;</span>
<span class='curline'><a href='../S/632.html#L131'>peer</a>              131 bgpd/bgp_advertise.h extern void bgp_adj_out_set (struct bgp_node *, struct peer *, struct prefix *,</span>
<span class='curline'><a href='../S/632.html#L133'>peer</a>              133 bgpd/bgp_advertise.h extern void bgp_adj_out_unset (struct bgp_node *, struct peer *, struct prefix *,</span>
<span class='curline'><a href='../S/632.html#L136'>peer</a>              136 bgpd/bgp_advertise.h 			 struct peer *, afi_t, safi_t);</span>
<span class='curline'><a href='../S/632.html#L137'>peer</a>              137 bgpd/bgp_advertise.h extern int bgp_adj_out_lookup (struct peer *, struct prefix *, afi_t, safi_t,</span>
<span class='curline'><a href='../S/632.html#L140'>peer</a>              140 bgpd/bgp_advertise.h extern void bgp_adj_in_set (struct bgp_node *, struct peer *, struct attr *);</span>
<span class='curline'><a href='../S/632.html#L141'>peer</a>              141 bgpd/bgp_advertise.h extern void bgp_adj_in_unset (struct bgp_node *, struct peer *);</span>
<span class='curline'><a href='../S/632.html#L145'>peer</a>              145 bgpd/bgp_advertise.h bgp_advertise_clean (struct peer *, struct bgp_adj_out *, afi_t, safi_t);</span>
<span class='curline'><a href='../S/632.html#L147'>peer</a>              147 bgpd/bgp_advertise.h extern void bgp_sync_init (struct peer *);</span>
<span class='curline'><a href='../S/632.html#L148'>peer</a>              148 bgpd/bgp_advertise.h extern void bgp_sync_delete (struct peer *);</span>
<span class='curline'><a href='../S/643.html#L731'>peer</a>              731 bgpd/bgp_attr.c   struct peer *const peer = args-&gt;peer; </span>
<span class='curline'><a href='../S/643.html#L740'>peer</a>              740 bgpd/bgp_attr.c   if (peer-&gt;sort != BGP_PEER_EBGP)</span>
<span class='curline'><a href='../S/643.html#L742'>peer</a>              742 bgpd/bgp_attr.c       bgp_notify_send_with_data (peer, BGP_NOTIFY_UPDATE_ERR, subcode,</span>
<span class='curline'><a href='../S/643.html#L751'>peer</a>              751 bgpd/bgp_attr.c   stream_set_getp (BGP_INPUT (peer),</span>
<span class='curline'><a href='../S/643.html#L752'>peer</a>              752 bgpd/bgp_attr.c                    (args-&gt;startp - STREAM_DATA (BGP_INPUT (peer)))</span>
<span class='curline'><a href='../S/643.html#L780'>peer</a>              780 bgpd/bgp_attr.c       bgp_notify_send_with_data (peer, BGP_NOTIFY_UPDATE_ERR, subcode,</span>
<span class='curline'><a href='../S/643.html#L821'>peer</a>              821 bgpd/bgp_attr.c       zlog (args-&gt;peer-&gt;log, LOG_ERR, "%s attribute must%s be flagged as \"%s\"",</span>
<span class='curline'><a href='../S/643.html#L829'>peer</a>              829 bgpd/bgp_attr.c       zlog (args-&gt;peer-&gt;log, LOG_DEBUG,</span>
<span class='curline'><a href='../S/643.html#L866'>peer</a>              866 bgpd/bgp_attr.c   struct peer *const peer = args-&gt;peer; </span>
<span class='curline'><a href='../S/643.html#L880'>peer</a>              880 bgpd/bgp_attr.c       zlog (peer-&gt;log, LOG_ERR,</span>
<span class='curline'><a href='../S/643.html#L893'>peer</a>              893 bgpd/bgp_attr.c           zlog (peer-&gt;log, LOG_ERR,</span>
<span class='curline'><a href='../S/643.html#L902'>peer</a>              902 bgpd/bgp_attr.c           zlog (peer-&gt;log, LOG_ERR,</span>
<span class='curline'><a href='../S/643.html#L929'>peer</a>              929 bgpd/bgp_attr.c   struct peer *const peer = args-&gt;peer;</span>
<span class='curline'><a href='../S/643.html#L940'>peer</a>              940 bgpd/bgp_attr.c       zlog (peer-&gt;log, LOG_ERR, "Origin attribute length is not one %d",</span>
<span class='curline'><a href='../S/643.html#L948'>peer</a>              948 bgpd/bgp_attr.c   attr-&gt;origin = stream_getc (BGP_INPUT (peer));</span>
<span class='curline'><a href='../S/643.html#L957'>peer</a>              957 bgpd/bgp_attr.c       zlog (peer-&gt;log, LOG_ERR, "Origin attribute value is invalid %d",</span>
<span class='curline'><a href='../S/643.html#L976'>peer</a>              976 bgpd/bgp_attr.c   struct peer *const peer = args-&gt;peer; </span>
<span class='curline'><a href='../S/643.html#L983'>peer</a>              983 bgpd/bgp_attr.c   attr-&gt;aspath = aspath_parse (peer-&gt;ibuf, length, </span>
<span class='curline'><a href='../S/643.html#L984'>peer</a>              984 bgpd/bgp_attr.c                                CHECK_FLAG (peer-&gt;cap, PEER_CAP_AS4_RCV));</span>
<span class='curline'><a href='../S/643.html#L989'>peer</a>              989 bgpd/bgp_attr.c       zlog (peer-&gt;log, LOG_ERR,</span>
<span class='curline'><a href='../S/643.html#L991'>peer</a>              991 bgpd/bgp_attr.c             peer-&gt;host, length);</span>
<span class='curline'><a href='../S/643.html#L1002'>peer</a>             1002 bgpd/bgp_attr.c bgp_attr_aspath_check (struct peer *const peer, struct attr *const attr)</span>
<span class='curline'><a href='../S/643.html#L1011'>peer</a>             1011 bgpd/bgp_attr.c   struct bgp *bgp = peer-&gt;bgp;</span>
<span class='curline'><a href='../S/643.html#L1015'>peer</a>             1015 bgpd/bgp_attr.c   if ((peer-&gt;sort == BGP_PEER_CONFED &amp;&amp; ! aspath_left_confed_check (attr-&gt;aspath)) ||</span>
<span class='curline'><a href='../S/643.html#L1016'>peer</a>             1016 bgpd/bgp_attr.c      (peer-&gt;sort == BGP_PEER_EBGP &amp;&amp; aspath_confed_check (attr-&gt;aspath)))</span>
<span class='curline'><a href='../S/643.html#L1018'>peer</a>             1018 bgpd/bgp_attr.c       zlog (peer-&gt;log, LOG_ERR, "Malformed AS path from %s", peer-&gt;host);</span>
<span class='curline'><a href='../S/643.html#L1019'>peer</a>             1019 bgpd/bgp_attr.c       bgp_notify_send (peer, BGP_NOTIFY_UPDATE_ERR,</span>
<span class='curline'><a href='../S/643.html#L1027'>peer</a>             1027 bgpd/bgp_attr.c       if (peer-&gt;sort == BGP_PEER_EBGP</span>
<span class='curline'><a href='../S/643.html#L1028'>peer</a>             1028 bgpd/bgp_attr.c 	  &amp;&amp; ! aspath_firstas_check (attr-&gt;aspath, peer-&gt;as))</span>
<span class='curline'><a href='../S/643.html#L1030'>peer</a>             1030 bgpd/bgp_attr.c  	  zlog (peer-&gt;log, LOG_ERR,</span>
<span class='curline'><a href='../S/643.html#L1031'>peer</a>             1031 bgpd/bgp_attr.c  		"%s incorrect first AS (must be %u)", peer-&gt;host, peer-&gt;as);</span>
<span class='curline'><a href='../S/643.html#L1032'>peer</a>             1032 bgpd/bgp_attr.c           bgp_notify_send (peer, BGP_NOTIFY_UPDATE_ERR,</span>
<span class='curline'><a href='../S/643.html#L1039'>peer</a>             1039 bgpd/bgp_attr.c   if (peer-&gt;change_local_as &amp;&amp;</span>
<span class='curline'><a href='../S/643.html#L1040'>peer</a>             1040 bgpd/bgp_attr.c       ! CHECK_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_NO_PREPEND))</span>
<span class='curline'><a href='../S/643.html#L1043'>peer</a>             1043 bgpd/bgp_attr.c       aspath = aspath_add_seq (aspath, peer-&gt;change_local_as);</span>
<span class='curline'><a href='../S/643.html#L1056'>peer</a>             1056 bgpd/bgp_attr.c   struct peer *const peer = args-&gt;peer; </span>
<span class='curline'><a href='../S/643.html#L1060'>peer</a>             1060 bgpd/bgp_attr.c   *as4_path = aspath_parse (peer-&gt;ibuf, length, 1);</span>
<span class='curline'><a href='../S/643.html#L1065'>peer</a>             1065 bgpd/bgp_attr.c       zlog (peer-&gt;log, LOG_ERR,</span>
<span class='curline'><a href='../S/643.html#L1067'>peer</a>             1067 bgpd/bgp_attr.c             peer-&gt;host, length);</span>
<span class='curline'><a href='../S/643.html#L1084'>peer</a>             1084 bgpd/bgp_attr.c   struct peer *const peer = args-&gt;peer; </span>
<span class='curline'><a href='../S/643.html#L1093'>peer</a>             1093 bgpd/bgp_attr.c       zlog (peer-&gt;log, LOG_ERR, "Nexthop attribute length isn't four [%d]",</span>
<span class='curline'><a href='../S/643.html#L1106'>peer</a>             1106 bgpd/bgp_attr.c   nexthop_n = stream_get_ipv4 (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/643.html#L1112'>peer</a>             1112 bgpd/bgp_attr.c       zlog (peer-&gt;log, LOG_ERR, "Martian nexthop %s", buf);</span>
<span class='curline'><a href='../S/643.html#L1128'>peer</a>             1128 bgpd/bgp_attr.c   struct peer *const peer = args-&gt;peer; </span>
<span class='curline'><a href='../S/643.html#L1135'>peer</a>             1135 bgpd/bgp_attr.c       zlog (peer-&gt;log, LOG_ERR, </span>
<span class='curline'><a href='../S/643.html#L1143'>peer</a>             1143 bgpd/bgp_attr.c   attr-&gt;med = stream_getl (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/643.html#L1154'>peer</a>             1154 bgpd/bgp_attr.c   struct peer *const peer = args-&gt;peer; </span>
<span class='curline'><a href='../S/643.html#L1161'>peer</a>             1161 bgpd/bgp_attr.c     zlog (peer-&gt;log, LOG_ERR, "LOCAL_PREF attribute length isn't 4 [%u]",</span>
<span class='curline'><a href='../S/643.html#L1171'>peer</a>             1171 bgpd/bgp_attr.c   if (peer-&gt;sort == BGP_PEER_EBGP)</span>
<span class='curline'><a href='../S/643.html#L1173'>peer</a>             1173 bgpd/bgp_attr.c       stream_forward_getp (peer-&gt;ibuf, length);</span>
<span class='curline'><a href='../S/643.html#L1177'>peer</a>             1177 bgpd/bgp_attr.c   attr-&gt;local_pref = stream_getl (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/643.html#L1189'>peer</a>             1189 bgpd/bgp_attr.c   struct peer *const peer = args-&gt;peer; </span>
<span class='curline'><a href='../S/643.html#L1196'>peer</a>             1196 bgpd/bgp_attr.c       zlog (peer-&gt;log, LOG_ERR, "ATOMIC_AGGREGATE attribute length isn't 0 [%u]",</span>
<span class='curline'><a href='../S/643.html#L1213'>peer</a>             1213 bgpd/bgp_attr.c   struct peer *const peer = args-&gt;peer; </span>
<span class='curline'><a href='../S/643.html#L1221'>peer</a>             1221 bgpd/bgp_attr.c   if (CHECK_FLAG (peer-&gt;cap, PEER_CAP_AS4_RCV))</span>
<span class='curline'><a href='../S/643.html#L1226'>peer</a>             1226 bgpd/bgp_attr.c       zlog (peer-&gt;log, LOG_ERR, "AGGREGATOR attribute length isn't %u [%u]",</span>
<span class='curline'><a href='../S/643.html#L1233'>peer</a>             1233 bgpd/bgp_attr.c   if ( CHECK_FLAG (peer-&gt;cap, PEER_CAP_AS4_RCV ) )</span>
<span class='curline'><a href='../S/643.html#L1234'>peer</a>             1234 bgpd/bgp_attr.c     attre-&gt;aggregator_as = stream_getl (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/643.html#L1236'>peer</a>             1236 bgpd/bgp_attr.c     attre-&gt;aggregator_as = stream_getw (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/643.html#L1237'>peer</a>             1237 bgpd/bgp_attr.c   attre-&gt;aggregator_addr.s_addr = stream_get_ipv4 (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/643.html#L1251'>peer</a>             1251 bgpd/bgp_attr.c   struct peer *const peer = args-&gt;peer; </span>
<span class='curline'><a href='../S/643.html#L1257'>peer</a>             1257 bgpd/bgp_attr.c       zlog (peer-&gt;log, LOG_ERR, "New Aggregator length is not 8 [%d]",</span>
<span class='curline'><a href='../S/643.html#L1264'>peer</a>             1264 bgpd/bgp_attr.c   *as4_aggregator_as = stream_getl (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/643.html#L1265'>peer</a>             1265 bgpd/bgp_attr.c   as4_aggregator_addr-&gt;s_addr = stream_get_ipv4 (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/643.html#L1275'>peer</a>             1275 bgpd/bgp_attr.c bgp_attr_munge_as4_attrs (struct peer *const peer,</span>
<span class='curline'><a href='../S/643.html#L1284'>peer</a>             1284 bgpd/bgp_attr.c   if (CHECK_FLAG (peer-&gt;cap, PEER_CAP_AS4_RCV))</span>
<span class='curline'><a href='../S/643.html#L1295'>peer</a>             1295 bgpd/bgp_attr.c                         peer-&gt;host, "AS4 capable peer, yet it sent");</span>
<span class='curline'><a href='../S/643.html#L1299'>peer</a>             1299 bgpd/bgp_attr.c                         peer-&gt;host, "AS4 capable peer, yet it sent");</span>
<span class='curline'><a href='../S/643.html#L1333'>peer</a>             1333 bgpd/bgp_attr.c                             " AS4_AGGREGATOR and AS4_PATH", peer-&gt;host);</span>
<span class='curline'><a href='../S/643.html#L1353'>peer</a>             1353 bgpd/bgp_attr.c                         " it as if AGGREGATOR with AS_TRANS had been there", peer-&gt;host);</span>
<span class='curline'><a href='../S/643.html#L1377'>peer</a>             1377 bgpd/bgp_attr.c   struct peer *const peer = args-&gt;peer; </span>
<span class='curline'><a href='../S/643.html#L1388'>peer</a>             1388 bgpd/bgp_attr.c     community_parse ((u_int32_t *)stream_pnt (peer-&gt;ibuf), length);</span>
<span class='curline'><a href='../S/643.html#L1391'>peer</a>             1391 bgpd/bgp_attr.c   stream_forward_getp (peer-&gt;ibuf, length);</span>
<span class='curline'><a href='../S/643.html#L1407'>peer</a>             1407 bgpd/bgp_attr.c   struct peer *const peer = args-&gt;peer; </span>
<span class='curline'><a href='../S/643.html#L1414'>peer</a>             1414 bgpd/bgp_attr.c       zlog (peer-&gt;log, LOG_ERR, "Bad originator ID length %d", length);</span>
<span class='curline'><a href='../S/643.html#L1422'>peer</a>             1422 bgpd/bgp_attr.c     = stream_get_ipv4 (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/643.html#L1433'>peer</a>             1433 bgpd/bgp_attr.c   struct peer *const peer = args-&gt;peer; </span>
<span class='curline'><a href='../S/643.html#L1440'>peer</a>             1440 bgpd/bgp_attr.c       zlog (peer-&gt;log, LOG_ERR, "Bad cluster list length %d", length);</span>
<span class='curline'><a href='../S/643.html#L1447'>peer</a>             1447 bgpd/bgp_attr.c     = cluster_parse ((struct in_addr *)stream_pnt (peer-&gt;ibuf), length);</span>
<span class='curline'><a href='../S/643.html#L1450'>peer</a>             1450 bgpd/bgp_attr.c   stream_forward_getp (peer-&gt;ibuf, length);</span>
<span class='curline'><a href='../S/643.html#L1468'>peer</a>             1468 bgpd/bgp_attr.c   struct peer *const peer = args-&gt;peer;  </span>
<span class='curline'><a href='../S/643.html#L1474'>peer</a>             1474 bgpd/bgp_attr.c   s = BGP_INPUT(peer);</span>
<span class='curline'><a href='../S/643.html#L1483'>peer</a>             1483 bgpd/bgp_attr.c 		 __func__, peer-&gt;host, (unsigned long)length);</span>
<span class='curline'><a href='../S/643.html#L1497'>peer</a>             1497 bgpd/bgp_attr.c 		 __func__, peer-&gt;host, attre-&gt;mp_nexthop_len);</span>
<span class='curline'><a href='../S/643.html#L1528'>peer</a>             1528 bgpd/bgp_attr.c 	    zlog_debug ("%s got two nexthop %s %s but second one is not a link-local nexthop", peer-&gt;host,</span>
<span class='curline'><a href='../S/643.html#L1540'>peer</a>             1540 bgpd/bgp_attr.c 		 __func__, peer-&gt;host, attre-&gt;mp_nexthop_len);</span>
<span class='curline'><a href='../S/643.html#L1547'>peer</a>             1547 bgpd/bgp_attr.c                  __func__, peer-&gt;host);</span>
<span class='curline'><a href='../S/643.html#L1555'>peer</a>             1555 bgpd/bgp_attr.c                 peer-&gt;host, val);</span>
<span class='curline'><a href='../S/643.html#L1563'>peer</a>             1563 bgpd/bgp_attr.c                  __func__, peer-&gt;host);</span>
<span class='curline'><a href='../S/643.html#L1569'>peer</a>             1569 bgpd/bgp_attr.c       ret = bgp_nlri_sanity_check (peer, afi, stream_pnt (s), nlri_len);</span>
<span class='curline'><a href='../S/643.html#L1573'>peer</a>             1573 bgpd/bgp_attr.c                      __func__, peer-&gt;host);</span>
<span class='curline'><a href='../S/643.html#L1599'>peer</a>             1599 bgpd/bgp_attr.c   struct peer *const peer = args-&gt;peer;  </span>
<span class='curline'><a href='../S/643.html#L1602'>peer</a>             1602 bgpd/bgp_attr.c   s = peer-&gt;ibuf;</span>
<span class='curline'><a href='../S/643.html#L1615'>peer</a>             1615 bgpd/bgp_attr.c       ret = bgp_nlri_sanity_check (peer, afi, stream_pnt (s), withdraw_len);</span>
<span class='curline'><a href='../S/643.html#L1634'>peer</a>             1634 bgpd/bgp_attr.c   struct peer *const peer = args-&gt;peer;  </span>
<span class='curline'><a href='../S/643.html#L1647'>peer</a>             1647 bgpd/bgp_attr.c     ecommunity_parse ((u_int8_t *)stream_pnt (peer-&gt;ibuf), length);</span>
<span class='curline'><a href='../S/643.html#L1649'>peer</a>             1649 bgpd/bgp_attr.c   stream_forward_getp (peer-&gt;ibuf, length);</span>
<span class='curline'><a href='../S/643.html#L1668'>peer</a>             1668 bgpd/bgp_attr.c   struct peer *const peer = args-&gt;peer; </span>
<span class='curline'><a href='../S/643.html#L1678'>peer</a>             1678 bgpd/bgp_attr.c 	      peer-&gt;host, type, length);</span>
<span class='curline'><a href='../S/643.html#L1681'>peer</a>             1681 bgpd/bgp_attr.c     zlog (peer-&gt;log, LOG_DEBUG, </span>
<span class='curline'><a href='../S/643.html#L1685'>peer</a>             1685 bgpd/bgp_attr.c   stream_forward_getp (peer-&gt;ibuf, length);</span>
<span class='curline'><a href='../S/643.html#L1730'>peer</a>             1730 bgpd/bgp_attr.c bgp_attr_parse (struct peer *peer, struct attr *attr, bgp_size_t size,</span>
<span class='curline'><a href='../S/643.html#L1750'>peer</a>             1750 bgpd/bgp_attr.c   endp = BGP_INPUT_PNT (peer) + size;</span>
<span class='curline'><a href='../S/643.html#L1753'>peer</a>             1753 bgpd/bgp_attr.c   while (BGP_INPUT_PNT (peer) &lt; endp)</span>
<span class='curline'><a href='../S/643.html#L1756'>peer</a>             1756 bgpd/bgp_attr.c       if (endp - BGP_INPUT_PNT (peer) &lt; BGP_ATTR_MIN_LEN)</span>
<span class='curline'><a href='../S/643.html#L1759'>peer</a>             1759 bgpd/bgp_attr.c 	  zlog (peer-&gt;log, LOG_WARNING, </span>
<span class='curline'><a href='../S/643.html#L1761'>peer</a>             1761 bgpd/bgp_attr.c 		peer-&gt;host,</span>
<span class='curline'><a href='../S/643.html#L1762'>peer</a>             1762 bgpd/bgp_attr.c 		(unsigned long) (endp - STREAM_PNT (BGP_INPUT (peer))));</span>
<span class='curline'><a href='../S/643.html#L1764'>peer</a>             1764 bgpd/bgp_attr.c 	  bgp_notify_send (peer, </span>
<span class='curline'><a href='../S/643.html#L1771'>peer</a>             1771 bgpd/bgp_attr.c       startp = BGP_INPUT_PNT (peer);</span>
<span class='curline'><a href='../S/643.html#L1775'>peer</a>             1775 bgpd/bgp_attr.c       flag = 0xF0 &amp; stream_getc (BGP_INPUT (peer));</span>
<span class='curline'><a href='../S/643.html#L1776'>peer</a>             1776 bgpd/bgp_attr.c       type = stream_getc (BGP_INPUT (peer));</span>
<span class='curline'><a href='../S/643.html#L1782'>peer</a>             1782 bgpd/bgp_attr.c 	  zlog (peer-&gt;log, LOG_WARNING, </span>
<span class='curline'><a href='../S/643.html#L1784'>peer</a>             1784 bgpd/bgp_attr.c 		peer-&gt;host,</span>
<span class='curline'><a href='../S/643.html#L1785'>peer</a>             1785 bgpd/bgp_attr.c 		(unsigned long) (endp - STREAM_PNT (BGP_INPUT (peer))));</span>
<span class='curline'><a href='../S/643.html#L1787'>peer</a>             1787 bgpd/bgp_attr.c 	  bgp_notify_send (peer, </span>
<span class='curline'><a href='../S/643.html#L1795'>peer</a>             1795 bgpd/bgp_attr.c 	length = stream_getw (BGP_INPUT (peer));</span>
<span class='curline'><a href='../S/643.html#L1797'>peer</a>             1797 bgpd/bgp_attr.c 	length = stream_getc (BGP_INPUT (peer));</span>
<span class='curline'><a href='../S/643.html#L1805'>peer</a>             1805 bgpd/bgp_attr.c 	  zlog (peer-&gt;log, LOG_WARNING,</span>
<span class='curline'><a href='../S/643.html#L1807'>peer</a>             1807 bgpd/bgp_attr.c 		peer-&gt;host, type);</span>
<span class='curline'><a href='../S/643.html#L1809'>peer</a>             1809 bgpd/bgp_attr.c 	  bgp_notify_send (peer, </span>
<span class='curline'><a href='../S/643.html#L1821'>peer</a>             1821 bgpd/bgp_attr.c       attr_endp =  BGP_INPUT_PNT (peer) + length;</span>
<span class='curline'><a href='../S/643.html#L1825'>peer</a>             1825 bgpd/bgp_attr.c 	  zlog (peer-&gt;log, LOG_WARNING, </span>
<span class='curline'><a href='../S/643.html#L1826'>peer</a>             1826 bgpd/bgp_attr.c 		"%s: BGP type %d length %d is too large, attribute total length is %d.  attr_endp is %p.  endp is %p", peer-&gt;host, type, length, size, attr_endp, endp);</span>
<span class='curline'><a href='../S/643.html#L1827'>peer</a>             1827 bgpd/bgp_attr.c 	  bgp_notify_send (peer, </span>
<span class='curline'><a href='../S/643.html#L1834'>peer</a>             1834 bgpd/bgp_attr.c           .peer = peer,</span>
<span class='curline'><a href='../S/643.html#L1917'>peer</a>             1917 bgpd/bgp_attr.c           zlog (peer-&gt;log, LOG_WARNING,</span>
<span class='curline'><a href='../S/643.html#L1919'>peer</a>             1919 bgpd/bgp_attr.c                 peer-&gt;host, </span>
<span class='curline'><a href='../S/643.html#L1921'>peer</a>             1921 bgpd/bgp_attr.c           bgp_notify_send (peer, </span>
<span class='curline'><a href='../S/643.html#L1931'>peer</a>             1931 bgpd/bgp_attr.c           zlog (peer-&gt;log, LOG_WARNING,</span>
<span class='curline'><a href='../S/643.html#L1933'>peer</a>             1933 bgpd/bgp_attr.c                 peer-&gt;host,</span>
<span class='curline'><a href='../S/643.html#L1941'>peer</a>             1941 bgpd/bgp_attr.c       if (BGP_INPUT_PNT (peer) != attr_endp)</span>
<span class='curline'><a href='../S/643.html#L1943'>peer</a>             1943 bgpd/bgp_attr.c 	  zlog (peer-&gt;log, LOG_WARNING, </span>
<span class='curline'><a href='../S/643.html#L1945'>peer</a>             1945 bgpd/bgp_attr.c                 peer-&gt;host, LOOKUP (attr_str, type));</span>
<span class='curline'><a href='../S/643.html#L1946'>peer</a>             1946 bgpd/bgp_attr.c 	  bgp_notify_send (peer, </span>
<span class='curline'><a href='../S/643.html#L1956'>peer</a>             1956 bgpd/bgp_attr.c   if (BGP_INPUT_PNT (peer) != endp)</span>
<span class='curline'><a href='../S/643.html#L1958'>peer</a>             1958 bgpd/bgp_attr.c       zlog (peer-&gt;log, LOG_WARNING, </span>
<span class='curline'><a href='../S/643.html#L1960'>peer</a>             1960 bgpd/bgp_attr.c 	    peer-&gt;host, LOOKUP (attr_str, type));</span>
<span class='curline'><a href='../S/643.html#L1961'>peer</a>             1961 bgpd/bgp_attr.c       bgp_notify_send (peer, </span>
<span class='curline'><a href='../S/643.html#L1980'>peer</a>             1980 bgpd/bgp_attr.c   if (bgp_attr_munge_as4_attrs (peer, attr, as4_path,</span>
<span class='curline'><a href='../S/643.html#L2012'>peer</a>             2012 bgpd/bgp_attr.c       ret = bgp_attr_aspath_check (peer, attr);</span>
<span class='curline'><a href='../S/643.html#L2026'>peer</a>             2026 bgpd/bgp_attr.c bgp_attr_check (struct peer *peer, struct attr *attr)</span>
<span class='curline'><a href='../S/643.html#L2039'>peer</a>             2039 bgpd/bgp_attr.c   if (peer-&gt;sort == BGP_PEER_IBGP</span>
<span class='curline'><a href='../S/643.html#L2045'>peer</a>             2045 bgpd/bgp_attr.c       zlog (peer-&gt;log, LOG_WARNING, </span>
<span class='curline'><a href='../S/643.html#L2047'>peer</a>             2047 bgpd/bgp_attr.c 	    peer-&gt;host, type);</span>
<span class='curline'><a href='../S/643.html#L2048'>peer</a>             2048 bgpd/bgp_attr.c       bgp_notify_send_with_data (peer, </span>
<span class='curline'><a href='../S/643.html#L2061'>peer</a>             2061 bgpd/bgp_attr.c bgp_packet_attribute (struct bgp *bgp, struct peer *peer,</span>
<span class='curline'><a href='../S/643.html#L2063'>peer</a>             2063 bgpd/bgp_attr.c 		      afi_t afi, safi_t safi, struct peer *from,</span>
<span class='curline'><a href='../S/643.html#L2071'>peer</a>             2071 bgpd/bgp_attr.c   int use32bit = (CHECK_FLAG (peer-&gt;cap, PEER_CAP_AS4_RCV)) ? 1 : 0;</span>
<span class='curline'><a href='../S/643.html#L2088'>peer</a>             2088 bgpd/bgp_attr.c   if (peer-&gt;sort == BGP_PEER_EBGP</span>
<span class='curline'><a href='../S/643.html#L2089'>peer</a>             2089 bgpd/bgp_attr.c       &amp;&amp; (! CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_AS_PATH_UNCHANGED)</span>
<span class='curline'><a href='../S/643.html#L2091'>peer</a>             2091 bgpd/bgp_attr.c       &amp;&amp; (! CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_RSERVER_CLIENT)))</span>
<span class='curline'><a href='../S/643.html#L2104'>peer</a>             2104 bgpd/bgp_attr.c 	  if (peer-&gt;change_local_as) {</span>
<span class='curline'><a href='../S/643.html#L2107'>peer</a>             2107 bgpd/bgp_attr.c             if( ! CHECK_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_REPLACE_AS) ) {</span>
<span class='curline'><a href='../S/643.html#L2108'>peer</a>             2108 bgpd/bgp_attr.c               aspath = aspath_add_seq (aspath, peer-&gt;local_as);</span>
<span class='curline'><a href='../S/643.html#L2110'>peer</a>             2110 bgpd/bgp_attr.c 	    aspath = aspath_add_seq (aspath, peer-&gt;change_local_as);</span>
<span class='curline'><a href='../S/643.html#L2112'>peer</a>             2112 bgpd/bgp_attr.c             aspath = aspath_add_seq (aspath, peer-&gt;local_as);</span>
<span class='curline'><a href='../S/643.html#L2116'>peer</a>             2116 bgpd/bgp_attr.c   else if (peer-&gt;sort == BGP_PEER_CONFED)</span>
<span class='curline'><a href='../S/643.html#L2120'>peer</a>             2120 bgpd/bgp_attr.c       aspath = aspath_add_confed_seq (aspath, peer-&gt;local_as);</span>
<span class='curline'><a href='../S/643.html#L2155'>peer</a>             2155 bgpd/bgp_attr.c 	    stream_put_ipv4 (s, peer-&gt;nexthop.v4.s_addr);</span>
<span class='curline'><a href='../S/643.html#L2173'>peer</a>             2173 bgpd/bgp_attr.c   if (peer-&gt;sort == BGP_PEER_IBGP ||</span>
<span class='curline'><a href='../S/643.html#L2174'>peer</a>             2174 bgpd/bgp_attr.c       peer-&gt;sort == BGP_PEER_CONFED)</span>
<span class='curline'><a href='../S/643.html#L2228'>peer</a>             2228 bgpd/bgp_attr.c   if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_SEND_COMMUNITY) </span>
<span class='curline'><a href='../S/643.html#L2247'>peer</a>             2247 bgpd/bgp_attr.c   if (peer-&gt;sort == BGP_PEER_IBGP</span>
<span class='curline'><a href='../S/643.html#L2378'>peer</a>             2378 bgpd/bgp_attr.c   if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_SEND_EXT_COMMUNITY) </span>
<span class='curline'><a href='../S/643.html#L2385'>peer</a>             2385 bgpd/bgp_attr.c       if (peer-&gt;sort == BGP_PEER_IBGP</span>
<span class='curline'><a href='../S/643.html#L2386'>peer</a>             2386 bgpd/bgp_attr.c           || peer-&gt;sort == BGP_PEER_CONFED)</span>
<span class='curline'><a href='../S/643.html#L2499'>peer</a>             2499 bgpd/bgp_attr.c bgp_packet_withdraw (struct peer *peer, struct stream *s, struct prefix *p,</span>
<span class='curline'><a href='../S/642.html#L144'>peer</a>              144 bgpd/bgp_attr.h extern bgp_attr_parse_ret_t bgp_attr_parse (struct peer *, struct attr *,</span>
<span class='curline'><a href='../S/642.html#L147'>peer</a>              147 bgpd/bgp_attr.h extern int bgp_attr_check (struct peer *, struct attr *);</span>
<span class='curline'><a href='../S/642.html#L160'>peer</a>              160 bgpd/bgp_attr.h extern bgp_size_t bgp_packet_attribute (struct bgp *bgp, struct peer *, </span>
<span class='curline'><a href='../S/642.html#L163'>peer</a>              163 bgpd/bgp_attr.h                                  struct peer *, struct prefix_rd *, u_char *);</span>
<span class='curline'><a href='../S/642.html#L164'>peer</a>              164 bgpd/bgp_attr.h extern bgp_size_t bgp_packet_withdraw (struct peer *peer, struct stream *s, </span>
<span class='curline'><a href='../S/642.html#L184'>peer</a>              184 bgpd/bgp_attr.h   struct peer *peer;</span>
<span class='curline'><a href='../S/633.html#L236'>peer</a>              236 bgpd/bgp_btoa.c 	  struct in_addr peer;</span>
<span class='curline'><a href='../S/633.html#L253'>peer</a>              253 bgpd/bgp_btoa.c 	      peer.s_addr = stream_get_ipv4 (s);</span>
<span class='curline'><a href='../S/633.html#L256'>peer</a>              256 bgpd/bgp_btoa.c 	      printf ("FROM: %s AS%d\n", inet_ntoa (peer), source_as);</span>
<span class='curline'><a href='../S/607.html#L134'>peer</a>              134 bgpd/bgp_damp.c       struct bgp *bgp = bdi-&gt;binfo-&gt;peer-&gt;bgp;</span>
<span class='curline'><a href='../S/613.html#L165'>peer</a>              165 bgpd/bgp_debug.c bgp_dump_attr (struct peer *peer, struct attr *attr, char *buf, size_t size)</span>
<span class='curline'><a href='../S/613.html#L242'>peer</a>              242 bgpd/bgp_debug.c bgp_notify_print(struct peer *peer, struct bgp_notify *bgp_notify, </span>
<span class='curline'><a href='../S/613.html#L280'>peer</a>              280 bgpd/bgp_debug.c   if (bgp_flag_check (peer-&gt;bgp, BGP_FLAG_LOG_NEIGHBOR_CHANGES))</span>
<span class='curline'><a href='../S/613.html#L283'>peer</a>              283 bgpd/bgp_debug.c               peer-&gt;host, bgp_notify-&gt;code, bgp_notify-&gt;subcode,</span>
<span class='curline'><a href='../S/613.html#L287'>peer</a>              287 bgpd/bgp_debug.c     plog_debug (peer-&gt;log, "%s %s NOTIFICATION %d/%d (%s%s) %d bytes %s",</span>
<span class='curline'><a href='../S/613.html#L288'>peer</a>              288 bgpd/bgp_debug.c 	       peer ? peer-&gt;host : "",</span>
<span class='curline'><a href='../S/662.html#L122'>peer</a>              122 bgpd/bgp_debug.h extern int bgp_dump_attr (struct peer *, struct attr *, char *, size_t);</span>
<span class='curline'><a href='../S/662.html#L123'>peer</a>              123 bgpd/bgp_debug.h extern void bgp_notify_print (struct peer *, struct bgp_notify *, const char *);</span>
<span class='curline'><a href='../S/626.html#L198'>peer</a>              198 bgpd/bgp_dump.c   struct peer *peer;</span>
<span class='curline'><a href='../S/626.html#L224'>peer</a>              224 bgpd/bgp_dump.c   stream_putw (obuf, listcount(bgp-&gt;peer));</span>
<span class='curline'><a href='../S/626.html#L227'>peer</a>              227 bgpd/bgp_dump.c   for(ALL_LIST_ELEMENTS_RO (bgp-&gt;peer, node, peer))</span>
<span class='curline'><a href='../S/626.html#L231'>peer</a>              231 bgpd/bgp_dump.c       if (sockunion_family(&amp;peer-&gt;su) == AF_INET)</span>
<span class='curline'><a href='../S/626.html#L236'>peer</a>              236 bgpd/bgp_dump.c       else if (sockunion_family(&amp;peer-&gt;su) == AF_INET6)</span>
<span class='curline'><a href='../S/626.html#L243'>peer</a>              243 bgpd/bgp_dump.c       stream_put_in_addr (obuf, &amp;peer-&gt;remote_id);</span>
<span class='curline'><a href='../S/626.html#L246'>peer</a>              246 bgpd/bgp_dump.c       if (sockunion_family(&amp;peer-&gt;su) == AF_INET)</span>
<span class='curline'><a href='../S/626.html#L248'>peer</a>              248 bgpd/bgp_dump.c           stream_put_in_addr (obuf, &amp;peer-&gt;su.sin.sin_addr);</span>
<span class='curline'><a href='../S/626.html#L251'>peer</a>              251 bgpd/bgp_dump.c       else if (sockunion_family(&amp;peer-&gt;su) == AF_INET6)</span>
<span class='curline'><a href='../S/626.html#L253'>peer</a>              253 bgpd/bgp_dump.c           stream_write (obuf, (u_char *)&amp;peer-&gt;su.sin6.sin6_addr,</span>
<span class='curline'><a href='../S/626.html#L260'>peer</a>              260 bgpd/bgp_dump.c       stream_putl (obuf, peer-&gt;as);</span>
<span class='curline'><a href='../S/626.html#L263'>peer</a>              263 bgpd/bgp_dump.c       peer-&gt;table_dump_index = peerno;</span>
<span class='curline'><a href='../S/626.html#L356'>peer</a>              356 bgpd/bgp_dump.c           stream_putw(obuf, info-&gt;peer-&gt;table_dump_index);</span>
<span class='curline'><a href='../S/626.html#L417'>peer</a>              417 bgpd/bgp_dump.c bgp_dump_common (struct stream *obuf, struct peer *peer, int forceas4)</span>
<span class='curline'><a href='../S/626.html#L422'>peer</a>              422 bgpd/bgp_dump.c   if (forceas4 || CHECK_FLAG (peer-&gt;cap, PEER_CAP_AS4_RCV) )</span>
<span class='curline'><a href='../S/626.html#L424'>peer</a>              424 bgpd/bgp_dump.c       stream_putl (obuf, peer-&gt;as);</span>
<span class='curline'><a href='../S/626.html#L425'>peer</a>              425 bgpd/bgp_dump.c       stream_putl (obuf, peer-&gt;local_as);</span>
<span class='curline'><a href='../S/626.html#L429'>peer</a>              429 bgpd/bgp_dump.c       stream_putw (obuf, peer-&gt;as);</span>
<span class='curline'><a href='../S/626.html#L430'>peer</a>              430 bgpd/bgp_dump.c       stream_putw (obuf, peer-&gt;local_as);</span>
<span class='curline'><a href='../S/626.html#L433'>peer</a>              433 bgpd/bgp_dump.c   if (peer-&gt;su.sa.sa_family == AF_INET)</span>
<span class='curline'><a href='../S/626.html#L435'>peer</a>              435 bgpd/bgp_dump.c       stream_putw (obuf, peer-&gt;ifindex);</span>
<span class='curline'><a href='../S/626.html#L438'>peer</a>              438 bgpd/bgp_dump.c       stream_put (obuf, &amp;peer-&gt;su.sin.sin_addr, IPV4_MAX_BYTELEN);</span>
<span class='curline'><a href='../S/626.html#L440'>peer</a>              440 bgpd/bgp_dump.c       if (peer-&gt;su_local)</span>
<span class='curline'><a href='../S/626.html#L441'>peer</a>              441 bgpd/bgp_dump.c 	stream_put (obuf, &amp;peer-&gt;su_local-&gt;sin.sin_addr, IPV4_MAX_BYTELEN);</span>
<span class='curline'><a href='../S/626.html#L446'>peer</a>              446 bgpd/bgp_dump.c   else if (peer-&gt;su.sa.sa_family == AF_INET6)</span>
<span class='curline'><a href='../S/626.html#L449'>peer</a>              449 bgpd/bgp_dump.c       stream_putw (obuf, peer-&gt;ifindex);</span>
<span class='curline'><a href='../S/626.html#L453'>peer</a>              453 bgpd/bgp_dump.c       stream_put (obuf, &amp;peer-&gt;su.sin6.sin6_addr, IPV6_MAX_BYTELEN);</span>
<span class='curline'><a href='../S/626.html#L455'>peer</a>              455 bgpd/bgp_dump.c       if (peer-&gt;su_local)</span>
<span class='curline'><a href='../S/626.html#L456'>peer</a>              456 bgpd/bgp_dump.c 	stream_put (obuf, &amp;peer-&gt;su_local-&gt;sin6.sin6_addr, IPV6_MAX_BYTELEN);</span>
<span class='curline'><a href='../S/626.html#L465'>peer</a>              465 bgpd/bgp_dump.c bgp_dump_state (struct peer *peer, int status_old, int status_new)</span>
<span class='curline'><a href='../S/626.html#L478'>peer</a>              478 bgpd/bgp_dump.c   bgp_dump_common (obuf, peer, 1);/* force this in as4speak*/</span>
<span class='curline'><a href='../S/626.html#L492'>peer</a>              492 bgpd/bgp_dump.c bgp_dump_packet_func (struct bgp_dump *bgp_dump, struct peer *peer,</span>
<span class='curline'><a href='../S/626.html#L506'>peer</a>              506 bgpd/bgp_dump.c   if (CHECK_FLAG (peer-&gt;cap, PEER_CAP_AS4_RCV) )</span>
<span class='curline'><a href='../S/626.html#L514'>peer</a>              514 bgpd/bgp_dump.c   bgp_dump_common (obuf, peer, 0);</span>
<span class='curline'><a href='../S/626.html#L529'>peer</a>              529 bgpd/bgp_dump.c bgp_dump_packet (struct peer *peer, int type, struct stream *packet)</span>
<span class='curline'><a href='../S/626.html#L532'>peer</a>              532 bgpd/bgp_dump.c   bgp_dump_packet_func (&amp;bgp_dump_all, peer, packet);</span>
<span class='curline'><a href='../S/626.html#L536'>peer</a>              536 bgpd/bgp_dump.c     bgp_dump_packet_func (&amp;bgp_dump_updates, peer, packet);</span>
<span class='curline'><a href='../S/616.html#L52'>peer</a>               52 bgpd/bgp_dump.h extern void bgp_dump_state (struct peer *, int, int);</span>
<span class='curline'><a href='../S/616.html#L53'>peer</a>               53 bgpd/bgp_dump.h extern void bgp_dump_packet (struct peer *, int, struct stream *);</span>
<span class='curline'><a href='../S/655.html#L62'>peer</a>               62 bgpd/bgp_fsm.c static int bgp_start (struct peer *);</span>
<span class='curline'><a href='../S/655.html#L80'>peer</a>               80 bgpd/bgp_fsm.c bgp_timer_set (struct peer *peer)</span>
<span class='curline'><a href='../S/655.html#L84'>peer</a>               84 bgpd/bgp_fsm.c   switch (peer-&gt;status)</span>
<span class='curline'><a href='../S/655.html#L90'>peer</a>               90 bgpd/bgp_fsm.c       if (BGP_PEER_START_SUPPRESSED (peer) || ! peer_active (peer))</span>
<span class='curline'><a href='../S/655.html#L92'>peer</a>               92 bgpd/bgp_fsm.c 	  BGP_TIMER_OFF (peer-&gt;t_start);</span>
<span class='curline'><a href='../S/655.html#L96'>peer</a>               96 bgpd/bgp_fsm.c 	  jitter = bgp_start_jitter (peer-&gt;v_start);</span>
<span class='curline'><a href='../S/655.html#L97'>peer</a>               97 bgpd/bgp_fsm.c 	  BGP_TIMER_ON (peer-&gt;t_start, bgp_start_timer,</span>
<span class='curline'><a href='../S/655.html#L98'>peer</a>               98 bgpd/bgp_fsm.c 			peer-&gt;v_start + jitter);</span>
<span class='curline'><a href='../S/655.html#L100'>peer</a>              100 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_connect);</span>
<span class='curline'><a href='../S/655.html#L101'>peer</a>              101 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_holdtime);</span>
<span class='curline'><a href='../S/655.html#L102'>peer</a>              102 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_keepalive);</span>
<span class='curline'><a href='../S/655.html#L103'>peer</a>              103 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_asorig);</span>
<span class='curline'><a href='../S/655.html#L104'>peer</a>              104 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_routeadv);</span>
<span class='curline'><a href='../S/655.html#L111'>peer</a>              111 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_start);</span>
<span class='curline'><a href='../S/655.html#L112'>peer</a>              112 bgpd/bgp_fsm.c       BGP_TIMER_ON (peer-&gt;t_connect, bgp_connect_timer, peer-&gt;v_connect);</span>
<span class='curline'><a href='../S/655.html#L113'>peer</a>              113 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_holdtime);</span>
<span class='curline'><a href='../S/655.html#L114'>peer</a>              114 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_keepalive);</span>
<span class='curline'><a href='../S/655.html#L115'>peer</a>              115 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_asorig);</span>
<span class='curline'><a href='../S/655.html#L116'>peer</a>              116 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_routeadv);</span>
<span class='curline'><a href='../S/655.html#L122'>peer</a>              122 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_start);</span>
<span class='curline'><a href='../S/655.html#L124'>peer</a>              124 bgpd/bgp_fsm.c       if (CHECK_FLAG (peer-&gt;flags, PEER_FLAG_PASSIVE)</span>
<span class='curline'><a href='../S/655.html#L125'>peer</a>              125 bgpd/bgp_fsm.c 	  || CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_NSF_WAIT))</span>
<span class='curline'><a href='../S/655.html#L127'>peer</a>              127 bgpd/bgp_fsm.c 	  BGP_TIMER_OFF (peer-&gt;t_connect);</span>
<span class='curline'><a href='../S/655.html#L131'>peer</a>              131 bgpd/bgp_fsm.c 	  BGP_TIMER_ON (peer-&gt;t_connect, bgp_connect_timer, peer-&gt;v_connect);</span>
<span class='curline'><a href='../S/655.html#L133'>peer</a>              133 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_holdtime);</span>
<span class='curline'><a href='../S/655.html#L134'>peer</a>              134 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_keepalive);</span>
<span class='curline'><a href='../S/655.html#L135'>peer</a>              135 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_asorig);</span>
<span class='curline'><a href='../S/655.html#L136'>peer</a>              136 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_routeadv);</span>
<span class='curline'><a href='../S/655.html#L141'>peer</a>              141 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_start);</span>
<span class='curline'><a href='../S/655.html#L142'>peer</a>              142 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_connect);</span>
<span class='curline'><a href='../S/655.html#L143'>peer</a>              143 bgpd/bgp_fsm.c       if (peer-&gt;v_holdtime != 0)</span>
<span class='curline'><a href='../S/655.html#L145'>peer</a>              145 bgpd/bgp_fsm.c 	  BGP_TIMER_ON (peer-&gt;t_holdtime, bgp_holdtime_timer, </span>
<span class='curline'><a href='../S/655.html#L146'>peer</a>              146 bgpd/bgp_fsm.c 			peer-&gt;v_holdtime);</span>
<span class='curline'><a href='../S/655.html#L150'>peer</a>              150 bgpd/bgp_fsm.c 	  BGP_TIMER_OFF (peer-&gt;t_holdtime);</span>
<span class='curline'><a href='../S/655.html#L152'>peer</a>              152 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_keepalive);</span>
<span class='curline'><a href='../S/655.html#L153'>peer</a>              153 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_asorig);</span>
<span class='curline'><a href='../S/655.html#L154'>peer</a>              154 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_routeadv);</span>
<span class='curline'><a href='../S/655.html#L159'>peer</a>              159 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_start);</span>
<span class='curline'><a href='../S/655.html#L160'>peer</a>              160 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_connect);</span>
<span class='curline'><a href='../S/655.html#L164'>peer</a>              164 bgpd/bgp_fsm.c       if (peer-&gt;v_holdtime == 0)</span>
<span class='curline'><a href='../S/655.html#L166'>peer</a>              166 bgpd/bgp_fsm.c 	  BGP_TIMER_OFF (peer-&gt;t_holdtime);</span>
<span class='curline'><a href='../S/655.html#L167'>peer</a>              167 bgpd/bgp_fsm.c 	  BGP_TIMER_OFF (peer-&gt;t_keepalive);</span>
<span class='curline'><a href='../S/655.html#L171'>peer</a>              171 bgpd/bgp_fsm.c 	  BGP_TIMER_ON (peer-&gt;t_holdtime, bgp_holdtime_timer,</span>
<span class='curline'><a href='../S/655.html#L172'>peer</a>              172 bgpd/bgp_fsm.c 			peer-&gt;v_holdtime);</span>
<span class='curline'><a href='../S/655.html#L173'>peer</a>              173 bgpd/bgp_fsm.c 	  BGP_TIMER_ON (peer-&gt;t_keepalive, bgp_keepalive_timer, </span>
<span class='curline'><a href='../S/655.html#L174'>peer</a>              174 bgpd/bgp_fsm.c 			peer-&gt;v_keepalive);</span>
<span class='curline'><a href='../S/655.html#L176'>peer</a>              176 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_asorig);</span>
<span class='curline'><a href='../S/655.html#L177'>peer</a>              177 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_routeadv);</span>
<span class='curline'><a href='../S/655.html#L183'>peer</a>              183 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_start);</span>
<span class='curline'><a href='../S/655.html#L184'>peer</a>              184 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_connect);</span>
<span class='curline'><a href='../S/655.html#L188'>peer</a>              188 bgpd/bgp_fsm.c       if (peer-&gt;v_holdtime == 0)</span>
<span class='curline'><a href='../S/655.html#L190'>peer</a>              190 bgpd/bgp_fsm.c 	  BGP_TIMER_OFF (peer-&gt;t_holdtime);</span>
<span class='curline'><a href='../S/655.html#L191'>peer</a>              191 bgpd/bgp_fsm.c 	  BGP_TIMER_OFF (peer-&gt;t_keepalive);</span>
<span class='curline'><a href='../S/655.html#L195'>peer</a>              195 bgpd/bgp_fsm.c 	  BGP_TIMER_ON (peer-&gt;t_holdtime, bgp_holdtime_timer,</span>
<span class='curline'><a href='../S/655.html#L196'>peer</a>              196 bgpd/bgp_fsm.c 			peer-&gt;v_holdtime);</span>
<span class='curline'><a href='../S/655.html#L197'>peer</a>              197 bgpd/bgp_fsm.c 	  BGP_TIMER_ON (peer-&gt;t_keepalive, bgp_keepalive_timer,</span>
<span class='curline'><a href='../S/655.html#L198'>peer</a>              198 bgpd/bgp_fsm.c 			peer-&gt;v_keepalive);</span>
<span class='curline'><a href='../S/655.html#L200'>peer</a>              200 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_asorig);</span>
<span class='curline'><a href='../S/655.html#L203'>peer</a>              203 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_gr_restart);</span>
<span class='curline'><a href='../S/655.html#L204'>peer</a>              204 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_gr_stale);</span>
<span class='curline'><a href='../S/655.html#L205'>peer</a>              205 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_pmax_restart);</span>
<span class='curline'><a href='../S/655.html#L207'>peer</a>              207 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_start);</span>
<span class='curline'><a href='../S/655.html#L208'>peer</a>              208 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_connect);</span>
<span class='curline'><a href='../S/655.html#L209'>peer</a>              209 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_holdtime);</span>
<span class='curline'><a href='../S/655.html#L210'>peer</a>              210 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_keepalive);</span>
<span class='curline'><a href='../S/655.html#L211'>peer</a>              211 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_asorig);</span>
<span class='curline'><a href='../S/655.html#L212'>peer</a>              212 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_routeadv);</span>
<span class='curline'><a href='../S/655.html#L221'>peer</a>              221 bgpd/bgp_fsm.c   struct peer *peer;</span>
<span class='curline'><a href='../S/655.html#L223'>peer</a>              223 bgpd/bgp_fsm.c   peer = THREAD_ARG (thread);</span>
<span class='curline'><a href='../S/655.html#L224'>peer</a>              224 bgpd/bgp_fsm.c   peer-&gt;t_start = NULL;</span>
<span class='curline'><a href='../S/655.html#L227'>peer</a>              227 bgpd/bgp_fsm.c     zlog (peer-&gt;log, LOG_DEBUG,</span>
<span class='curline'><a href='../S/655.html#L228'>peer</a>              228 bgpd/bgp_fsm.c 	  "%s [FSM] Timer (start timer expire).", peer-&gt;host);</span>
<span class='curline'><a href='../S/655.html#L240'>peer</a>              240 bgpd/bgp_fsm.c   struct peer *peer;</span>
<span class='curline'><a href='../S/655.html#L242'>peer</a>              242 bgpd/bgp_fsm.c   peer = THREAD_ARG (thread);</span>
<span class='curline'><a href='../S/655.html#L243'>peer</a>              243 bgpd/bgp_fsm.c   peer-&gt;t_connect = NULL;</span>
<span class='curline'><a href='../S/655.html#L246'>peer</a>              246 bgpd/bgp_fsm.c     zlog (peer-&gt;log, LOG_DEBUG, "%s [FSM] Timer (connect timer expire)",</span>
<span class='curline'><a href='../S/655.html#L247'>peer</a>              247 bgpd/bgp_fsm.c 	  peer-&gt;host);</span>
<span class='curline'><a href='../S/655.html#L259'>peer</a>              259 bgpd/bgp_fsm.c   struct peer *peer;</span>
<span class='curline'><a href='../S/655.html#L261'>peer</a>              261 bgpd/bgp_fsm.c   peer = THREAD_ARG (thread);</span>
<span class='curline'><a href='../S/655.html#L262'>peer</a>              262 bgpd/bgp_fsm.c   peer-&gt;t_holdtime = NULL;</span>
<span class='curline'><a href='../S/655.html#L265'>peer</a>              265 bgpd/bgp_fsm.c     zlog (peer-&gt;log, LOG_DEBUG,</span>
<span class='curline'><a href='../S/655.html#L267'>peer</a>              267 bgpd/bgp_fsm.c 	  peer-&gt;host);</span>
<span class='curline'><a href='../S/655.html#L279'>peer</a>              279 bgpd/bgp_fsm.c   struct peer *peer;</span>
<span class='curline'><a href='../S/655.html#L281'>peer</a>              281 bgpd/bgp_fsm.c   peer = THREAD_ARG (thread);</span>
<span class='curline'><a href='../S/655.html#L282'>peer</a>              282 bgpd/bgp_fsm.c   peer-&gt;t_keepalive = NULL;</span>
<span class='curline'><a href='../S/655.html#L285'>peer</a>              285 bgpd/bgp_fsm.c     zlog (peer-&gt;log, LOG_DEBUG,</span>
<span class='curline'><a href='../S/655.html#L287'>peer</a>              287 bgpd/bgp_fsm.c 	  peer-&gt;host);</span>
<span class='curline'><a href='../S/655.html#L298'>peer</a>              298 bgpd/bgp_fsm.c   struct peer *peer;</span>
<span class='curline'><a href='../S/655.html#L300'>peer</a>              300 bgpd/bgp_fsm.c   peer = THREAD_ARG (thread);</span>
<span class='curline'><a href='../S/655.html#L301'>peer</a>              301 bgpd/bgp_fsm.c   peer-&gt;t_routeadv = NULL;</span>
<span class='curline'><a href='../S/655.html#L304'>peer</a>              304 bgpd/bgp_fsm.c     zlog (peer-&gt;log, LOG_DEBUG,</span>
<span class='curline'><a href='../S/655.html#L306'>peer</a>              306 bgpd/bgp_fsm.c 	  peer-&gt;host);</span>
<span class='curline'><a href='../S/655.html#L308'>peer</a>              308 bgpd/bgp_fsm.c   peer-&gt;synctime = bgp_clock ();</span>
<span class='curline'><a href='../S/655.html#L310'>peer</a>              310 bgpd/bgp_fsm.c   BGP_WRITE_ON (peer-&gt;t_write, bgp_write, peer-&gt;fd);</span>
<span class='curline'><a href='../S/655.html#L312'>peer</a>              312 bgpd/bgp_fsm.c   BGP_TIMER_ON (peer-&gt;t_routeadv, bgp_routeadv_timer,</span>
<span class='curline'><a href='../S/655.html#L313'>peer</a>              313 bgpd/bgp_fsm.c 		peer-&gt;v_routeadv);</span>
<span class='curline'><a href='../S/655.html#L349'>peer</a>              349 bgpd/bgp_fsm.c   struct peer *peer;</span>
<span class='curline'><a href='../S/655.html#L353'>peer</a>              353 bgpd/bgp_fsm.c   peer = THREAD_ARG (thread);</span>
<span class='curline'><a href='../S/655.html#L354'>peer</a>              354 bgpd/bgp_fsm.c   peer-&gt;t_gr_restart = NULL;</span>
<span class='curline'><a href='../S/655.html#L359'>peer</a>              359 bgpd/bgp_fsm.c       if (peer-&gt;nsf[afi][safi])</span>
<span class='curline'><a href='../S/655.html#L360'>peer</a>              360 bgpd/bgp_fsm.c 	bgp_clear_stale_route (peer, afi, safi);</span>
<span class='curline'><a href='../S/655.html#L362'>peer</a>              362 bgpd/bgp_fsm.c   UNSET_FLAG (peer-&gt;sflags, PEER_STATUS_NSF_WAIT);</span>
<span class='curline'><a href='../S/655.html#L363'>peer</a>              363 bgpd/bgp_fsm.c   BGP_TIMER_OFF (peer-&gt;t_gr_stale);</span>
<span class='curline'><a href='../S/655.html#L367'>peer</a>              367 bgpd/bgp_fsm.c       zlog_debug ("%s graceful restart timer expired", peer-&gt;host);</span>
<span class='curline'><a href='../S/655.html#L368'>peer</a>              368 bgpd/bgp_fsm.c       zlog_debug ("%s graceful restart stalepath timer stopped", peer-&gt;host);</span>
<span class='curline'><a href='../S/655.html#L371'>peer</a>              371 bgpd/bgp_fsm.c   bgp_timer_set (peer);</span>
<span class='curline'><a href='../S/655.html#L379'>peer</a>              379 bgpd/bgp_fsm.c   struct peer *peer;</span>
<span class='curline'><a href='../S/655.html#L383'>peer</a>              383 bgpd/bgp_fsm.c   peer = THREAD_ARG (thread);</span>
<span class='curline'><a href='../S/655.html#L384'>peer</a>              384 bgpd/bgp_fsm.c   peer-&gt;t_gr_stale = NULL;</span>
<span class='curline'><a href='../S/655.html#L387'>peer</a>              387 bgpd/bgp_fsm.c     zlog_debug ("%s graceful restart stalepath timer expired", peer-&gt;host);</span>
<span class='curline'><a href='../S/655.html#L392'>peer</a>              392 bgpd/bgp_fsm.c       if (peer-&gt;nsf[afi][safi])</span>
<span class='curline'><a href='../S/655.html#L393'>peer</a>              393 bgpd/bgp_fsm.c 	bgp_clear_stale_route (peer, afi, safi);</span>
<span class='curline'><a href='../S/655.html#L401'>peer</a>              401 bgpd/bgp_fsm.c bgp_fsm_change_status (struct peer *peer, int status)</span>
<span class='curline'><a href='../S/655.html#L403'>peer</a>              403 bgpd/bgp_fsm.c   bgp_dump_state (peer, peer-&gt;status, status);</span>
<span class='curline'><a href='../S/655.html#L409'>peer</a>              409 bgpd/bgp_fsm.c     bgp_clear_route_all (peer);</span>
<span class='curline'><a href='../S/655.html#L412'>peer</a>              412 bgpd/bgp_fsm.c   peer-&gt;ostatus = peer-&gt;status;</span>
<span class='curline'><a href='../S/655.html#L413'>peer</a>              413 bgpd/bgp_fsm.c   peer-&gt;status = status;</span>
<span class='curline'><a href='../S/655.html#L417'>peer</a>              417 bgpd/bgp_fsm.c 		peer-&gt;host,</span>
<span class='curline'><a href='../S/655.html#L418'>peer</a>              418 bgpd/bgp_fsm.c 		LOOKUP (bgp_status_msg, peer-&gt;ostatus),</span>
<span class='curline'><a href='../S/655.html#L419'>peer</a>              419 bgpd/bgp_fsm.c 		LOOKUP (bgp_status_msg, peer-&gt;status));</span>
<span class='curline'><a href='../S/655.html#L424'>peer</a>              424 bgpd/bgp_fsm.c bgp_clearing_completed (struct peer *peer)</span>
<span class='curline'><a href='../S/655.html#L426'>peer</a>              426 bgpd/bgp_fsm.c   int rc = bgp_stop(peer);</span>
<span class='curline'><a href='../S/655.html#L427'>peer</a>              427 bgpd/bgp_fsm.c   BGP_EVENT_FLUSH (peer);</span>
<span class='curline'><a href='../S/655.html#L435'>peer</a>              435 bgpd/bgp_fsm.c bgp_stop (struct peer *peer)</span>
<span class='curline'><a href='../S/655.html#L442'>peer</a>              442 bgpd/bgp_fsm.c   if (peer-&gt;status != Clearing)</span>
<span class='curline'><a href='../S/655.html#L445'>peer</a>              445 bgpd/bgp_fsm.c       BGP_EVENT_FLUSH (peer);</span>
<span class='curline'><a href='../S/655.html#L449'>peer</a>              449 bgpd/bgp_fsm.c   if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/655.html#L451'>peer</a>              451 bgpd/bgp_fsm.c       peer-&gt;dropped++;</span>
<span class='curline'><a href='../S/655.html#L454'>peer</a>              454 bgpd/bgp_fsm.c       if (bgp_flag_check (peer-&gt;bgp, BGP_FLAG_LOG_NEIGHBOR_CHANGES))</span>
<span class='curline'><a href='../S/655.html#L455'>peer</a>              455 bgpd/bgp_fsm.c 	zlog_info ("%%ADJCHANGE: neighbor %s Down %s", peer-&gt;host,</span>
<span class='curline'><a href='../S/655.html#L456'>peer</a>              456 bgpd/bgp_fsm.c                    peer_down_str [(int) peer-&gt;last_reset]);</span>
<span class='curline'><a href='../S/655.html#L459'>peer</a>              459 bgpd/bgp_fsm.c       if (peer-&gt;t_gr_stale)</span>
<span class='curline'><a href='../S/655.html#L461'>peer</a>              461 bgpd/bgp_fsm.c 	  BGP_TIMER_OFF (peer-&gt;t_gr_stale);</span>
<span class='curline'><a href='../S/655.html#L463'>peer</a>              463 bgpd/bgp_fsm.c 	    zlog_debug ("%s graceful restart stalepath timer stopped", peer-&gt;host);</span>
<span class='curline'><a href='../S/655.html#L465'>peer</a>              465 bgpd/bgp_fsm.c       if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_NSF_WAIT))</span>
<span class='curline'><a href='../S/655.html#L470'>peer</a>              470 bgpd/bgp_fsm.c 			  peer-&gt;host, peer-&gt;v_gr_restart);</span>
<span class='curline'><a href='../S/655.html#L472'>peer</a>              472 bgpd/bgp_fsm.c 			  peer-&gt;host, peer-&gt;bgp-&gt;stalepath_time);</span>
<span class='curline'><a href='../S/655.html#L474'>peer</a>              474 bgpd/bgp_fsm.c 	  BGP_TIMER_ON (peer-&gt;t_gr_restart, bgp_graceful_restart_timer_expire,</span>
<span class='curline'><a href='../S/655.html#L475'>peer</a>              475 bgpd/bgp_fsm.c 			peer-&gt;v_gr_restart);</span>
<span class='curline'><a href='../S/655.html#L476'>peer</a>              476 bgpd/bgp_fsm.c 	  BGP_TIMER_ON (peer-&gt;t_gr_stale, bgp_graceful_stale_timer_expire,</span>
<span class='curline'><a href='../S/655.html#L477'>peer</a>              477 bgpd/bgp_fsm.c 			peer-&gt;bgp-&gt;stalepath_time);</span>
<span class='curline'><a href='../S/655.html#L481'>peer</a>              481 bgpd/bgp_fsm.c 	  UNSET_FLAG (peer-&gt;sflags, PEER_STATUS_NSF_MODE);</span>
<span class='curline'><a href='../S/655.html#L485'>peer</a>              485 bgpd/bgp_fsm.c 	      peer-&gt;nsf[afi][safi] = 0;</span>
<span class='curline'><a href='../S/655.html#L489'>peer</a>              489 bgpd/bgp_fsm.c       peer-&gt;resettime = peer-&gt;uptime = bgp_clock ();</span>
<span class='curline'><a href='../S/655.html#L492'>peer</a>              492 bgpd/bgp_fsm.c       bgpTrapBackwardTransition (peer);</span>
<span class='curline'><a href='../S/655.html#L496'>peer</a>              496 bgpd/bgp_fsm.c       peer-&gt;synctime = 0;</span>
<span class='curline'><a href='../S/655.html#L500'>peer</a>              500 bgpd/bgp_fsm.c   BGP_READ_OFF (peer-&gt;t_read);</span>
<span class='curline'><a href='../S/655.html#L501'>peer</a>              501 bgpd/bgp_fsm.c   BGP_WRITE_OFF (peer-&gt;t_write);</span>
<span class='curline'><a href='../S/655.html#L504'>peer</a>              504 bgpd/bgp_fsm.c   BGP_TIMER_OFF (peer-&gt;t_start);</span>
<span class='curline'><a href='../S/655.html#L505'>peer</a>              505 bgpd/bgp_fsm.c   BGP_TIMER_OFF (peer-&gt;t_connect);</span>
<span class='curline'><a href='../S/655.html#L506'>peer</a>              506 bgpd/bgp_fsm.c   BGP_TIMER_OFF (peer-&gt;t_holdtime);</span>
<span class='curline'><a href='../S/655.html#L507'>peer</a>              507 bgpd/bgp_fsm.c   BGP_TIMER_OFF (peer-&gt;t_keepalive);</span>
<span class='curline'><a href='../S/655.html#L508'>peer</a>              508 bgpd/bgp_fsm.c   BGP_TIMER_OFF (peer-&gt;t_asorig);</span>
<span class='curline'><a href='../S/655.html#L509'>peer</a>              509 bgpd/bgp_fsm.c   BGP_TIMER_OFF (peer-&gt;t_routeadv);</span>
<span class='curline'><a href='../S/655.html#L512'>peer</a>              512 bgpd/bgp_fsm.c   peer-&gt;packet_size = 0;</span>
<span class='curline'><a href='../S/655.html#L515'>peer</a>              515 bgpd/bgp_fsm.c   if (peer-&gt;ibuf)</span>
<span class='curline'><a href='../S/655.html#L516'>peer</a>              516 bgpd/bgp_fsm.c     stream_reset (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/655.html#L517'>peer</a>              517 bgpd/bgp_fsm.c   if (peer-&gt;work)</span>
<span class='curline'><a href='../S/655.html#L518'>peer</a>              518 bgpd/bgp_fsm.c     stream_reset (peer-&gt;work);</span>
<span class='curline'><a href='../S/655.html#L519'>peer</a>              519 bgpd/bgp_fsm.c   if (peer-&gt;obuf)</span>
<span class='curline'><a href='../S/655.html#L520'>peer</a>              520 bgpd/bgp_fsm.c     stream_fifo_clean (peer-&gt;obuf);</span>
<span class='curline'><a href='../S/655.html#L523'>peer</a>              523 bgpd/bgp_fsm.c   if (peer-&gt;fd &gt;= 0)</span>
<span class='curline'><a href='../S/655.html#L525'>peer</a>              525 bgpd/bgp_fsm.c       close (peer-&gt;fd);</span>
<span class='curline'><a href='../S/655.html#L526'>peer</a>              526 bgpd/bgp_fsm.c       peer-&gt;fd = -1;</span>
<span class='curline'><a href='../S/655.html#L533'>peer</a>              533 bgpd/bgp_fsm.c         peer-&gt;afc_nego[afi][safi] = 0;</span>
<span class='curline'><a href='../S/655.html#L534'>peer</a>              534 bgpd/bgp_fsm.c         peer-&gt;afc_adv[afi][safi] = 0;</span>
<span class='curline'><a href='../S/655.html#L535'>peer</a>              535 bgpd/bgp_fsm.c         peer-&gt;afc_recv[afi][safi] = 0;</span>
<span class='curline'><a href='../S/655.html#L538'>peer</a>              538 bgpd/bgp_fsm.c 	peer-&gt;af_cap[afi][safi] = 0;</span>
<span class='curline'><a href='../S/655.html#L541'>peer</a>              541 bgpd/bgp_fsm.c 	peer-&gt;af_sflags[afi][safi] = 0;</span>
<span class='curline'><a href='../S/655.html#L544'>peer</a>              544 bgpd/bgp_fsm.c 	peer-&gt;orf_plist[afi][safi] = NULL;</span>
<span class='curline'><a href='../S/655.html#L547'>peer</a>              547 bgpd/bgp_fsm.c         sprintf (orf_name, "%s.%d.%d", peer-&gt;host, afi, safi);</span>
<span class='curline'><a href='../S/655.html#L552'>peer</a>              552 bgpd/bgp_fsm.c   if (CHECK_FLAG (peer-&gt;config, PEER_CONFIG_TIMER))</span>
<span class='curline'><a href='../S/655.html#L554'>peer</a>              554 bgpd/bgp_fsm.c       peer-&gt;v_keepalive = peer-&gt;keepalive;</span>
<span class='curline'><a href='../S/655.html#L555'>peer</a>              555 bgpd/bgp_fsm.c       peer-&gt;v_holdtime = peer-&gt;holdtime;</span>
<span class='curline'><a href='../S/655.html#L559'>peer</a>              559 bgpd/bgp_fsm.c       peer-&gt;v_keepalive = peer-&gt;bgp-&gt;default_keepalive;</span>
<span class='curline'><a href='../S/655.html#L560'>peer</a>              560 bgpd/bgp_fsm.c       peer-&gt;v_holdtime = peer-&gt;bgp-&gt;default_holdtime;</span>
<span class='curline'><a href='../S/655.html#L563'>peer</a>              563 bgpd/bgp_fsm.c   peer-&gt;update_time = 0;</span>
<span class='curline'><a href='../S/655.html#L569'>peer</a>              569 bgpd/bgp_fsm.c   peer-&gt;pcount[AFI_IP][SAFI_UNICAST] = 0;</span>
<span class='curline'><a href='../S/655.html#L570'>peer</a>              570 bgpd/bgp_fsm.c   peer-&gt;pcount[AFI_IP][SAFI_MULTICAST] = 0;</span>
<span class='curline'><a href='../S/655.html#L571'>peer</a>              571 bgpd/bgp_fsm.c   peer-&gt;pcount[AFI_IP][SAFI_MPLS_VPN] = 0;</span>
<span class='curline'><a href='../S/655.html#L572'>peer</a>              572 bgpd/bgp_fsm.c   peer-&gt;pcount[AFI_IP6][SAFI_UNICAST] = 0;</span>
<span class='curline'><a href='../S/655.html#L573'>peer</a>              573 bgpd/bgp_fsm.c   peer-&gt;pcount[AFI_IP6][SAFI_MULTICAST] = 0;</span>
<span class='curline'><a href='../S/655.html#L581'>peer</a>              581 bgpd/bgp_fsm.c bgp_stop_with_error (struct peer *peer)</span>
<span class='curline'><a href='../S/655.html#L584'>peer</a>              584 bgpd/bgp_fsm.c   peer-&gt;v_start *= 2;</span>
<span class='curline'><a href='../S/655.html#L587'>peer</a>              587 bgpd/bgp_fsm.c   if (peer-&gt;v_start &gt;= (60 * 2))</span>
<span class='curline'><a href='../S/655.html#L588'>peer</a>              588 bgpd/bgp_fsm.c     peer-&gt;v_start = (60 * 2);</span>
<span class='curline'><a href='../S/655.html#L590'>peer</a>              590 bgpd/bgp_fsm.c   bgp_stop (peer);</span>
<span class='curline'><a href='../S/655.html#L598'>peer</a>              598 bgpd/bgp_fsm.c bgp_connect_success (struct peer *peer)</span>
<span class='curline'><a href='../S/655.html#L600'>peer</a>              600 bgpd/bgp_fsm.c   if (peer-&gt;fd &lt; 0)</span>
<span class='curline'><a href='../S/655.html#L603'>peer</a>              603 bgpd/bgp_fsm.c 		peer-&gt;fd);</span>
<span class='curline'><a href='../S/655.html#L606'>peer</a>              606 bgpd/bgp_fsm.c   BGP_READ_ON (peer-&gt;t_read, bgp_read, peer-&gt;fd);</span>
<span class='curline'><a href='../S/655.html#L608'>peer</a>              608 bgpd/bgp_fsm.c   if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_ACCEPT_PEER))</span>
<span class='curline'><a href='../S/655.html#L609'>peer</a>              609 bgpd/bgp_fsm.c     bgp_getsockname (peer);</span>
<span class='curline'><a href='../S/655.html#L615'>peer</a>              615 bgpd/bgp_fsm.c       if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_ACCEPT_PEER))</span>
<span class='curline'><a href='../S/655.html#L616'>peer</a>              616 bgpd/bgp_fsm.c 	zlog_debug ("%s open active, local address %s", peer-&gt;host,</span>
<span class='curline'><a href='../S/655.html#L617'>peer</a>              617 bgpd/bgp_fsm.c 		    sockunion2str (peer-&gt;su_local, buf1, SU_ADDRSTRLEN));</span>
<span class='curline'><a href='../S/655.html#L619'>peer</a>              619 bgpd/bgp_fsm.c 	zlog_debug ("%s passive open", peer-&gt;host);</span>
<span class='curline'><a href='../S/655.html#L622'>peer</a>              622 bgpd/bgp_fsm.c   if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_ACCEPT_PEER))</span>
<span class='curline'><a href='../S/655.html#L623'>peer</a>              623 bgpd/bgp_fsm.c     bgp_open_send (peer);</span>
<span class='curline'><a href='../S/655.html#L630'>peer</a>              630 bgpd/bgp_fsm.c bgp_connect_fail (struct peer *peer)</span>
<span class='curline'><a href='../S/655.html#L632'>peer</a>              632 bgpd/bgp_fsm.c   bgp_stop (peer);</span>
<span class='curline'><a href='../S/655.html#L639'>peer</a>              639 bgpd/bgp_fsm.c bgp_start (struct peer *peer)</span>
<span class='curline'><a href='../S/655.html#L643'>peer</a>              643 bgpd/bgp_fsm.c   if (BGP_PEER_START_SUPPRESSED (peer))</span>
<span class='curline'><a href='../S/655.html#L646'>peer</a>              646 bgpd/bgp_fsm.c         plog_err (peer-&gt;log, "%s [FSM] Trying to start suppressed peer"</span>
<span class='curline'><a href='../S/655.html#L647'>peer</a>              647 bgpd/bgp_fsm.c                   " - this is never supposed to happen!", peer-&gt;host);</span>
<span class='curline'><a href='../S/655.html#L655'>peer</a>              655 bgpd/bgp_fsm.c   if (peer-&gt;su_local)</span>
<span class='curline'><a href='../S/655.html#L657'>peer</a>              657 bgpd/bgp_fsm.c       sockunion_free (peer-&gt;su_local);</span>
<span class='curline'><a href='../S/655.html#L658'>peer</a>              658 bgpd/bgp_fsm.c       peer-&gt;su_local = NULL;</span>
<span class='curline'><a href='../S/655.html#L661'>peer</a>              661 bgpd/bgp_fsm.c   if (peer-&gt;su_remote)</span>
<span class='curline'><a href='../S/655.html#L663'>peer</a>              663 bgpd/bgp_fsm.c       sockunion_free (peer-&gt;su_remote);</span>
<span class='curline'><a href='../S/655.html#L664'>peer</a>              664 bgpd/bgp_fsm.c       peer-&gt;su_remote = NULL;</span>
<span class='curline'><a href='../S/655.html#L668'>peer</a>              668 bgpd/bgp_fsm.c   peer-&gt;remote_id.s_addr = 0;</span>
<span class='curline'><a href='../S/655.html#L671'>peer</a>              671 bgpd/bgp_fsm.c   peer-&gt;cap = 0;</span>
<span class='curline'><a href='../S/655.html#L674'>peer</a>              674 bgpd/bgp_fsm.c   if (CHECK_FLAG (peer-&gt;flags, PEER_FLAG_PASSIVE))</span>
<span class='curline'><a href='../S/655.html#L676'>peer</a>              676 bgpd/bgp_fsm.c       BGP_EVENT_ADD (peer, TCP_connection_open_failed);</span>
<span class='curline'><a href='../S/655.html#L680'>peer</a>              680 bgpd/bgp_fsm.c   status = bgp_connect (peer);</span>
<span class='curline'><a href='../S/655.html#L686'>peer</a>              686 bgpd/bgp_fsm.c 	plog_debug (peer-&gt;log, "%s [FSM] Connect error", peer-&gt;host);</span>
<span class='curline'><a href='../S/655.html#L687'>peer</a>              687 bgpd/bgp_fsm.c       BGP_EVENT_ADD (peer, TCP_connection_open_failed);</span>
<span class='curline'><a href='../S/655.html#L691'>peer</a>              691 bgpd/bgp_fsm.c 	plog_debug (peer-&gt;log, "%s [FSM] Connect immediately success",</span>
<span class='curline'><a href='../S/655.html#L692'>peer</a>              692 bgpd/bgp_fsm.c 		   peer-&gt;host);</span>
<span class='curline'><a href='../S/655.html#L693'>peer</a>              693 bgpd/bgp_fsm.c       BGP_EVENT_ADD (peer, TCP_connection_open);</span>
<span class='curline'><a href='../S/655.html#L699'>peer</a>              699 bgpd/bgp_fsm.c 	plog_debug (peer-&gt;log, "%s [FSM] Non blocking connect waiting result",</span>
<span class='curline'><a href='../S/655.html#L700'>peer</a>              700 bgpd/bgp_fsm.c 		   peer-&gt;host);</span>
<span class='curline'><a href='../S/655.html#L701'>peer</a>              701 bgpd/bgp_fsm.c       if (peer-&gt;fd &lt; 0)</span>
<span class='curline'><a href='../S/655.html#L704'>peer</a>              704 bgpd/bgp_fsm.c 		    peer-&gt;fd);</span>
<span class='curline'><a href='../S/655.html#L707'>peer</a>              707 bgpd/bgp_fsm.c       BGP_READ_ON (peer-&gt;t_read, bgp_read, peer-&gt;fd);</span>
<span class='curline'><a href='../S/655.html#L708'>peer</a>              708 bgpd/bgp_fsm.c       BGP_WRITE_ON (peer-&gt;t_write, bgp_write, peer-&gt;fd);</span>
<span class='curline'><a href='../S/655.html#L716'>peer</a>              716 bgpd/bgp_fsm.c bgp_reconnect (struct peer *peer)</span>
<span class='curline'><a href='../S/655.html#L718'>peer</a>              718 bgpd/bgp_fsm.c   bgp_stop (peer);</span>
<span class='curline'><a href='../S/655.html#L719'>peer</a>              719 bgpd/bgp_fsm.c   bgp_start (peer);</span>
<span class='curline'><a href='../S/655.html#L724'>peer</a>              724 bgpd/bgp_fsm.c bgp_fsm_open (struct peer *peer)</span>
<span class='curline'><a href='../S/655.html#L727'>peer</a>              727 bgpd/bgp_fsm.c   bgp_keepalive_send (peer);</span>
<span class='curline'><a href='../S/655.html#L730'>peer</a>              730 bgpd/bgp_fsm.c   BGP_TIMER_OFF (peer-&gt;t_holdtime);</span>
<span class='curline'><a href='../S/655.html#L737'>peer</a>              737 bgpd/bgp_fsm.c bgp_fsm_keepalive_expire (struct peer *peer)</span>
<span class='curline'><a href='../S/655.html#L739'>peer</a>              739 bgpd/bgp_fsm.c   bgp_keepalive_send (peer);</span>
<span class='curline'><a href='../S/655.html#L746'>peer</a>              746 bgpd/bgp_fsm.c bgp_fsm_holdtime_expire (struct peer *peer)</span>
<span class='curline'><a href='../S/655.html#L749'>peer</a>              749 bgpd/bgp_fsm.c     zlog (peer-&gt;log, LOG_DEBUG, "%s [FSM] Hold timer expire", peer-&gt;host);</span>
<span class='curline'><a href='../S/655.html#L752'>peer</a>              752 bgpd/bgp_fsm.c   bgp_notify_send (peer, BGP_NOTIFY_HOLD_ERR, 0);</span>
<span class='curline'><a href='../S/655.html#L755'>peer</a>              755 bgpd/bgp_fsm.c   if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_ACCEPT_PEER))</span>
<span class='curline'><a href='../S/655.html#L757'>peer</a>              757 bgpd/bgp_fsm.c       zlog_info ("%s [Event] Accepting BGP peer is deleted", peer-&gt;host);</span>
<span class='curline'><a href='../S/655.html#L758'>peer</a>              758 bgpd/bgp_fsm.c       peer_delete (peer);</span>
<span class='curline'><a href='../S/655.html#L763'>peer</a>              763 bgpd/bgp_fsm.c   bgp_stop(peer);</span>
<span class='curline'><a href='../S/655.html#L771'>peer</a>              771 bgpd/bgp_fsm.c bgp_establish (struct peer *peer)</span>
<span class='curline'><a href='../S/655.html#L779'>peer</a>              779 bgpd/bgp_fsm.c   if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_CAPABILITY_OPEN))</span>
<span class='curline'><a href='../S/655.html#L780'>peer</a>              780 bgpd/bgp_fsm.c     SET_FLAG (peer-&gt;sflags, PEER_STATUS_CAPABILITY_OPEN);</span>
<span class='curline'><a href='../S/655.html#L783'>peer</a>              783 bgpd/bgp_fsm.c   notify = &amp;peer-&gt;notify;</span>
<span class='curline'><a href='../S/655.html#L789'>peer</a>              789 bgpd/bgp_fsm.c   peer-&gt;v_start = BGP_INIT_START_TIMER;</span>
<span class='curline'><a href='../S/655.html#L792'>peer</a>              792 bgpd/bgp_fsm.c   peer-&gt;established++;</span>
<span class='curline'><a href='../S/655.html#L793'>peer</a>              793 bgpd/bgp_fsm.c   bgp_fsm_change_status (peer, Established);</span>
<span class='curline'><a href='../S/655.html#L796'>peer</a>              796 bgpd/bgp_fsm.c   if (bgp_flag_check (peer-&gt;bgp, BGP_FLAG_LOG_NEIGHBOR_CHANGES))</span>
<span class='curline'><a href='../S/655.html#L797'>peer</a>              797 bgpd/bgp_fsm.c     zlog_info ("%%ADJCHANGE: neighbor %s Up", peer-&gt;host);</span>
<span class='curline'><a href='../S/655.html#L800'>peer</a>              800 bgpd/bgp_fsm.c   UNSET_FLAG (peer-&gt;sflags, PEER_STATUS_NSF_WAIT);</span>
<span class='curline'><a href='../S/655.html#L804'>peer</a>              804 bgpd/bgp_fsm.c 	if (peer-&gt;afc_nego[afi][safi]</span>
<span class='curline'><a href='../S/655.html#L805'>peer</a>              805 bgpd/bgp_fsm.c 	    &amp;&amp; CHECK_FLAG (peer-&gt;cap, PEER_CAP_RESTART_ADV)</span>
<span class='curline'><a href='../S/655.html#L806'>peer</a>              806 bgpd/bgp_fsm.c 	    &amp;&amp; CHECK_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_RESTART_AF_RCV))</span>
<span class='curline'><a href='../S/655.html#L808'>peer</a>              808 bgpd/bgp_fsm.c 	    if (peer-&gt;nsf[afi][safi]</span>
<span class='curline'><a href='../S/655.html#L809'>peer</a>              809 bgpd/bgp_fsm.c 		&amp;&amp; ! CHECK_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_RESTART_AF_PRESERVE_RCV))</span>
<span class='curline'><a href='../S/655.html#L810'>peer</a>              810 bgpd/bgp_fsm.c 	      bgp_clear_stale_route (peer, afi, safi);</span>
<span class='curline'><a href='../S/655.html#L812'>peer</a>              812 bgpd/bgp_fsm.c 	    peer-&gt;nsf[afi][safi] = 1;</span>
<span class='curline'><a href='../S/655.html#L817'>peer</a>              817 bgpd/bgp_fsm.c 	    if (peer-&gt;nsf[afi][safi])</span>
<span class='curline'><a href='../S/655.html#L818'>peer</a>              818 bgpd/bgp_fsm.c 	      bgp_clear_stale_route (peer, afi, safi);</span>
<span class='curline'><a href='../S/655.html#L819'>peer</a>              819 bgpd/bgp_fsm.c 	    peer-&gt;nsf[afi][safi] = 0;</span>
<span class='curline'><a href='../S/655.html#L824'>peer</a>              824 bgpd/bgp_fsm.c     SET_FLAG (peer-&gt;sflags, PEER_STATUS_NSF_MODE);</span>
<span class='curline'><a href='../S/655.html#L827'>peer</a>              827 bgpd/bgp_fsm.c       UNSET_FLAG (peer-&gt;sflags, PEER_STATUS_NSF_MODE);</span>
<span class='curline'><a href='../S/655.html#L828'>peer</a>              828 bgpd/bgp_fsm.c       if (peer-&gt;t_gr_stale)</span>
<span class='curline'><a href='../S/655.html#L830'>peer</a>              830 bgpd/bgp_fsm.c 	  BGP_TIMER_OFF (peer-&gt;t_gr_stale);</span>
<span class='curline'><a href='../S/655.html#L832'>peer</a>              832 bgpd/bgp_fsm.c 	    zlog_debug ("%s graceful restart stalepath timer stopped", peer-&gt;host);</span>
<span class='curline'><a href='../S/655.html#L836'>peer</a>              836 bgpd/bgp_fsm.c   if (peer-&gt;t_gr_restart)</span>
<span class='curline'><a href='../S/655.html#L838'>peer</a>              838 bgpd/bgp_fsm.c       BGP_TIMER_OFF (peer-&gt;t_gr_restart);</span>
<span class='curline'><a href='../S/655.html#L840'>peer</a>              840 bgpd/bgp_fsm.c 	zlog_debug ("%s graceful restart timer stopped", peer-&gt;host);</span>
<span class='curline'><a href='../S/655.html#L844'>peer</a>              844 bgpd/bgp_fsm.c   bgpTrapEstablished (peer);</span>
<span class='curline'><a href='../S/655.html#L848'>peer</a>              848 bgpd/bgp_fsm.c   peer-&gt;uptime = bgp_clock ();</span>
<span class='curline'><a href='../S/655.html#L853'>peer</a>              853 bgpd/bgp_fsm.c       if (CHECK_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_ORF_PREFIX_SM_ADV))</span>
<span class='curline'><a href='../S/655.html#L855'>peer</a>              855 bgpd/bgp_fsm.c 	  if (CHECK_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_ORF_PREFIX_RM_RCV))</span>
<span class='curline'><a href='../S/655.html#L856'>peer</a>              856 bgpd/bgp_fsm.c 	    bgp_route_refresh_send (peer, afi, safi, ORF_TYPE_PREFIX,</span>
<span class='curline'><a href='../S/655.html#L858'>peer</a>              858 bgpd/bgp_fsm.c 	  else if (CHECK_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_ORF_PREFIX_RM_OLD_RCV))</span>
<span class='curline'><a href='../S/655.html#L859'>peer</a>              859 bgpd/bgp_fsm.c 	    bgp_route_refresh_send (peer, afi, safi, ORF_TYPE_PREFIX_OLD,</span>
<span class='curline'><a href='../S/655.html#L863'>peer</a>              863 bgpd/bgp_fsm.c   if (peer-&gt;v_keepalive)</span>
<span class='curline'><a href='../S/655.html#L864'>peer</a>              864 bgpd/bgp_fsm.c     bgp_keepalive_send (peer);</span>
<span class='curline'><a href='../S/655.html#L869'>peer</a>              869 bgpd/bgp_fsm.c       if (CHECK_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_ORF_PREFIX_RM_ADV))</span>
<span class='curline'><a href='../S/655.html#L870'>peer</a>              870 bgpd/bgp_fsm.c 	if (CHECK_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_ORF_PREFIX_SM_RCV)</span>
<span class='curline'><a href='../S/655.html#L871'>peer</a>              871 bgpd/bgp_fsm.c 	    || CHECK_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_ORF_PREFIX_SM_OLD_RCV))</span>
<span class='curline'><a href='../S/655.html#L872'>peer</a>              872 bgpd/bgp_fsm.c 	  SET_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_ORF_WAIT_REFRESH);</span>
<span class='curline'><a href='../S/655.html#L874'>peer</a>              874 bgpd/bgp_fsm.c   bgp_announce_route_all (peer);</span>
<span class='curline'><a href='../S/655.html#L876'>peer</a>              876 bgpd/bgp_fsm.c   BGP_TIMER_ON (peer-&gt;t_routeadv, bgp_routeadv_timer, 1);</span>
<span class='curline'><a href='../S/655.html#L883'>peer</a>              883 bgpd/bgp_fsm.c bgp_fsm_keepalive (struct peer *peer)</span>
<span class='curline'><a href='../S/655.html#L886'>peer</a>              886 bgpd/bgp_fsm.c   peer-&gt;keepalive_in++;</span>
<span class='curline'><a href='../S/655.html#L888'>peer</a>              888 bgpd/bgp_fsm.c   BGP_TIMER_OFF (peer-&gt;t_holdtime);</span>
<span class='curline'><a href='../S/655.html#L894'>peer</a>              894 bgpd/bgp_fsm.c bgp_fsm_update (struct peer *peer)</span>
<span class='curline'><a href='../S/655.html#L896'>peer</a>              896 bgpd/bgp_fsm.c   BGP_TIMER_OFF (peer-&gt;t_holdtime);</span>
<span class='curline'><a href='../S/655.html#L902'>peer</a>              902 bgpd/bgp_fsm.c bgp_ignore (struct peer *peer)</span>
<span class='curline'><a href='../S/655.html#L905'>peer</a>              905 bgpd/bgp_fsm.c     zlog (peer-&gt;log, LOG_DEBUG, "%s [FSM] bgp_ignore called", peer-&gt;host);</span>
<span class='curline'><a href='../S/655.html#L911'>peer</a>              911 bgpd/bgp_fsm.c   int (*func) (struct peer *);</span>
<span class='curline'><a href='../S/655.html#L1081'>peer</a>             1081 bgpd/bgp_fsm.c   struct peer *peer;</span>
<span class='curline'><a href='../S/655.html#L1083'>peer</a>             1083 bgpd/bgp_fsm.c   peer = THREAD_ARG (thread);</span>
<span class='curline'><a href='../S/655.html#L1087'>peer</a>             1087 bgpd/bgp_fsm.c   next = FSM [peer-&gt;status -1][event - 1].next_state;</span>
<span class='curline'><a href='../S/655.html#L1089'>peer</a>             1089 bgpd/bgp_fsm.c   if (BGP_DEBUG (fsm, FSM) &amp;&amp; peer-&gt;status != next)</span>
<span class='curline'><a href='../S/655.html#L1090'>peer</a>             1090 bgpd/bgp_fsm.c     plog_debug (peer-&gt;log, "%s [FSM] %s (%s-&gt;%s)", peer-&gt;host, </span>
<span class='curline'><a href='../S/655.html#L1092'>peer</a>             1092 bgpd/bgp_fsm.c 	       LOOKUP (bgp_status_msg, peer-&gt;status),</span>
<span class='curline'><a href='../S/655.html#L1096'>peer</a>             1096 bgpd/bgp_fsm.c   if (FSM [peer-&gt;status -1][event - 1].func)</span>
<span class='curline'><a href='../S/655.html#L1097'>peer</a>             1097 bgpd/bgp_fsm.c     ret = (*(FSM [peer-&gt;status - 1][event - 1].func))(peer);</span>
<span class='curline'><a href='../S/655.html#L1103'>peer</a>             1103 bgpd/bgp_fsm.c       if (next != peer-&gt;status)</span>
<span class='curline'><a href='../S/655.html#L1104'>peer</a>             1104 bgpd/bgp_fsm.c         bgp_fsm_change_status (peer, next);</span>
<span class='curline'><a href='../S/655.html#L1107'>peer</a>             1107 bgpd/bgp_fsm.c       bgp_timer_set (peer);</span>
<span class='curline'><a href='../S/658.html#L28'>peer</a>               28 bgpd/bgp_fsm.h     if (!(T) &amp;&amp; (peer-&gt;status != Deleted))	\</span>
<span class='curline'><a href='../S/658.html#L29'>peer</a>               29 bgpd/bgp_fsm.h       THREAD_READ_ON(master,T,F,peer,V);	\</span>
<span class='curline'><a href='../S/658.html#L40'>peer</a>               40 bgpd/bgp_fsm.h     if (!(T) &amp;&amp; (peer-&gt;status != Deleted))	\</span>
<span class='curline'><a href='../S/658.html#L41'>peer</a>               41 bgpd/bgp_fsm.h       THREAD_WRITE_ON(master,(T),(F),peer,(V)); \</span>
<span class='curline'><a href='../S/658.html#L52'>peer</a>               52 bgpd/bgp_fsm.h     if (!(T) &amp;&amp; (peer-&gt;status != Deleted))	\</span>
<span class='curline'><a href='../S/658.html#L53'>peer</a>               53 bgpd/bgp_fsm.h       THREAD_TIMER_ON(master,(T),(F),peer,(V)); \</span>
<span class='curline'><a href='../S/658.html#L70'>peer</a>               70 bgpd/bgp_fsm.h     assert (peer); 				\</span>
<span class='curline'><a href='../S/658.html#L76'>peer</a>               76 bgpd/bgp_fsm.h extern int bgp_stop (struct peer *peer);</span>
<span class='curline'><a href='../S/658.html#L77'>peer</a>               77 bgpd/bgp_fsm.h extern void bgp_timer_set (struct peer *);</span>
<span class='curline'><a href='../S/658.html#L78'>peer</a>               78 bgpd/bgp_fsm.h extern void bgp_fsm_change_status (struct peer *peer, int status);</span>
<span class='curline'><a href='../S/650.html#L166'>peer</a>              166 bgpd/bgp_mpath.c     compare = sockunion_cmp (bi1-&gt;peer-&gt;su_remote, bi2-&gt;peer-&gt;su_remote);</span>
<span class='curline'><a href='../S/650.html#L423'>peer</a>              423 bgpd/bgp_mpath.c       maxpaths = (new_best-&gt;peer-&gt;sort == BGP_PEER_IBGP) ?</span>
<span class='curline'><a href='../S/650.html#L481'>peer</a>              481 bgpd/bgp_mpath.c                             sockunion2str (cur_mpath-&gt;peer-&gt;su_remote,</span>
<span class='curline'><a href='../S/650.html#L505'>peer</a>              505 bgpd/bgp_mpath.c                         sockunion2str (cur_mpath-&gt;peer-&gt;su_remote,</span>
<span class='curline'><a href='../S/650.html#L539'>peer</a>              539 bgpd/bgp_mpath.c                             sockunion2str (new_mpath-&gt;peer-&gt;su_remote,</span>
<span class='curline'><a href='../S/641.html#L79'>peer</a>               79 bgpd/bgp_mplsvpn.c bgp_nlri_parse_vpnv4 (struct peer *peer, struct attr *attr, </span>
<span class='curline'><a href='../S/641.html#L95'>peer</a>               95 bgpd/bgp_mplsvpn.c   if (peer-&gt;status != Established)</span>
<span class='curline'><a href='../S/641.html#L159'>peer</a>              159 bgpd/bgp_mplsvpn.c 	bgp_update (peer, &amp;p, attr, AFI_IP, SAFI_MPLS_VPN,</span>
<span class='curline'><a href='../S/641.html#L162'>peer</a>              162 bgpd/bgp_mplsvpn.c 	bgp_withdraw (peer, &amp;p, attr, AFI_IP, SAFI_MPLS_VPN,</span>
<span class='curline'><a href='../S/641.html#L315'>peer</a>              315 bgpd/bgp_mplsvpn.c show_adj_route_vpn (struct vty *vty, struct peer *peer, struct prefix_rd *prd)</span>
<span class='curline'><a href='../S/641.html#L445'>peer</a>              445 bgpd/bgp_mplsvpn.c 		    if (ri-&gt;peer-&gt;su_remote == NULL || ! sockunion_same(ri-&gt;peer-&gt;su_remote, su))</span>
<span class='curline'><a href='../S/641.html#L585'>peer</a>              585 bgpd/bgp_mplsvpn.c   struct peer *peer;</span>
<span class='curline'><a href='../S/641.html#L595'>peer</a>              595 bgpd/bgp_mplsvpn.c   peer = peer_lookup (NULL, &amp;su);</span>
<span class='curline'><a href='../S/641.html#L596'>peer</a>              596 bgpd/bgp_mplsvpn.c   if (! peer || ! peer-&gt;afc[AFI_IP][SAFI_MPLS_VPN])</span>
<span class='curline'><a href='../S/641.html#L620'>peer</a>              620 bgpd/bgp_mplsvpn.c   struct peer *peer;</span>
<span class='curline'><a href='../S/641.html#L637'>peer</a>              637 bgpd/bgp_mplsvpn.c   peer = peer_lookup (NULL, &amp;su);</span>
<span class='curline'><a href='../S/641.html#L638'>peer</a>              638 bgpd/bgp_mplsvpn.c   if (! peer || ! peer-&gt;afc[AFI_IP][SAFI_MPLS_VPN])</span>
<span class='curline'><a href='../S/641.html#L660'>peer</a>              660 bgpd/bgp_mplsvpn.c   struct peer *peer;</span>
<span class='curline'><a href='../S/641.html#L669'>peer</a>              669 bgpd/bgp_mplsvpn.c   peer = peer_lookup (NULL, &amp;su);</span>
<span class='curline'><a href='../S/641.html#L670'>peer</a>              670 bgpd/bgp_mplsvpn.c   if (! peer || ! peer-&gt;afc[AFI_IP][SAFI_MPLS_VPN])</span>
<span class='curline'><a href='../S/641.html#L676'>peer</a>              676 bgpd/bgp_mplsvpn.c   return show_adj_route_vpn (vty, peer, NULL);</span>
<span class='curline'><a href='../S/641.html#L693'>peer</a>              693 bgpd/bgp_mplsvpn.c   struct peer *peer;</span>
<span class='curline'><a href='../S/641.html#L703'>peer</a>              703 bgpd/bgp_mplsvpn.c   peer = peer_lookup (NULL, &amp;su);</span>
<span class='curline'><a href='../S/641.html#L704'>peer</a>              704 bgpd/bgp_mplsvpn.c   if (! peer || ! peer-&gt;afc[AFI_IP][SAFI_MPLS_VPN])</span>
<span class='curline'><a href='../S/641.html#L717'>peer</a>              717 bgpd/bgp_mplsvpn.c   return show_adj_route_vpn (vty, peer, &amp;prd);</span>
<span class='curline'><a href='../S/612.html#L44'>peer</a>               44 bgpd/bgp_mplsvpn.h extern int bgp_nlri_parse_vpnv4 (struct peer *, struct attr *, struct bgp_nlri *);</span>
<span class='curline'><a href='../S/652.html#L98'>peer</a>               98 bgpd/bgp_network.c bgp_md5_set (struct peer *peer)</span>
<span class='curline'><a href='../S/652.html#L114'>peer</a>              114 bgpd/bgp_network.c     if (listener-&gt;su.sa.sa_family == peer-&gt;su.sa.sa_family)</span>
<span class='curline'><a href='../S/652.html#L116'>peer</a>              116 bgpd/bgp_network.c 	ret = bgp_md5_set_socket (listener-&gt;fd, &amp;peer-&gt;su, peer-&gt;password);</span>
<span class='curline'><a href='../S/652.html#L134'>peer</a>              134 bgpd/bgp_network.c   struct peer *peer;</span>
<span class='curline'><a href='../S/652.html#L135'>peer</a>              135 bgpd/bgp_network.c   struct peer *peer1;</span>
<span class='curline'><a href='../S/652.html#L190'>peer</a>              190 bgpd/bgp_network.c     peer = peer_create_accept (peer1-&gt;bgp);</span>
<span class='curline'><a href='../S/652.html#L191'>peer</a>              191 bgpd/bgp_network.c     SET_FLAG (peer-&gt;sflags, PEER_STATUS_ACCEPT_PEER);</span>
<span class='curline'><a href='../S/652.html#L192'>peer</a>              192 bgpd/bgp_network.c     peer-&gt;su = su;</span>
<span class='curline'><a href='../S/652.html#L193'>peer</a>              193 bgpd/bgp_network.c     peer-&gt;fd = bgp_sock;</span>
<span class='curline'><a href='../S/652.html#L194'>peer</a>              194 bgpd/bgp_network.c     peer-&gt;status = Active;</span>
<span class='curline'><a href='../S/652.html#L195'>peer</a>              195 bgpd/bgp_network.c     peer-&gt;local_id = peer1-&gt;local_id;</span>
<span class='curline'><a href='../S/652.html#L196'>peer</a>              196 bgpd/bgp_network.c     peer-&gt;v_holdtime = peer1-&gt;v_holdtime;</span>
<span class='curline'><a href='../S/652.html#L197'>peer</a>              197 bgpd/bgp_network.c     peer-&gt;v_keepalive = peer1-&gt;v_keepalive;</span>
<span class='curline'><a href='../S/652.html#L201'>peer</a>              201 bgpd/bgp_network.c     peer-&gt;host = XSTRDUP (MTYPE_BGP_PEER_HOST, buf);</span>
<span class='curline'><a href='../S/652.html#L204'>peer</a>              204 bgpd/bgp_network.c   BGP_EVENT_ADD (peer, TCP_connection_open);</span>
<span class='curline'><a href='../S/652.html#L211'>peer</a>              211 bgpd/bgp_network.c bgp_bind (struct peer *peer)</span>
<span class='curline'><a href='../S/652.html#L217'>peer</a>              217 bgpd/bgp_network.c   if (! peer-&gt;ifname)</span>
<span class='curline'><a href='../S/652.html#L220'>peer</a>              220 bgpd/bgp_network.c   strncpy ((char *)&amp;ifreq.ifr_name, peer-&gt;ifname, sizeof (ifreq.ifr_name));</span>
<span class='curline'><a href='../S/652.html#L225'>peer</a>              225 bgpd/bgp_network.c   ret = setsockopt (peer-&gt;fd, SOL_SOCKET, SO_BINDTODEVICE, </span>
<span class='curline'><a href='../S/652.html#L233'>peer</a>              233 bgpd/bgp_network.c       zlog (peer-&gt;log, LOG_INFO, "bind to interface %s failed", peer-&gt;ifname);</span>
<span class='curline'><a href='../S/652.html#L275'>peer</a>              275 bgpd/bgp_network.c bgp_update_source (struct peer *peer)</span>
<span class='curline'><a href='../S/652.html#L281'>peer</a>              281 bgpd/bgp_network.c   if (peer-&gt;update_if)</span>
<span class='curline'><a href='../S/652.html#L283'>peer</a>              283 bgpd/bgp_network.c       ifp = if_lookup_by_name (peer-&gt;update_if);</span>
<span class='curline'><a href='../S/652.html#L287'>peer</a>              287 bgpd/bgp_network.c       if (bgp_update_address (ifp, &amp;peer-&gt;su, &amp;addr))</span>
<span class='curline'><a href='../S/652.html#L290'>peer</a>              290 bgpd/bgp_network.c       sockunion_bind (peer-&gt;fd, &amp;addr, 0, &amp;addr);</span>
<span class='curline'><a href='../S/652.html#L294'>peer</a>              294 bgpd/bgp_network.c   if (peer-&gt;update_source)</span>
<span class='curline'><a href='../S/652.html#L295'>peer</a>              295 bgpd/bgp_network.c     sockunion_bind (peer-&gt;fd, peer-&gt;update_source, 0, peer-&gt;update_source);</span>
<span class='curline'><a href='../S/652.html#L300'>peer</a>              300 bgpd/bgp_network.c bgp_connect (struct peer *peer)</span>
<span class='curline'><a href='../S/652.html#L305'>peer</a>              305 bgpd/bgp_network.c   peer-&gt;fd = sockunion_socket (&amp;peer-&gt;su);</span>
<span class='curline'><a href='../S/652.html#L306'>peer</a>              306 bgpd/bgp_network.c   if (peer-&gt;fd &lt; 0)</span>
<span class='curline'><a href='../S/652.html#L310'>peer</a>              310 bgpd/bgp_network.c   if (peer-&gt;sort == BGP_PEER_EBGP) {</span>
<span class='curline'><a href='../S/652.html#L311'>peer</a>              311 bgpd/bgp_network.c     sockopt_ttl (peer-&gt;su.sa.sa_family, peer-&gt;fd, peer-&gt;ttl);</span>
<span class='curline'><a href='../S/652.html#L312'>peer</a>              312 bgpd/bgp_network.c     if (peer-&gt;gtsm_hops)</span>
<span class='curline'><a href='../S/652.html#L313'>peer</a>              313 bgpd/bgp_network.c       sockopt_minttl (peer-&gt;su.sa.sa_family, peer-&gt;fd, MAXTTL + 1 - peer-&gt;gtsm_hops);</span>
<span class='curline'><a href='../S/652.html#L316'>peer</a>              316 bgpd/bgp_network.c   sockopt_reuseaddr (peer-&gt;fd);</span>
<span class='curline'><a href='../S/652.html#L317'>peer</a>              317 bgpd/bgp_network.c   sockopt_reuseport (peer-&gt;fd);</span>
<span class='curline'><a href='../S/652.html#L322'>peer</a>              322 bgpd/bgp_network.c   if (sockunion_family (&amp;peer-&gt;su) == AF_INET)</span>
<span class='curline'><a href='../S/652.html#L323'>peer</a>              323 bgpd/bgp_network.c     setsockopt_ipv4_tos (peer-&gt;fd, IPTOS_PREC_INTERNETCONTROL);</span>
<span class='curline'><a href='../S/652.html#L325'>peer</a>              325 bgpd/bgp_network.c   else if (sockunion_family (&amp;peer-&gt;su) == AF_INET6)</span>
<span class='curline'><a href='../S/652.html#L326'>peer</a>              326 bgpd/bgp_network.c     setsockopt_ipv6_tclass (peer-&gt;fd, IPTOS_PREC_INTERNETCONTROL);</span>
<span class='curline'><a href='../S/652.html#L332'>peer</a>              332 bgpd/bgp_network.c   if (peer-&gt;password)</span>
<span class='curline'><a href='../S/652.html#L333'>peer</a>              333 bgpd/bgp_network.c     bgp_md5_set_connect (peer-&gt;fd, &amp;peer-&gt;su, peer-&gt;password);</span>
<span class='curline'><a href='../S/652.html#L336'>peer</a>              336 bgpd/bgp_network.c   bgp_bind (peer);</span>
<span class='curline'><a href='../S/652.html#L339'>peer</a>              339 bgpd/bgp_network.c   bgp_update_source (peer);</span>
<span class='curline'><a href='../S/652.html#L342'>peer</a>              342 bgpd/bgp_network.c   if (peer-&gt;ifname)</span>
<span class='curline'><a href='../S/652.html#L343'>peer</a>              343 bgpd/bgp_network.c     ifindex = if_nametoindex (peer-&gt;ifname);</span>
<span class='curline'><a href='../S/652.html#L347'>peer</a>              347 bgpd/bgp_network.c     plog_debug (peer-&gt;log, "%s [Event] Connect start to %s fd %d",</span>
<span class='curline'><a href='../S/652.html#L348'>peer</a>              348 bgpd/bgp_network.c 	       peer-&gt;host, peer-&gt;host, peer-&gt;fd);</span>
<span class='curline'><a href='../S/652.html#L351'>peer</a>              351 bgpd/bgp_network.c   return sockunion_connect (peer-&gt;fd, &amp;peer-&gt;su, htons (peer-&gt;port), ifindex);</span>
<span class='curline'><a href='../S/652.html#L356'>peer</a>              356 bgpd/bgp_network.c bgp_getsockname (struct peer *peer)</span>
<span class='curline'><a href='../S/652.html#L358'>peer</a>              358 bgpd/bgp_network.c   if (peer-&gt;su_local)</span>
<span class='curline'><a href='../S/652.html#L360'>peer</a>              360 bgpd/bgp_network.c       sockunion_free (peer-&gt;su_local);</span>
<span class='curline'><a href='../S/652.html#L361'>peer</a>              361 bgpd/bgp_network.c       peer-&gt;su_local = NULL;</span>
<span class='curline'><a href='../S/652.html#L364'>peer</a>              364 bgpd/bgp_network.c   if (peer-&gt;su_remote)</span>
<span class='curline'><a href='../S/652.html#L366'>peer</a>              366 bgpd/bgp_network.c       sockunion_free (peer-&gt;su_remote);</span>
<span class='curline'><a href='../S/652.html#L367'>peer</a>              367 bgpd/bgp_network.c       peer-&gt;su_remote = NULL;</span>
<span class='curline'><a href='../S/652.html#L370'>peer</a>              370 bgpd/bgp_network.c   peer-&gt;su_local = sockunion_getsockname (peer-&gt;fd);</span>
<span class='curline'><a href='../S/652.html#L371'>peer</a>              371 bgpd/bgp_network.c   peer-&gt;su_remote = sockunion_getpeername (peer-&gt;fd);</span>
<span class='curline'><a href='../S/652.html#L373'>peer</a>              373 bgpd/bgp_network.c   bgp_nexthop_set (peer-&gt;su_local, peer-&gt;su_remote, &amp;peer-&gt;nexthop, peer);</span>
<span class='curline'><a href='../S/647.html#L26'>peer</a>               26 bgpd/bgp_network.h extern int bgp_connect (struct peer *);</span>
<span class='curline'><a href='../S/647.html#L27'>peer</a>               27 bgpd/bgp_network.h extern void bgp_getsockname (struct peer *);</span>
<span class='curline'><a href='../S/647.html#L29'>peer</a>               29 bgpd/bgp_network.h extern int bgp_md5_set (struct peer *);</span>
<span class='curline'><a href='../S/644.html#L225'>peer</a>              225 bgpd/bgp_nexthop.c bgp_nexthop_lookup_ipv6 (struct peer *peer, struct bgp_info *ri, int *changed,</span>
<span class='curline'><a href='../S/644.html#L311'>peer</a>              311 bgpd/bgp_nexthop.c bgp_nexthop_lookup (afi_t afi, struct peer *peer, struct bgp_info *ri,</span>
<span class='curline'><a href='../S/644.html#L329'>peer</a>              329 bgpd/bgp_nexthop.c     return bgp_nexthop_lookup_ipv6 (peer, ri, changed, metricchanged);</span>
<span class='curline'><a href='../S/644.html#L417'>peer</a>              417 bgpd/bgp_nexthop.c   struct peer *peer;</span>
<span class='curline'><a href='../S/644.html#L436'>peer</a>              436 bgpd/bgp_nexthop.c   for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/644.html#L438'>peer</a>              438 bgpd/bgp_nexthop.c       if (peer-&gt;status != Established)</span>
<span class='curline'><a href='../S/644.html#L441'>peer</a>              441 bgpd/bgp_nexthop.c       if (peer-&gt;afc[afi][SAFI_UNICAST])</span>
<span class='curline'><a href='../S/644.html#L442'>peer</a>              442 bgpd/bgp_nexthop.c 	bgp_maximum_prefix_overflow (peer, afi, SAFI_UNICAST, 1);</span>
<span class='curline'><a href='../S/644.html#L443'>peer</a>              443 bgpd/bgp_nexthop.c       if (peer-&gt;afc[afi][SAFI_MULTICAST])</span>
<span class='curline'><a href='../S/644.html#L444'>peer</a>              444 bgpd/bgp_nexthop.c 	bgp_maximum_prefix_overflow (peer, afi, SAFI_MULTICAST, 1);</span>
<span class='curline'><a href='../S/644.html#L445'>peer</a>              445 bgpd/bgp_nexthop.c       if (peer-&gt;afc[afi][SAFI_MPLS_VPN])</span>
<span class='curline'><a href='../S/644.html#L446'>peer</a>              446 bgpd/bgp_nexthop.c 	bgp_maximum_prefix_overflow (peer, afi, SAFI_MPLS_VPN, 1);</span>
<span class='curline'><a href='../S/644.html#L461'>peer</a>              461 bgpd/bgp_nexthop.c 	      if (bi-&gt;peer-&gt;sort == BGP_PEER_EBGP &amp;&amp; bi-&gt;peer-&gt;ttl == 1)</span>
<span class='curline'><a href='../S/644.html#L464'>peer</a>              464 bgpd/bgp_nexthop.c 		valid = bgp_nexthop_lookup (afi, bi-&gt;peer, bi,</span>
<span class='curline'><a href='../S/644.html#L517'>peer</a>              517 bgpd/bgp_nexthop.c   for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/644.html#L519'>peer</a>              519 bgpd/bgp_nexthop.c       if (peer-&gt;status == Established</span>
<span class='curline'><a href='../S/644.html#L520'>peer</a>              520 bgpd/bgp_nexthop.c 	  &amp;&amp; CHECK_FLAG(peer-&gt;af_flags[afi][safi], PEER_FLAG_DEFAULT_ORIGINATE)</span>
<span class='curline'><a href='../S/644.html#L521'>peer</a>              521 bgpd/bgp_nexthop.c 	  &amp;&amp; peer-&gt;default_rmap[afi][safi].name)</span>
<span class='curline'><a href='../S/644.html#L522'>peer</a>              522 bgpd/bgp_nexthop.c 	bgp_default_originate (peer, afi, safi, 0);</span>
<span class='curline'><a href='../S/644.html#L1198'>peer</a>             1198 bgpd/bgp_nexthop.c bgp_multiaccess_check_v4 (struct in_addr nexthop, char *peer)</span>
<span class='curline'><a href='../S/644.html#L1207'>peer</a>             1207 bgpd/bgp_nexthop.c   ret = inet_aton (peer, &amp;addr);</span>
<span class='curline'><a href='../S/645.html#L51'>peer</a>               51 bgpd/bgp_nexthop.h extern int bgp_nexthop_lookup (afi_t, struct peer *peer, struct bgp_info *,</span>
<span class='curline'><a href='../S/625.html#L51'>peer</a>               51 bgpd/bgp_open.c bgp_capability_vty_out (struct vty *vty, struct peer *peer)</span>
<span class='curline'><a href='../S/625.html#L58'>peer</a>               58 bgpd/bgp_open.c   pnt = peer-&gt;notify.data;</span>
<span class='curline'><a href='../S/625.html#L59'>peer</a>               59 bgpd/bgp_open.c   end = pnt + peer-&gt;notify.length;</span>
<span class='curline'><a href='../S/625.html#L151'>peer</a>              151 bgpd/bgp_open.c bgp_capability_mp (struct peer *peer, struct capability_header *hdr)</span>
<span class='curline'><a href='../S/625.html#L154'>peer</a>              154 bgpd/bgp_open.c   struct stream *s = BGP_INPUT (peer);</span>
<span class='curline'><a href='../S/625.html#L160'>peer</a>              160 bgpd/bgp_open.c                peer-&gt;host, mpc.afi, mpc.safi);</span>
<span class='curline'><a href='../S/625.html#L166'>peer</a>              166 bgpd/bgp_open.c   peer-&gt;afc_recv[mpc.afi][mpc.safi] = 1;</span>
<span class='curline'><a href='../S/625.html#L168'>peer</a>              168 bgpd/bgp_open.c   if (peer-&gt;afc[mpc.afi][mpc.safi])</span>
<span class='curline'><a href='../S/625.html#L169'>peer</a>              169 bgpd/bgp_open.c     peer-&gt;afc_nego[mpc.afi][mpc.safi] = 1;</span>
<span class='curline'><a href='../S/625.html#L177'>peer</a>              177 bgpd/bgp_open.c bgp_capability_orf_not_support (struct peer *peer, afi_t afi, safi_t safi,</span>
<span class='curline'><a href='../S/625.html#L182'>peer</a>              182 bgpd/bgp_open.c 	       peer-&gt;host, afi, safi, type, mode);</span>
<span class='curline'><a href='../S/625.html#L201'>peer</a>              201 bgpd/bgp_open.c bgp_capability_orf_entry (struct peer *peer, struct capability_header *hdr)</span>
<span class='curline'><a href='../S/625.html#L203'>peer</a>              203 bgpd/bgp_open.c   struct stream *s = BGP_INPUT (peer);</span>
<span class='curline'><a href='../S/625.html#L221'>peer</a>              221 bgpd/bgp_open.c 	        peer-&gt;host, entry.mpc.afi, entry.mpc.safi);</span>
<span class='curline'><a href='../S/625.html#L228'>peer</a>              228 bgpd/bgp_open.c                  peer-&gt;host, entry.mpc.afi, entry.mpc.safi);</span>
<span class='curline'><a href='../S/625.html#L237'>peer</a>              237 bgpd/bgp_open.c                  peer-&gt;host, hdr-&gt;length, entry.num);</span>
<span class='curline'><a href='../S/625.html#L238'>peer</a>              238 bgpd/bgp_open.c       bgp_notify_send (peer, BGP_NOTIFY_CEASE, 0);</span>
<span class='curline'><a href='../S/625.html#L255'>peer</a>              255 bgpd/bgp_open.c 	    bgp_capability_orf_not_support (peer, afi, safi, type, mode);</span>
<span class='curline'><a href='../S/625.html#L268'>peer</a>              268 bgpd/bgp_open.c                   bgp_capability_orf_not_support (peer, afi, safi, type, mode);</span>
<span class='curline'><a href='../S/625.html#L278'>peer</a>              278 bgpd/bgp_open.c                   bgp_capability_orf_not_support (peer, afi, safi, type, mode);</span>
<span class='curline'><a href='../S/625.html#L283'>peer</a>              283 bgpd/bgp_open.c             bgp_capability_orf_not_support (peer, afi, safi, type, mode);</span>
<span class='curline'><a href='../S/625.html#L292'>peer</a>              292 bgpd/bgp_open.c           bgp_capability_orf_not_support (peer, afi, safi, type, mode);</span>
<span class='curline'><a href='../S/625.html#L299'>peer</a>              299 bgpd/bgp_open.c                     peer-&gt;host, LOOKUP (orf_type_str, type),</span>
<span class='curline'><a href='../S/625.html#L315'>peer</a>              315 bgpd/bgp_open.c 	  bgp_capability_orf_not_support (peer, afi, safi, type, mode);</span>
<span class='curline'><a href='../S/625.html#L322'>peer</a>              322 bgpd/bgp_open.c 	    SET_FLAG (peer-&gt;af_cap[afi][safi], sm_cap);</span>
<span class='curline'><a href='../S/625.html#L323'>peer</a>              323 bgpd/bgp_open.c 	    SET_FLAG (peer-&gt;af_cap[afi][safi], rm_cap);</span>
<span class='curline'><a href='../S/625.html#L326'>peer</a>              326 bgpd/bgp_open.c 	    SET_FLAG (peer-&gt;af_cap[afi][safi], sm_cap);</span>
<span class='curline'><a href='../S/625.html#L329'>peer</a>              329 bgpd/bgp_open.c 	    SET_FLAG (peer-&gt;af_cap[afi][safi], rm_cap);</span>
<span class='curline'><a href='../S/625.html#L337'>peer</a>              337 bgpd/bgp_open.c bgp_capability_restart (struct peer *peer, struct capability_header *caphdr)</span>
<span class='curline'><a href='../S/625.html#L339'>peer</a>              339 bgpd/bgp_open.c   struct stream *s = BGP_INPUT (peer);</span>
<span class='curline'><a href='../S/625.html#L344'>peer</a>              344 bgpd/bgp_open.c   SET_FLAG (peer-&gt;cap, PEER_CAP_RESTART_RCV);</span>
<span class='curline'><a href='../S/625.html#L349'>peer</a>              349 bgpd/bgp_open.c   peer-&gt;v_gr_restart = restart_flag_time;</span>
<span class='curline'><a href='../S/625.html#L353'>peer</a>              353 bgpd/bgp_open.c       zlog_debug ("%s OPEN has Graceful Restart capability", peer-&gt;host);</span>
<span class='curline'><a href='../S/625.html#L355'>peer</a>              355 bgpd/bgp_open.c                   peer-&gt;host, restart_bit ? " " : " not ",</span>
<span class='curline'><a href='../S/625.html#L356'>peer</a>              356 bgpd/bgp_open.c                   peer-&gt;v_gr_restart);</span>
<span class='curline'><a href='../S/625.html#L370'>peer</a>              370 bgpd/bgp_open.c                         peer-&gt;host, afi, safi);</span>
<span class='curline'><a href='../S/625.html#L372'>peer</a>              372 bgpd/bgp_open.c       else if (!peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/625.html#L377'>peer</a>              377 bgpd/bgp_open.c                         peer-&gt;host, afi, safi);</span>
<span class='curline'><a href='../S/625.html#L382'>peer</a>              382 bgpd/bgp_open.c             zlog_debug ("%s Address family %s is%spreserved", peer-&gt;host,</span>
<span class='curline'><a href='../S/625.html#L384'>peer</a>              384 bgpd/bgp_open.c                         CHECK_FLAG (peer-&gt;af_cap[afi][safi],</span>
<span class='curline'><a href='../S/625.html#L388'>peer</a>              388 bgpd/bgp_open.c           SET_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_RESTART_AF_RCV);</span>
<span class='curline'><a href='../S/625.html#L390'>peer</a>              390 bgpd/bgp_open.c             SET_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_RESTART_AF_PRESERVE_RCV);</span>
<span class='curline'><a href='../S/625.html#L398'>peer</a>              398 bgpd/bgp_open.c bgp_capability_as4 (struct peer *peer, struct capability_header *hdr)</span>
<span class='curline'><a href='../S/625.html#L400'>peer</a>              400 bgpd/bgp_open.c   SET_FLAG (peer-&gt;cap, PEER_CAP_AS4_RCV);</span>
<span class='curline'><a href='../S/625.html#L405'>peer</a>              405 bgpd/bgp_open.c                 peer-&gt;host, hdr-&gt;length);</span>
<span class='curline'><a href='../S/625.html#L409'>peer</a>              409 bgpd/bgp_open.c   as_t as4 = stream_getl (BGP_INPUT(peer));</span>
<span class='curline'><a href='../S/625.html#L413'>peer</a>              413 bgpd/bgp_open.c                 peer-&gt;host, as4);</span>
<span class='curline'><a href='../S/625.html#L451'>peer</a>              451 bgpd/bgp_open.c bgp_capability_parse (struct peer *peer, size_t length, int *mp_capability,</span>
<span class='curline'><a href='../S/625.html#L455'>peer</a>              455 bgpd/bgp_open.c   struct stream *s = BGP_INPUT (peer);</span>
<span class='curline'><a href='../S/625.html#L469'>peer</a>              469 bgpd/bgp_open.c 	  zlog_info ("%s Capability length error (&lt; header)", peer-&gt;host);</span>
<span class='curline'><a href='../S/625.html#L470'>peer</a>              470 bgpd/bgp_open.c 	  bgp_notify_send (peer, BGP_NOTIFY_CEASE, 0);</span>
<span class='curline'><a href='../S/625.html#L481'>peer</a>              481 bgpd/bgp_open.c 	  zlog_info ("%s Capability length error (&lt; length)", peer-&gt;host);</span>
<span class='curline'><a href='../S/625.html#L482'>peer</a>              482 bgpd/bgp_open.c 	  bgp_notify_send (peer, BGP_NOTIFY_CEASE, 0);</span>
<span class='curline'><a href='../S/625.html#L488'>peer</a>              488 bgpd/bgp_open.c 		   peer-&gt;host,</span>
<span class='curline'><a href='../S/625.html#L508'>peer</a>              508 bgpd/bgp_open.c                              peer-&gt;host, </span>
<span class='curline'><a href='../S/625.html#L512'>peer</a>              512 bgpd/bgp_open.c                   bgp_notify_send (peer, BGP_NOTIFY_CEASE, 0);</span>
<span class='curline'><a href='../S/625.html#L527'>peer</a>              527 bgpd/bgp_open.c               if (! CHECK_FLAG (peer-&gt;flags, PEER_FLAG_OVERRIDE_CAPABILITY))</span>
<span class='curline'><a href='../S/625.html#L530'>peer</a>              530 bgpd/bgp_open.c                   ret = bgp_capability_mp (peer, &amp;caphdr);</span>
<span class='curline'><a href='../S/625.html#L547'>peer</a>              547 bgpd/bgp_open.c                 SET_FLAG (peer-&gt;cap, PEER_CAP_REFRESH_OLD_RCV);</span>
<span class='curline'><a href='../S/625.html#L549'>peer</a>              549 bgpd/bgp_open.c                 SET_FLAG (peer-&gt;cap, PEER_CAP_REFRESH_NEW_RCV);</span>
<span class='curline'><a href='../S/625.html#L554'>peer</a>              554 bgpd/bgp_open.c             if (bgp_capability_orf_entry (peer, &amp;caphdr))</span>
<span class='curline'><a href='../S/625.html#L558'>peer</a>              558 bgpd/bgp_open.c             if (bgp_capability_restart (peer, &amp;caphdr))</span>
<span class='curline'><a href='../S/625.html#L562'>peer</a>              562 bgpd/bgp_open.c             SET_FLAG (peer-&gt;cap, PEER_CAP_DYNAMIC_RCV);</span>
<span class='curline'><a href='../S/625.html#L569'>peer</a>              569 bgpd/bgp_open.c               if (!bgp_capability_as4 (peer, &amp;caphdr))</span>
<span class='curline'><a href='../S/625.html#L578'>peer</a>              578 bgpd/bgp_open.c                            peer-&gt;host, caphdr.code);</span>
<span class='curline'><a href='../S/625.html#L583'>peer</a>              583 bgpd/bgp_open.c                            peer-&gt;host, caphdr.code);</span>
<span class='curline'><a href='../S/625.html#L592'>peer</a>              592 bgpd/bgp_open.c                        peer-&gt;host, LOOKUP (capcode_str, caphdr.code),</span>
<span class='curline'><a href='../S/625.html#L601'>peer</a>              601 bgpd/bgp_open.c bgp_auth_parse (struct peer *peer, size_t length)</span>
<span class='curline'><a href='../S/625.html#L603'>peer</a>              603 bgpd/bgp_open.c   bgp_notify_send (peer, </span>
<span class='curline'><a href='../S/625.html#L610'>peer</a>              610 bgpd/bgp_open.c strict_capability_same (struct peer *peer)</span>
<span class='curline'><a href='../S/625.html#L616'>peer</a>              616 bgpd/bgp_open.c       if (peer-&gt;afc[i][j] != peer-&gt;afc_nego[i][j])</span>
<span class='curline'><a href='../S/625.html#L625'>peer</a>              625 bgpd/bgp_open.c peek_for_as4_capability (struct peer *peer, u_char length)</span>
<span class='curline'><a href='../S/625.html#L627'>peer</a>              627 bgpd/bgp_open.c   struct stream *s = BGP_INPUT (peer);</span>
<span class='curline'><a href='../S/625.html#L639'>peer</a>              639 bgpd/bgp_open.c 	        peer-&gt;host, length);</span>
<span class='curline'><a href='../S/625.html#L684'>peer</a>              684 bgpd/bgp_open.c 	          as4 = bgp_capability_as4 (peer, &amp;hdr);</span>
<span class='curline'><a href='../S/625.html#L704'>peer</a>              704 bgpd/bgp_open.c bgp_open_option_parse (struct peer *peer, u_char length, int *mp_capability)</span>
<span class='curline'><a href='../S/625.html#L709'>peer</a>              709 bgpd/bgp_open.c   struct stream *s = BGP_INPUT(peer);</span>
<span class='curline'><a href='../S/625.html#L717'>peer</a>              717 bgpd/bgp_open.c 	       peer-&gt;host, length);</span>
<span class='curline'><a href='../S/625.html#L727'>peer</a>              727 bgpd/bgp_open.c 	  zlog_info ("%s Option length error", peer-&gt;host);</span>
<span class='curline'><a href='../S/625.html#L728'>peer</a>              728 bgpd/bgp_open.c 	  bgp_notify_send (peer, BGP_NOTIFY_CEASE, 0);</span>
<span class='curline'><a href='../S/625.html#L739'>peer</a>              739 bgpd/bgp_open.c 	  zlog_info ("%s Option length error", peer-&gt;host);</span>
<span class='curline'><a href='../S/625.html#L740'>peer</a>              740 bgpd/bgp_open.c 	  bgp_notify_send (peer, BGP_NOTIFY_CEASE, 0);</span>
<span class='curline'><a href='../S/625.html#L746'>peer</a>              746 bgpd/bgp_open.c 		   peer-&gt;host, opt_type,</span>
<span class='curline'><a href='../S/625.html#L754'>peer</a>              754 bgpd/bgp_open.c 	  ret = bgp_auth_parse (peer, opt_length);</span>
<span class='curline'><a href='../S/625.html#L757'>peer</a>              757 bgpd/bgp_open.c 	  ret = bgp_capability_parse (peer, opt_length, mp_capability, &amp;error);</span>
<span class='curline'><a href='../S/625.html#L760'>peer</a>              760 bgpd/bgp_open.c 	  bgp_notify_send (peer, </span>
<span class='curline'><a href='../S/625.html#L777'>peer</a>              777 bgpd/bgp_open.c   if (CHECK_FLAG (peer-&gt;flags, PEER_FLAG_STRICT_CAP_MATCH))</span>
<span class='curline'><a href='../S/625.html#L782'>peer</a>              782 bgpd/bgp_open.c 	  bgp_notify_send_with_data (peer, </span>
<span class='curline'><a href='../S/625.html#L791'>peer</a>              791 bgpd/bgp_open.c       if (! strict_capability_same (peer))</span>
<span class='curline'><a href='../S/625.html#L793'>peer</a>              793 bgpd/bgp_open.c 	  bgp_notify_send (peer, </span>
<span class='curline'><a href='../S/625.html#L803'>peer</a>              803 bgpd/bgp_open.c       ! CHECK_FLAG (peer-&gt;flags, PEER_FLAG_OVERRIDE_CAPABILITY))</span>
<span class='curline'><a href='../S/625.html#L805'>peer</a>              805 bgpd/bgp_open.c       if (! peer-&gt;afc_nego[AFI_IP][SAFI_UNICAST] </span>
<span class='curline'><a href='../S/625.html#L806'>peer</a>              806 bgpd/bgp_open.c 	  &amp;&amp; ! peer-&gt;afc_nego[AFI_IP][SAFI_MULTICAST]</span>
<span class='curline'><a href='../S/625.html#L807'>peer</a>              807 bgpd/bgp_open.c 	  &amp;&amp; ! peer-&gt;afc_nego[AFI_IP][SAFI_MPLS_VPN]</span>
<span class='curline'><a href='../S/625.html#L808'>peer</a>              808 bgpd/bgp_open.c 	  &amp;&amp; ! peer-&gt;afc_nego[AFI_IP6][SAFI_UNICAST]</span>
<span class='curline'><a href='../S/625.html#L809'>peer</a>              809 bgpd/bgp_open.c 	  &amp;&amp; ! peer-&gt;afc_nego[AFI_IP6][SAFI_MULTICAST])</span>
<span class='curline'><a href='../S/625.html#L811'>peer</a>              811 bgpd/bgp_open.c 	  plog_err (peer-&gt;log, "%s [Error] Configured AFI/SAFIs do not "</span>
<span class='curline'><a href='../S/625.html#L813'>peer</a>              813 bgpd/bgp_open.c 		    peer-&gt;host);</span>
<span class='curline'><a href='../S/625.html#L817'>peer</a>              817 bgpd/bgp_open.c 	    bgp_notify_send_with_data (peer, </span>
<span class='curline'><a href='../S/625.html#L822'>peer</a>              822 bgpd/bgp_open.c 	    bgp_notify_send (peer, </span>
<span class='curline'><a href='../S/625.html#L832'>peer</a>              832 bgpd/bgp_open.c bgp_open_capability_orf (struct stream *s, struct peer *peer,</span>
<span class='curline'><a href='../S/625.html#L858'>peer</a>              858 bgpd/bgp_open.c   if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_ORF_PREFIX_SM)</span>
<span class='curline'><a href='../S/625.html#L859'>peer</a>              859 bgpd/bgp_open.c       || CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_ORF_PREFIX_RM))</span>
<span class='curline'><a href='../S/625.html#L864'>peer</a>              864 bgpd/bgp_open.c       if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_ORF_PREFIX_SM)</span>
<span class='curline'><a href='../S/625.html#L865'>peer</a>              865 bgpd/bgp_open.c 	  &amp;&amp; CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_ORF_PREFIX_RM))</span>
<span class='curline'><a href='../S/625.html#L867'>peer</a>              867 bgpd/bgp_open.c 	  SET_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_ORF_PREFIX_SM_ADV);</span>
<span class='curline'><a href='../S/625.html#L868'>peer</a>              868 bgpd/bgp_open.c 	  SET_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_ORF_PREFIX_RM_ADV);</span>
<span class='curline'><a href='../S/625.html#L871'>peer</a>              871 bgpd/bgp_open.c       else if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_ORF_PREFIX_SM))</span>
<span class='curline'><a href='../S/625.html#L873'>peer</a>              873 bgpd/bgp_open.c 	  SET_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_ORF_PREFIX_SM_ADV);</span>
<span class='curline'><a href='../S/625.html#L878'>peer</a>              878 bgpd/bgp_open.c 	  SET_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_ORF_PREFIX_RM_ADV);</span>
<span class='curline'><a href='../S/625.html#L898'>peer</a>              898 bgpd/bgp_open.c bgp_open_capability (struct stream *s, struct peer *peer)</span>
<span class='curline'><a href='../S/625.html#L913'>peer</a>              913 bgpd/bgp_open.c   if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_CAPABILITY_OPEN) </span>
<span class='curline'><a href='../S/625.html#L914'>peer</a>              914 bgpd/bgp_open.c       || CHECK_FLAG (peer-&gt;flags, PEER_FLAG_DONT_CAPABILITY))</span>
<span class='curline'><a href='../S/625.html#L918'>peer</a>              918 bgpd/bgp_open.c   if (peer-&gt;afc[AFI_IP][SAFI_UNICAST])</span>
<span class='curline'><a href='../S/625.html#L920'>peer</a>              920 bgpd/bgp_open.c       peer-&gt;afc_adv[AFI_IP][SAFI_UNICAST] = 1;</span>
<span class='curline'><a href='../S/625.html#L930'>peer</a>              930 bgpd/bgp_open.c   if (peer-&gt;afc[AFI_IP][SAFI_MULTICAST])</span>
<span class='curline'><a href='../S/625.html#L932'>peer</a>              932 bgpd/bgp_open.c       peer-&gt;afc_adv[AFI_IP][SAFI_MULTICAST] = 1;</span>
<span class='curline'><a href='../S/625.html#L942'>peer</a>              942 bgpd/bgp_open.c   if (peer-&gt;afc[AFI_IP][SAFI_MPLS_VPN])</span>
<span class='curline'><a href='../S/625.html#L944'>peer</a>              944 bgpd/bgp_open.c       peer-&gt;afc_adv[AFI_IP][SAFI_MPLS_VPN] = 1;</span>
<span class='curline'><a href='../S/625.html#L955'>peer</a>              955 bgpd/bgp_open.c   if (peer-&gt;afc[AFI_IP6][SAFI_UNICAST])</span>
<span class='curline'><a href='../S/625.html#L957'>peer</a>              957 bgpd/bgp_open.c       peer-&gt;afc_adv[AFI_IP6][SAFI_UNICAST] = 1;</span>
<span class='curline'><a href='../S/625.html#L967'>peer</a>              967 bgpd/bgp_open.c   if (peer-&gt;afc[AFI_IP6][SAFI_MULTICAST])</span>
<span class='curline'><a href='../S/625.html#L969'>peer</a>              969 bgpd/bgp_open.c       peer-&gt;afc_adv[AFI_IP6][SAFI_MULTICAST] = 1;</span>
<span class='curline'><a href='../S/625.html#L981'>peer</a>              981 bgpd/bgp_open.c   SET_FLAG (peer-&gt;cap, PEER_CAP_REFRESH_ADV);</span>
<span class='curline'><a href='../S/625.html#L992'>peer</a>              992 bgpd/bgp_open.c   SET_FLAG (peer-&gt;cap, PEER_CAP_AS4_ADV);</span>
<span class='curline'><a href='../S/625.html#L997'>peer</a>              997 bgpd/bgp_open.c   if ( peer-&gt;change_local_as )</span>
<span class='curline'><a href='../S/625.html#L998'>peer</a>              998 bgpd/bgp_open.c     local_as = peer-&gt;change_local_as;</span>
<span class='curline'><a href='../S/625.html#L1000'>peer</a>             1000 bgpd/bgp_open.c     local_as = peer-&gt;local_as;</span>
<span class='curline'><a href='../S/625.html#L1006'>peer</a>             1006 bgpd/bgp_open.c       if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_ORF_PREFIX_SM)</span>
<span class='curline'><a href='../S/625.html#L1007'>peer</a>             1007 bgpd/bgp_open.c 	  || CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_ORF_PREFIX_RM))</span>
<span class='curline'><a href='../S/625.html#L1009'>peer</a>             1009 bgpd/bgp_open.c 	  bgp_open_capability_orf (s, peer, afi, safi, CAPABILITY_CODE_ORF_OLD);</span>
<span class='curline'><a href='../S/625.html#L1010'>peer</a>             1010 bgpd/bgp_open.c 	  bgp_open_capability_orf (s, peer, afi, safi, CAPABILITY_CODE_ORF);</span>
<span class='curline'><a href='../S/625.html#L1014'>peer</a>             1014 bgpd/bgp_open.c   if (CHECK_FLAG (peer-&gt;flags, PEER_FLAG_DYNAMIC_CAPABILITY))</span>
<span class='curline'><a href='../S/625.html#L1016'>peer</a>             1016 bgpd/bgp_open.c       SET_FLAG (peer-&gt;cap, PEER_CAP_DYNAMIC_ADV);</span>
<span class='curline'><a href='../S/625.html#L1024'>peer</a>             1024 bgpd/bgp_open.c   if (bgp_flag_check (peer-&gt;bgp, BGP_FLAG_GRACEFUL_RESTART))</span>
<span class='curline'><a href='../S/625.html#L1026'>peer</a>             1026 bgpd/bgp_open.c       SET_FLAG (peer-&gt;cap, PEER_CAP_RESTART_ADV);</span>
<span class='curline'><a href='../S/625.html#L1031'>peer</a>             1031 bgpd/bgp_open.c       stream_putw (s, peer-&gt;bgp-&gt;restart_time);</span>
<span class='curline'><a href='../S/659.html#L105'>peer</a>              105 bgpd/bgp_open.h extern int bgp_open_option_parse (struct peer *, u_char, int *);</span>
<span class='curline'><a href='../S/659.html#L106'>peer</a>              106 bgpd/bgp_open.h extern void bgp_open_capability (struct stream *, struct peer *);</span>
<span class='curline'><a href='../S/659.html#L107'>peer</a>              107 bgpd/bgp_open.h extern void bgp_capability_vty_out (struct vty *, struct peer *);</span>
<span class='curline'><a href='../S/659.html#L108'>peer</a>              108 bgpd/bgp_open.h extern as_t peek_for_as4_capability (struct peer *, u_char);</span>
<span class='curline'><a href='../S/622.html#L89'>peer</a>               89 bgpd/bgp_packet.c bgp_packet_add (struct peer *peer, struct stream *s)</span>
<span class='curline'><a href='../S/622.html#L92'>peer</a>               92 bgpd/bgp_packet.c   stream_fifo_push (peer-&gt;obuf, s);</span>
<span class='curline'><a href='../S/622.html#L97'>peer</a>               97 bgpd/bgp_packet.c bgp_packet_delete (struct peer *peer)</span>
<span class='curline'><a href='../S/622.html#L99'>peer</a>               99 bgpd/bgp_packet.c   stream_free (stream_fifo_pop (peer-&gt;obuf));</span>
<span class='curline'><a href='../S/622.html#L104'>peer</a>              104 bgpd/bgp_packet.c bgp_connect_check (struct peer *peer)</span>
<span class='curline'><a href='../S/622.html#L111'>peer</a>              111 bgpd/bgp_packet.c   BGP_READ_OFF (peer-&gt;t_read);</span>
<span class='curline'><a href='../S/622.html#L112'>peer</a>              112 bgpd/bgp_packet.c   BGP_WRITE_OFF (peer-&gt;t_write);</span>
<span class='curline'><a href='../S/622.html#L116'>peer</a>              116 bgpd/bgp_packet.c   ret = getsockopt(peer-&gt;fd, SOL_SOCKET, SO_ERROR, (void *) &amp;status, &amp;slen);</span>
<span class='curline'><a href='../S/622.html#L121'>peer</a>              121 bgpd/bgp_packet.c       zlog (peer-&gt;log, LOG_INFO, "can't get sockopt for nonblocking connect");</span>
<span class='curline'><a href='../S/622.html#L122'>peer</a>              122 bgpd/bgp_packet.c       BGP_EVENT_ADD (peer, TCP_fatal_error);</span>
<span class='curline'><a href='../S/622.html#L129'>peer</a>              129 bgpd/bgp_packet.c       BGP_EVENT_ADD (peer, TCP_connection_open);</span>
<span class='curline'><a href='../S/622.html#L134'>peer</a>              134 bgpd/bgp_packet.c 	  plog_debug (peer-&gt;log, "%s [Event] Connect failed (%s)",</span>
<span class='curline'><a href='../S/622.html#L135'>peer</a>              135 bgpd/bgp_packet.c 		     peer-&gt;host, safe_strerror (errno));</span>
<span class='curline'><a href='../S/622.html#L136'>peer</a>              136 bgpd/bgp_packet.c       BGP_EVENT_ADD (peer, TCP_connection_open_failed);</span>
<span class='curline'><a href='../S/622.html#L142'>peer</a>              142 bgpd/bgp_packet.c bgp_update_packet (struct peer *peer, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/622.html#L153'>peer</a>              153 bgpd/bgp_packet.c   s = peer-&gt;work;</span>
<span class='curline'><a href='../S/622.html#L156'>peer</a>              156 bgpd/bgp_packet.c   adv = FIFO_HEAD (&amp;peer-&gt;sync[afi][safi]-&gt;update);</span>
<span class='curline'><a href='../S/622.html#L175'>peer</a>              175 bgpd/bgp_packet.c 	  struct peer *from = NULL;</span>
<span class='curline'><a href='../S/622.html#L181'>peer</a>              181 bgpd/bgp_packet.c               from = binfo-&gt;peer;</span>
<span class='curline'><a href='../S/622.html#L190'>peer</a>              190 bgpd/bgp_packet.c 	  total_attr_len = bgp_packet_attribute (NULL, peer, s, </span>
<span class='curline'><a href='../S/622.html#L204'>peer</a>              204 bgpd/bgp_packet.c           zlog (peer-&gt;log, LOG_DEBUG, "%s send UPDATE %s/%d",</span>
<span class='curline'><a href='../S/622.html#L205'>peer</a>              205 bgpd/bgp_packet.c                 peer-&gt;host,</span>
<span class='curline'><a href='../S/622.html#L214'>peer</a>              214 bgpd/bgp_packet.c 	peer-&gt;scount[afi][safi]++;</span>
<span class='curline'><a href='../S/622.html#L218'>peer</a>              218 bgpd/bgp_packet.c       adv = bgp_advertise_clean (peer, adj, afi, safi);</span>
<span class='curline'><a href='../S/622.html#L228'>peer</a>              228 bgpd/bgp_packet.c       bgp_packet_add (peer, packet);</span>
<span class='curline'><a href='../S/622.html#L229'>peer</a>              229 bgpd/bgp_packet.c       BGP_WRITE_ON (peer-&gt;t_write, bgp_write, peer-&gt;fd);</span>
<span class='curline'><a href='../S/622.html#L237'>peer</a>              237 bgpd/bgp_packet.c bgp_update_packet_eor (struct peer *peer, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/622.html#L246'>peer</a>              246 bgpd/bgp_packet.c     zlog_debug ("send End-of-RIB for %s to %s", afi_safi_print (afi, safi), peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L274'>peer</a>              274 bgpd/bgp_packet.c   bgp_packet_add (peer, packet);</span>
<span class='curline'><a href='../S/622.html#L281'>peer</a>              281 bgpd/bgp_packet.c bgp_withdraw_packet (struct peer *peer, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/622.html#L292'>peer</a>              292 bgpd/bgp_packet.c   s = peer-&gt;work;</span>
<span class='curline'><a href='../S/622.html#L295'>peer</a>              295 bgpd/bgp_packet.c   while ((adv = FIFO_HEAD (&amp;peer-&gt;sync[afi][safi]-&gt;withdraw)) != NULL)</span>
<span class='curline'><a href='../S/622.html#L322'>peer</a>              322 bgpd/bgp_packet.c 	    = bgp_packet_withdraw (peer, s, &amp;rn-&gt;p, afi, safi, prd, NULL);</span>
<span class='curline'><a href='../S/622.html#L332'>peer</a>              332 bgpd/bgp_packet.c           zlog (peer-&gt;log, LOG_DEBUG, "%s send UPDATE %s/%d -- unreachable",</span>
<span class='curline'><a href='../S/622.html#L333'>peer</a>              333 bgpd/bgp_packet.c                 peer-&gt;host,</span>
<span class='curline'><a href='../S/622.html#L338'>peer</a>              338 bgpd/bgp_packet.c       peer-&gt;scount[afi][safi]--;</span>
<span class='curline'><a href='../S/622.html#L340'>peer</a>              340 bgpd/bgp_packet.c       bgp_adj_out_remove (rn, adj, peer, afi, safi);</span>
<span class='curline'><a href='../S/622.html#L358'>peer</a>              358 bgpd/bgp_packet.c       bgp_packet_add (peer, packet);</span>
<span class='curline'><a href='../S/622.html#L367'>peer</a>              367 bgpd/bgp_packet.c bgp_default_update_send (struct peer *peer, struct attr *attr,</span>
<span class='curline'><a href='../S/622.html#L368'>peer</a>              368 bgpd/bgp_packet.c 			 afi_t afi, safi_t safi, struct peer *from)</span>
<span class='curline'><a href='../S/622.html#L393'>peer</a>              393 bgpd/bgp_packet.c       bgp_dump_attr (peer, attr, attrstr, BUFSIZ);</span>
<span class='curline'><a href='../S/622.html#L394'>peer</a>              394 bgpd/bgp_packet.c       zlog (peer-&gt;log, LOG_DEBUG, "%s send UPDATE %s/%d %s",</span>
<span class='curline'><a href='../S/622.html#L395'>peer</a>              395 bgpd/bgp_packet.c 	    peer-&gt;host, inet_ntop(p.family, &amp;(p.u.prefix), buf, INET6_BUFSIZ),</span>
<span class='curline'><a href='../S/622.html#L410'>peer</a>              410 bgpd/bgp_packet.c   total_attr_len = bgp_packet_attribute (NULL, peer, s, attr, &amp;p, afi, safi, from, NULL, NULL);</span>
<span class='curline'><a href='../S/622.html#L431'>peer</a>              431 bgpd/bgp_packet.c   bgp_packet_add (peer, packet);</span>
<span class='curline'><a href='../S/622.html#L433'>peer</a>              433 bgpd/bgp_packet.c   BGP_WRITE_ON (peer-&gt;t_write, bgp_write, peer-&gt;fd);</span>
<span class='curline'><a href='../S/622.html#L437'>peer</a>              437 bgpd/bgp_packet.c bgp_default_withdraw_send (struct peer *peer, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/622.html#L464'>peer</a>              464 bgpd/bgp_packet.c       zlog (peer-&gt;log, LOG_DEBUG, "%s send UPDATE %s/%d -- unreachable",</span>
<span class='curline'><a href='../S/622.html#L465'>peer</a>              465 bgpd/bgp_packet.c             peer-&gt;host, inet_ntop(p.family, &amp;(p.u.prefix), buf, INET6_BUFSIZ),</span>
<span class='curline'><a href='../S/622.html#L495'>peer</a>              495 bgpd/bgp_packet.c       total_attr_len = bgp_packet_withdraw (peer, s, &amp;p, afi, safi, NULL, NULL);</span>
<span class='curline'><a href='../S/622.html#L507'>peer</a>              507 bgpd/bgp_packet.c   bgp_packet_add (peer, packet);</span>
<span class='curline'><a href='../S/622.html#L509'>peer</a>              509 bgpd/bgp_packet.c   BGP_WRITE_ON (peer-&gt;t_write, bgp_write, peer-&gt;fd);</span>
<span class='curline'><a href='../S/622.html#L514'>peer</a>              514 bgpd/bgp_packet.c bgp_write_packet (struct peer *peer)</span>
<span class='curline'><a href='../S/622.html#L521'>peer</a>              521 bgpd/bgp_packet.c   s = stream_fifo_head (peer-&gt;obuf);</span>
<span class='curline'><a href='../S/622.html#L528'>peer</a>              528 bgpd/bgp_packet.c 	adv = FIFO_HEAD (&amp;peer-&gt;sync[afi][safi]-&gt;withdraw);</span>
<span class='curline'><a href='../S/622.html#L531'>peer</a>              531 bgpd/bgp_packet.c 	    s = bgp_withdraw_packet (peer, afi, safi);</span>
<span class='curline'><a href='../S/622.html#L540'>peer</a>              540 bgpd/bgp_packet.c 	adv = FIFO_HEAD (&amp;peer-&gt;sync[afi][safi]-&gt;update);</span>
<span class='curline'><a href='../S/622.html#L543'>peer</a>              543 bgpd/bgp_packet.c             if (adv-&gt;binfo &amp;&amp; adv-&gt;binfo-&gt;uptime &lt; peer-&gt;synctime)</span>
<span class='curline'><a href='../S/622.html#L545'>peer</a>              545 bgpd/bgp_packet.c 		if (CHECK_FLAG (adv-&gt;binfo-&gt;peer-&gt;cap, PEER_CAP_RESTART_RCV)</span>
<span class='curline'><a href='../S/622.html#L546'>peer</a>              546 bgpd/bgp_packet.c 		    &amp;&amp; CHECK_FLAG (adv-&gt;binfo-&gt;peer-&gt;cap, PEER_CAP_RESTART_ADV)</span>
<span class='curline'><a href='../S/622.html#L550'>peer</a>              550 bgpd/bgp_packet.c 		    if (CHECK_FLAG (adv-&gt;binfo-&gt;peer-&gt;af_sflags[afi][safi],</span>
<span class='curline'><a href='../S/622.html#L552'>peer</a>              552 bgpd/bgp_packet.c 		      s = bgp_update_packet (peer, afi, safi);</span>
<span class='curline'><a href='../S/622.html#L555'>peer</a>              555 bgpd/bgp_packet.c 		  s = bgp_update_packet (peer, afi, safi);</span>
<span class='curline'><a href='../S/622.html#L562'>peer</a>              562 bgpd/bgp_packet.c 	if (CHECK_FLAG (peer-&gt;cap, PEER_CAP_RESTART_RCV))</span>
<span class='curline'><a href='../S/622.html#L564'>peer</a>              564 bgpd/bgp_packet.c 	    if (peer-&gt;afc_nego[afi][safi] &amp;&amp; peer-&gt;synctime</span>
<span class='curline'><a href='../S/622.html#L565'>peer</a>              565 bgpd/bgp_packet.c 		&amp;&amp; ! CHECK_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_EOR_SEND)</span>
<span class='curline'><a href='../S/622.html#L568'>peer</a>              568 bgpd/bgp_packet.c 		SET_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_EOR_SEND);</span>
<span class='curline'><a href='../S/622.html#L569'>peer</a>              569 bgpd/bgp_packet.c 		return bgp_update_packet_eor (peer, afi, safi);</span>
<span class='curline'><a href='../S/622.html#L580'>peer</a>              580 bgpd/bgp_packet.c bgp_write_proceed (struct peer *peer)</span>
<span class='curline'><a href='../S/622.html#L586'>peer</a>              586 bgpd/bgp_packet.c   if (stream_fifo_head (peer-&gt;obuf))</span>
<span class='curline'><a href='../S/622.html#L591'>peer</a>              591 bgpd/bgp_packet.c       if (FIFO_HEAD (&amp;peer-&gt;sync[afi][safi]-&gt;withdraw))</span>
<span class='curline'><a href='../S/622.html#L596'>peer</a>              596 bgpd/bgp_packet.c       if ((adv = FIFO_HEAD (&amp;peer-&gt;sync[afi][safi]-&gt;update)) != NULL)</span>
<span class='curline'><a href='../S/622.html#L597'>peer</a>              597 bgpd/bgp_packet.c 	if (adv-&gt;binfo-&gt;uptime &lt; peer-&gt;synctime)</span>
<span class='curline'><a href='../S/622.html#L607'>peer</a>              607 bgpd/bgp_packet.c   struct peer *peer;</span>
<span class='curline'><a href='../S/622.html#L614'>peer</a>              614 bgpd/bgp_packet.c   peer = THREAD_ARG (thread);</span>
<span class='curline'><a href='../S/622.html#L615'>peer</a>              615 bgpd/bgp_packet.c   peer-&gt;t_write = NULL;</span>
<span class='curline'><a href='../S/622.html#L618'>peer</a>              618 bgpd/bgp_packet.c   if (peer-&gt;status == Connect)</span>
<span class='curline'><a href='../S/622.html#L620'>peer</a>              620 bgpd/bgp_packet.c       bgp_connect_check (peer);</span>
<span class='curline'><a href='../S/622.html#L624'>peer</a>              624 bgpd/bgp_packet.c   s = bgp_write_packet (peer);</span>
<span class='curline'><a href='../S/622.html#L628'>peer</a>              628 bgpd/bgp_packet.c   sockopt_cork (peer-&gt;fd, 1);</span>
<span class='curline'><a href='../S/622.html#L639'>peer</a>              639 bgpd/bgp_packet.c       num = write (peer-&gt;fd, STREAM_PNT (s), writenum);</span>
<span class='curline'><a href='../S/622.html#L646'>peer</a>              646 bgpd/bgp_packet.c           BGP_EVENT_ADD (peer, TCP_fatal_error);</span>
<span class='curline'><a href='../S/622.html#L664'>peer</a>              664 bgpd/bgp_packet.c 	  peer-&gt;open_out++;</span>
<span class='curline'><a href='../S/622.html#L667'>peer</a>              667 bgpd/bgp_packet.c 	  peer-&gt;update_out++;</span>
<span class='curline'><a href='../S/622.html#L670'>peer</a>              670 bgpd/bgp_packet.c 	  peer-&gt;notify_out++;</span>
<span class='curline'><a href='../S/622.html#L672'>peer</a>              672 bgpd/bgp_packet.c 	  peer-&gt;v_start *= 2;</span>
<span class='curline'><a href='../S/622.html#L675'>peer</a>              675 bgpd/bgp_packet.c 	  if (peer-&gt;v_start &gt;= (60 * 2))</span>
<span class='curline'><a href='../S/622.html#L676'>peer</a>              676 bgpd/bgp_packet.c 	    peer-&gt;v_start = (60 * 2);</span>
<span class='curline'><a href='../S/622.html#L679'>peer</a>              679 bgpd/bgp_packet.c 	  BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/622.html#L683'>peer</a>              683 bgpd/bgp_packet.c 	  peer-&gt;keepalive_out++;</span>
<span class='curline'><a href='../S/622.html#L687'>peer</a>              687 bgpd/bgp_packet.c 	  peer-&gt;refresh_out++;</span>
<span class='curline'><a href='../S/622.html#L690'>peer</a>              690 bgpd/bgp_packet.c 	  peer-&gt;dynamic_cap_out++;</span>
<span class='curline'><a href='../S/622.html#L695'>peer</a>              695 bgpd/bgp_packet.c       bgp_packet_delete (peer);</span>
<span class='curline'><a href='../S/622.html#L698'>peer</a>              698 bgpd/bgp_packet.c 	 (s = bgp_write_packet (peer)) != NULL);</span>
<span class='curline'><a href='../S/622.html#L700'>peer</a>              700 bgpd/bgp_packet.c   if (bgp_write_proceed (peer))</span>
<span class='curline'><a href='../S/622.html#L701'>peer</a>              701 bgpd/bgp_packet.c     BGP_WRITE_ON (peer-&gt;t_write, bgp_write, peer-&gt;fd);</span>
<span class='curline'><a href='../S/622.html#L704'>peer</a>              704 bgpd/bgp_packet.c   sockopt_cork (peer-&gt;fd, 0);</span>
<span class='curline'><a href='../S/622.html#L710'>peer</a>              710 bgpd/bgp_packet.c bgp_write_notify (struct peer *peer)</span>
<span class='curline'><a href='../S/622.html#L717'>peer</a>              717 bgpd/bgp_packet.c   s = stream_fifo_head (peer-&gt;obuf);</span>
<span class='curline'><a href='../S/622.html#L723'>peer</a>              723 bgpd/bgp_packet.c   val = fcntl (peer-&gt;fd, F_GETFL, 0);</span>
<span class='curline'><a href='../S/622.html#L724'>peer</a>              724 bgpd/bgp_packet.c   fcntl (peer-&gt;fd, F_SETFL, val &amp; ~O_NONBLOCK);</span>
<span class='curline'><a href='../S/622.html#L727'>peer</a>              727 bgpd/bgp_packet.c   sockopt_cork (peer-&gt;fd, 0);</span>
<span class='curline'><a href='../S/622.html#L729'>peer</a>              729 bgpd/bgp_packet.c   ret = write (peer-&gt;fd, STREAM_DATA (s), stream_get_endp (s));</span>
<span class='curline'><a href='../S/622.html#L732'>peer</a>              732 bgpd/bgp_packet.c       BGP_EVENT_ADD (peer, TCP_fatal_error);</span>
<span class='curline'><a href='../S/622.html#L738'>peer</a>              738 bgpd/bgp_packet.c   (void) setsockopt (peer-&gt;fd, IPPROTO_TCP, TCP_NODELAY,</span>
<span class='curline'><a href='../S/622.html#L748'>peer</a>              748 bgpd/bgp_packet.c   peer-&gt;notify_out++;</span>
<span class='curline'><a href='../S/622.html#L751'>peer</a>              751 bgpd/bgp_packet.c   peer-&gt;v_start *= 2;</span>
<span class='curline'><a href='../S/622.html#L754'>peer</a>              754 bgpd/bgp_packet.c   if (peer-&gt;v_start &gt;= (60 * 2))</span>
<span class='curline'><a href='../S/622.html#L755'>peer</a>              755 bgpd/bgp_packet.c     peer-&gt;v_start = (60 * 2);</span>
<span class='curline'><a href='../S/622.html#L757'>peer</a>              757 bgpd/bgp_packet.c   BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/622.html#L764'>peer</a>              764 bgpd/bgp_packet.c bgp_keepalive_send (struct peer *peer)</span>
<span class='curline'><a href='../S/622.html#L781'>peer</a>              781 bgpd/bgp_packet.c     zlog_debug ("%s sending KEEPALIVE", peer-&gt;host); </span>
<span class='curline'><a href='../S/622.html#L784'>peer</a>              784 bgpd/bgp_packet.c                peer-&gt;host, BGP_MSG_KEEPALIVE, length);</span>
<span class='curline'><a href='../S/622.html#L787'>peer</a>              787 bgpd/bgp_packet.c   bgp_packet_add (peer, s);</span>
<span class='curline'><a href='../S/622.html#L789'>peer</a>              789 bgpd/bgp_packet.c   BGP_WRITE_ON (peer-&gt;t_write, bgp_write, peer-&gt;fd);</span>
<span class='curline'><a href='../S/622.html#L794'>peer</a>              794 bgpd/bgp_packet.c bgp_open_send (struct peer *peer)</span>
<span class='curline'><a href='../S/622.html#L801'>peer</a>              801 bgpd/bgp_packet.c   if (CHECK_FLAG (peer-&gt;config, PEER_CONFIG_TIMER))</span>
<span class='curline'><a href='../S/622.html#L802'>peer</a>              802 bgpd/bgp_packet.c     send_holdtime = peer-&gt;holdtime;</span>
<span class='curline'><a href='../S/622.html#L804'>peer</a>              804 bgpd/bgp_packet.c     send_holdtime = peer-&gt;bgp-&gt;default_holdtime;</span>
<span class='curline'><a href='../S/622.html#L807'>peer</a>              807 bgpd/bgp_packet.c   if (peer-&gt;change_local_as)</span>
<span class='curline'><a href='../S/622.html#L808'>peer</a>              808 bgpd/bgp_packet.c     local_as = peer-&gt;change_local_as; </span>
<span class='curline'><a href='../S/622.html#L810'>peer</a>              810 bgpd/bgp_packet.c     local_as = peer-&gt;local_as; </span>
<span class='curline'><a href='../S/622.html#L822'>peer</a>              822 bgpd/bgp_packet.c   stream_put_in_addr (s, &amp;peer-&gt;local_id); /* BGP Identifier */</span>
<span class='curline'><a href='../S/622.html#L825'>peer</a>              825 bgpd/bgp_packet.c   bgp_open_capability (s, peer);</span>
<span class='curline'><a href='../S/622.html#L832'>peer</a>              832 bgpd/bgp_packet.c 	       peer-&gt;host, BGP_VERSION_4, local_as,</span>
<span class='curline'><a href='../S/622.html#L833'>peer</a>              833 bgpd/bgp_packet.c 	       send_holdtime, inet_ntoa (peer-&gt;local_id));</span>
<span class='curline'><a href='../S/622.html#L837'>peer</a>              837 bgpd/bgp_packet.c 	       peer-&gt;host, BGP_MSG_OPEN, length);</span>
<span class='curline'><a href='../S/622.html#L843'>peer</a>              843 bgpd/bgp_packet.c   bgp_packet_add (peer, s);</span>
<span class='curline'><a href='../S/622.html#L845'>peer</a>              845 bgpd/bgp_packet.c   BGP_WRITE_ON (peer-&gt;t_write, bgp_write, peer-&gt;fd);</span>
<span class='curline'><a href='../S/622.html#L850'>peer</a>              850 bgpd/bgp_packet.c bgp_notify_send_with_data (struct peer *peer, u_char code, u_char sub_code,</span>
<span class='curline'><a href='../S/622.html#L874'>peer</a>              874 bgpd/bgp_packet.c   stream_fifo_clean (peer-&gt;obuf);</span>
<span class='curline'><a href='../S/622.html#L875'>peer</a>              875 bgpd/bgp_packet.c   bgp_packet_add (peer, s);</span>
<span class='curline'><a href='../S/622.html#L905'>peer</a>              905 bgpd/bgp_packet.c     bgp_notify_print (peer, &amp;bgp_notify, "sending");</span>
<span class='curline'><a href='../S/622.html#L912'>peer</a>              912 bgpd/bgp_packet.c 	       peer-&gt;host, BGP_MSG_NOTIFY, length);</span>
<span class='curline'><a href='../S/622.html#L919'>peer</a>              919 bgpd/bgp_packet.c         peer-&gt;last_reset = PEER_DOWN_USER_RESET;</span>
<span class='curline'><a href='../S/622.html#L920'>peer</a>              920 bgpd/bgp_packet.c         zlog_info ("Notification sent to neighbor %s: User reset", peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L924'>peer</a>              924 bgpd/bgp_packet.c         peer-&gt;last_reset = PEER_DOWN_USER_SHUTDOWN;</span>
<span class='curline'><a href='../S/622.html#L925'>peer</a>              925 bgpd/bgp_packet.c         zlog_info ("Notification sent to neighbor %s: shutdown", peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L929'>peer</a>              929 bgpd/bgp_packet.c         peer-&gt;last_reset = PEER_DOWN_NOTIFY_SEND;</span>
<span class='curline'><a href='../S/622.html#L931'>peer</a>              931 bgpd/bgp_packet.c                    peer-&gt;host, code, sub_code);</span>
<span class='curline'><a href='../S/622.html#L936'>peer</a>              936 bgpd/bgp_packet.c                 peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L939'>peer</a>              939 bgpd/bgp_packet.c   BGP_WRITE_OFF (peer-&gt;t_write);</span>
<span class='curline'><a href='../S/622.html#L941'>peer</a>              941 bgpd/bgp_packet.c   bgp_write_notify (peer);</span>
<span class='curline'><a href='../S/622.html#L946'>peer</a>              946 bgpd/bgp_packet.c bgp_notify_send (struct peer *peer, u_char code, u_char sub_code)</span>
<span class='curline'><a href='../S/622.html#L948'>peer</a>              948 bgpd/bgp_packet.c   bgp_notify_send_with_data (peer, code, sub_code, NULL, 0);</span>
<span class='curline'><a href='../S/622.html#L953'>peer</a>              953 bgpd/bgp_packet.c bgp_route_refresh_send (struct peer *peer, afi_t afi, safi_t safi,</span>
<span class='curline'><a href='../S/622.html#L965'>peer</a>              965 bgpd/bgp_packet.c   filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/622.html#L974'>peer</a>              974 bgpd/bgp_packet.c   if (CHECK_FLAG (peer-&gt;cap, PEER_CAP_REFRESH_NEW_RCV))</span>
<span class='curline'><a href='../S/622.html#L999'>peer</a>              999 bgpd/bgp_packet.c 	    UNSET_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_ORF_PREFIX_SEND);</span>
<span class='curline'><a href='../S/622.html#L1003'>peer</a>             1003 bgpd/bgp_packet.c 			 peer-&gt;host, orf_type,</span>
<span class='curline'><a href='../S/622.html#L1009'>peer</a>             1009 bgpd/bgp_packet.c 	    SET_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_ORF_PREFIX_SEND);</span>
<span class='curline'><a href='../S/622.html#L1015'>peer</a>             1015 bgpd/bgp_packet.c 			 peer-&gt;host, orf_type,</span>
<span class='curline'><a href='../S/622.html#L1032'>peer</a>             1032 bgpd/bgp_packet.c 		   peer-&gt;host, afi, safi);</span>
<span class='curline'><a href='../S/622.html#L1034'>peer</a>             1034 bgpd/bgp_packet.c 		 peer-&gt;host, CHECK_FLAG (peer-&gt;cap, PEER_CAP_REFRESH_NEW_RCV) ?</span>
<span class='curline'><a href='../S/622.html#L1043'>peer</a>             1043 bgpd/bgp_packet.c   bgp_packet_add (peer, packet);</span>
<span class='curline'><a href='../S/622.html#L1045'>peer</a>             1045 bgpd/bgp_packet.c   BGP_WRITE_ON (peer-&gt;t_write, bgp_write, peer-&gt;fd);</span>
<span class='curline'><a href='../S/622.html#L1050'>peer</a>             1050 bgpd/bgp_packet.c bgp_capability_send (struct peer *peer, afi_t afi, safi_t safi,</span>
<span class='curline'><a href='../S/622.html#L1078'>peer</a>             1078 bgpd/bgp_packet.c 		   peer-&gt;host, action == CAPABILITY_ACTION_SET ?</span>
<span class='curline'><a href='../S/622.html#L1090'>peer</a>             1090 bgpd/bgp_packet.c   bgp_packet_add (peer, packet);</span>
<span class='curline'><a href='../S/622.html#L1094'>peer</a>             1094 bgpd/bgp_packet.c 	       peer-&gt;host, BGP_MSG_CAPABILITY, length);</span>
<span class='curline'><a href='../S/622.html#L1096'>peer</a>             1096 bgpd/bgp_packet.c   BGP_WRITE_ON (peer-&gt;t_write, bgp_write, peer-&gt;fd);</span>
<span class='curline'><a href='../S/622.html#L1101'>peer</a>             1101 bgpd/bgp_packet.c bgp_collision_detect (struct peer *new, struct in_addr remote_id)</span>
<span class='curline'><a href='../S/622.html#L1103'>peer</a>             1103 bgpd/bgp_packet.c   struct peer *peer;</span>
<span class='curline'><a href='../S/622.html#L1120'>peer</a>             1120 bgpd/bgp_packet.c   for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/622.html#L1125'>peer</a>             1125 bgpd/bgp_packet.c       if (peer != new</span>
<span class='curline'><a href='../S/622.html#L1126'>peer</a>             1126 bgpd/bgp_packet.c 	  &amp;&amp; (peer-&gt;status == OpenConfirm || peer-&gt;status == OpenSent)</span>
<span class='curline'><a href='../S/622.html#L1127'>peer</a>             1127 bgpd/bgp_packet.c 	  &amp;&amp; sockunion_same (&amp;peer-&gt;su, &amp;new-&gt;su))</span>
<span class='curline'><a href='../S/622.html#L1133'>peer</a>             1133 bgpd/bgp_packet.c 	  if (ntohl (peer-&gt;local_id.s_addr) &lt; ntohl (remote_id.s_addr))</span>
<span class='curline'><a href='../S/622.html#L1141'>peer</a>             1141 bgpd/bgp_packet.c 	      if (peer-&gt;fd &gt;= 0)</span>
<span class='curline'><a href='../S/622.html#L1142'>peer</a>             1142 bgpd/bgp_packet.c 		bgp_notify_send (peer, BGP_NOTIFY_CEASE, BGP_NOTIFY_CEASE_COLLISION_RESOLUTION);</span>
<span class='curline'><a href='../S/622.html#L1164'>peer</a>             1164 bgpd/bgp_packet.c bgp_open_receive (struct peer *peer, bgp_size_t size)</span>
<span class='curline'><a href='../S/622.html#L1173'>peer</a>             1173 bgpd/bgp_packet.c   struct peer *realpeer;</span>
<span class='curline'><a href='../S/622.html#L1182'>peer</a>             1182 bgpd/bgp_packet.c   version = stream_getc (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/622.html#L1183'>peer</a>             1183 bgpd/bgp_packet.c   memcpy (notify_data_remote_as, stream_pnt (peer-&gt;ibuf), 2);</span>
<span class='curline'><a href='../S/622.html#L1184'>peer</a>             1184 bgpd/bgp_packet.c   remote_as  = stream_getw (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/622.html#L1185'>peer</a>             1185 bgpd/bgp_packet.c   holdtime = stream_getw (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/622.html#L1186'>peer</a>             1186 bgpd/bgp_packet.c   memcpy (notify_data_remote_id, stream_pnt (peer-&gt;ibuf), 4);</span>
<span class='curline'><a href='../S/622.html#L1187'>peer</a>             1187 bgpd/bgp_packet.c   remote_id.s_addr = stream_get_ipv4 (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/622.html#L1193'>peer</a>             1193 bgpd/bgp_packet.c 	        peer-&gt;host, version, remote_as, holdtime,</span>
<span class='curline'><a href='../S/622.html#L1198'>peer</a>             1198 bgpd/bgp_packet.c   optlen = stream_getc (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/622.html#L1206'>peer</a>             1206 bgpd/bgp_packet.c       as4 = peek_for_as4_capability (peer, optlen);</span>
<span class='curline'><a href='../S/622.html#L1210'>peer</a>             1210 bgpd/bgp_packet.c   if (CHECK_FLAG (peer-&gt;cap, PEER_CAP_AS4_RCV) &amp;&amp; !as4)</span>
<span class='curline'><a href='../S/622.html#L1213'>peer</a>             1213 bgpd/bgp_packet.c                 peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L1214'>peer</a>             1214 bgpd/bgp_packet.c       bgp_notify_send (peer, BGP_NOTIFY_OPEN_ERR,</span>
<span class='curline'><a href='../S/622.html#L1228'>peer</a>             1228 bgpd/bgp_packet.c                     peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L1229'>peer</a>             1229 bgpd/bgp_packet.c           bgp_notify_send (peer, BGP_NOTIFY_OPEN_ERR,</span>
<span class='curline'><a href='../S/622.html#L1236'>peer</a>             1236 bgpd/bgp_packet.c                     " Odd, but proceeding.", peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L1239'>peer</a>             1239 bgpd/bgp_packet.c                     "in 2-bytes, very odd peer.", peer-&gt;host, as4);</span>
<span class='curline'><a href='../S/622.html#L1247'>peer</a>             1247 bgpd/bgp_packet.c       if (CHECK_FLAG (peer-&gt;cap, PEER_CAP_AS4_RCV)</span>
<span class='curline'><a href='../S/622.html#L1253'>peer</a>             1253 bgpd/bgp_packet.c 	            peer-&gt;host, as4, remote_as);</span>
<span class='curline'><a href='../S/622.html#L1254'>peer</a>             1254 bgpd/bgp_packet.c 	  bgp_notify_send (peer, BGP_NOTIFY_OPEN_ERR,</span>
<span class='curline'><a href='../S/622.html#L1261'>peer</a>             1261 bgpd/bgp_packet.c   if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_ACCEPT_PEER))</span>
<span class='curline'><a href='../S/622.html#L1265'>peer</a>             1265 bgpd/bgp_packet.c       realpeer = peer_lookup_with_open (&amp;peer-&gt;su, remote_as, &amp;remote_id, &amp;as);</span>
<span class='curline'><a href='../S/622.html#L1276'>peer</a>             1276 bgpd/bgp_packet.c 			    peer-&gt;host, inet_ntoa (remote_id));</span>
<span class='curline'><a href='../S/622.html#L1277'>peer</a>             1277 bgpd/bgp_packet.c 	      bgp_notify_send_with_data (peer, BGP_NOTIFY_OPEN_ERR, </span>
<span class='curline'><a href='../S/622.html#L1285'>peer</a>             1285 bgpd/bgp_packet.c 			    peer-&gt;host, remote_as, peer-&gt;as);</span>
<span class='curline'><a href='../S/622.html#L1286'>peer</a>             1286 bgpd/bgp_packet.c 	      bgp_notify_send_with_data (peer, BGP_NOTIFY_OPEN_ERR,</span>
<span class='curline'><a href='../S/622.html#L1296'>peer</a>             1296 bgpd/bgp_packet.c   ret = bgp_collision_detect (peer, remote_id);</span>
<span class='curline'><a href='../S/622.html#L1301'>peer</a>             1301 bgpd/bgp_packet.c   if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_ACCEPT_PEER))</span>
<span class='curline'><a href='../S/622.html#L1363'>peer</a>             1363 bgpd/bgp_packet.c 	  bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/622.html#L1371'>peer</a>             1371 bgpd/bgp_packet.c 		   peer-&gt;host, </span>
<span class='curline'><a href='../S/622.html#L1377'>peer</a>             1377 bgpd/bgp_packet.c       realpeer-&gt;fd = peer-&gt;fd;</span>
<span class='curline'><a href='../S/622.html#L1378'>peer</a>             1378 bgpd/bgp_packet.c       peer-&gt;fd = -1;</span>
<span class='curline'><a href='../S/622.html#L1382'>peer</a>             1382 bgpd/bgp_packet.c       realpeer-&gt;ibuf = peer-&gt;ibuf;</span>
<span class='curline'><a href='../S/622.html#L1383'>peer</a>             1383 bgpd/bgp_packet.c       realpeer-&gt;packet_size = peer-&gt;packet_size;</span>
<span class='curline'><a href='../S/622.html#L1384'>peer</a>             1384 bgpd/bgp_packet.c       peer-&gt;ibuf = NULL;</span>
<span class='curline'><a href='../S/622.html#L1387'>peer</a>             1387 bgpd/bgp_packet.c       realpeer-&gt;status = peer-&gt;status;</span>
<span class='curline'><a href='../S/622.html#L1388'>peer</a>             1388 bgpd/bgp_packet.c       bgp_stop (peer);</span>
<span class='curline'><a href='../S/622.html#L1391'>peer</a>             1391 bgpd/bgp_packet.c       peer = realpeer;</span>
<span class='curline'><a href='../S/622.html#L1392'>peer</a>             1392 bgpd/bgp_packet.c       bgp_open_send (peer);</span>
<span class='curline'><a href='../S/622.html#L1393'>peer</a>             1393 bgpd/bgp_packet.c       if (peer-&gt;fd &lt; 0)</span>
<span class='curline'><a href='../S/622.html#L1396'>peer</a>             1396 bgpd/bgp_packet.c 		    peer-&gt;fd);</span>
<span class='curline'><a href='../S/622.html#L1399'>peer</a>             1399 bgpd/bgp_packet.c       BGP_READ_ON (peer-&gt;t_read, bgp_read, peer-&gt;fd);</span>
<span class='curline'><a href='../S/622.html#L1405'>peer</a>             1405 bgpd/bgp_packet.c       || ntohl (peer-&gt;local_id.s_addr) == ntohl (remote_id.s_addr))</span>
<span class='curline'><a href='../S/622.html#L1409'>peer</a>             1409 bgpd/bgp_packet.c 		   peer-&gt;host, inet_ntoa (remote_id));</span>
<span class='curline'><a href='../S/622.html#L1410'>peer</a>             1410 bgpd/bgp_packet.c       bgp_notify_send_with_data (peer, </span>
<span class='curline'><a href='../S/622.html#L1418'>peer</a>             1418 bgpd/bgp_packet.c   peer-&gt;remote_id = remote_id;</span>
<span class='curline'><a href='../S/622.html#L1427'>peer</a>             1427 bgpd/bgp_packet.c 		   peer-&gt;host, version, BGP_VERSION_4);</span>
<span class='curline'><a href='../S/622.html#L1429'>peer</a>             1429 bgpd/bgp_packet.c       bgp_notify_send_with_data (peer, </span>
<span class='curline'><a href='../S/622.html#L1437'>peer</a>             1437 bgpd/bgp_packet.c   if (remote_as != peer-&gt;as)</span>
<span class='curline'><a href='../S/622.html#L1441'>peer</a>             1441 bgpd/bgp_packet.c 		   peer-&gt;host, remote_as, peer-&gt;as);</span>
<span class='curline'><a href='../S/622.html#L1442'>peer</a>             1442 bgpd/bgp_packet.c       bgp_notify_send_with_data (peer, </span>
<span class='curline'><a href='../S/622.html#L1457'>peer</a>             1457 bgpd/bgp_packet.c       bgp_notify_send (peer,</span>
<span class='curline'><a href='../S/622.html#L1469'>peer</a>             1469 bgpd/bgp_packet.c   if (CHECK_FLAG (peer-&gt;config, PEER_CONFIG_TIMER))</span>
<span class='curline'><a href='../S/622.html#L1470'>peer</a>             1470 bgpd/bgp_packet.c     send_holdtime = peer-&gt;holdtime;</span>
<span class='curline'><a href='../S/622.html#L1472'>peer</a>             1472 bgpd/bgp_packet.c     send_holdtime = peer-&gt;bgp-&gt;default_holdtime;</span>
<span class='curline'><a href='../S/622.html#L1475'>peer</a>             1475 bgpd/bgp_packet.c     peer-&gt;v_holdtime = holdtime;</span>
<span class='curline'><a href='../S/622.html#L1477'>peer</a>             1477 bgpd/bgp_packet.c     peer-&gt;v_holdtime = send_holdtime;</span>
<span class='curline'><a href='../S/622.html#L1479'>peer</a>             1479 bgpd/bgp_packet.c   peer-&gt;v_keepalive = peer-&gt;v_holdtime / 3;</span>
<span class='curline'><a href='../S/622.html#L1484'>peer</a>             1484 bgpd/bgp_packet.c       if ((ret = bgp_open_option_parse (peer, optlen, &amp;mp_capability)) &lt; 0)</span>
<span class='curline'><a href='../S/622.html#L1486'>peer</a>             1486 bgpd/bgp_packet.c           bgp_notify_send (peer,</span>
<span class='curline'><a href='../S/622.html#L1496'>peer</a>             1496 bgpd/bgp_packet.c 		   peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L1505'>peer</a>             1505 bgpd/bgp_packet.c       CHECK_FLAG (peer-&gt;flags, PEER_FLAG_OVERRIDE_CAPABILITY))</span>
<span class='curline'><a href='../S/622.html#L1507'>peer</a>             1507 bgpd/bgp_packet.c       peer-&gt;afc_nego[AFI_IP][SAFI_UNICAST] = peer-&gt;afc[AFI_IP][SAFI_UNICAST];</span>
<span class='curline'><a href='../S/622.html#L1508'>peer</a>             1508 bgpd/bgp_packet.c       peer-&gt;afc_nego[AFI_IP][SAFI_MULTICAST] = peer-&gt;afc[AFI_IP][SAFI_MULTICAST];</span>
<span class='curline'><a href='../S/622.html#L1509'>peer</a>             1509 bgpd/bgp_packet.c       peer-&gt;afc_nego[AFI_IP6][SAFI_UNICAST] = peer-&gt;afc[AFI_IP6][SAFI_UNICAST];</span>
<span class='curline'><a href='../S/622.html#L1510'>peer</a>             1510 bgpd/bgp_packet.c       peer-&gt;afc_nego[AFI_IP6][SAFI_MULTICAST] = peer-&gt;afc[AFI_IP6][SAFI_MULTICAST];</span>
<span class='curline'><a href='../S/622.html#L1514'>peer</a>             1514 bgpd/bgp_packet.c   bgp_getsockname (peer);</span>
<span class='curline'><a href='../S/622.html#L1516'>peer</a>             1516 bgpd/bgp_packet.c   BGP_EVENT_ADD (peer, Receive_OPEN_message);</span>
<span class='curline'><a href='../S/622.html#L1518'>peer</a>             1518 bgpd/bgp_packet.c   peer-&gt;packet_size = 0;</span>
<span class='curline'><a href='../S/622.html#L1519'>peer</a>             1519 bgpd/bgp_packet.c   if (peer-&gt;ibuf)</span>
<span class='curline'><a href='../S/622.html#L1520'>peer</a>             1520 bgpd/bgp_packet.c     stream_reset (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/622.html#L1527'>peer</a>             1527 bgpd/bgp_packet.c bgp_update_receive (struct peer *peer, bgp_size_t size)</span>
<span class='curline'><a href='../S/622.html#L1543'>peer</a>             1543 bgpd/bgp_packet.c   if (peer-&gt;status != Established) </span>
<span class='curline'><a href='../S/622.html#L1546'>peer</a>             1546 bgpd/bgp_packet.c 		peer-&gt;host, LOOKUP (bgp_status_msg, peer-&gt;status));</span>
<span class='curline'><a href='../S/622.html#L1547'>peer</a>             1547 bgpd/bgp_packet.c       bgp_notify_send (peer, BGP_NOTIFY_FSM_ERR, 0);</span>
<span class='curline'><a href='../S/622.html#L1560'>peer</a>             1560 bgpd/bgp_packet.c   s = peer-&gt;ibuf;</span>
<span class='curline'><a href='../S/622.html#L1571'>peer</a>             1571 bgpd/bgp_packet.c 		peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L1572'>peer</a>             1572 bgpd/bgp_packet.c       bgp_notify_send (peer, BGP_NOTIFY_UPDATE_ERR, </span>
<span class='curline'><a href='../S/622.html#L1585'>peer</a>             1585 bgpd/bgp_packet.c 		peer-&gt;host, withdraw_len);</span>
<span class='curline'><a href='../S/622.html#L1586'>peer</a>             1586 bgpd/bgp_packet.c       bgp_notify_send (peer, BGP_NOTIFY_UPDATE_ERR, </span>
<span class='curline'><a href='../S/622.html#L1594'>peer</a>             1594 bgpd/bgp_packet.c       ret = bgp_nlri_sanity_check (peer, AFI_IP, stream_pnt (s), withdraw_len);</span>
<span class='curline'><a href='../S/622.html#L1599'>peer</a>             1599 bgpd/bgp_packet.c 	zlog_debug ("%s [Update:RECV] Unfeasible NLRI received", peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L1613'>peer</a>             1613 bgpd/bgp_packet.c 		 peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L1614'>peer</a>             1614 bgpd/bgp_packet.c       bgp_notify_send (peer, BGP_NOTIFY_UPDATE_ERR, </span>
<span class='curline'><a href='../S/622.html#L1627'>peer</a>             1627 bgpd/bgp_packet.c 		 peer-&gt;host, attribute_len);</span>
<span class='curline'><a href='../S/622.html#L1628'>peer</a>             1628 bgpd/bgp_packet.c       bgp_notify_send (peer, BGP_NOTIFY_UPDATE_ERR, </span>
<span class='curline'><a href='../S/622.html#L1649'>peer</a>             1649 bgpd/bgp_packet.c       attr_parse_ret = bgp_attr_parse (peer, &amp;attr, attribute_len, </span>
<span class='curline'><a href='../S/622.html#L1662'>peer</a>             1662 bgpd/bgp_packet.c       ret= bgp_dump_attr (peer, &amp;attr, attrstr, BUFSIZ);</span>
<span class='curline'><a href='../S/622.html#L1667'>peer</a>             1667 bgpd/bgp_packet.c         zlog (peer-&gt;log, LOG_ERR,</span>
<span class='curline'><a href='../S/622.html#L1669'>peer</a>             1669 bgpd/bgp_packet.c               peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L1672'>peer</a>             1672 bgpd/bgp_packet.c 	zlog (peer-&gt;log, lvl, "%s rcvd UPDATE w/ attr: %s",</span>
<span class='curline'><a href='../S/622.html#L1673'>peer</a>             1673 bgpd/bgp_packet.c 	      peer-&gt;host, attrstr);</span>
<span class='curline'><a href='../S/622.html#L1682'>peer</a>             1682 bgpd/bgp_packet.c       ret = bgp_nlri_sanity_check (peer, AFI_IP, stream_pnt (s), update_len);</span>
<span class='curline'><a href='../S/622.html#L1699'>peer</a>             1699 bgpd/bgp_packet.c   if (peer-&gt;afc[AFI_IP][SAFI_UNICAST])</span>
<span class='curline'><a href='../S/622.html#L1702'>peer</a>             1702 bgpd/bgp_packet.c 	bgp_nlri_parse (peer, NULL, &amp;withdraw);</span>
<span class='curline'><a href='../S/622.html#L1708'>peer</a>             1708 bgpd/bgp_packet.c 	  ret = bgp_attr_check (peer, &amp;attr);</span>
<span class='curline'><a href='../S/622.html#L1715'>peer</a>             1715 bgpd/bgp_packet.c 	  bgp_nlri_parse (peer, NLRI_ATTR_ARG, &amp;update);</span>
<span class='curline'><a href='../S/622.html#L1721'>peer</a>             1721 bgpd/bgp_packet.c 	bgp_nlri_parse (peer, NLRI_ATTR_ARG, &amp;mp_update);</span>
<span class='curline'><a href='../S/622.html#L1726'>peer</a>             1726 bgpd/bgp_packet.c 	bgp_nlri_parse (peer, NULL, &amp;mp_withdraw);</span>
<span class='curline'><a href='../S/622.html#L1731'>peer</a>             1731 bgpd/bgp_packet.c 	  SET_FLAG (peer-&gt;af_sflags[AFI_IP][SAFI_UNICAST],</span>
<span class='curline'><a href='../S/622.html#L1735'>peer</a>             1735 bgpd/bgp_packet.c 	  if (peer-&gt;nsf[AFI_IP][SAFI_UNICAST])</span>
<span class='curline'><a href='../S/622.html#L1736'>peer</a>             1736 bgpd/bgp_packet.c 	    bgp_clear_stale_route (peer, AFI_IP, SAFI_UNICAST);</span>
<span class='curline'><a href='../S/622.html#L1739'>peer</a>             1739 bgpd/bgp_packet.c 	    zlog (peer-&gt;log, LOG_DEBUG, "rcvd End-of-RIB for IPv4 Unicast from %s",</span>
<span class='curline'><a href='../S/622.html#L1740'>peer</a>             1740 bgpd/bgp_packet.c 		  peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L1743'>peer</a>             1743 bgpd/bgp_packet.c   if (peer-&gt;afc[AFI_IP][SAFI_MULTICAST])</span>
<span class='curline'><a href='../S/622.html#L1748'>peer</a>             1748 bgpd/bgp_packet.c 	bgp_nlri_parse (peer, NLRI_ATTR_ARG, &amp;mp_update);</span>
<span class='curline'><a href='../S/622.html#L1753'>peer</a>             1753 bgpd/bgp_packet.c 	bgp_nlri_parse (peer, NULL, &amp;mp_withdraw);</span>
<span class='curline'><a href='../S/622.html#L1761'>peer</a>             1761 bgpd/bgp_packet.c 	  SET_FLAG (peer-&gt;af_sflags[AFI_IP][SAFI_MULTICAST],</span>
<span class='curline'><a href='../S/622.html#L1765'>peer</a>             1765 bgpd/bgp_packet.c 	  if (peer-&gt;nsf[AFI_IP][SAFI_MULTICAST])</span>
<span class='curline'><a href='../S/622.html#L1766'>peer</a>             1766 bgpd/bgp_packet.c 	    bgp_clear_stale_route (peer, AFI_IP, SAFI_MULTICAST);</span>
<span class='curline'><a href='../S/622.html#L1769'>peer</a>             1769 bgpd/bgp_packet.c 	    zlog (peer-&gt;log, LOG_DEBUG, "rcvd End-of-RIB for IPv4 Multicast from %s",</span>
<span class='curline'><a href='../S/622.html#L1770'>peer</a>             1770 bgpd/bgp_packet.c 		  peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L1773'>peer</a>             1773 bgpd/bgp_packet.c   if (peer-&gt;afc[AFI_IP6][SAFI_UNICAST])</span>
<span class='curline'><a href='../S/622.html#L1778'>peer</a>             1778 bgpd/bgp_packet.c 	bgp_nlri_parse (peer, NLRI_ATTR_ARG, &amp;mp_update);</span>
<span class='curline'><a href='../S/622.html#L1783'>peer</a>             1783 bgpd/bgp_packet.c 	bgp_nlri_parse (peer, NULL, &amp;mp_withdraw);</span>
<span class='curline'><a href='../S/622.html#L1791'>peer</a>             1791 bgpd/bgp_packet.c 	  SET_FLAG (peer-&gt;af_sflags[AFI_IP6][SAFI_UNICAST], PEER_STATUS_EOR_RECEIVED);</span>
<span class='curline'><a href='../S/622.html#L1794'>peer</a>             1794 bgpd/bgp_packet.c 	  if (peer-&gt;nsf[AFI_IP6][SAFI_UNICAST])</span>
<span class='curline'><a href='../S/622.html#L1795'>peer</a>             1795 bgpd/bgp_packet.c 	    bgp_clear_stale_route (peer, AFI_IP6, SAFI_UNICAST);</span>
<span class='curline'><a href='../S/622.html#L1798'>peer</a>             1798 bgpd/bgp_packet.c 	    zlog (peer-&gt;log, LOG_DEBUG, "rcvd End-of-RIB for IPv6 Unicast from %s",</span>
<span class='curline'><a href='../S/622.html#L1799'>peer</a>             1799 bgpd/bgp_packet.c 		  peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L1802'>peer</a>             1802 bgpd/bgp_packet.c   if (peer-&gt;afc[AFI_IP6][SAFI_MULTICAST])</span>
<span class='curline'><a href='../S/622.html#L1807'>peer</a>             1807 bgpd/bgp_packet.c 	bgp_nlri_parse (peer, NLRI_ATTR_ARG, &amp;mp_update);</span>
<span class='curline'><a href='../S/622.html#L1812'>peer</a>             1812 bgpd/bgp_packet.c 	bgp_nlri_parse (peer, NULL, &amp;mp_withdraw);</span>
<span class='curline'><a href='../S/622.html#L1822'>peer</a>             1822 bgpd/bgp_packet.c 	  if (peer-&gt;nsf[AFI_IP6][SAFI_MULTICAST])</span>
<span class='curline'><a href='../S/622.html#L1823'>peer</a>             1823 bgpd/bgp_packet.c 	    bgp_clear_stale_route (peer, AFI_IP6, SAFI_MULTICAST);</span>
<span class='curline'><a href='../S/622.html#L1826'>peer</a>             1826 bgpd/bgp_packet.c 	    zlog (peer-&gt;log, LOG_DEBUG, "rcvd End-of-RIB for IPv6 Multicast from %s",</span>
<span class='curline'><a href='../S/622.html#L1827'>peer</a>             1827 bgpd/bgp_packet.c 		  peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L1830'>peer</a>             1830 bgpd/bgp_packet.c   if (peer-&gt;afc[AFI_IP][SAFI_MPLS_VPN])</span>
<span class='curline'><a href='../S/622.html#L1835'>peer</a>             1835 bgpd/bgp_packet.c 	bgp_nlri_parse_vpnv4 (peer, NLRI_ATTR_ARG, &amp;mp_update);</span>
<span class='curline'><a href='../S/622.html#L1840'>peer</a>             1840 bgpd/bgp_packet.c 	bgp_nlri_parse_vpnv4 (peer, NULL, &amp;mp_withdraw);</span>
<span class='curline'><a href='../S/622.html#L1850'>peer</a>             1850 bgpd/bgp_packet.c 	    zlog (peer-&gt;log, LOG_DEBUG, "rcvd End-of-RIB for VPNv4 Unicast from %s",</span>
<span class='curline'><a href='../S/622.html#L1851'>peer</a>             1851 bgpd/bgp_packet.c 		  peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L1861'>peer</a>             1861 bgpd/bgp_packet.c   if (peer-&gt;status != Established)</span>
<span class='curline'><a href='../S/622.html#L1865'>peer</a>             1865 bgpd/bgp_packet.c   peer-&gt;update_in++;</span>
<span class='curline'><a href='../S/622.html#L1866'>peer</a>             1866 bgpd/bgp_packet.c   peer-&gt;update_time = bgp_clock ();</span>
<span class='curline'><a href='../S/622.html#L1869'>peer</a>             1869 bgpd/bgp_packet.c   BGP_TIMER_OFF (peer-&gt;t_holdtime);</span>
<span class='curline'><a href='../S/622.html#L1870'>peer</a>             1870 bgpd/bgp_packet.c   bgp_timer_set (peer);</span>
<span class='curline'><a href='../S/622.html#L1877'>peer</a>             1877 bgpd/bgp_packet.c bgp_notify_receive (struct peer *peer, bgp_size_t size)</span>
<span class='curline'><a href='../S/622.html#L1881'>peer</a>             1881 bgpd/bgp_packet.c   if (peer-&gt;notify.data)</span>
<span class='curline'><a href='../S/622.html#L1883'>peer</a>             1883 bgpd/bgp_packet.c       XFREE (MTYPE_TMP, peer-&gt;notify.data);</span>
<span class='curline'><a href='../S/622.html#L1884'>peer</a>             1884 bgpd/bgp_packet.c       peer-&gt;notify.data = NULL;</span>
<span class='curline'><a href='../S/622.html#L1885'>peer</a>             1885 bgpd/bgp_packet.c       peer-&gt;notify.length = 0;</span>
<span class='curline'><a href='../S/622.html#L1888'>peer</a>             1888 bgpd/bgp_packet.c   bgp_notify.code = stream_getc (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/622.html#L1889'>peer</a>             1889 bgpd/bgp_packet.c   bgp_notify.subcode = stream_getc (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/622.html#L1894'>peer</a>             1894 bgpd/bgp_packet.c   peer-&gt;notify.code = bgp_notify.code;</span>
<span class='curline'><a href='../S/622.html#L1895'>peer</a>             1895 bgpd/bgp_packet.c   peer-&gt;notify.subcode = bgp_notify.subcode;</span>
<span class='curline'><a href='../S/622.html#L1899'>peer</a>             1899 bgpd/bgp_packet.c       peer-&gt;notify.length = size - 2;</span>
<span class='curline'><a href='../S/622.html#L1900'>peer</a>             1900 bgpd/bgp_packet.c       peer-&gt;notify.data = XMALLOC (MTYPE_TMP, size - 2);</span>
<span class='curline'><a href='../S/622.html#L1901'>peer</a>             1901 bgpd/bgp_packet.c       memcpy (peer-&gt;notify.data, stream_pnt (peer-&gt;ibuf), size - 2);</span>
<span class='curline'><a href='../S/622.html#L1916'>peer</a>             1916 bgpd/bgp_packet.c 	      sprintf (c, " %02x", stream_getc (peer-&gt;ibuf));</span>
<span class='curline'><a href='../S/622.html#L1922'>peer</a>             1922 bgpd/bgp_packet.c 	      sprintf (c, "%02x", stream_getc (peer-&gt;ibuf));</span>
<span class='curline'><a href='../S/622.html#L1927'>peer</a>             1927 bgpd/bgp_packet.c     bgp_notify_print(peer, &amp;bgp_notify, "received");</span>
<span class='curline'><a href='../S/622.html#L1933'>peer</a>             1933 bgpd/bgp_packet.c   peer-&gt;notify_in++;</span>
<span class='curline'><a href='../S/622.html#L1935'>peer</a>             1935 bgpd/bgp_packet.c   if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/622.html#L1936'>peer</a>             1936 bgpd/bgp_packet.c     peer-&gt;last_reset = PEER_DOWN_NOTIFY_RECEIVED;</span>
<span class='curline'><a href='../S/622.html#L1944'>peer</a>             1944 bgpd/bgp_packet.c     UNSET_FLAG (peer-&gt;sflags, PEER_STATUS_CAPABILITY_OPEN);</span>
<span class='curline'><a href='../S/622.html#L1946'>peer</a>             1946 bgpd/bgp_packet.c   BGP_EVENT_ADD (peer, Receive_NOTIFICATION_message);</span>
<span class='curline'><a href='../S/622.html#L1951'>peer</a>             1951 bgpd/bgp_packet.c bgp_keepalive_receive (struct peer *peer, bgp_size_t size)</span>
<span class='curline'><a href='../S/622.html#L1954'>peer</a>             1954 bgpd/bgp_packet.c     zlog_debug ("%s KEEPALIVE rcvd", peer-&gt;host); </span>
<span class='curline'><a href='../S/622.html#L1956'>peer</a>             1956 bgpd/bgp_packet.c   BGP_EVENT_ADD (peer, Receive_KEEPALIVE_message);</span>
<span class='curline'><a href='../S/622.html#L1961'>peer</a>             1961 bgpd/bgp_packet.c bgp_route_refresh_receive (struct peer *peer, bgp_size_t size)</span>
<span class='curline'><a href='../S/622.html#L1969'>peer</a>             1969 bgpd/bgp_packet.c   if (! CHECK_FLAG (peer-&gt;cap, PEER_CAP_REFRESH_ADV))</span>
<span class='curline'><a href='../S/622.html#L1971'>peer</a>             1971 bgpd/bgp_packet.c       plog_err (peer-&gt;log, "%s [Error] BGP route refresh is not enabled",</span>
<span class='curline'><a href='../S/622.html#L1972'>peer</a>             1972 bgpd/bgp_packet.c 		peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L1973'>peer</a>             1973 bgpd/bgp_packet.c       bgp_notify_send (peer,</span>
<span class='curline'><a href='../S/622.html#L1980'>peer</a>             1980 bgpd/bgp_packet.c   if (peer-&gt;status != Established) </span>
<span class='curline'><a href='../S/622.html#L1982'>peer</a>             1982 bgpd/bgp_packet.c       plog_err (peer-&gt;log,</span>
<span class='curline'><a href='../S/622.html#L1984'>peer</a>             1984 bgpd/bgp_packet.c 		peer-&gt;host, LOOKUP (bgp_status_msg, peer-&gt;status));</span>
<span class='curline'><a href='../S/622.html#L1985'>peer</a>             1985 bgpd/bgp_packet.c       bgp_notify_send (peer, BGP_NOTIFY_FSM_ERR, 0);</span>
<span class='curline'><a href='../S/622.html#L1989'>peer</a>             1989 bgpd/bgp_packet.c   s = peer-&gt;ibuf;</span>
<span class='curline'><a href='../S/622.html#L1998'>peer</a>             1998 bgpd/bgp_packet.c 	       peer-&gt;host, afi, safi);</span>
<span class='curline'><a href='../S/622.html#L2008'>peer</a>             2008 bgpd/bgp_packet.c 		     peer-&gt;host, afi, safi);</span>
<span class='curline'><a href='../S/622.html#L2026'>peer</a>             2026 bgpd/bgp_packet.c           zlog_info ("%s ORF route refresh length error", peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L2027'>peer</a>             2027 bgpd/bgp_packet.c           bgp_notify_send (peer, BGP_NOTIFY_CEASE, 0);</span>
<span class='curline'><a href='../S/622.html#L2057'>peer</a>             2057 bgpd/bgp_packet.c 			     peer-&gt;host, orf_type, orf_len);</span>
<span class='curline'><a href='../S/622.html#L2067'>peer</a>             2067 bgpd/bgp_packet.c 	      sprintf (name, "%s.%d.%d", peer-&gt;host, afi, safi);</span>
<span class='curline'><a href='../S/622.html#L2082'>peer</a>             2082 bgpd/bgp_packet.c 			zlog_debug ("%s rcvd Remove-All pfxlist ORF request", peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L2125'>peer</a>             2125 bgpd/bgp_packet.c 			         peer-&gt;host,</span>
<span class='curline'><a href='../S/622.html#L2143'>peer</a>             2143 bgpd/bgp_packet.c 			            " Remove All pfxlist", peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L2148'>peer</a>             2148 bgpd/bgp_packet.c 	      peer-&gt;orf_plist[afi][safi] =</span>
<span class='curline'><a href='../S/622.html#L2154'>peer</a>             2154 bgpd/bgp_packet.c 	zlog_debug ("%s rcvd Refresh %s ORF request", peer-&gt;host,</span>
<span class='curline'><a href='../S/622.html#L2161'>peer</a>             2161 bgpd/bgp_packet.c   if (CHECK_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_ORF_WAIT_REFRESH))</span>
<span class='curline'><a href='../S/622.html#L2162'>peer</a>             2162 bgpd/bgp_packet.c     UNSET_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_ORF_WAIT_REFRESH);</span>
<span class='curline'><a href='../S/622.html#L2165'>peer</a>             2165 bgpd/bgp_packet.c   bgp_announce_route (peer, afi, safi);</span>
<span class='curline'><a href='../S/622.html#L2169'>peer</a>             2169 bgpd/bgp_packet.c bgp_capability_msg_parse (struct peer *peer, u_char *pnt, bgp_size_t length)</span>
<span class='curline'><a href='../S/622.html#L2179'>peer</a>             2179 bgpd/bgp_packet.c   bgp = peer-&gt;bgp;</span>
<span class='curline'><a href='../S/622.html#L2187'>peer</a>             2187 bgpd/bgp_packet.c           zlog_info ("%s Capability length error", peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L2188'>peer</a>             2188 bgpd/bgp_packet.c           bgp_notify_send (peer, BGP_NOTIFY_CEASE, 0);</span>
<span class='curline'><a href='../S/622.html#L2199'>peer</a>             2199 bgpd/bgp_packet.c 		     peer-&gt;host, action);</span>
<span class='curline'><a href='../S/622.html#L2200'>peer</a>             2200 bgpd/bgp_packet.c           bgp_notify_send (peer, BGP_NOTIFY_CEASE, 0);</span>
<span class='curline'><a href='../S/622.html#L2206'>peer</a>             2206 bgpd/bgp_packet.c 		   peer-&gt;host, action, hdr-&gt;code, hdr-&gt;length);</span>
<span class='curline'><a href='../S/622.html#L2211'>peer</a>             2211 bgpd/bgp_packet.c           zlog_info ("%s Capability length error", peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L2212'>peer</a>             2212 bgpd/bgp_packet.c           bgp_notify_send (peer, BGP_NOTIFY_CEASE, 0);</span>
<span class='curline'><a href='../S/622.html#L2226'>peer</a>             2226 bgpd/bgp_packet.c           if (CHECK_FLAG (peer-&gt;flags, PEER_FLAG_OVERRIDE_CAPABILITY))</span>
<span class='curline'><a href='../S/622.html#L2233'>peer</a>             2233 bgpd/bgp_packet.c                             "(%u/%u)", peer-&gt;host, afi, safi);</span>
<span class='curline'><a href='../S/622.html#L2240'>peer</a>             2240 bgpd/bgp_packet.c                        peer-&gt;host,</span>
<span class='curline'><a href='../S/622.html#L2247'>peer</a>             2247 bgpd/bgp_packet.c               peer-&gt;afc_recv[afi][safi] = 1;</span>
<span class='curline'><a href='../S/622.html#L2248'>peer</a>             2248 bgpd/bgp_packet.c               if (peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/622.html#L2250'>peer</a>             2250 bgpd/bgp_packet.c                   peer-&gt;afc_nego[afi][safi] = 1;</span>
<span class='curline'><a href='../S/622.html#L2251'>peer</a>             2251 bgpd/bgp_packet.c                   bgp_announce_route (peer, afi, safi);</span>
<span class='curline'><a href='../S/622.html#L2256'>peer</a>             2256 bgpd/bgp_packet.c               peer-&gt;afc_recv[afi][safi] = 0;</span>
<span class='curline'><a href='../S/622.html#L2257'>peer</a>             2257 bgpd/bgp_packet.c               peer-&gt;afc_nego[afi][safi] = 0;</span>
<span class='curline'><a href='../S/622.html#L2259'>peer</a>             2259 bgpd/bgp_packet.c               if (peer_active_nego (peer))</span>
<span class='curline'><a href='../S/622.html#L2260'>peer</a>             2260 bgpd/bgp_packet.c                 bgp_clear_route (peer, afi, safi, BGP_CLEAR_ROUTE_NORMAL);</span>
<span class='curline'><a href='../S/622.html#L2262'>peer</a>             2262 bgpd/bgp_packet.c                 BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/622.html#L2268'>peer</a>             2268 bgpd/bgp_packet.c                      peer-&gt;host, hdr-&gt;code);</span>
<span class='curline'><a href='../S/622.html#L2280'>peer</a>             2280 bgpd/bgp_packet.c bgp_capability_receive (struct peer *peer, bgp_size_t size)</span>
<span class='curline'><a href='../S/622.html#L2285'>peer</a>             2285 bgpd/bgp_packet.c   pnt = stream_pnt (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/622.html#L2288'>peer</a>             2288 bgpd/bgp_packet.c     zlog_debug ("%s rcv CAPABILITY", peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L2291'>peer</a>             2291 bgpd/bgp_packet.c   if (! CHECK_FLAG (peer-&gt;cap, PEER_CAP_DYNAMIC_ADV))</span>
<span class='curline'><a href='../S/622.html#L2293'>peer</a>             2293 bgpd/bgp_packet.c       plog_err (peer-&gt;log, "%s [Error] BGP dynamic capability is not enabled",</span>
<span class='curline'><a href='../S/622.html#L2294'>peer</a>             2294 bgpd/bgp_packet.c 		peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L2295'>peer</a>             2295 bgpd/bgp_packet.c       bgp_notify_send (peer,</span>
<span class='curline'><a href='../S/622.html#L2302'>peer</a>             2302 bgpd/bgp_packet.c   if (peer-&gt;status != Established)</span>
<span class='curline'><a href='../S/622.html#L2304'>peer</a>             2304 bgpd/bgp_packet.c       plog_err (peer-&gt;log,</span>
<span class='curline'><a href='../S/622.html#L2305'>peer</a>             2305 bgpd/bgp_packet.c 		"%s [Error] Dynamic capability packet received under status %s", peer-&gt;host, LOOKUP (bgp_status_msg, peer-&gt;status));</span>
<span class='curline'><a href='../S/622.html#L2306'>peer</a>             2306 bgpd/bgp_packet.c       bgp_notify_send (peer, BGP_NOTIFY_FSM_ERR, 0);</span>
<span class='curline'><a href='../S/622.html#L2311'>peer</a>             2311 bgpd/bgp_packet.c   return bgp_capability_msg_parse (peer, pnt, size);</span>
<span class='curline'><a href='../S/622.html#L2316'>peer</a>             2316 bgpd/bgp_packet.c bgp_read_packet (struct peer *peer)</span>
<span class='curline'><a href='../S/622.html#L2321'>peer</a>             2321 bgpd/bgp_packet.c   readsize = peer-&gt;packet_size - stream_get_endp (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/622.html#L2328'>peer</a>             2328 bgpd/bgp_packet.c   nbytes = stream_read_try (peer-&gt;ibuf, peer-&gt;fd, readsize);</span>
<span class='curline'><a href='../S/622.html#L2337'>peer</a>             2337 bgpd/bgp_packet.c       plog_err (peer-&gt;log, "%s [Error] bgp_read_packet error: %s",</span>
<span class='curline'><a href='../S/622.html#L2338'>peer</a>             2338 bgpd/bgp_packet.c 		 peer-&gt;host, safe_strerror (errno));</span>
<span class='curline'><a href='../S/622.html#L2340'>peer</a>             2340 bgpd/bgp_packet.c       if (peer-&gt;status == Established) </span>
<span class='curline'><a href='../S/622.html#L2342'>peer</a>             2342 bgpd/bgp_packet.c 	  if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_NSF_MODE))</span>
<span class='curline'><a href='../S/622.html#L2344'>peer</a>             2344 bgpd/bgp_packet.c 	      peer-&gt;last_reset = PEER_DOWN_NSF_CLOSE_SESSION;</span>
<span class='curline'><a href='../S/622.html#L2345'>peer</a>             2345 bgpd/bgp_packet.c 	      SET_FLAG (peer-&gt;sflags, PEER_STATUS_NSF_WAIT);</span>
<span class='curline'><a href='../S/622.html#L2348'>peer</a>             2348 bgpd/bgp_packet.c 	    peer-&gt;last_reset = PEER_DOWN_CLOSE_SESSION;</span>
<span class='curline'><a href='../S/622.html#L2351'>peer</a>             2351 bgpd/bgp_packet.c       BGP_EVENT_ADD (peer, TCP_fatal_error);</span>
<span class='curline'><a href='../S/622.html#L2359'>peer</a>             2359 bgpd/bgp_packet.c 	plog_debug (peer-&gt;log, "%s [Event] BGP connection closed fd %d",</span>
<span class='curline'><a href='../S/622.html#L2360'>peer</a>             2360 bgpd/bgp_packet.c 		   peer-&gt;host, peer-&gt;fd);</span>
<span class='curline'><a href='../S/622.html#L2362'>peer</a>             2362 bgpd/bgp_packet.c       if (peer-&gt;status == Established) </span>
<span class='curline'><a href='../S/622.html#L2364'>peer</a>             2364 bgpd/bgp_packet.c 	  if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_NSF_MODE))</span>
<span class='curline'><a href='../S/622.html#L2366'>peer</a>             2366 bgpd/bgp_packet.c 	      peer-&gt;last_reset = PEER_DOWN_NSF_CLOSE_SESSION;</span>
<span class='curline'><a href='../S/622.html#L2367'>peer</a>             2367 bgpd/bgp_packet.c 	      SET_FLAG (peer-&gt;sflags, PEER_STATUS_NSF_WAIT);</span>
<span class='curline'><a href='../S/622.html#L2370'>peer</a>             2370 bgpd/bgp_packet.c 	    peer-&gt;last_reset = PEER_DOWN_CLOSE_SESSION;</span>
<span class='curline'><a href='../S/622.html#L2373'>peer</a>             2373 bgpd/bgp_packet.c       BGP_EVENT_ADD (peer, TCP_connection_closed);</span>
<span class='curline'><a href='../S/622.html#L2378'>peer</a>             2378 bgpd/bgp_packet.c   if (stream_get_endp (peer-&gt;ibuf) != peer-&gt;packet_size)</span>
<span class='curline'><a href='../S/622.html#L2412'>peer</a>             2412 bgpd/bgp_packet.c   struct peer *peer;</span>
<span class='curline'><a href='../S/622.html#L2417'>peer</a>             2417 bgpd/bgp_packet.c   peer = THREAD_ARG (thread);</span>
<span class='curline'><a href='../S/622.html#L2418'>peer</a>             2418 bgpd/bgp_packet.c   peer-&gt;t_read = NULL;</span>
<span class='curline'><a href='../S/622.html#L2421'>peer</a>             2421 bgpd/bgp_packet.c   if (peer-&gt;status == Connect)</span>
<span class='curline'><a href='../S/622.html#L2423'>peer</a>             2423 bgpd/bgp_packet.c       bgp_connect_check (peer);</span>
<span class='curline'><a href='../S/622.html#L2428'>peer</a>             2428 bgpd/bgp_packet.c       if (peer-&gt;fd &lt; 0)</span>
<span class='curline'><a href='../S/622.html#L2430'>peer</a>             2430 bgpd/bgp_packet.c 	  zlog_err ("bgp_read peer's fd is negative value %d", peer-&gt;fd);</span>
<span class='curline'><a href='../S/622.html#L2433'>peer</a>             2433 bgpd/bgp_packet.c       BGP_READ_ON (peer-&gt;t_read, bgp_read, peer-&gt;fd);</span>
<span class='curline'><a href='../S/622.html#L2437'>peer</a>             2437 bgpd/bgp_packet.c   if (peer-&gt;packet_size == 0)</span>
<span class='curline'><a href='../S/622.html#L2438'>peer</a>             2438 bgpd/bgp_packet.c     peer-&gt;packet_size = BGP_HEADER_SIZE;</span>
<span class='curline'><a href='../S/622.html#L2440'>peer</a>             2440 bgpd/bgp_packet.c   if (stream_get_endp (peer-&gt;ibuf) &lt; BGP_HEADER_SIZE)</span>
<span class='curline'><a href='../S/622.html#L2442'>peer</a>             2442 bgpd/bgp_packet.c       ret = bgp_read_packet (peer);</span>
<span class='curline'><a href='../S/622.html#L2449'>peer</a>             2449 bgpd/bgp_packet.c       stream_forward_getp (peer-&gt;ibuf, BGP_MARKER_SIZE);</span>
<span class='curline'><a href='../S/622.html#L2450'>peer</a>             2450 bgpd/bgp_packet.c       memcpy (notify_data_length, stream_pnt (peer-&gt;ibuf), 2);</span>
<span class='curline'><a href='../S/622.html#L2451'>peer</a>             2451 bgpd/bgp_packet.c       size = stream_getw (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/622.html#L2452'>peer</a>             2452 bgpd/bgp_packet.c       type = stream_getc (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/622.html#L2456'>peer</a>             2456 bgpd/bgp_packet.c 		   peer-&gt;host, type, size - BGP_HEADER_SIZE);</span>
<span class='curline'><a href='../S/622.html#L2460'>peer</a>             2460 bgpd/bgp_packet.c 	  &amp;&amp; ! bgp_marker_all_one (peer-&gt;ibuf, BGP_MARKER_SIZE))</span>
<span class='curline'><a href='../S/622.html#L2462'>peer</a>             2462 bgpd/bgp_packet.c 	  bgp_notify_send (peer,</span>
<span class='curline'><a href='../S/622.html#L2476'>peer</a>             2476 bgpd/bgp_packet.c 	    plog_debug (peer-&gt;log,</span>
<span class='curline'><a href='../S/622.html#L2478'>peer</a>             2478 bgpd/bgp_packet.c 		      peer-&gt;host, type);</span>
<span class='curline'><a href='../S/622.html#L2479'>peer</a>             2479 bgpd/bgp_packet.c 	  bgp_notify_send_with_data (peer,</span>
<span class='curline'><a href='../S/622.html#L2497'>peer</a>             2497 bgpd/bgp_packet.c 	    plog_debug (peer-&gt;log,</span>
<span class='curline'><a href='../S/622.html#L2499'>peer</a>             2499 bgpd/bgp_packet.c 		      peer-&gt;host, size, </span>
<span class='curline'><a href='../S/622.html#L2502'>peer</a>             2502 bgpd/bgp_packet.c 	  bgp_notify_send_with_data (peer,</span>
<span class='curline'><a href='../S/622.html#L2510'>peer</a>             2510 bgpd/bgp_packet.c       peer-&gt;packet_size = size;</span>
<span class='curline'><a href='../S/622.html#L2513'>peer</a>             2513 bgpd/bgp_packet.c   ret = bgp_read_packet (peer);</span>
<span class='curline'><a href='../S/622.html#L2518'>peer</a>             2518 bgpd/bgp_packet.c   size = stream_getw_from (peer-&gt;ibuf, BGP_MARKER_SIZE);</span>
<span class='curline'><a href='../S/622.html#L2519'>peer</a>             2519 bgpd/bgp_packet.c   type = stream_getc_from (peer-&gt;ibuf, BGP_MARKER_SIZE + 2);</span>
<span class='curline'><a href='../S/622.html#L2522'>peer</a>             2522 bgpd/bgp_packet.c   bgp_dump_packet (peer, type, peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/622.html#L2524'>peer</a>             2524 bgpd/bgp_packet.c   size = (peer-&gt;packet_size - BGP_HEADER_SIZE);</span>
<span class='curline'><a href='../S/622.html#L2530'>peer</a>             2530 bgpd/bgp_packet.c       peer-&gt;open_in++;</span>
<span class='curline'><a href='../S/622.html#L2531'>peer</a>             2531 bgpd/bgp_packet.c       bgp_open_receive (peer, size); /* XXX return value ignored! */</span>
<span class='curline'><a href='../S/622.html#L2534'>peer</a>             2534 bgpd/bgp_packet.c       peer-&gt;readtime = bgp_recent_clock ();</span>
<span class='curline'><a href='../S/622.html#L2535'>peer</a>             2535 bgpd/bgp_packet.c       bgp_update_receive (peer, size);</span>
<span class='curline'><a href='../S/622.html#L2538'>peer</a>             2538 bgpd/bgp_packet.c       bgp_notify_receive (peer, size);</span>
<span class='curline'><a href='../S/622.html#L2541'>peer</a>             2541 bgpd/bgp_packet.c       peer-&gt;readtime = bgp_recent_clock ();</span>
<span class='curline'><a href='../S/622.html#L2542'>peer</a>             2542 bgpd/bgp_packet.c       bgp_keepalive_receive (peer, size);</span>
<span class='curline'><a href='../S/622.html#L2546'>peer</a>             2546 bgpd/bgp_packet.c       peer-&gt;refresh_in++;</span>
<span class='curline'><a href='../S/622.html#L2547'>peer</a>             2547 bgpd/bgp_packet.c       bgp_route_refresh_receive (peer, size);</span>
<span class='curline'><a href='../S/622.html#L2550'>peer</a>             2550 bgpd/bgp_packet.c       peer-&gt;dynamic_cap_in++;</span>
<span class='curline'><a href='../S/622.html#L2551'>peer</a>             2551 bgpd/bgp_packet.c       bgp_capability_receive (peer, size);</span>
<span class='curline'><a href='../S/622.html#L2556'>peer</a>             2556 bgpd/bgp_packet.c   peer-&gt;packet_size = 0;</span>
<span class='curline'><a href='../S/622.html#L2557'>peer</a>             2557 bgpd/bgp_packet.c   if (peer-&gt;ibuf)</span>
<span class='curline'><a href='../S/622.html#L2558'>peer</a>             2558 bgpd/bgp_packet.c     stream_reset (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/622.html#L2561'>peer</a>             2561 bgpd/bgp_packet.c   if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_ACCEPT_PEER))</span>
<span class='curline'><a href='../S/622.html#L2564'>peer</a>             2564 bgpd/bgp_packet.c 	zlog_debug ("%s [Event] Accepting BGP peer delete", peer-&gt;host);</span>
<span class='curline'><a href='../S/622.html#L2565'>peer</a>             2565 bgpd/bgp_packet.c       peer_delete (peer);</span>
<span class='curline'><a href='../S/634.html#L44'>peer</a>               44 bgpd/bgp_packet.h extern void bgp_keepalive_send (struct peer *);</span>
<span class='curline'><a href='../S/634.html#L45'>peer</a>               45 bgpd/bgp_packet.h extern void bgp_open_send (struct peer *);</span>
<span class='curline'><a href='../S/634.html#L46'>peer</a>               46 bgpd/bgp_packet.h extern void bgp_notify_send (struct peer *, u_int8_t, u_int8_t);</span>
<span class='curline'><a href='../S/634.html#L47'>peer</a>               47 bgpd/bgp_packet.h extern void bgp_notify_send_with_data (struct peer *, u_int8_t, u_int8_t, </span>
<span class='curline'><a href='../S/634.html#L49'>peer</a>               49 bgpd/bgp_packet.h extern void bgp_route_refresh_send (struct peer *, afi_t, safi_t, u_char, u_char, int);</span>
<span class='curline'><a href='../S/634.html#L50'>peer</a>               50 bgpd/bgp_packet.h extern void bgp_capability_send (struct peer *, afi_t, safi_t, int, int);</span>
<span class='curline'><a href='../S/634.html#L51'>peer</a>               51 bgpd/bgp_packet.h extern void bgp_default_update_send (struct peer *, struct attr *,</span>
<span class='curline'><a href='../S/634.html#L52'>peer</a>               52 bgpd/bgp_packet.h 			      afi_t, safi_t, struct peer *);</span>
<span class='curline'><a href='../S/634.html#L53'>peer</a>               53 bgpd/bgp_packet.h extern void bgp_default_withdraw_send (struct peer *, afi_t, safi_t);</span>
<span class='curline'><a href='../S/634.html#L55'>peer</a>               55 bgpd/bgp_packet.h extern int bgp_capability_receive (struct peer *, bgp_size_t);</span>
<span class='curline'><a href='../S/620.html#L146'>peer</a>              146 bgpd/bgp_route.c   peer_unlock (binfo-&gt;peer); /* bgp_info peer reference */</span>
<span class='curline'><a href='../S/620.html#L200'>peer</a>              200 bgpd/bgp_route.c   peer_lock (ri-&gt;peer); /* bgp_info peer reference */</span>
<span class='curline'><a href='../S/620.html#L246'>peer</a>              246 bgpd/bgp_route.c   assert (ri &amp;&amp; ri-&gt;peer &amp;&amp; ri-&gt;peer-&gt;bgp);</span>
<span class='curline'><a href='../S/620.html#L252'>peer</a>              252 bgpd/bgp_route.c       || ri-&gt;peer == ri-&gt;peer-&gt;bgp-&gt;peer_self)</span>
<span class='curline'><a href='../S/620.html#L262'>peer</a>              262 bgpd/bgp_route.c       if (ri-&gt;peer-&gt;pcount[table-&gt;afi][table-&gt;safi])</span>
<span class='curline'><a href='../S/620.html#L263'>peer</a>              263 bgpd/bgp_route.c         ri-&gt;peer-&gt;pcount[table-&gt;afi][table-&gt;safi]--;</span>
<span class='curline'><a href='../S/620.html#L267'>peer</a>              267 bgpd/bgp_route.c                      __func__, ri-&gt;peer-&gt;host);</span>
<span class='curline'><a href='../S/620.html#L276'>peer</a>              276 bgpd/bgp_route.c       ri-&gt;peer-&gt;pcount[table-&gt;afi][table-&gt;safi]++;</span>
<span class='curline'><a href='../S/620.html#L457'>peer</a>              457 bgpd/bgp_route.c   new_sort = new-&gt;peer-&gt;sort;</span>
<span class='curline'><a href='../S/620.html#L458'>peer</a>              458 bgpd/bgp_route.c   exist_sort = exist-&gt;peer-&gt;sort;</span>
<span class='curline'><a href='../S/620.html#L483'>peer</a>              483 bgpd/bgp_route.c       if (new-&gt;peer-&gt;sort == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/620.html#L488'>peer</a>              488 bgpd/bgp_route.c       else if (new-&gt;peer-&gt;as == exist-&gt;peer-&gt;as)</span>
<span class='curline'><a href='../S/620.html#L518'>peer</a>              518 bgpd/bgp_route.c     new_id.s_addr = new-&gt;peer-&gt;remote_id.s_addr;</span>
<span class='curline'><a href='../S/620.html#L522'>peer</a>              522 bgpd/bgp_route.c     exist_id.s_addr = exist-&gt;peer-&gt;remote_id.s_addr;</span>
<span class='curline'><a href='../S/620.html#L543'>peer</a>              543 bgpd/bgp_route.c   ret = sockunion_cmp (new-&gt;peer-&gt;su_remote, exist-&gt;peer-&gt;su_remote);</span>
<span class='curline'><a href='../S/620.html#L554'>peer</a>              554 bgpd/bgp_route.c bgp_input_filter (struct peer *peer, struct prefix *p, struct attr *attr,</span>
<span class='curline'><a href='../S/620.html#L559'>peer</a>              559 bgpd/bgp_route.c   filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/620.html#L564'>peer</a>              564 bgpd/bgp_route.c     plog_warn (peer-&gt;log, "%s: Could not find configured input %s-list %s!", \</span>
<span class='curline'><a href='../S/620.html#L565'>peer</a>              565 bgpd/bgp_route.c                peer-&gt;host, #f, F ## _IN_NAME(filter));</span>
<span class='curline'><a href='../S/620.html#L593'>peer</a>              593 bgpd/bgp_route.c bgp_output_filter (struct peer *peer, struct prefix *p, struct attr *attr,</span>
<span class='curline'><a href='../S/620.html#L598'>peer</a>              598 bgpd/bgp_route.c   filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/620.html#L603'>peer</a>              603 bgpd/bgp_route.c     plog_warn (peer-&gt;log, "%s: Could not find configured output %s-list %s!", \</span>
<span class='curline'><a href='../S/620.html#L604'>peer</a>              604 bgpd/bgp_route.c                peer-&gt;host, #f, F ## _OUT_NAME(filter));</span>
<span class='curline'><a href='../S/620.html#L633'>peer</a>              633 bgpd/bgp_route.c bgp_community_filter (struct peer *peer, struct attr *attr)</span>
<span class='curline'><a href='../S/620.html#L642'>peer</a>              642 bgpd/bgp_route.c       if (peer-&gt;sort == BGP_PEER_EBGP &amp;&amp;</span>
<span class='curline'><a href='../S/620.html#L647'>peer</a>              647 bgpd/bgp_route.c       if (peer-&gt;sort == BGP_PEER_EBGP</span>
<span class='curline'><a href='../S/620.html#L648'>peer</a>              648 bgpd/bgp_route.c 	  || peer-&gt;sort == BGP_PEER_CONFED)</span>
<span class='curline'><a href='../S/620.html#L657'>peer</a>              657 bgpd/bgp_route.c bgp_cluster_filter (struct peer *peer, struct attr *attr)</span>
<span class='curline'><a href='../S/620.html#L663'>peer</a>              663 bgpd/bgp_route.c       if (peer-&gt;bgp-&gt;config &amp; BGP_CONFIG_CLUSTER_ID)</span>
<span class='curline'><a href='../S/620.html#L664'>peer</a>              664 bgpd/bgp_route.c 	cluster_id = peer-&gt;bgp-&gt;cluster_id;</span>
<span class='curline'><a href='../S/620.html#L666'>peer</a>              666 bgpd/bgp_route.c 	cluster_id = peer-&gt;bgp-&gt;router_id;</span>
<span class='curline'><a href='../S/620.html#L675'>peer</a>              675 bgpd/bgp_route.c bgp_input_modifier (struct peer *peer, struct prefix *p, struct attr *attr,</span>
<span class='curline'><a href='../S/620.html#L682'>peer</a>              682 bgpd/bgp_route.c   filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/620.html#L685'>peer</a>              685 bgpd/bgp_route.c   if (peer-&gt;weight)</span>
<span class='curline'><a href='../S/620.html#L686'>peer</a>              686 bgpd/bgp_route.c     (bgp_attr_extra_get (attr))-&gt;weight = peer-&gt;weight;</span>
<span class='curline'><a href='../S/620.html#L692'>peer</a>              692 bgpd/bgp_route.c       info.peer = peer;</span>
<span class='curline'><a href='../S/620.html#L695'>peer</a>              695 bgpd/bgp_route.c       SET_FLAG (peer-&gt;rmap_type, PEER_RMAP_TYPE_IN); </span>
<span class='curline'><a href='../S/620.html#L700'>peer</a>              700 bgpd/bgp_route.c       peer-&gt;rmap_type = 0;</span>
<span class='curline'><a href='../S/620.html#L713'>peer</a>              713 bgpd/bgp_route.c bgp_export_modifier (struct peer *rsclient, struct peer *peer,</span>
<span class='curline'><a href='../S/620.html#L720'>peer</a>              720 bgpd/bgp_route.c   filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/620.html#L726'>peer</a>              726 bgpd/bgp_route.c       info.peer = rsclient;</span>
<span class='curline'><a href='../S/620.html#L747'>peer</a>              747 bgpd/bgp_route.c bgp_import_modifier (struct peer *rsclient, struct peer *peer,</span>
<span class='curline'><a href='../S/620.html#L757'>peer</a>              757 bgpd/bgp_route.c   if (peer-&gt;weight)</span>
<span class='curline'><a href='../S/620.html#L758'>peer</a>              758 bgpd/bgp_route.c     (bgp_attr_extra_get (attr))-&gt;weight = peer-&gt;weight;</span>
<span class='curline'><a href='../S/620.html#L764'>peer</a>              764 bgpd/bgp_route.c       info.peer = peer;</span>
<span class='curline'><a href='../S/620.html#L767'>peer</a>              767 bgpd/bgp_route.c       SET_FLAG (peer-&gt;rmap_type, PEER_RMAP_TYPE_IMPORT);</span>
<span class='curline'><a href='../S/620.html#L772'>peer</a>              772 bgpd/bgp_route.c       peer-&gt;rmap_type = 0;</span>
<span class='curline'><a href='../S/620.html#L785'>peer</a>              785 bgpd/bgp_route.c bgp_announce_check (struct bgp_info *ri, struct peer *peer, struct prefix *p,</span>
<span class='curline'><a href='../S/620.html#L791'>peer</a>              791 bgpd/bgp_route.c   struct peer *from;</span>
<span class='curline'><a href='../S/620.html#L797'>peer</a>              797 bgpd/bgp_route.c   from = ri-&gt;peer;</span>
<span class='curline'><a href='../S/620.html#L798'>peer</a>              798 bgpd/bgp_route.c   filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/620.html#L799'>peer</a>              799 bgpd/bgp_route.c   bgp = peer-&gt;bgp;</span>
<span class='curline'><a href='../S/620.html#L806'>peer</a>              806 bgpd/bgp_route.c   if (CHECK_FLAG(peer-&gt;af_flags[afi][safi], PEER_FLAG_RSERVER_CLIENT))</span>
<span class='curline'><a href='../S/620.html#L810'>peer</a>              810 bgpd/bgp_route.c   if (from == peer)</span>
<span class='curline'><a href='../S/620.html#L815'>peer</a>              815 bgpd/bgp_route.c       &amp;&amp; IPV4_ADDR_SAME(&amp;peer-&gt;remote_id, &amp;riattr-&gt;nexthop))</span>
<span class='curline'><a href='../S/620.html#L819'>peer</a>              819 bgpd/bgp_route.c      &amp;&amp; IPV6_ADDR_SAME(&amp;peer-&gt;remote_id, &amp;riattr-&gt;nexthop))</span>
<span class='curline'><a href='../S/620.html#L829'>peer</a>              829 bgpd/bgp_route.c   if (CHECK_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_DEFAULT_ORIGINATE))</span>
<span class='curline'><a href='../S/620.html#L840'>peer</a>              840 bgpd/bgp_route.c   if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_RSERVER_CLIENT)</span>
<span class='curline'><a href='../S/620.html#L847'>peer</a>              847 bgpd/bgp_route.c   if (! transparent &amp;&amp; bgp_community_filter (peer, riattr))</span>
<span class='curline'><a href='../S/620.html#L854'>peer</a>              854 bgpd/bgp_route.c       if (IPV4_ADDR_SAME (&amp;peer-&gt;remote_id, &amp;riattr-&gt;extra-&gt;originator_id))</span>
<span class='curline'><a href='../S/620.html#L857'>peer</a>              857 bgpd/bgp_route.c 	    zlog (peer-&gt;log, LOG_DEBUG,</span>
<span class='curline'><a href='../S/620.html#L859'>peer</a>              859 bgpd/bgp_route.c 		  peer-&gt;host,</span>
<span class='curline'><a href='../S/620.html#L867'>peer</a>              867 bgpd/bgp_route.c   if (CHECK_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_ORF_PREFIX_RM_ADV)</span>
<span class='curline'><a href='../S/620.html#L868'>peer</a>              868 bgpd/bgp_route.c       &amp;&amp; (CHECK_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_ORF_PREFIX_SM_RCV)</span>
<span class='curline'><a href='../S/620.html#L869'>peer</a>              869 bgpd/bgp_route.c 	  || CHECK_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_ORF_PREFIX_SM_OLD_RCV)))</span>
<span class='curline'><a href='../S/620.html#L870'>peer</a>              870 bgpd/bgp_route.c     if (peer-&gt;orf_plist[afi][safi])</span>
<span class='curline'><a href='../S/620.html#L872'>peer</a>              872 bgpd/bgp_route.c 	if (prefix_list_apply (peer-&gt;orf_plist[afi][safi], p) == PREFIX_DENY)</span>
<span class='curline'><a href='../S/620.html#L877'>peer</a>              877 bgpd/bgp_route.c   if (bgp_output_filter (peer, p, riattr, afi, safi) == FILTER_DENY)</span>
<span class='curline'><a href='../S/620.html#L880'>peer</a>              880 bgpd/bgp_route.c 	zlog (peer-&gt;log, LOG_DEBUG,</span>
<span class='curline'><a href='../S/620.html#L882'>peer</a>              882 bgpd/bgp_route.c 	      peer-&gt;host,</span>
<span class='curline'><a href='../S/620.html#L890'>peer</a>              890 bgpd/bgp_route.c   if (aspath_loop_check (riattr-&gt;aspath, peer-&gt;as))</span>
<span class='curline'><a href='../S/620.html#L893'>peer</a>              893 bgpd/bgp_route.c         zlog (peer-&gt;log, LOG_DEBUG, </span>
<span class='curline'><a href='../S/620.html#L895'>peer</a>              895 bgpd/bgp_route.c 	      peer-&gt;host, peer-&gt;as);</span>
<span class='curline'><a href='../S/620.html#L906'>peer</a>              906 bgpd/bgp_route.c 	    zlog (peer-&gt;log, LOG_DEBUG, </span>
<span class='curline'><a href='../S/620.html#L908'>peer</a>              908 bgpd/bgp_route.c 		  peer-&gt;host,</span>
<span class='curline'><a href='../S/620.html#L915'>peer</a>              915 bgpd/bgp_route.c   if (from-&gt;sort == BGP_PEER_IBGP &amp;&amp; peer-&gt;sort == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/620.html#L931'>peer</a>              931 bgpd/bgp_route.c 	    if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_REFLECTOR_CLIENT))</span>
<span class='curline'><a href='../S/620.html#L938'>peer</a>              938 bgpd/bgp_route.c 	  if (! CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_REFLECTOR_CLIENT))</span>
<span class='curline'><a href='../S/620.html#L947'>peer</a>              947 bgpd/bgp_route.c   if ((peer-&gt;sort == BGP_PEER_IBGP</span>
<span class='curline'><a href='../S/620.html#L948'>peer</a>              948 bgpd/bgp_route.c        || peer-&gt;sort == BGP_PEER_CONFED)</span>
<span class='curline'><a href='../S/620.html#L956'>peer</a>              956 bgpd/bgp_route.c   if (peer-&gt;sort == BGP_PEER_EBGP</span>
<span class='curline'><a href='../S/620.html#L959'>peer</a>              959 bgpd/bgp_route.c       if (ri-&gt;peer != bgp-&gt;peer_self &amp;&amp; ! transparent</span>
<span class='curline'><a href='../S/620.html#L960'>peer</a>              960 bgpd/bgp_route.c 	  &amp;&amp; ! CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MED_UNCHANGED))</span>
<span class='curline'><a href='../S/620.html#L966'>peer</a>              966 bgpd/bgp_route.c       || (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_NEXTHOP_UNCHANGED)</span>
<span class='curline'><a href='../S/620.html#L976'>peer</a>              976 bgpd/bgp_route.c   else if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_NEXTHOP_SELF)</span>
<span class='curline'><a href='../S/620.html#L982'>peer</a>              982 bgpd/bgp_route.c 	   || (peer-&gt;sort == BGP_PEER_EBGP</span>
<span class='curline'><a href='../S/620.html#L983'>peer</a>              983 bgpd/bgp_route.c 	       &amp;&amp; bgp_multiaccess_check_v4 (attr-&gt;nexthop, peer-&gt;host) == 0))</span>
<span class='curline'><a href='../S/620.html#L989'>peer</a>              989 bgpd/bgp_route.c 	    memcpy (&amp;attr-&gt;extra-&gt;mp_nexthop_global_in, &amp;peer-&gt;nexthop.v4,</span>
<span class='curline'><a href='../S/620.html#L992'>peer</a>              992 bgpd/bgp_route.c 	    memcpy (&amp;attr-&gt;nexthop, &amp;peer-&gt;nexthop.v4, IPV4_MAX_BYTELEN);</span>
<span class='curline'><a href='../S/620.html#L999'>peer</a>              999 bgpd/bgp_route.c 	  memcpy (&amp;attr-&gt;extra-&gt;mp_nexthop_global, &amp;peer-&gt;nexthop.v6_global, </span>
<span class='curline'><a href='../S/620.html#L1010'>peer</a>             1010 bgpd/bgp_route.c       if ( CHECK_FLAG (peer-&gt;af_flags[afi][safi], </span>
<span class='curline'><a href='../S/620.html#L1026'>peer</a>             1026 bgpd/bgp_route.c       if (peer-&gt;shared_network </span>
<span class='curline'><a href='../S/620.html#L1027'>peer</a>             1027 bgpd/bgp_route.c 	  &amp;&amp; ! IN6_IS_ADDR_UNSPECIFIED (&amp;peer-&gt;nexthop.v6_local))</span>
<span class='curline'><a href='../S/620.html#L1029'>peer</a>             1029 bgpd/bgp_route.c 	  memcpy (&amp;attr-&gt;extra-&gt;mp_nexthop_local, &amp;peer-&gt;nexthop.v6_local, </span>
<span class='curline'><a href='../S/620.html#L1040'>peer</a>             1040 bgpd/bgp_route.c       if (! IN6_IS_ADDR_LINKLOCAL (&amp;peer-&gt;nexthop.v6_local))</span>
<span class='curline'><a href='../S/620.html#L1048'>peer</a>             1048 bgpd/bgp_route.c   if (peer-&gt;sort == BGP_PEER_EBGP</span>
<span class='curline'><a href='../S/620.html#L1049'>peer</a>             1049 bgpd/bgp_route.c       &amp;&amp; peer_af_flag_check (peer, afi, safi, PEER_FLAG_REMOVE_PRIVATE_AS)</span>
<span class='curline'><a href='../S/620.html#L1063'>peer</a>             1063 bgpd/bgp_route.c       info.peer = peer;</span>
<span class='curline'><a href='../S/620.html#L1069'>peer</a>             1069 bgpd/bgp_route.c 	  &amp;&amp; peer-&gt;sort == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/620.html#L1075'>peer</a>             1075 bgpd/bgp_route.c       SET_FLAG (peer-&gt;rmap_type, PEER_RMAP_TYPE_OUT); </span>
<span class='curline'><a href='../S/620.html#L1082'>peer</a>             1082 bgpd/bgp_route.c       peer-&gt;rmap_type = 0;</span>
<span class='curline'><a href='../S/620.html#L1094'>peer</a>             1094 bgpd/bgp_route.c bgp_announce_check_rsclient (struct bgp_info *ri, struct peer *rsclient,</span>
<span class='curline'><a href='../S/620.html#L1101'>peer</a>             1101 bgpd/bgp_route.c   struct peer *from;</span>
<span class='curline'><a href='../S/620.html#L1104'>peer</a>             1104 bgpd/bgp_route.c   from = ri-&gt;peer;</span>
<span class='curline'><a href='../S/620.html#L1269'>peer</a>             1269 bgpd/bgp_route.c       info.peer = rsclient;</span>
<span class='curline'><a href='../S/620.html#L1430'>peer</a>             1430 bgpd/bgp_route.c bgp_process_announce_selected (struct peer *peer, struct bgp_info *selected,</span>
<span class='curline'><a href='../S/620.html#L1440'>peer</a>             1440 bgpd/bgp_route.c   if (peer-&gt;status != Established)</span>
<span class='curline'><a href='../S/620.html#L1444'>peer</a>             1444 bgpd/bgp_route.c   if (! peer-&gt;afc_nego[afi][safi])</span>
<span class='curline'><a href='../S/620.html#L1448'>peer</a>             1448 bgpd/bgp_route.c   if (CHECK_FLAG (peer-&gt;af_sflags[afi][safi],</span>
<span class='curline'><a href='../S/620.html#L1460'>peer</a>             1460 bgpd/bgp_route.c         if (selected &amp;&amp; bgp_announce_check (selected, peer, p, &amp;attr, afi, safi))</span>
<span class='curline'><a href='../S/620.html#L1461'>peer</a>             1461 bgpd/bgp_route.c           bgp_adj_out_set (rn, peer, p, &amp;attr, afi, safi, selected);</span>
<span class='curline'><a href='../S/620.html#L1463'>peer</a>             1463 bgpd/bgp_route.c           bgp_adj_out_unset (rn, peer, p, afi, safi);</span>
<span class='curline'><a href='../S/620.html#L1469'>peer</a>             1469 bgpd/bgp_route.c             bgp_announce_check_rsclient (selected, peer, p, &amp;attr, afi, safi))</span>
<span class='curline'><a href='../S/620.html#L1470'>peer</a>             1470 bgpd/bgp_route.c           bgp_adj_out_set (rn, peer, p, &amp;attr, afi, safi, selected);</span>
<span class='curline'><a href='../S/620.html#L1472'>peer</a>             1472 bgpd/bgp_route.c 	  bgp_adj_out_unset (rn, peer, p, afi, safi);</span>
<span class='curline'><a href='../S/620.html#L1499'>peer</a>             1499 bgpd/bgp_route.c   struct peer *rsclient = bgp_node_table (rn)-&gt;owner;</span>
<span class='curline'><a href='../S/620.html#L1509'>peer</a>             1509 bgpd/bgp_route.c         for (ALL_LIST_ELEMENTS (rsclient-&gt;group-&gt;peer, node, nnode, rsclient))</span>
<span class='curline'><a href='../S/620.html#L1562'>peer</a>             1562 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L1595'>peer</a>             1595 bgpd/bgp_route.c   for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/620.html#L1597'>peer</a>             1597 bgpd/bgp_route.c       bgp_process_announce_selected (peer, new_select, rn, afi, safi);</span>
<span class='curline'><a href='../S/620.html#L1705'>peer</a>             1705 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L1707'>peer</a>             1707 bgpd/bgp_route.c   peer = THREAD_ARG (thread);</span>
<span class='curline'><a href='../S/620.html#L1708'>peer</a>             1708 bgpd/bgp_route.c   peer-&gt;t_pmax_restart = NULL;</span>
<span class='curline'><a href='../S/620.html#L1712'>peer</a>             1712 bgpd/bgp_route.c 		peer-&gt;host);</span>
<span class='curline'><a href='../S/620.html#L1714'>peer</a>             1714 bgpd/bgp_route.c   peer_clear (peer);</span>
<span class='curline'><a href='../S/620.html#L1720'>peer</a>             1720 bgpd/bgp_route.c bgp_maximum_prefix_overflow (struct peer *peer, afi_t afi, </span>
<span class='curline'><a href='../S/620.html#L1723'>peer</a>             1723 bgpd/bgp_route.c   if (!CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MAX_PREFIX))</span>
<span class='curline'><a href='../S/620.html#L1726'>peer</a>             1726 bgpd/bgp_route.c   if (peer-&gt;pcount[afi][safi] &gt; peer-&gt;pmax[afi][safi])</span>
<span class='curline'><a href='../S/620.html#L1728'>peer</a>             1728 bgpd/bgp_route.c       if (CHECK_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_PREFIX_LIMIT)</span>
<span class='curline'><a href='../S/620.html#L1732'>peer</a>             1732 bgpd/bgp_route.c       zlog (peer-&gt;log, LOG_INFO,</span>
<span class='curline'><a href='../S/620.html#L1734'>peer</a>             1734 bgpd/bgp_route.c 	    "limit %ld", afi_safi_print (afi, safi), peer-&gt;host,</span>
<span class='curline'><a href='../S/620.html#L1735'>peer</a>             1735 bgpd/bgp_route.c 	    peer-&gt;pcount[afi][safi], peer-&gt;pmax[afi][safi]);</span>
<span class='curline'><a href='../S/620.html#L1736'>peer</a>             1736 bgpd/bgp_route.c       SET_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_PREFIX_LIMIT);</span>
<span class='curline'><a href='../S/620.html#L1738'>peer</a>             1738 bgpd/bgp_route.c       if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MAX_PREFIX_WARNING))</span>
<span class='curline'><a href='../S/620.html#L1750'>peer</a>             1750 bgpd/bgp_route.c        ndata[3] = (peer-&gt;pmax[afi][safi] &gt;&gt; 24);</span>
<span class='curline'><a href='../S/620.html#L1751'>peer</a>             1751 bgpd/bgp_route.c        ndata[4] = (peer-&gt;pmax[afi][safi] &gt;&gt; 16);</span>
<span class='curline'><a href='../S/620.html#L1752'>peer</a>             1752 bgpd/bgp_route.c        ndata[5] = (peer-&gt;pmax[afi][safi] &gt;&gt; 8);</span>
<span class='curline'><a href='../S/620.html#L1753'>peer</a>             1753 bgpd/bgp_route.c        ndata[6] = (peer-&gt;pmax[afi][safi]);</span>
<span class='curline'><a href='../S/620.html#L1755'>peer</a>             1755 bgpd/bgp_route.c        SET_FLAG (peer-&gt;sflags, PEER_STATUS_PREFIX_OVERFLOW);</span>
<span class='curline'><a href='../S/620.html#L1756'>peer</a>             1756 bgpd/bgp_route.c        bgp_notify_send_with_data (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/620.html#L1761'>peer</a>             1761 bgpd/bgp_route.c       if (peer-&gt;pmax_restart[afi][safi])</span>
<span class='curline'><a href='../S/620.html#L1763'>peer</a>             1763 bgpd/bgp_route.c 	  peer-&gt;v_pmax_restart = peer-&gt;pmax_restart[afi][safi] * 60;</span>
<span class='curline'><a href='../S/620.html#L1767'>peer</a>             1767 bgpd/bgp_route.c 			peer-&gt;host, peer-&gt;v_pmax_restart);</span>
<span class='curline'><a href='../S/620.html#L1769'>peer</a>             1769 bgpd/bgp_route.c 	  BGP_TIMER_ON (peer-&gt;t_pmax_restart, bgp_maximum_prefix_restart_timer,</span>
<span class='curline'><a href='../S/620.html#L1770'>peer</a>             1770 bgpd/bgp_route.c 			peer-&gt;v_pmax_restart);</span>
<span class='curline'><a href='../S/620.html#L1776'>peer</a>             1776 bgpd/bgp_route.c     UNSET_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_PREFIX_LIMIT);</span>
<span class='curline'><a href='../S/620.html#L1778'>peer</a>             1778 bgpd/bgp_route.c   if (peer-&gt;pcount[afi][safi] &gt; (peer-&gt;pmax[afi][safi] * peer-&gt;pmax_threshold[afi][safi] / 100))</span>
<span class='curline'><a href='../S/620.html#L1780'>peer</a>             1780 bgpd/bgp_route.c       if (CHECK_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_PREFIX_THRESHOLD)</span>
<span class='curline'><a href='../S/620.html#L1784'>peer</a>             1784 bgpd/bgp_route.c       zlog (peer-&gt;log, LOG_INFO,</span>
<span class='curline'><a href='../S/620.html#L1786'>peer</a>             1786 bgpd/bgp_route.c 	    afi_safi_print (afi, safi), peer-&gt;host, peer-&gt;pcount[afi][safi],</span>
<span class='curline'><a href='../S/620.html#L1787'>peer</a>             1787 bgpd/bgp_route.c 	    peer-&gt;pmax[afi][safi]);</span>
<span class='curline'><a href='../S/620.html#L1788'>peer</a>             1788 bgpd/bgp_route.c       SET_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_PREFIX_THRESHOLD);</span>
<span class='curline'><a href='../S/620.html#L1791'>peer</a>             1791 bgpd/bgp_route.c     UNSET_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_PREFIX_THRESHOLD);</span>
<span class='curline'><a href='../S/620.html#L1799'>peer</a>             1799 bgpd/bgp_route.c bgp_rib_remove (struct bgp_node *rn, struct bgp_info *ri, struct peer *peer,</span>
<span class='curline'><a href='../S/620.html#L1802'>peer</a>             1802 bgpd/bgp_route.c   bgp_aggregate_decrement (peer-&gt;bgp, &amp;rn-&gt;p, ri, afi, safi);</span>
<span class='curline'><a href='../S/620.html#L1807'>peer</a>             1807 bgpd/bgp_route.c   bgp_process (peer-&gt;bgp, rn, afi, safi);</span>
<span class='curline'><a href='../S/620.html#L1811'>peer</a>             1811 bgpd/bgp_route.c bgp_rib_withdraw (struct bgp_node *rn, struct bgp_info *ri, struct peer *peer,</span>
<span class='curline'><a href='../S/620.html#L1819'>peer</a>             1819 bgpd/bgp_route.c   if (CHECK_FLAG (peer-&gt;bgp-&gt;af_flags[afi][safi], BGP_CONFIG_DAMPENING)</span>
<span class='curline'><a href='../S/620.html#L1820'>peer</a>             1820 bgpd/bgp_route.c       &amp;&amp; peer-&gt;sort == BGP_PEER_EBGP)</span>
<span class='curline'><a href='../S/620.html#L1824'>peer</a>             1824 bgpd/bgp_route.c         bgp_aggregate_decrement (peer-&gt;bgp, &amp;rn-&gt;p, ri, afi, safi);</span>
<span class='curline'><a href='../S/620.html#L1828'>peer</a>             1828 bgpd/bgp_route.c   bgp_rib_remove (rn, ri, peer, afi, safi);</span>
<span class='curline'><a href='../S/620.html#L1832'>peer</a>             1832 bgpd/bgp_route.c bgp_update_rsclient (struct peer *rsclient, afi_t afi, safi_t safi,</span>
<span class='curline'><a href='../S/620.html#L1833'>peer</a>             1833 bgpd/bgp_route.c       struct attr *attr, struct peer *peer, struct prefix *p, int type,</span>
<span class='curline'><a href='../S/620.html#L1848'>peer</a>             1848 bgpd/bgp_route.c   if (peer == rsclient)</span>
<span class='curline'><a href='../S/620.html#L1851'>peer</a>             1851 bgpd/bgp_route.c   bgp = peer-&gt;bgp;</span>
<span class='curline'><a href='../S/620.html#L1856'>peer</a>             1856 bgpd/bgp_route.c     if (ri-&gt;peer == peer &amp;&amp; ri-&gt;type == type &amp;&amp; ri-&gt;sub_type == sub_type)</span>
<span class='curline'><a href='../S/620.html#L1860'>peer</a>             1860 bgpd/bgp_route.c   if (aspath_loop_check (attr-&gt;aspath, rsclient-&gt;as) &gt; peer-&gt;allowas_in[afi][safi])</span>
<span class='curline'><a href='../S/620.html#L1878'>peer</a>             1878 bgpd/bgp_route.c   if (CHECK_FLAG(peer-&gt;af_flags[afi][safi], PEER_FLAG_RSERVER_CLIENT) &amp;&amp;</span>
<span class='curline'><a href='../S/620.html#L1879'>peer</a>             1879 bgpd/bgp_route.c         bgp_export_modifier (rsclient, peer, p, &amp;new_attr, afi, safi) == RMAP_DENY)</span>
<span class='curline'><a href='../S/620.html#L1888'>peer</a>             1888 bgpd/bgp_route.c   if (bgp_import_modifier (rsclient, peer, p, &amp;new_attr, afi, safi) == RMAP_DENY)</span>
<span class='curline'><a href='../S/620.html#L1926'>peer</a>             1926 bgpd/bgp_route.c             zlog (peer-&gt;log, LOG_DEBUG,</span>
<span class='curline'><a href='../S/620.html#L1928'>peer</a>             1928 bgpd/bgp_route.c                     peer-&gt;host,</span>
<span class='curline'><a href='../S/620.html#L1944'>peer</a>             1944 bgpd/bgp_route.c         zlog (peer-&gt;log, LOG_DEBUG, "%s rcvd %s/%d for RS-client %s",</span>
<span class='curline'><a href='../S/620.html#L1945'>peer</a>             1945 bgpd/bgp_route.c                 peer-&gt;host,</span>
<span class='curline'><a href='../S/620.html#L1972'>peer</a>             1972 bgpd/bgp_route.c       zlog (peer-&gt;log, LOG_DEBUG, "%s rcvd %s/%d for RS-client %s",</span>
<span class='curline'><a href='../S/620.html#L1973'>peer</a>             1973 bgpd/bgp_route.c               peer-&gt;host,</span>
<span class='curline'><a href='../S/620.html#L1982'>peer</a>             1982 bgpd/bgp_route.c   new-&gt;peer = peer;</span>
<span class='curline'><a href='../S/620.html#L2007'>peer</a>             2007 bgpd/bgp_route.c         zlog (peer-&gt;log, LOG_DEBUG,</span>
<span class='curline'><a href='../S/620.html#L2009'>peer</a>             2009 bgpd/bgp_route.c         peer-&gt;host,</span>
<span class='curline'><a href='../S/620.html#L2014'>peer</a>             2014 bgpd/bgp_route.c     bgp_rib_remove (rn, ri, peer, afi, safi);</span>
<span class='curline'><a href='../S/620.html#L2022'>peer</a>             2022 bgpd/bgp_route.c bgp_withdraw_rsclient (struct peer *rsclient, afi_t afi, safi_t safi,</span>
<span class='curline'><a href='../S/620.html#L2023'>peer</a>             2023 bgpd/bgp_route.c       struct peer *peer, struct prefix *p, int type, int sub_type,</span>
<span class='curline'><a href='../S/620.html#L2030'>peer</a>             2030 bgpd/bgp_route.c   if (rsclient == peer)</span>
<span class='curline'><a href='../S/620.html#L2037'>peer</a>             2037 bgpd/bgp_route.c     if (ri-&gt;peer == peer &amp;&amp; ri-&gt;type == type &amp;&amp; ri-&gt;sub_type == sub_type)</span>
<span class='curline'><a href='../S/620.html#L2042'>peer</a>             2042 bgpd/bgp_route.c     bgp_rib_withdraw (rn, ri, peer, afi, safi);</span>
<span class='curline'><a href='../S/620.html#L2044'>peer</a>             2044 bgpd/bgp_route.c     zlog (peer-&gt;log, LOG_DEBUG,</span>
<span class='curline'><a href='../S/620.html#L2045'>peer</a>             2045 bgpd/bgp_route.c           "%s Can't find the route %s/%d", peer-&gt;host,</span>
<span class='curline'><a href='../S/620.html#L2054'>peer</a>             2054 bgpd/bgp_route.c bgp_update_main (struct peer *peer, struct prefix *p, struct attr *attr,</span>
<span class='curline'><a href='../S/620.html#L2070'>peer</a>             2070 bgpd/bgp_route.c   bgp = peer-&gt;bgp;</span>
<span class='curline'><a href='../S/620.html#L2075'>peer</a>             2075 bgpd/bgp_route.c   if (! soft_reconfig &amp;&amp; CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_SOFT_RECONFIG)</span>
<span class='curline'><a href='../S/620.html#L2076'>peer</a>             2076 bgpd/bgp_route.c       &amp;&amp; peer != bgp-&gt;peer_self)</span>
<span class='curline'><a href='../S/620.html#L2077'>peer</a>             2077 bgpd/bgp_route.c     bgp_adj_in_set (rn, peer, attr);</span>
<span class='curline'><a href='../S/620.html#L2081'>peer</a>             2081 bgpd/bgp_route.c     if (ri-&gt;peer == peer &amp;&amp; ri-&gt;type == type &amp;&amp; ri-&gt;sub_type == sub_type)</span>
<span class='curline'><a href='../S/620.html#L2085'>peer</a>             2085 bgpd/bgp_route.c   if (peer-&gt;change_local_as)</span>
<span class='curline'><a href='../S/620.html#L2087'>peer</a>             2087 bgpd/bgp_route.c       if (! CHECK_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_NO_PREPEND))</span>
<span class='curline'><a href='../S/620.html#L2090'>peer</a>             2090 bgpd/bgp_route.c       if (aspath_loop_check (attr-&gt;aspath, peer-&gt;change_local_as) &gt; aspath_loop_count) </span>
<span class='curline'><a href='../S/620.html#L2098'>peer</a>             2098 bgpd/bgp_route.c   if (aspath_loop_check (attr-&gt;aspath, bgp-&gt;as) &gt; peer-&gt;allowas_in[afi][safi]</span>
<span class='curline'><a href='../S/620.html#L2101'>peer</a>             2101 bgpd/bgp_route.c 	  &gt; peer-&gt;allowas_in[afi][safi]))</span>
<span class='curline'><a href='../S/620.html#L2116'>peer</a>             2116 bgpd/bgp_route.c   if (bgp_cluster_filter (peer, attr))</span>
<span class='curline'><a href='../S/620.html#L2123'>peer</a>             2123 bgpd/bgp_route.c   if (bgp_input_filter (peer, p, attr, afi, safi) == FILTER_DENY)</span>
<span class='curline'><a href='../S/620.html#L2133'>peer</a>             2133 bgpd/bgp_route.c   if (bgp_input_modifier (peer, p, &amp;new_attr, afi, safi) == RMAP_DENY)</span>
<span class='curline'><a href='../S/620.html#L2144'>peer</a>             2144 bgpd/bgp_route.c       if (peer-&gt;sort == BGP_PEER_EBGP &amp;&amp; peer-&gt;ttl == 1</span>
<span class='curline'><a href='../S/620.html#L2146'>peer</a>             2146 bgpd/bgp_route.c 	  &amp;&amp; ! CHECK_FLAG (peer-&gt;flags, PEER_FLAG_DISABLE_CONNECTED_CHECK))</span>
<span class='curline'><a href='../S/620.html#L2177'>peer</a>             2177 bgpd/bgp_route.c 	      &amp;&amp; peer-&gt;sort == BGP_PEER_EBGP</span>
<span class='curline'><a href='../S/620.html#L2181'>peer</a>             2181 bgpd/bgp_route.c 		  zlog (peer-&gt;log, LOG_DEBUG, "%s rcvd %s/%d",</span>
<span class='curline'><a href='../S/620.html#L2182'>peer</a>             2182 bgpd/bgp_route.c 		  peer-&gt;host,</span>
<span class='curline'><a href='../S/620.html#L2195'>peer</a>             2195 bgpd/bgp_route.c 		zlog (peer-&gt;log, LOG_DEBUG,</span>
<span class='curline'><a href='../S/620.html#L2197'>peer</a>             2197 bgpd/bgp_route.c 		peer-&gt;host,</span>
<span class='curline'><a href='../S/620.html#L2219'>peer</a>             2219 bgpd/bgp_route.c             zlog (peer-&gt;log, LOG_DEBUG, "%s rcvd %s/%d, flapped quicker than processing",</span>
<span class='curline'><a href='../S/620.html#L2220'>peer</a>             2220 bgpd/bgp_route.c             peer-&gt;host,</span>
<span class='curline'><a href='../S/620.html#L2228'>peer</a>             2228 bgpd/bgp_route.c 	zlog (peer-&gt;log, LOG_DEBUG, "%s rcvd %s/%d",</span>
<span class='curline'><a href='../S/620.html#L2229'>peer</a>             2229 bgpd/bgp_route.c 	      peer-&gt;host,</span>
<span class='curline'><a href='../S/620.html#L2247'>peer</a>             2247 bgpd/bgp_route.c 	  &amp;&amp; peer-&gt;sort == BGP_PEER_EBGP)</span>
<span class='curline'><a href='../S/620.html#L2265'>peer</a>             2265 bgpd/bgp_route.c 	  &amp;&amp; peer-&gt;sort == BGP_PEER_EBGP)</span>
<span class='curline'><a href='../S/620.html#L2279'>peer</a>             2279 bgpd/bgp_route.c 	  &amp;&amp; (peer-&gt;sort == BGP_PEER_IBGP</span>
<span class='curline'><a href='../S/620.html#L2280'>peer</a>             2280 bgpd/bgp_route.c               || peer-&gt;sort == BGP_PEER_CONFED</span>
<span class='curline'><a href='../S/620.html#L2281'>peer</a>             2281 bgpd/bgp_route.c 	      || (peer-&gt;sort == BGP_PEER_EBGP &amp;&amp; peer-&gt;ttl != 1)</span>
<span class='curline'><a href='../S/620.html#L2282'>peer</a>             2282 bgpd/bgp_route.c 	      || CHECK_FLAG (peer-&gt;flags, PEER_FLAG_DISABLE_CONNECTED_CHECK)))</span>
<span class='curline'><a href='../S/620.html#L2284'>peer</a>             2284 bgpd/bgp_route.c 	  if (bgp_nexthop_lookup (afi, peer, ri, NULL, NULL))</span>
<span class='curline'><a href='../S/620.html#L2304'>peer</a>             2304 bgpd/bgp_route.c       zlog (peer-&gt;log, LOG_DEBUG, "%s rcvd %s/%d",</span>
<span class='curline'><a href='../S/620.html#L2305'>peer</a>             2305 bgpd/bgp_route.c 	    peer-&gt;host,</span>
<span class='curline'><a href='../S/620.html#L2314'>peer</a>             2314 bgpd/bgp_route.c   new-&gt;peer = peer;</span>
<span class='curline'><a href='../S/620.html#L2325'>peer</a>             2325 bgpd/bgp_route.c       &amp;&amp; (peer-&gt;sort == BGP_PEER_IBGP</span>
<span class='curline'><a href='../S/620.html#L2326'>peer</a>             2326 bgpd/bgp_route.c           || peer-&gt;sort == BGP_PEER_CONFED</span>
<span class='curline'><a href='../S/620.html#L2327'>peer</a>             2327 bgpd/bgp_route.c 	  || (peer-&gt;sort == BGP_PEER_EBGP &amp;&amp; peer-&gt;ttl != 1)</span>
<span class='curline'><a href='../S/620.html#L2328'>peer</a>             2328 bgpd/bgp_route.c 	  || CHECK_FLAG (peer-&gt;flags, PEER_FLAG_DISABLE_CONNECTED_CHECK)))</span>
<span class='curline'><a href='../S/620.html#L2330'>peer</a>             2330 bgpd/bgp_route.c       if (bgp_nexthop_lookup (afi, peer, new, NULL, NULL))</span>
<span class='curline'><a href='../S/620.html#L2349'>peer</a>             2349 bgpd/bgp_route.c   if (bgp_maximum_prefix_overflow (peer, afi, safi, 0))</span>
<span class='curline'><a href='../S/620.html#L2361'>peer</a>             2361 bgpd/bgp_route.c     zlog (peer-&gt;log, LOG_DEBUG,</span>
<span class='curline'><a href='../S/620.html#L2363'>peer</a>             2363 bgpd/bgp_route.c 	  peer-&gt;host,</span>
<span class='curline'><a href='../S/620.html#L2368'>peer</a>             2368 bgpd/bgp_route.c     bgp_rib_remove (rn, ri, peer, afi, safi);</span>
<span class='curline'><a href='../S/620.html#L2376'>peer</a>             2376 bgpd/bgp_route.c bgp_update (struct peer *peer, struct prefix *p, struct attr *attr,</span>
<span class='curline'><a href='../S/620.html#L2380'>peer</a>             2380 bgpd/bgp_route.c   struct peer *rsclient;</span>
<span class='curline'><a href='../S/620.html#L2385'>peer</a>             2385 bgpd/bgp_route.c   ret = bgp_update_main (peer, p, attr, afi, safi, type, sub_type, prd, tag,</span>
<span class='curline'><a href='../S/620.html#L2388'>peer</a>             2388 bgpd/bgp_route.c   bgp = peer-&gt;bgp;</span>
<span class='curline'><a href='../S/620.html#L2394'>peer</a>             2394 bgpd/bgp_route.c         bgp_update_rsclient (rsclient, afi, safi, attr, peer, p, type,</span>
<span class='curline'><a href='../S/620.html#L2402'>peer</a>             2402 bgpd/bgp_route.c bgp_withdraw (struct peer *peer, struct prefix *p, struct attr *attr, </span>
<span class='curline'><a href='../S/620.html#L2410'>peer</a>             2410 bgpd/bgp_route.c   struct peer *rsclient;</span>
<span class='curline'><a href='../S/620.html#L2413'>peer</a>             2413 bgpd/bgp_route.c   bgp = peer-&gt;bgp;</span>
<span class='curline'><a href='../S/620.html#L2419'>peer</a>             2419 bgpd/bgp_route.c         bgp_withdraw_rsclient (rsclient, afi, safi, peer, p, type, sub_type, prd, tag);</span>
<span class='curline'><a href='../S/620.html#L2424'>peer</a>             2424 bgpd/bgp_route.c     zlog (peer-&gt;log, LOG_DEBUG, "%s rcvd UPDATE about %s/%d -- withdrawn",</span>
<span class='curline'><a href='../S/620.html#L2425'>peer</a>             2425 bgpd/bgp_route.c 	  peer-&gt;host,</span>
<span class='curline'><a href='../S/620.html#L2434'>peer</a>             2434 bgpd/bgp_route.c   if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_SOFT_RECONFIG)</span>
<span class='curline'><a href='../S/620.html#L2435'>peer</a>             2435 bgpd/bgp_route.c       &amp;&amp; peer != bgp-&gt;peer_self)</span>
<span class='curline'><a href='../S/620.html#L2436'>peer</a>             2436 bgpd/bgp_route.c     bgp_adj_in_unset (rn, peer);</span>
<span class='curline'><a href='../S/620.html#L2440'>peer</a>             2440 bgpd/bgp_route.c     if (ri-&gt;peer == peer &amp;&amp; ri-&gt;type == type &amp;&amp; ri-&gt;sub_type == sub_type)</span>
<span class='curline'><a href='../S/620.html#L2445'>peer</a>             2445 bgpd/bgp_route.c     bgp_rib_withdraw (rn, ri, peer, afi, safi);</span>
<span class='curline'><a href='../S/620.html#L2447'>peer</a>             2447 bgpd/bgp_route.c     zlog (peer-&gt;log, LOG_DEBUG, </span>
<span class='curline'><a href='../S/620.html#L2448'>peer</a>             2448 bgpd/bgp_route.c 	  "%s Can't find the route %s/%d", peer-&gt;host,</span>
<span class='curline'><a href='../S/620.html#L2459'>peer</a>             2459 bgpd/bgp_route.c bgp_default_originate (struct peer *peer, afi_t afi, safi_t safi, int withdraw)</span>
<span class='curline'><a href='../S/620.html#L2465'>peer</a>             2465 bgpd/bgp_route.c   struct peer *from;</span>
<span class='curline'><a href='../S/620.html#L2473'>peer</a>             2473 bgpd/bgp_route.c   bgp = peer-&gt;bgp;</span>
<span class='curline'><a href='../S/620.html#L2479'>peer</a>             2479 bgpd/bgp_route.c   memcpy (&amp;attr.nexthop, &amp;peer-&gt;nexthop.v4, IPV4_MAX_BYTELEN);</span>
<span class='curline'><a href='../S/620.html#L2491'>peer</a>             2491 bgpd/bgp_route.c       memcpy (&amp;ae-&gt;mp_nexthop_global, &amp;peer-&gt;nexthop.v6_global, </span>
<span class='curline'><a href='../S/620.html#L2497'>peer</a>             2497 bgpd/bgp_route.c       if (peer-&gt;shared_network </span>
<span class='curline'><a href='../S/620.html#L2498'>peer</a>             2498 bgpd/bgp_route.c 	  &amp;&amp; !IN6_IS_ADDR_UNSPECIFIED (&amp;peer-&gt;nexthop.v6_local))</span>
<span class='curline'><a href='../S/620.html#L2500'>peer</a>             2500 bgpd/bgp_route.c 	  memcpy (&amp;ae-&gt;mp_nexthop_local, &amp;peer-&gt;nexthop.v6_local, </span>
<span class='curline'><a href='../S/620.html#L2507'>peer</a>             2507 bgpd/bgp_route.c   if (peer-&gt;default_rmap[afi][safi].name)</span>
<span class='curline'><a href='../S/620.html#L2521'>peer</a>             2521 bgpd/bgp_route.c               info.peer = ri-&gt;peer;</span>
<span class='curline'><a href='../S/620.html#L2524'>peer</a>             2524 bgpd/bgp_route.c               ret = route_map_apply(peer-&gt;default_rmap[afi][safi].map, &amp;rn-&gt;p,</span>
<span class='curline'><a href='../S/620.html#L2544'>peer</a>             2544 bgpd/bgp_route.c       if (CHECK_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_DEFAULT_ORIGINATE))</span>
<span class='curline'><a href='../S/620.html#L2545'>peer</a>             2545 bgpd/bgp_route.c 	bgp_default_withdraw_send (peer, afi, safi);</span>
<span class='curline'><a href='../S/620.html#L2546'>peer</a>             2546 bgpd/bgp_route.c       UNSET_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_DEFAULT_ORIGINATE);</span>
<span class='curline'><a href='../S/620.html#L2550'>peer</a>             2550 bgpd/bgp_route.c       if (! CHECK_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_DEFAULT_ORIGINATE))</span>
<span class='curline'><a href='../S/620.html#L2552'>peer</a>             2552 bgpd/bgp_route.c           SET_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_DEFAULT_ORIGINATE);</span>
<span class='curline'><a href='../S/620.html#L2553'>peer</a>             2553 bgpd/bgp_route.c           bgp_default_update_send (peer, &amp;attr, afi, safi, from);</span>
<span class='curline'><a href='../S/620.html#L2562'>peer</a>             2562 bgpd/bgp_route.c bgp_announce_table (struct peer *peer, afi_t afi, safi_t safi,</span>
<span class='curline'><a href='../S/620.html#L2571'>peer</a>             2571 bgpd/bgp_route.c     table = (rsclient) ? peer-&gt;rib[afi][safi] : peer-&gt;bgp-&gt;rib[afi][safi];</span>
<span class='curline'><a href='../S/620.html#L2574'>peer</a>             2574 bgpd/bgp_route.c       &amp;&amp; CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_DEFAULT_ORIGINATE))</span>
<span class='curline'><a href='../S/620.html#L2575'>peer</a>             2575 bgpd/bgp_route.c     bgp_default_originate (peer, afi, safi, 0);</span>
<span class='curline'><a href='../S/620.html#L2582'>peer</a>             2582 bgpd/bgp_route.c       if (CHECK_FLAG (ri-&gt;flags, BGP_INFO_SELECTED) &amp;&amp; ri-&gt;peer != peer)</span>
<span class='curline'><a href='../S/620.html#L2585'>peer</a>             2585 bgpd/bgp_route.c               (bgp_announce_check_rsclient (ri, peer, &amp;rn-&gt;p, &amp;attr, afi, safi))</span>
<span class='curline'><a href='../S/620.html#L2586'>peer</a>             2586 bgpd/bgp_route.c               : (bgp_announce_check (ri, peer, &amp;rn-&gt;p, &amp;attr, afi, safi)))</span>
<span class='curline'><a href='../S/620.html#L2587'>peer</a>             2587 bgpd/bgp_route.c 	    bgp_adj_out_set (rn, peer, &amp;rn-&gt;p, &amp;attr, afi, safi, ri);</span>
<span class='curline'><a href='../S/620.html#L2589'>peer</a>             2589 bgpd/bgp_route.c 	    bgp_adj_out_unset (rn, peer, &amp;rn-&gt;p, afi, safi);</span>
<span class='curline'><a href='../S/620.html#L2594'>peer</a>             2594 bgpd/bgp_route.c bgp_announce_route (struct peer *peer, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/620.html#L2599'>peer</a>             2599 bgpd/bgp_route.c   if (peer-&gt;status != Established)</span>
<span class='curline'><a href='../S/620.html#L2602'>peer</a>             2602 bgpd/bgp_route.c   if (! peer-&gt;afc_nego[afi][safi])</span>
<span class='curline'><a href='../S/620.html#L2606'>peer</a>             2606 bgpd/bgp_route.c   if (CHECK_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_ORF_WAIT_REFRESH))</span>
<span class='curline'><a href='../S/620.html#L2610'>peer</a>             2610 bgpd/bgp_route.c     bgp_announce_table (peer, afi, safi, NULL, 0);</span>
<span class='curline'><a href='../S/620.html#L2612'>peer</a>             2612 bgpd/bgp_route.c     for (rn = bgp_table_top (peer-&gt;bgp-&gt;rib[afi][safi]); rn;</span>
<span class='curline'><a href='../S/620.html#L2615'>peer</a>             2615 bgpd/bgp_route.c        bgp_announce_table (peer, afi, safi, table, 0);</span>
<span class='curline'><a href='../S/620.html#L2617'>peer</a>             2617 bgpd/bgp_route.c   if (CHECK_FLAG(peer-&gt;af_flags[afi][safi], PEER_FLAG_RSERVER_CLIENT))</span>
<span class='curline'><a href='../S/620.html#L2618'>peer</a>             2618 bgpd/bgp_route.c     bgp_announce_table (peer, afi, safi, NULL, 1);</span>
<span class='curline'><a href='../S/620.html#L2622'>peer</a>             2622 bgpd/bgp_route.c bgp_announce_route_all (struct peer *peer)</span>
<span class='curline'><a href='../S/620.html#L2629'>peer</a>             2629 bgpd/bgp_route.c       bgp_announce_route (peer, afi, safi);</span>
<span class='curline'><a href='../S/620.html#L2633'>peer</a>             2633 bgpd/bgp_route.c bgp_soft_reconfig_table_rsclient (struct peer *rsclient, afi_t afi,</span>
<span class='curline'><a href='../S/620.html#L2648'>peer</a>             2648 bgpd/bgp_route.c         bgp_update_rsclient (rsclient, afi, safi, ain-&gt;attr, ain-&gt;peer,</span>
<span class='curline'><a href='../S/620.html#L2654'>peer</a>             2654 bgpd/bgp_route.c bgp_soft_reconfig_rsclient (struct peer *rsclient, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/620.html#L2677'>peer</a>             2677 bgpd/bgp_route.c bgp_soft_reconfig_table (struct peer *peer, afi_t afi, safi_t safi,</span>
<span class='curline'><a href='../S/620.html#L2685'>peer</a>             2685 bgpd/bgp_route.c     table = peer-&gt;bgp-&gt;rib[afi][safi];</span>
<span class='curline'><a href='../S/620.html#L2690'>peer</a>             2690 bgpd/bgp_route.c 	if (ain-&gt;peer == peer)</span>
<span class='curline'><a href='../S/620.html#L2695'>peer</a>             2695 bgpd/bgp_route.c 	    ret = bgp_update (peer, &amp;rn-&gt;p, ain-&gt;attr, afi, safi,</span>
<span class='curline'><a href='../S/620.html#L2710'>peer</a>             2710 bgpd/bgp_route.c bgp_soft_reconfig_in (struct peer *peer, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/620.html#L2715'>peer</a>             2715 bgpd/bgp_route.c   if (peer-&gt;status != Established)</span>
<span class='curline'><a href='../S/620.html#L2719'>peer</a>             2719 bgpd/bgp_route.c     bgp_soft_reconfig_table (peer, afi, safi, NULL, NULL);</span>
<span class='curline'><a href='../S/620.html#L2721'>peer</a>             2721 bgpd/bgp_route.c     for (rn = bgp_table_top (peer-&gt;bgp-&gt;rib[afi][safi]); rn;</span>
<span class='curline'><a href='../S/620.html#L2730'>peer</a>             2730 bgpd/bgp_route.c           bgp_soft_reconfig_table (peer, afi, safi, table, &amp;prd);</span>
<span class='curline'><a href='../S/620.html#L2746'>peer</a>             2746 bgpd/bgp_route.c   struct peer *peer = wq-&gt;spec.data;</span>
<span class='curline'><a href='../S/620.html#L2751'>peer</a>             2751 bgpd/bgp_route.c   assert (rn &amp;&amp; peer);</span>
<span class='curline'><a href='../S/620.html#L2754'>peer</a>             2754 bgpd/bgp_route.c     if (ri-&gt;peer == peer || cnq-&gt;purpose == BGP_CLEAR_ROUTE_MY_RSCLIENT)</span>
<span class='curline'><a href='../S/620.html#L2757'>peer</a>             2757 bgpd/bgp_route.c         if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_NSF_WAIT)</span>
<span class='curline'><a href='../S/620.html#L2758'>peer</a>             2758 bgpd/bgp_route.c             &amp;&amp; peer-&gt;nsf[afi][safi]</span>
<span class='curline'><a href='../S/620.html#L2763'>peer</a>             2763 bgpd/bgp_route.c           bgp_rib_remove (rn, ri, peer, afi, safi);</span>
<span class='curline'><a href='../S/620.html#L2784'>peer</a>             2784 bgpd/bgp_route.c   struct peer *peer = wq-&gt;spec.data;</span>
<span class='curline'><a href='../S/620.html#L2787'>peer</a>             2787 bgpd/bgp_route.c   BGP_EVENT_ADD (peer, Clearing_Completed);</span>
<span class='curline'><a href='../S/620.html#L2789'>peer</a>             2789 bgpd/bgp_route.c   peer_unlock (peer); /* bgp_clear_route */</span>
<span class='curline'><a href='../S/620.html#L2793'>peer</a>             2793 bgpd/bgp_route.c bgp_clear_node_queue_init (struct peer *peer)</span>
<span class='curline'><a href='../S/620.html#L2797'>peer</a>             2797 bgpd/bgp_route.c   snprintf (wname, sizeof(wname), "clear %s", peer-&gt;host);</span>
<span class='curline'><a href='../S/620.html#L2800'>peer</a>             2800 bgpd/bgp_route.c   if ( (peer-&gt;clear_node_queue = work_queue_new (bm-&gt;master, wname)) == NULL)</span>
<span class='curline'><a href='../S/620.html#L2805'>peer</a>             2805 bgpd/bgp_route.c   peer-&gt;clear_node_queue-&gt;spec.hold = 10;</span>
<span class='curline'><a href='../S/620.html#L2806'>peer</a>             2806 bgpd/bgp_route.c   peer-&gt;clear_node_queue-&gt;spec.workfunc = &amp;bgp_clear_route_node;</span>
<span class='curline'><a href='../S/620.html#L2807'>peer</a>             2807 bgpd/bgp_route.c   peer-&gt;clear_node_queue-&gt;spec.del_item_data = &amp;bgp_clear_node_queue_del;</span>
<span class='curline'><a href='../S/620.html#L2808'>peer</a>             2808 bgpd/bgp_route.c   peer-&gt;clear_node_queue-&gt;spec.completion_func = &amp;bgp_clear_node_complete;</span>
<span class='curline'><a href='../S/620.html#L2809'>peer</a>             2809 bgpd/bgp_route.c   peer-&gt;clear_node_queue-&gt;spec.max_retries = 0;</span>
<span class='curline'><a href='../S/620.html#L2812'>peer</a>             2812 bgpd/bgp_route.c   peer-&gt;clear_node_queue-&gt;spec.data = peer;</span>
<span class='curline'><a href='../S/620.html#L2816'>peer</a>             2816 bgpd/bgp_route.c bgp_clear_route_table (struct peer *peer, afi_t afi, safi_t safi,</span>
<span class='curline'><a href='../S/620.html#L2817'>peer</a>             2817 bgpd/bgp_route.c                        struct bgp_table *table, struct peer *rsclient,</span>
<span class='curline'><a href='../S/620.html#L2824'>peer</a>             2824 bgpd/bgp_route.c     table = (rsclient) ? rsclient-&gt;rib[afi][safi] : peer-&gt;bgp-&gt;rib[afi][safi];</span>
<span class='curline'><a href='../S/620.html#L2868'>peer</a>             2868 bgpd/bgp_route.c         if (ain-&gt;peer == peer || purpose == BGP_CLEAR_ROUTE_MY_RSCLIENT)</span>
<span class='curline'><a href='../S/620.html#L2875'>peer</a>             2875 bgpd/bgp_route.c         if (aout-&gt;peer == peer || purpose == BGP_CLEAR_ROUTE_MY_RSCLIENT)</span>
<span class='curline'><a href='../S/620.html#L2877'>peer</a>             2877 bgpd/bgp_route.c             bgp_adj_out_remove (rn, aout, peer, afi, safi);</span>
<span class='curline'><a href='../S/620.html#L2883'>peer</a>             2883 bgpd/bgp_route.c         if (ri-&gt;peer == peer || purpose == BGP_CLEAR_ROUTE_MY_RSCLIENT)</span>
<span class='curline'><a href='../S/620.html#L2894'>peer</a>             2894 bgpd/bgp_route.c             work_queue_add (peer-&gt;clear_node_queue, cnq);</span>
<span class='curline'><a href='../S/620.html#L2902'>peer</a>             2902 bgpd/bgp_route.c bgp_clear_route (struct peer *peer, afi_t afi, safi_t safi,</span>
<span class='curline'><a href='../S/620.html#L2907'>peer</a>             2907 bgpd/bgp_route.c   struct peer *rsclient;</span>
<span class='curline'><a href='../S/620.html#L2910'>peer</a>             2910 bgpd/bgp_route.c   if (peer-&gt;clear_node_queue == NULL)</span>
<span class='curline'><a href='../S/620.html#L2911'>peer</a>             2911 bgpd/bgp_route.c     bgp_clear_node_queue_init (peer);</span>
<span class='curline'><a href='../S/620.html#L2925'>peer</a>             2925 bgpd/bgp_route.c   if (!peer-&gt;clear_node_queue-&gt;thread)</span>
<span class='curline'><a href='../S/620.html#L2926'>peer</a>             2926 bgpd/bgp_route.c     peer_lock (peer); /* bgp_clear_node_complete */</span>
<span class='curline'><a href='../S/620.html#L2932'>peer</a>             2932 bgpd/bgp_route.c         bgp_clear_route_table (peer, afi, safi, NULL, NULL, purpose);</span>
<span class='curline'><a href='../S/620.html#L2934'>peer</a>             2934 bgpd/bgp_route.c         for (rn = bgp_table_top (peer-&gt;bgp-&gt;rib[afi][safi]); rn;</span>
<span class='curline'><a href='../S/620.html#L2937'>peer</a>             2937 bgpd/bgp_route.c             bgp_clear_route_table (peer, afi, safi, table, NULL, purpose);</span>
<span class='curline'><a href='../S/620.html#L2939'>peer</a>             2939 bgpd/bgp_route.c       for (ALL_LIST_ELEMENTS (peer-&gt;bgp-&gt;rsclient, node, nnode, rsclient))</span>
<span class='curline'><a href='../S/620.html#L2942'>peer</a>             2942 bgpd/bgp_route.c           bgp_clear_route_table (peer, afi, safi, NULL, rsclient, purpose);</span>
<span class='curline'><a href='../S/620.html#L2946'>peer</a>             2946 bgpd/bgp_route.c       bgp_clear_route_table (peer, afi, safi, NULL, peer, purpose);</span>
<span class='curline'><a href='../S/620.html#L2973'>peer</a>             2973 bgpd/bgp_route.c   if (!peer-&gt;clear_node_queue-&gt;thread)</span>
<span class='curline'><a href='../S/620.html#L2974'>peer</a>             2974 bgpd/bgp_route.c     bgp_clear_node_complete (peer-&gt;clear_node_queue);</span>
<span class='curline'><a href='../S/620.html#L2978'>peer</a>             2978 bgpd/bgp_route.c bgp_clear_route_all (struct peer *peer)</span>
<span class='curline'><a href='../S/620.html#L2985'>peer</a>             2985 bgpd/bgp_route.c       bgp_clear_route (peer, afi, safi, BGP_CLEAR_ROUTE_NORMAL);</span>
<span class='curline'><a href='../S/620.html#L2989'>peer</a>             2989 bgpd/bgp_route.c bgp_clear_adj_in (struct peer *peer, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/620.html#L2995'>peer</a>             2995 bgpd/bgp_route.c   table = peer-&gt;bgp-&gt;rib[afi][safi];</span>
<span class='curline'><a href='../S/620.html#L2999'>peer</a>             2999 bgpd/bgp_route.c       if (ain-&gt;peer == peer)</span>
<span class='curline'><a href='../S/620.html#L3008'>peer</a>             3008 bgpd/bgp_route.c bgp_clear_stale_route (struct peer *peer, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/620.html#L3014'>peer</a>             3014 bgpd/bgp_route.c   table = peer-&gt;bgp-&gt;rib[afi][safi];</span>
<span class='curline'><a href='../S/620.html#L3019'>peer</a>             3019 bgpd/bgp_route.c 	if (ri-&gt;peer == peer)</span>
<span class='curline'><a href='../S/620.html#L3022'>peer</a>             3022 bgpd/bgp_route.c 	      bgp_rib_remove (rn, ri, peer, afi, safi);</span>
<span class='curline'><a href='../S/620.html#L3072'>peer</a>             3072 bgpd/bgp_route.c bgp_nlri_parse (struct peer *peer, struct attr *attr, struct bgp_nlri *packet)</span>
<span class='curline'><a href='../S/620.html#L3081'>peer</a>             3081 bgpd/bgp_route.c   if (peer-&gt;status != Established)</span>
<span class='curline'><a href='../S/620.html#L3124'>peer</a>             3124 bgpd/bgp_route.c 	      zlog (peer-&gt;log, LOG_ERR, </span>
<span class='curline'><a href='../S/620.html#L3140'>peer</a>             3140 bgpd/bgp_route.c 	      zlog (peer-&gt;log, LOG_WARNING, </span>
<span class='curline'><a href='../S/620.html#L3151'>peer</a>             3151 bgpd/bgp_route.c 	ret = bgp_update (peer, &amp;p, attr, packet-&gt;afi, packet-&gt;safi, </span>
<span class='curline'><a href='../S/620.html#L3154'>peer</a>             3154 bgpd/bgp_route.c 	ret = bgp_withdraw (peer, &amp;p, attr, packet-&gt;afi, packet-&gt;safi, </span>
<span class='curline'><a href='../S/620.html#L3172'>peer</a>             3172 bgpd/bgp_route.c bgp_nlri_sanity_check (struct peer *peer, int afi, u_char *pnt,</span>
<span class='curline'><a href='../S/620.html#L3193'>peer</a>             3193 bgpd/bgp_route.c 	  plog_err (peer-&gt;log, </span>
<span class='curline'><a href='../S/620.html#L3195'>peer</a>             3195 bgpd/bgp_route.c 		    peer-&gt;host, prefixlen);</span>
<span class='curline'><a href='../S/620.html#L3196'>peer</a>             3196 bgpd/bgp_route.c 	  bgp_notify_send (peer, BGP_NOTIFY_UPDATE_ERR, </span>
<span class='curline'><a href='../S/620.html#L3206'>peer</a>             3206 bgpd/bgp_route.c 	  plog_err (peer-&gt;log, </span>
<span class='curline'><a href='../S/620.html#L3209'>peer</a>             3209 bgpd/bgp_route.c 		    peer-&gt;host, psize);</span>
<span class='curline'><a href='../S/620.html#L3210'>peer</a>             3210 bgpd/bgp_route.c 	  bgp_notify_send (peer, BGP_NOTIFY_UPDATE_ERR, </span>
<span class='curline'><a href='../S/620.html#L3221'>peer</a>             3221 bgpd/bgp_route.c       plog_err (peer-&gt;log,</span>
<span class='curline'><a href='../S/620.html#L3224'>peer</a>             3224 bgpd/bgp_route.c 		peer-&gt;host);</span>
<span class='curline'><a href='../S/620.html#L3225'>peer</a>             3225 bgpd/bgp_route.c       bgp_notify_send (peer, BGP_NOTIFY_UPDATE_ERR, </span>
<span class='curline'><a href='../S/620.html#L3247'>peer</a>             3247 bgpd/bgp_route.c bgp_static_withdraw_rsclient (struct bgp *bgp, struct peer *rsclient,</span>
<span class='curline'><a href='../S/620.html#L3257'>peer</a>             3257 bgpd/bgp_route.c     if (ri-&gt;peer == bgp-&gt;peer_self</span>
<span class='curline'><a href='../S/620.html#L3274'>peer</a>             3274 bgpd/bgp_route.c bgp_static_update_rsclient (struct peer *rsclient, struct prefix *p,</span>
<span class='curline'><a href='../S/620.html#L3311'>peer</a>             3311 bgpd/bgp_route.c       info.peer = rsclient;</span>
<span class='curline'><a href='../S/620.html#L3370'>peer</a>             3370 bgpd/bgp_route.c     if (ri-&gt;peer == bgp-&gt;peer_self &amp;&amp; ri-&gt;type == ZEBRA_ROUTE_BGP</span>
<span class='curline'><a href='../S/620.html#L3410'>peer</a>             3410 bgpd/bgp_route.c   new-&gt;peer = bgp-&gt;peer_self;</span>
<span class='curline'><a href='../S/620.html#L3460'>peer</a>             3460 bgpd/bgp_route.c       info.peer = bgp-&gt;peer_self;</span>
<span class='curline'><a href='../S/620.html#L3486'>peer</a>             3486 bgpd/bgp_route.c     if (ri-&gt;peer == bgp-&gt;peer_self &amp;&amp; ri-&gt;type == ZEBRA_ROUTE_BGP</span>
<span class='curline'><a href='../S/620.html#L3529'>peer</a>             3529 bgpd/bgp_route.c   new-&gt;peer = bgp-&gt;peer_self;</span>
<span class='curline'><a href='../S/620.html#L3555'>peer</a>             3555 bgpd/bgp_route.c   struct peer *rsclient;</span>
<span class='curline'><a href='../S/620.html#L3580'>peer</a>             3580 bgpd/bgp_route.c   new-&gt;peer = bgp-&gt;peer_self;</span>
<span class='curline'><a href='../S/620.html#L3611'>peer</a>             3611 bgpd/bgp_route.c     if (ri-&gt;peer == bgp-&gt;peer_self </span>
<span class='curline'><a href='../S/620.html#L3629'>peer</a>             3629 bgpd/bgp_route.c bgp_check_local_routes_rsclient (struct peer *rsclient, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/620.html#L3659'>peer</a>             3659 bgpd/bgp_route.c     if (ri-&gt;peer == bgp-&gt;peer_self </span>
<span class='curline'><a href='../S/620.html#L4658'>peer</a>             4658 bgpd/bgp_route.c       new-&gt;peer = bgp-&gt;peer_self;</span>
<span class='curline'><a href='../S/620.html#L4843'>peer</a>             4843 bgpd/bgp_route.c       new-&gt;peer = bgp-&gt;peer_self;</span>
<span class='curline'><a href='../S/620.html#L4911'>peer</a>             4911 bgpd/bgp_route.c     if (ri-&gt;peer == bgp-&gt;peer_self </span>
<span class='curline'><a href='../S/620.html#L5421'>peer</a>             5421 bgpd/bgp_route.c 	      info.peer = bgp-&gt;peer_self;</span>
<span class='curline'><a href='../S/620.html#L5450'>peer</a>             5450 bgpd/bgp_route.c  	    if (bi-&gt;peer == bgp-&gt;peer_self</span>
<span class='curline'><a href='../S/620.html#L5492'>peer</a>             5492 bgpd/bgp_route.c 	  new-&gt;peer = bgp-&gt;peer_self;</span>
<span class='curline'><a href='../S/620.html#L5527'>peer</a>             5527 bgpd/bgp_route.c 	    if (ri-&gt;peer == bgp-&gt;peer_self</span>
<span class='curline'><a href='../S/620.html#L5555'>peer</a>             5555 bgpd/bgp_route.c 	if (ri-&gt;peer == bgp-&gt;peer_self</span>
<span class='curline'><a href='../S/620.html#L5634'>peer</a>             5634 bgpd/bgp_route.c     if ((binfo-&gt;peer-&gt;as) &amp;&amp; (binfo-&gt;peer-&gt;as == binfo-&gt;peer-&gt;local_as))</span>
<span class='curline'><a href='../S/620.html#L5850'>peer</a>             5850 bgpd/bgp_route.c   len = vty_out (vty, "%s", binfo-&gt;peer-&gt;host);</span>
<span class='curline'><a href='../S/620.html#L5897'>peer</a>             5897 bgpd/bgp_route.c   len = vty_out (vty, "%s", binfo-&gt;peer-&gt;host);</span>
<span class='curline'><a href='../S/620.html#L5968'>peer</a>             5968 bgpd/bgp_route.c       if (CHECK_FLAG (binfo-&gt;peer-&gt;af_flags[afi][safi], PEER_FLAG_REFLECTOR_CLIENT))</span>
<span class='curline'><a href='../S/620.html#L5970'>peer</a>             5970 bgpd/bgp_route.c       if (CHECK_FLAG (binfo-&gt;peer-&gt;af_flags[afi][safi], PEER_FLAG_RSERVER_CLIENT))</span>
<span class='curline'><a href='../S/620.html#L5995'>peer</a>             5995 bgpd/bgp_route.c       if (binfo-&gt;peer == bgp-&gt;peer_self)</span>
<span class='curline'><a href='../S/620.html#L6007'>peer</a>             6007 bgpd/bgp_route.c 	  vty_out (vty, " from %s", sockunion2str (&amp;binfo-&gt;peer-&gt;su, buf, SU_ADDRSTRLEN));</span>
<span class='curline'><a href='../S/620.html#L6011'>peer</a>             6011 bgpd/bgp_route.c 	    vty_out (vty, " (%s)", inet_ntop (AF_INET, &amp;binfo-&gt;peer-&gt;remote_id, buf1, BUFSIZ));</span>
<span class='curline'><a href='../S/620.html#L6043'>peer</a>             6043 bgpd/bgp_route.c       if (binfo-&gt;peer != bgp-&gt;peer_self)</span>
<span class='curline'><a href='../S/620.html#L6045'>peer</a>             6045 bgpd/bgp_route.c 	  if (binfo-&gt;peer-&gt;as == binfo-&gt;peer-&gt;local_as)</span>
<span class='curline'><a href='../S/620.html#L6049'>peer</a>             6049 bgpd/bgp_route.c 		     (bgp_confederation_peers_check(bgp, binfo-&gt;peer-&gt;as) ? "confed-external" : "external"));</span>
<span class='curline'><a href='../S/620.html#L6223'>peer</a>             6223 bgpd/bgp_route.c 		binfo.peer = ri-&gt;peer;</span>
<span class='curline'><a href='../S/620.html#L6236'>peer</a>             6236 bgpd/bgp_route.c 		if (ri-&gt;peer-&gt;su_remote == NULL || ! sockunion_same(ri-&gt;peer-&gt;su_remote, su))</span>
<span class='curline'><a href='../S/620.html#L6404'>peer</a>             6404 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L6464'>peer</a>             6464 bgpd/bgp_route.c   for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/620.html#L6466'>peer</a>             6466 bgpd/bgp_route.c       if (bgp_adj_out_lookup (peer, p, afi, safi, rn))</span>
<span class='curline'><a href='../S/620.html#L6470'>peer</a>             6470 bgpd/bgp_route.c 	  vty_out (vty, " %s", sockunion2str (&amp;peer-&gt;su, buf1, SU_ADDRSTRLEN));</span>
<span class='curline'><a href='../S/620.html#L9192'>peer</a>             9192 bgpd/bgp_route.c static struct peer *</span>
<span class='curline'><a href='../S/620.html#L9198'>peer</a>             9198 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L9230'>peer</a>             9230 bgpd/bgp_route.c   peer = peer_lookup (bgp, &amp;su);</span>
<span class='curline'><a href='../S/620.html#L9231'>peer</a>             9231 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L9237'>peer</a>             9237 bgpd/bgp_route.c   return peer;</span>
<span class='curline'><a href='../S/620.html#L9619'>peer</a>             9619 bgpd/bgp_route.c   const struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L9628'>peer</a>             9628 bgpd/bgp_route.c   const struct peer *peer = pc-&gt;peer;</span>
<span class='curline'><a href='../S/620.html#L9636'>peer</a>             9636 bgpd/bgp_route.c         if (ain-&gt;peer == peer)</span>
<span class='curline'><a href='../S/620.html#L9643'>peer</a>             9643 bgpd/bgp_route.c           if (ri-&gt;peer != peer)</span>
<span class='curline'><a href='../S/620.html#L9665'>peer</a>             9665 bgpd/bgp_route.c                 plog_warn (peer-&gt;log,</span>
<span class='curline'><a href='../S/620.html#L9667'>peer</a>             9667 bgpd/bgp_route.c                            peer-&gt;host,</span>
<span class='curline'><a href='../S/620.html#L9676'>peer</a>             9676 bgpd/bgp_route.c                 plog_warn (peer-&gt;log,</span>
<span class='curline'><a href='../S/620.html#L9678'>peer</a>             9678 bgpd/bgp_route.c                            peer-&gt;host,</span>
<span class='curline'><a href='../S/620.html#L9690'>peer</a>             9690 bgpd/bgp_route.c bgp_peer_counts (struct vty *vty, struct peer *peer, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/620.html#L9692'>peer</a>             9692 bgpd/bgp_route.c   struct peer_pcounts pcounts = { .peer = peer };</span>
<span class='curline'><a href='../S/620.html#L9695'>peer</a>             9695 bgpd/bgp_route.c   if (!peer || !peer-&gt;bgp || !peer-&gt;afc[afi][safi]</span>
<span class='curline'><a href='../S/620.html#L9696'>peer</a>             9696 bgpd/bgp_route.c       || !peer-&gt;bgp-&gt;rib[afi][safi])</span>
<span class='curline'><a href='../S/620.html#L9703'>peer</a>             9703 bgpd/bgp_route.c   pcounts.peer = peer;</span>
<span class='curline'><a href='../S/620.html#L9704'>peer</a>             9704 bgpd/bgp_route.c   pcounts.table = peer-&gt;bgp-&gt;rib[afi][safi];</span>
<span class='curline'><a href='../S/620.html#L9713'>peer</a>             9713 bgpd/bgp_route.c            peer-&gt;host, afi_safi_print (afi, safi), VTY_NEWLINE);</span>
<span class='curline'><a href='../S/620.html#L9714'>peer</a>             9714 bgpd/bgp_route.c   vty_out (vty, "PfxCt: %ld%s", peer-&gt;pcount[afi][safi], VTY_NEWLINE);</span>
<span class='curline'><a href='../S/620.html#L9722'>peer</a>             9722 bgpd/bgp_route.c   if (pcounts.count[PCOUNT_PFCNT] != peer-&gt;pcount[afi][safi])</span>
<span class='curline'><a href='../S/620.html#L9725'>peer</a>             9725 bgpd/bgp_route.c                peer-&gt;host, VTY_NEWLINE);</span>
<span class='curline'><a href='../S/620.html#L9744'>peer</a>             9744 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L9746'>peer</a>             9746 bgpd/bgp_route.c   peer = peer_lookup_in_view (vty, NULL, argv[0]);  </span>
<span class='curline'><a href='../S/620.html#L9747'>peer</a>             9747 bgpd/bgp_route.c   if (! peer) </span>
<span class='curline'><a href='../S/620.html#L9750'>peer</a>             9750 bgpd/bgp_route.c   return bgp_peer_counts (vty, peer, AFI_IP, SAFI_UNICAST);</span>
<span class='curline'><a href='../S/620.html#L9764'>peer</a>             9764 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L9766'>peer</a>             9766 bgpd/bgp_route.c   peer = peer_lookup_in_view (vty, NULL, argv[0]);  </span>
<span class='curline'><a href='../S/620.html#L9767'>peer</a>             9767 bgpd/bgp_route.c   if (! peer) </span>
<span class='curline'><a href='../S/620.html#L9770'>peer</a>             9770 bgpd/bgp_route.c   return bgp_peer_counts (vty, peer, AFI_IP6, SAFI_UNICAST);</span>
<span class='curline'><a href='../S/620.html#L9787'>peer</a>             9787 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L9789'>peer</a>             9789 bgpd/bgp_route.c   peer = peer_lookup_in_view (vty, NULL, argv[1]);</span>
<span class='curline'><a href='../S/620.html#L9790'>peer</a>             9790 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L9794'>peer</a>             9794 bgpd/bgp_route.c     return bgp_peer_counts (vty, peer, AFI_IP, SAFI_MULTICAST);</span>
<span class='curline'><a href='../S/620.html#L9796'>peer</a>             9796 bgpd/bgp_route.c   return bgp_peer_counts (vty, peer, AFI_IP, SAFI_UNICAST);</span>
<span class='curline'><a href='../S/620.html#L9813'>peer</a>             9813 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L9815'>peer</a>             9815 bgpd/bgp_route.c   peer = peer_lookup_in_view (vty, NULL, argv[0]);</span>
<span class='curline'><a href='../S/620.html#L9816'>peer</a>             9816 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L9819'>peer</a>             9819 bgpd/bgp_route.c   return bgp_peer_counts (vty, peer, AFI_IP, SAFI_MPLS_VPN);</span>
<span class='curline'><a href='../S/620.html#L9824'>peer</a>             9824 bgpd/bgp_route.c show_adj_route (struct vty *vty, struct peer *peer, afi_t afi, safi_t safi,</span>
<span class='curline'><a href='../S/620.html#L9836'>peer</a>             9836 bgpd/bgp_route.c   bgp = peer-&gt;bgp;</span>
<span class='curline'><a href='../S/620.html#L9845'>peer</a>             9845 bgpd/bgp_route.c   if (! in &amp;&amp; CHECK_FLAG (peer-&gt;af_sflags[afi][safi],</span>
<span class='curline'><a href='../S/620.html#L9861'>peer</a>             9861 bgpd/bgp_route.c 	  if (ain-&gt;peer == peer)</span>
<span class='curline'><a href='../S/620.html#L9885'>peer</a>             9885 bgpd/bgp_route.c 	  if (adj-&gt;peer == peer)</span>
<span class='curline'><a href='../S/620.html#L9913'>peer</a>             9913 bgpd/bgp_route.c peer_adj_routes (struct vty *vty, struct peer *peer, afi_t afi, safi_t safi, int in)</span>
<span class='curline'><a href='../S/620.html#L9915'>peer</a>             9915 bgpd/bgp_route.c   if (! peer || ! peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/620.html#L9921'>peer</a>             9921 bgpd/bgp_route.c   if (in &amp;&amp; ! CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_SOFT_RECONFIG))</span>
<span class='curline'><a href='../S/620.html#L9928'>peer</a>             9928 bgpd/bgp_route.c   show_adj_route (vty, peer, afi, safi, in);</span>
<span class='curline'><a href='../S/620.html#L9946'>peer</a>             9946 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L9949'>peer</a>             9949 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[1]);</span>
<span class='curline'><a href='../S/620.html#L9951'>peer</a>             9951 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, NULL, argv[0]);</span>
<span class='curline'><a href='../S/620.html#L9953'>peer</a>             9953 bgpd/bgp_route.c   if (! peer) </span>
<span class='curline'><a href='../S/620.html#L9956'>peer</a>             9956 bgpd/bgp_route.c   return peer_adj_routes (vty, peer, AFI_IP, SAFI_UNICAST, 0);</span>
<span class='curline'><a href='../S/620.html#L9984'>peer</a>             9984 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L9986'>peer</a>             9986 bgpd/bgp_route.c   peer = peer_lookup_in_view (vty, NULL, argv[1]);</span>
<span class='curline'><a href='../S/620.html#L9987'>peer</a>             9987 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L9991'>peer</a>             9991 bgpd/bgp_route.c     return peer_adj_routes (vty, peer, AFI_IP, SAFI_MULTICAST, 0);</span>
<span class='curline'><a href='../S/620.html#L9993'>peer</a>             9993 bgpd/bgp_route.c   return peer_adj_routes (vty, peer, AFI_IP, SAFI_UNICAST, 0);</span>
<span class='curline'><a href='../S/620.html#L10009'>peer</a>             10009 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10012'>peer</a>             10012 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[1]);</span>
<span class='curline'><a href='../S/620.html#L10014'>peer</a>             10014 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, NULL, argv[0]);</span>
<span class='curline'><a href='../S/620.html#L10016'>peer</a>             10016 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10019'>peer</a>             10019 bgpd/bgp_route.c   return peer_adj_routes (vty, peer, AFI_IP6, SAFI_UNICAST, 0);</span>
<span class='curline'><a href='../S/620.html#L10047'>peer</a>             10047 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10050'>peer</a>             10050 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[1]);</span>
<span class='curline'><a href='../S/620.html#L10052'>peer</a>             10052 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, NULL, argv[0]);</span>
<span class='curline'><a href='../S/620.html#L10054'>peer</a>             10054 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10057'>peer</a>             10057 bgpd/bgp_route.c   return peer_adj_routes (vty, peer, AFI_IP6, SAFI_UNICAST, 1);</span>
<span class='curline'><a href='../S/620.html#L10118'>peer</a>             10118 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10120'>peer</a>             10120 bgpd/bgp_route.c   peer = peer_lookup_in_view (vty, NULL, argv[0]);</span>
<span class='curline'><a href='../S/620.html#L10121'>peer</a>             10121 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10124'>peer</a>             10124 bgpd/bgp_route.c   return peer_adj_routes (vty, peer, AFI_IP6, SAFI_MULTICAST, 0);</span>
<span class='curline'><a href='../S/620.html#L10141'>peer</a>             10141 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10144'>peer</a>             10144 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[1]);</span>
<span class='curline'><a href='../S/620.html#L10146'>peer</a>             10146 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, NULL, argv[0]);</span>
<span class='curline'><a href='../S/620.html#L10148'>peer</a>             10148 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10151'>peer</a>             10151 bgpd/bgp_route.c   return peer_adj_routes (vty, peer, AFI_IP, SAFI_UNICAST, 1);</span>
<span class='curline'><a href='../S/620.html#L10179'>peer</a>             10179 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10181'>peer</a>             10181 bgpd/bgp_route.c   peer = peer_lookup_in_view (vty, NULL, argv[1]);</span>
<span class='curline'><a href='../S/620.html#L10182'>peer</a>             10182 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10186'>peer</a>             10186 bgpd/bgp_route.c     return peer_adj_routes (vty, peer, AFI_IP, SAFI_MULTICAST, 1);</span>
<span class='curline'><a href='../S/620.html#L10188'>peer</a>             10188 bgpd/bgp_route.c   return peer_adj_routes (vty, peer, AFI_IP, SAFI_UNICAST, 1);</span>
<span class='curline'><a href='../S/620.html#L10217'>peer</a>             10217 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10220'>peer</a>             10220 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[3]);</span>
<span class='curline'><a href='../S/620.html#L10222'>peer</a>             10222 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[2]);</span>
<span class='curline'><a href='../S/620.html#L10225'>peer</a>             10225 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10238'>peer</a>             10238 bgpd/bgp_route.c   return peer_adj_routes (vty, peer, afi, safi, in);</span>
<span class='curline'><a href='../S/620.html#L10255'>peer</a>             10255 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10265'>peer</a>             10265 bgpd/bgp_route.c   peer = peer_lookup (NULL, &amp;su);</span>
<span class='curline'><a href='../S/620.html#L10266'>peer</a>             10266 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10269'>peer</a>             10269 bgpd/bgp_route.c   sprintf (name, "%s.%d.%d", peer-&gt;host, AFI_IP, SAFI_UNICAST);</span>
<span class='curline'><a href='../S/620.html#L10297'>peer</a>             10297 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10307'>peer</a>             10307 bgpd/bgp_route.c   peer = peer_lookup (NULL, &amp;su);</span>
<span class='curline'><a href='../S/620.html#L10308'>peer</a>             10308 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10313'>peer</a>             10313 bgpd/bgp_route.c       sprintf (name, "%s.%d.%d", peer-&gt;host, AFI_IP, SAFI_MULTICAST);</span>
<span class='curline'><a href='../S/620.html#L10323'>peer</a>             10323 bgpd/bgp_route.c       sprintf (name, "%s.%d.%d", peer-&gt;host, AFI_IP, SAFI_UNICAST);</span>
<span class='curline'><a href='../S/620.html#L10371'>peer</a>             10371 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10381'>peer</a>             10381 bgpd/bgp_route.c   peer = peer_lookup (NULL, &amp;su);</span>
<span class='curline'><a href='../S/620.html#L10382'>peer</a>             10382 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10385'>peer</a>             10385 bgpd/bgp_route.c   sprintf (name, "%s.%d.%d", peer-&gt;host, AFI_IP6, SAFI_UNICAST);</span>
<span class='curline'><a href='../S/620.html#L10432'>peer</a>             10432 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10434'>peer</a>             10434 bgpd/bgp_route.c   peer = peer_lookup_in_view (vty, NULL, argv[0]);</span>
<span class='curline'><a href='../S/620.html#L10435'>peer</a>             10435 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10438'>peer</a>             10438 bgpd/bgp_route.c   return peer_adj_routes (vty, peer, AFI_IP6, SAFI_MULTICAST, 1);</span>
<span class='curline'><a href='../S/620.html#L10456'>peer</a>             10456 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10475'>peer</a>             10475 bgpd/bgp_route.c   peer = peer_lookup (bgp, &amp;su);</span>
<span class='curline'><a href='../S/620.html#L10476'>peer</a>             10476 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10479'>peer</a>             10479 bgpd/bgp_route.c   sprintf (name, "%s.%d.%d", peer-&gt;host, AFI_IP6, SAFI_UNICAST);</span>
<span class='curline'><a href='../S/620.html#L10506'>peer</a>             10506 bgpd/bgp_route.c bgp_show_neighbor_route (struct vty *vty, struct peer *peer, afi_t afi,</span>
<span class='curline'><a href='../S/620.html#L10509'>peer</a>             10509 bgpd/bgp_route.c   if (! peer || ! peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/620.html#L10515'>peer</a>             10515 bgpd/bgp_route.c   return bgp_show (vty, peer-&gt;bgp, afi, safi, type, &amp;peer-&gt;su);</span>
<span class='curline'><a href='../S/620.html#L10529'>peer</a>             10529 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10531'>peer</a>             10531 bgpd/bgp_route.c   peer = peer_lookup_in_view (vty, NULL, argv[0]);</span>
<span class='curline'><a href='../S/620.html#L10532'>peer</a>             10532 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10535'>peer</a>             10535 bgpd/bgp_route.c   return bgp_show_neighbor_route (vty, peer, AFI_IP, SAFI_UNICAST,</span>
<span class='curline'><a href='../S/620.html#L10550'>peer</a>             10550 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10552'>peer</a>             10552 bgpd/bgp_route.c   peer = peer_lookup_in_view (vty, NULL, argv[0]);</span>
<span class='curline'><a href='../S/620.html#L10553'>peer</a>             10553 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10556'>peer</a>             10556 bgpd/bgp_route.c   return bgp_show_neighbor_route (vty, peer, AFI_IP, SAFI_UNICAST,</span>
<span class='curline'><a href='../S/620.html#L10571'>peer</a>             10571 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10573'>peer</a>             10573 bgpd/bgp_route.c   peer = peer_lookup_in_view (vty, NULL, argv[0]);</span>
<span class='curline'><a href='../S/620.html#L10574'>peer</a>             10574 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10577'>peer</a>             10577 bgpd/bgp_route.c   return bgp_show_neighbor_route (vty, peer, AFI_IP, SAFI_UNICAST,</span>
<span class='curline'><a href='../S/620.html#L10595'>peer</a>             10595 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10597'>peer</a>             10597 bgpd/bgp_route.c   peer = peer_lookup_in_view (vty, NULL, argv[1]);</span>
<span class='curline'><a href='../S/620.html#L10598'>peer</a>             10598 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10602'>peer</a>             10602 bgpd/bgp_route.c     return bgp_show_neighbor_route (vty, peer, AFI_IP, SAFI_MULTICAST,</span>
<span class='curline'><a href='../S/620.html#L10605'>peer</a>             10605 bgpd/bgp_route.c   return bgp_show_neighbor_route (vty, peer, AFI_IP, SAFI_UNICAST,</span>
<span class='curline'><a href='../S/620.html#L10621'>peer</a>             10621 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10624'>peer</a>             10624 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[1]);</span>
<span class='curline'><a href='../S/620.html#L10626'>peer</a>             10626 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, NULL, argv[0]);</span>
<span class='curline'><a href='../S/620.html#L10628'>peer</a>             10628 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10631'>peer</a>             10631 bgpd/bgp_route.c   if (! peer-&gt;afc[AFI_IP][SAFI_UNICAST])</span>
<span class='curline'><a href='../S/620.html#L10638'>peer</a>             10638 bgpd/bgp_route.c   if ( ! CHECK_FLAG (peer-&gt;af_flags[AFI_IP][SAFI_UNICAST],</span>
<span class='curline'><a href='../S/620.html#L10646'>peer</a>             10646 bgpd/bgp_route.c   table = peer-&gt;rib[AFI_IP][SAFI_UNICAST];</span>
<span class='curline'><a href='../S/620.html#L10648'>peer</a>             10648 bgpd/bgp_route.c   return bgp_show_table (vty, table, &amp;peer-&gt;remote_id, bgp_show_type_normal, NULL);</span>
<span class='curline'><a href='../S/620.html#L10674'>peer</a>             10674 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10678'>peer</a>             10678 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[2]);</span>
<span class='curline'><a href='../S/620.html#L10681'>peer</a>             10681 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, NULL, argv[1]);</span>
<span class='curline'><a href='../S/620.html#L10685'>peer</a>             10685 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10688'>peer</a>             10688 bgpd/bgp_route.c   if (! peer-&gt;afc[AFI_IP][safi])</span>
<span class='curline'><a href='../S/620.html#L10695'>peer</a>             10695 bgpd/bgp_route.c   if ( ! CHECK_FLAG (peer-&gt;af_flags[AFI_IP][safi],</span>
<span class='curline'><a href='../S/620.html#L10703'>peer</a>             10703 bgpd/bgp_route.c   table = peer-&gt;rib[AFI_IP][safi];</span>
<span class='curline'><a href='../S/620.html#L10705'>peer</a>             10705 bgpd/bgp_route.c   return bgp_show_table (vty, table, &amp;peer-&gt;remote_id, bgp_show_type_normal, NULL);</span>
<span class='curline'><a href='../S/620.html#L10732'>peer</a>             10732 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10755'>peer</a>             10755 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[1]);</span>
<span class='curline'><a href='../S/620.html#L10757'>peer</a>             10757 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, NULL, argv[0]);</span>
<span class='curline'><a href='../S/620.html#L10759'>peer</a>             10759 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10762'>peer</a>             10762 bgpd/bgp_route.c   if (! peer-&gt;afc[AFI_IP][SAFI_UNICAST])</span>
<span class='curline'><a href='../S/620.html#L10769'>peer</a>             10769 bgpd/bgp_route.c   if ( ! CHECK_FLAG (peer-&gt;af_flags[AFI_IP][SAFI_UNICAST],</span>
<span class='curline'><a href='../S/620.html#L10777'>peer</a>             10777 bgpd/bgp_route.c   return bgp_show_route_in_table (vty, bgp, peer-&gt;rib[AFI_IP][SAFI_UNICAST], </span>
<span class='curline'><a href='../S/620.html#L10807'>peer</a>             10807 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10831'>peer</a>             10831 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[2]);</span>
<span class='curline'><a href='../S/620.html#L10834'>peer</a>             10834 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, NULL, argv[1]);</span>
<span class='curline'><a href='../S/620.html#L10838'>peer</a>             10838 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10841'>peer</a>             10841 bgpd/bgp_route.c   if (! peer-&gt;afc[AFI_IP][safi])</span>
<span class='curline'><a href='../S/620.html#L10848'>peer</a>             10848 bgpd/bgp_route.c   if ( ! CHECK_FLAG (peer-&gt;af_flags[AFI_IP][safi],</span>
<span class='curline'><a href='../S/620.html#L10856'>peer</a>             10856 bgpd/bgp_route.c   return bgp_show_route_in_table (vty, bgp, peer-&gt;rib[AFI_IP][safi],</span>
<span class='curline'><a href='../S/620.html#L10886'>peer</a>             10886 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10909'>peer</a>             10909 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[1]);</span>
<span class='curline'><a href='../S/620.html#L10911'>peer</a>             10911 bgpd/bgp_route.c   peer = peer_lookup_in_view (vty, NULL, argv[0]);</span>
<span class='curline'><a href='../S/620.html#L10913'>peer</a>             10913 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10916'>peer</a>             10916 bgpd/bgp_route.c   if (! peer-&gt;afc[AFI_IP][SAFI_UNICAST])</span>
<span class='curline'><a href='../S/620.html#L10923'>peer</a>             10923 bgpd/bgp_route.c   if ( ! CHECK_FLAG (peer-&gt;af_flags[AFI_IP][SAFI_UNICAST],</span>
<span class='curline'><a href='../S/620.html#L10931'>peer</a>             10931 bgpd/bgp_route.c   return bgp_show_route_in_table (vty, bgp, peer-&gt;rib[AFI_IP][SAFI_UNICAST], </span>
<span class='curline'><a href='../S/620.html#L10961'>peer</a>             10961 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L10985'>peer</a>             10985 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[2]);</span>
<span class='curline'><a href='../S/620.html#L10988'>peer</a>             10988 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, NULL, argv[1]);</span>
<span class='curline'><a href='../S/620.html#L10992'>peer</a>             10992 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L10995'>peer</a>             10995 bgpd/bgp_route.c   if (! peer-&gt;afc[AFI_IP][safi])</span>
<span class='curline'><a href='../S/620.html#L11002'>peer</a>             11002 bgpd/bgp_route.c   if ( ! CHECK_FLAG (peer-&gt;af_flags[AFI_IP][safi],</span>
<span class='curline'><a href='../S/620.html#L11010'>peer</a>             11010 bgpd/bgp_route.c   return bgp_show_route_in_table (vty, bgp, peer-&gt;rib[AFI_IP][safi],</span>
<span class='curline'><a href='../S/620.html#L11040'>peer</a>             11040 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L11043'>peer</a>             11043 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[1]);</span>
<span class='curline'><a href='../S/620.html#L11045'>peer</a>             11045 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, NULL, argv[0]);</span>
<span class='curline'><a href='../S/620.html#L11047'>peer</a>             11047 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L11050'>peer</a>             11050 bgpd/bgp_route.c   return bgp_show_neighbor_route (vty, peer, AFI_IP6, SAFI_UNICAST,</span>
<span class='curline'><a href='../S/620.html#L11079'>peer</a>             11079 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L11082'>peer</a>             11082 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[1]);</span>
<span class='curline'><a href='../S/620.html#L11084'>peer</a>             11084 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, NULL, argv[0]);</span>
<span class='curline'><a href='../S/620.html#L11086'>peer</a>             11086 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L11089'>peer</a>             11089 bgpd/bgp_route.c   return bgp_show_neighbor_route (vty, peer, AFI_IP6, SAFI_UNICAST,</span>
<span class='curline'><a href='../S/620.html#L11118'>peer</a>             11118 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L11121'>peer</a>             11121 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[1]);</span>
<span class='curline'><a href='../S/620.html#L11123'>peer</a>             11123 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, NULL, argv[0]);</span>
<span class='curline'><a href='../S/620.html#L11125'>peer</a>             11125 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L11128'>peer</a>             11128 bgpd/bgp_route.c   return bgp_show_neighbor_route (vty, peer, AFI_IP6, SAFI_UNICAST,</span>
<span class='curline'><a href='../S/620.html#L11191'>peer</a>             11191 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L11193'>peer</a>             11193 bgpd/bgp_route.c   peer = peer_lookup_in_view (vty, NULL, argv[0]);</span>
<span class='curline'><a href='../S/620.html#L11194'>peer</a>             11194 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L11197'>peer</a>             11197 bgpd/bgp_route.c   return bgp_show_neighbor_route (vty, peer, AFI_IP6, SAFI_MULTICAST,</span>
<span class='curline'><a href='../S/620.html#L11254'>peer</a>             11254 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L11257'>peer</a>             11257 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[1]);</span>
<span class='curline'><a href='../S/620.html#L11259'>peer</a>             11259 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, NULL, argv[0]);</span>
<span class='curline'><a href='../S/620.html#L11261'>peer</a>             11261 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L11264'>peer</a>             11264 bgpd/bgp_route.c   if (! peer-&gt;afc[AFI_IP6][SAFI_UNICAST])</span>
<span class='curline'><a href='../S/620.html#L11271'>peer</a>             11271 bgpd/bgp_route.c   if ( ! CHECK_FLAG (peer-&gt;af_flags[AFI_IP6][SAFI_UNICAST],</span>
<span class='curline'><a href='../S/620.html#L11279'>peer</a>             11279 bgpd/bgp_route.c   table = peer-&gt;rib[AFI_IP6][SAFI_UNICAST];</span>
<span class='curline'><a href='../S/620.html#L11281'>peer</a>             11281 bgpd/bgp_route.c   return bgp_show_table (vty, table, &amp;peer-&gt;remote_id, bgp_show_type_normal, NULL);</span>
<span class='curline'><a href='../S/620.html#L11306'>peer</a>             11306 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L11310'>peer</a>             11310 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[2]);</span>
<span class='curline'><a href='../S/620.html#L11313'>peer</a>             11313 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, NULL, argv[1]);</span>
<span class='curline'><a href='../S/620.html#L11317'>peer</a>             11317 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L11320'>peer</a>             11320 bgpd/bgp_route.c   if (! peer-&gt;afc[AFI_IP6][safi])</span>
<span class='curline'><a href='../S/620.html#L11327'>peer</a>             11327 bgpd/bgp_route.c   if ( ! CHECK_FLAG (peer-&gt;af_flags[AFI_IP6][safi],</span>
<span class='curline'><a href='../S/620.html#L11335'>peer</a>             11335 bgpd/bgp_route.c   table = peer-&gt;rib[AFI_IP6][safi];</span>
<span class='curline'><a href='../S/620.html#L11337'>peer</a>             11337 bgpd/bgp_route.c   return bgp_show_table (vty, table, &amp;peer-&gt;remote_id, bgp_show_type_normal, NULL);</span>
<span class='curline'><a href='../S/620.html#L11363'>peer</a>             11363 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L11386'>peer</a>             11386 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[1]);</span>
<span class='curline'><a href='../S/620.html#L11388'>peer</a>             11388 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, NULL, argv[0]);</span>
<span class='curline'><a href='../S/620.html#L11390'>peer</a>             11390 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L11393'>peer</a>             11393 bgpd/bgp_route.c   if (! peer-&gt;afc[AFI_IP6][SAFI_UNICAST])</span>
<span class='curline'><a href='../S/620.html#L11400'>peer</a>             11400 bgpd/bgp_route.c   if ( ! CHECK_FLAG (peer-&gt;af_flags[AFI_IP6][SAFI_UNICAST],</span>
<span class='curline'><a href='../S/620.html#L11408'>peer</a>             11408 bgpd/bgp_route.c   return bgp_show_route_in_table (vty, bgp, peer-&gt;rib[AFI_IP6][SAFI_UNICAST],</span>
<span class='curline'><a href='../S/620.html#L11437'>peer</a>             11437 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L11461'>peer</a>             11461 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[2]);</span>
<span class='curline'><a href='../S/620.html#L11464'>peer</a>             11464 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, NULL, argv[1]);</span>
<span class='curline'><a href='../S/620.html#L11468'>peer</a>             11468 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L11471'>peer</a>             11471 bgpd/bgp_route.c   if (! peer-&gt;afc[AFI_IP6][safi])</span>
<span class='curline'><a href='../S/620.html#L11478'>peer</a>             11478 bgpd/bgp_route.c   if ( ! CHECK_FLAG (peer-&gt;af_flags[AFI_IP6][safi],</span>
<span class='curline'><a href='../S/620.html#L11486'>peer</a>             11486 bgpd/bgp_route.c   return bgp_show_route_in_table (vty, bgp, peer-&gt;rib[AFI_IP6][safi],</span>
<span class='curline'><a href='../S/620.html#L11515'>peer</a>             11515 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L11538'>peer</a>             11538 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[1]);</span>
<span class='curline'><a href='../S/620.html#L11540'>peer</a>             11540 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, NULL, argv[0]);</span>
<span class='curline'><a href='../S/620.html#L11542'>peer</a>             11542 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L11545'>peer</a>             11545 bgpd/bgp_route.c   if (! peer-&gt;afc[AFI_IP6][SAFI_UNICAST])</span>
<span class='curline'><a href='../S/620.html#L11552'>peer</a>             11552 bgpd/bgp_route.c   if ( ! CHECK_FLAG (peer-&gt;af_flags[AFI_IP6][SAFI_UNICAST],</span>
<span class='curline'><a href='../S/620.html#L11560'>peer</a>             11560 bgpd/bgp_route.c   return bgp_show_route_in_table (vty, bgp, peer-&gt;rib[AFI_IP6][SAFI_UNICAST],</span>
<span class='curline'><a href='../S/620.html#L11589'>peer</a>             11589 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L11613'>peer</a>             11613 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, argv[0], argv[2]);</span>
<span class='curline'><a href='../S/620.html#L11616'>peer</a>             11616 bgpd/bgp_route.c     peer = peer_lookup_in_view (vty, NULL, argv[1]);</span>
<span class='curline'><a href='../S/620.html#L11620'>peer</a>             11620 bgpd/bgp_route.c   if (! peer)</span>
<span class='curline'><a href='../S/620.html#L11623'>peer</a>             11623 bgpd/bgp_route.c   if (! peer-&gt;afc[AFI_IP6][safi])</span>
<span class='curline'><a href='../S/620.html#L11630'>peer</a>             11630 bgpd/bgp_route.c   if ( ! CHECK_FLAG (peer-&gt;af_flags[AFI_IP6][safi],</span>
<span class='curline'><a href='../S/620.html#L11638'>peer</a>             11638 bgpd/bgp_route.c   return bgp_show_route_in_table (vty, bgp, peer-&gt;rib[AFI_IP6][safi],</span>
<span class='curline'><a href='../S/620.html#L11772'>peer</a>             11772 bgpd/bgp_route.c   struct peer *peer;</span>
<span class='curline'><a href='../S/620.html#L11783'>peer</a>             11783 bgpd/bgp_route.c   peer = rinfo-&gt;peer;</span>
<span class='curline'><a href='../S/620.html#L11785'>peer</a>             11785 bgpd/bgp_route.c   if (peer-&gt;su.sa.sa_family != AF_INET)</span>
<span class='curline'><a href='../S/620.html#L11790'>peer</a>             11790 bgpd/bgp_route.c   q.prefix = peer-&gt;su.sin.sin_addr;</span>
<span class='curline'><a href='../S/620.html#L11826'>peer</a>             11826 bgpd/bgp_route.c   if (peer-&gt;sort == BGP_PEER_EBGP)</span>
<span class='curline'><a href='../S/609.html#L52'>peer</a>               52 bgpd/bgp_route.h   struct peer *peer;</span>
<span class='curline'><a href='../S/609.html#L176'>peer</a>              176 bgpd/bgp_route.h extern void bgp_announce_route (struct peer *, afi_t, safi_t);</span>
<span class='curline'><a href='../S/609.html#L177'>peer</a>              177 bgpd/bgp_route.h extern void bgp_announce_route_all (struct peer *);</span>
<span class='curline'><a href='../S/609.html#L178'>peer</a>              178 bgpd/bgp_route.h extern void bgp_default_originate (struct peer *, afi_t, safi_t, int);</span>
<span class='curline'><a href='../S/609.html#L179'>peer</a>              179 bgpd/bgp_route.h extern void bgp_soft_reconfig_in (struct peer *, afi_t, safi_t);</span>
<span class='curline'><a href='../S/609.html#L180'>peer</a>              180 bgpd/bgp_route.h extern void bgp_soft_reconfig_rsclient (struct peer *, afi_t, safi_t);</span>
<span class='curline'><a href='../S/609.html#L181'>peer</a>              181 bgpd/bgp_route.h extern void bgp_check_local_routes_rsclient (struct peer *rsclient, afi_t afi, safi_t safi);</span>
<span class='curline'><a href='../S/609.html#L182'>peer</a>              182 bgpd/bgp_route.h extern void bgp_clear_route (struct peer *, afi_t, safi_t,</span>
<span class='curline'><a href='../S/609.html#L184'>peer</a>              184 bgpd/bgp_route.h extern void bgp_clear_route_all (struct peer *);</span>
<span class='curline'><a href='../S/609.html#L185'>peer</a>              185 bgpd/bgp_route.h extern void bgp_clear_adj_in (struct peer *, afi_t, safi_t);</span>
<span class='curline'><a href='../S/609.html#L186'>peer</a>              186 bgpd/bgp_route.h extern void bgp_clear_stale_route (struct peer *, afi_t, safi_t);</span>
<span class='curline'><a href='../S/609.html#L196'>peer</a>              196 bgpd/bgp_route.h extern int bgp_nlri_sanity_check (struct peer *, int, u_char *, bgp_size_t);</span>
<span class='curline'><a href='../S/609.html#L197'>peer</a>              197 bgpd/bgp_route.h extern int bgp_nlri_parse (struct peer *, struct attr *, struct bgp_nlri *);</span>
<span class='curline'><a href='../S/609.html#L199'>peer</a>              199 bgpd/bgp_route.h extern int bgp_maximum_prefix_overflow (struct peer *, afi_t, safi_t, int);</span>
<span class='curline'><a href='../S/609.html#L219'>peer</a>              219 bgpd/bgp_route.h extern int bgp_update (struct peer *, struct prefix *, struct attr *,</span>
<span class='curline'><a href='../S/609.html#L222'>peer</a>              222 bgpd/bgp_route.h extern int bgp_withdraw (struct peer *, struct prefix *, struct attr *,</span>
<span class='curline'><a href='../S/621.html#L117'>peer</a>              117 bgpd/bgp_routemap.c   struct peer *peer;</span>
<span class='curline'><a href='../S/621.html#L123'>peer</a>              123 bgpd/bgp_routemap.c       peer = ((struct bgp_info *) object)-&gt;peer;</span>
<span class='curline'><a href='../S/621.html#L125'>peer</a>              125 bgpd/bgp_routemap.c       if ( ! CHECK_FLAG (peer-&gt;rmap_type, PEER_RMAP_TYPE_IMPORT) &amp;&amp;</span>
<span class='curline'><a href='../S/621.html#L126'>peer</a>              126 bgpd/bgp_routemap.c            ! CHECK_FLAG (peer-&gt;rmap_type, PEER_RMAP_TYPE_EXPORT) )</span>
<span class='curline'><a href='../S/621.html#L134'>peer</a>              134 bgpd/bgp_routemap.c           if ( CHECK_FLAG (peer-&gt;rmap_type, PEER_RMAP_TYPE_NETWORK) ||</span>
<span class='curline'><a href='../S/621.html#L135'>peer</a>              135 bgpd/bgp_routemap.c                CHECK_FLAG (peer-&gt;rmap_type, PEER_RMAP_TYPE_REDISTRIBUTE) ||</span>
<span class='curline'><a href='../S/621.html#L136'>peer</a>              136 bgpd/bgp_routemap.c                CHECK_FLAG (peer-&gt;rmap_type, PEER_RMAP_TYPE_DEFAULT))</span>
<span class='curline'><a href='../S/621.html#L143'>peer</a>              143 bgpd/bgp_routemap.c       if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/621.html#L145'>peer</a>              145 bgpd/bgp_routemap.c           if (sockunion_same (su, &amp;peer-&gt;su))</span>
<span class='curline'><a href='../S/621.html#L152'>peer</a>              152 bgpd/bgp_routemap.c           group = peer-&gt;group;</span>
<span class='curline'><a href='../S/621.html#L153'>peer</a>              153 bgpd/bgp_routemap.c           for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/621.html#L155'>peer</a>              155 bgpd/bgp_routemap.c               if (sockunion_same (su, &amp;peer-&gt;su))</span>
<span class='curline'><a href='../S/621.html#L305'>peer</a>              305 bgpd/bgp_routemap.c   struct peer *peer;</span>
<span class='curline'><a href='../S/621.html#L311'>peer</a>              311 bgpd/bgp_routemap.c       peer = bgp_info-&gt;peer;</span>
<span class='curline'><a href='../S/621.html#L313'>peer</a>              313 bgpd/bgp_routemap.c       if (! peer || sockunion_family (&amp;peer-&gt;su) != AF_INET)</span>
<span class='curline'><a href='../S/621.html#L317'>peer</a>              317 bgpd/bgp_routemap.c       p.prefix = peer-&gt;su.sin.sin_addr;</span>
<span class='curline'><a href='../S/621.html#L449'>peer</a>              449 bgpd/bgp_routemap.c   struct peer *peer;</span>
<span class='curline'><a href='../S/621.html#L455'>peer</a>              455 bgpd/bgp_routemap.c       peer = bgp_info-&gt;peer;</span>
<span class='curline'><a href='../S/621.html#L457'>peer</a>              457 bgpd/bgp_routemap.c       if (! peer || sockunion_family (&amp;peer-&gt;su) != AF_INET)</span>
<span class='curline'><a href='../S/621.html#L461'>peer</a>              461 bgpd/bgp_routemap.c       p.prefix = peer-&gt;su.sin.sin_addr;</span>
<span class='curline'><a href='../S/621.html#L879'>peer</a>              879 bgpd/bgp_routemap.c   struct peer *peer;</span>
<span class='curline'><a href='../S/621.html#L884'>peer</a>              884 bgpd/bgp_routemap.c       peer = bgp_info-&gt;peer;</span>
<span class='curline'><a href='../S/621.html#L888'>peer</a>              888 bgpd/bgp_routemap.c          if ((CHECK_FLAG (peer-&gt;rmap_type, PEER_RMAP_TYPE_IN) ||</span>
<span class='curline'><a href='../S/621.html#L889'>peer</a>              889 bgpd/bgp_routemap.c            CHECK_FLAG (peer-&gt;rmap_type, PEER_RMAP_TYPE_IMPORT))</span>
<span class='curline'><a href='../S/621.html#L890'>peer</a>              890 bgpd/bgp_routemap.c 	      &amp;&amp; peer-&gt;su_remote </span>
<span class='curline'><a href='../S/621.html#L891'>peer</a>              891 bgpd/bgp_routemap.c 	      &amp;&amp; sockunion_family (peer-&gt;su_remote) == AF_INET)</span>
<span class='curline'><a href='../S/621.html#L893'>peer</a>              893 bgpd/bgp_routemap.c 	      bgp_info-&gt;attr-&gt;nexthop.s_addr = sockunion2ip (peer-&gt;su_remote);</span>
<span class='curline'><a href='../S/621.html#L896'>peer</a>              896 bgpd/bgp_routemap.c 	  else if (CHECK_FLAG (peer-&gt;rmap_type, PEER_RMAP_TYPE_OUT)</span>
<span class='curline'><a href='../S/621.html#L897'>peer</a>              897 bgpd/bgp_routemap.c 		   &amp;&amp; peer-&gt;su_local</span>
<span class='curline'><a href='../S/621.html#L898'>peer</a>              898 bgpd/bgp_routemap.c 		   &amp;&amp; sockunion_family (peer-&gt;su_local) == AF_INET)</span>
<span class='curline'><a href='../S/621.html#L900'>peer</a>              900 bgpd/bgp_routemap.c 	      bgp_info-&gt;attr-&gt;nexthop.s_addr = sockunion2ip (peer-&gt;su_local);</span>
<span class='curline'><a href='../S/621.html#L2306'>peer</a>             2306 bgpd/bgp_routemap.c   struct peer *peer;</span>
<span class='curline'><a href='../S/621.html#L2315'>peer</a>             2315 bgpd/bgp_routemap.c       for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/621.html#L2320'>peer</a>             2320 bgpd/bgp_routemap.c 		filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/621.html#L2364'>peer</a>             2364 bgpd/bgp_routemap.c       for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/621.html#L2369'>peer</a>             2369 bgpd/bgp_routemap.c 		if (peer-&gt;default_rmap[afi][safi].name)</span>
<span class='curline'><a href='../S/621.html#L2370'>peer</a>             2370 bgpd/bgp_routemap.c 		  peer-&gt;default_rmap[afi][safi].map =</span>
<span class='curline'><a href='../S/621.html#L2371'>peer</a>             2371 bgpd/bgp_routemap.c 		    route_map_lookup_by_name (peer-&gt;default_rmap[afi][safi].name);</span>
<span class='curline'><a href='../S/621.html#L2373'>peer</a>             2373 bgpd/bgp_routemap.c 		  peer-&gt;default_rmap[afi][safi].map = NULL;</span>
<span class='curline'><a href='../S/619.html#L282'>peer</a>              282 bgpd/bgp_snmp.c static struct peer *</span>
<span class='curline'><a href='../S/619.html#L286'>peer</a>              286 bgpd/bgp_snmp.c   struct peer *peer;</span>
<span class='curline'><a href='../S/619.html#L295'>peer</a>              295 bgpd/bgp_snmp.c   for (ALL_LIST_ELEMENTS_RO (bgp-&gt;peer, node, peer))</span>
<span class='curline'><a href='../S/619.html#L297'>peer</a>              297 bgpd/bgp_snmp.c       ret = inet_pton (AF_INET, peer-&gt;host, &amp;addr);</span>
<span class='curline'><a href='../S/619.html#L301'>peer</a>              301 bgpd/bgp_snmp.c 	    return peer;</span>
<span class='curline'><a href='../S/619.html#L307'>peer</a>              307 bgpd/bgp_snmp.c static struct peer *</span>
<span class='curline'><a href='../S/619.html#L311'>peer</a>              311 bgpd/bgp_snmp.c   struct peer *peer;</span>
<span class='curline'><a href='../S/619.html#L323'>peer</a>              323 bgpd/bgp_snmp.c   for (ALL_LIST_ELEMENTS_RO (bgp-&gt;peer, node, peer))</span>
<span class='curline'><a href='../S/619.html#L325'>peer</a>              325 bgpd/bgp_snmp.c       ret = inet_pton (AF_INET, peer-&gt;host, &amp;su.sin.sin_addr);</span>
<span class='curline'><a href='../S/619.html#L333'>peer</a>              333 bgpd/bgp_snmp.c 	      return peer;</span>
<span class='curline'><a href='../S/619.html#L340'>peer</a>              340 bgpd/bgp_snmp.c static struct peer *</span>
<span class='curline'><a href='../S/619.html#L344'>peer</a>              344 bgpd/bgp_snmp.c   struct peer *peer = NULL;</span>
<span class='curline'><a href='../S/619.html#L355'>peer</a>              355 bgpd/bgp_snmp.c       peer = peer_lookup_addr_ipv4 (addr);</span>
<span class='curline'><a href='../S/619.html#L356'>peer</a>              356 bgpd/bgp_snmp.c       return peer;</span>
<span class='curline'><a href='../S/619.html#L365'>peer</a>              365 bgpd/bgp_snmp.c       peer = bgp_peer_lookup_next (addr);</span>
<span class='curline'><a href='../S/619.html#L367'>peer</a>              367 bgpd/bgp_snmp.c       if (peer == NULL)</span>
<span class='curline'><a href='../S/619.html#L373'>peer</a>              373 bgpd/bgp_snmp.c       return peer;</span>
<span class='curline'><a href='../S/619.html#L386'>peer</a>              386 bgpd/bgp_snmp.c   struct peer *peer;</span>
<span class='curline'><a href='../S/619.html#L407'>peer</a>              407 bgpd/bgp_snmp.c   peer = bgpPeerTable_lookup (v, name, &amp;length, &amp;addr, 1);</span>
<span class='curline'><a href='../S/619.html#L408'>peer</a>              408 bgpd/bgp_snmp.c   if (! peer)</span>
<span class='curline'><a href='../S/619.html#L420'>peer</a>              420 bgpd/bgp_snmp.c 	BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/619.html#L427'>peer</a>              427 bgpd/bgp_snmp.c       SET_FLAG (peer-&gt;config, PEER_CONFIG_CONNECT);</span>
<span class='curline'><a href='../S/619.html#L428'>peer</a>              428 bgpd/bgp_snmp.c       peer-&gt;connect = intval;</span>
<span class='curline'><a href='../S/619.html#L429'>peer</a>              429 bgpd/bgp_snmp.c       peer-&gt;v_connect = intval;</span>
<span class='curline'><a href='../S/619.html#L432'>peer</a>              432 bgpd/bgp_snmp.c       SET_FLAG (peer-&gt;config, PEER_CONFIG_TIMER);</span>
<span class='curline'><a href='../S/619.html#L433'>peer</a>              433 bgpd/bgp_snmp.c       peer-&gt;holdtime = intval;</span>
<span class='curline'><a href='../S/619.html#L434'>peer</a>              434 bgpd/bgp_snmp.c       peer-&gt;v_holdtime = intval;</span>
<span class='curline'><a href='../S/619.html#L437'>peer</a>              437 bgpd/bgp_snmp.c       SET_FLAG (peer-&gt;config, PEER_CONFIG_TIMER);</span>
<span class='curline'><a href='../S/619.html#L438'>peer</a>              438 bgpd/bgp_snmp.c       peer-&gt;keepalive = intval;</span>
<span class='curline'><a href='../S/619.html#L439'>peer</a>              439 bgpd/bgp_snmp.c       peer-&gt;v_keepalive = intval;</span>
<span class='curline'><a href='../S/619.html#L442'>peer</a>              442 bgpd/bgp_snmp.c       peer-&gt;v_asorig = intval;</span>
<span class='curline'><a href='../S/619.html#L445'>peer</a>              445 bgpd/bgp_snmp.c       peer-&gt;v_routeadv = intval;</span>
<span class='curline'><a href='../S/619.html#L456'>peer</a>              456 bgpd/bgp_snmp.c   struct peer *peer;</span>
<span class='curline'><a href='../S/619.html#L463'>peer</a>              463 bgpd/bgp_snmp.c   peer = bgpPeerTable_lookup (v, name, length, &amp;addr, exact);</span>
<span class='curline'><a href='../S/619.html#L464'>peer</a>              464 bgpd/bgp_snmp.c   if (! peer)</span>
<span class='curline'><a href='../S/619.html#L470'>peer</a>              470 bgpd/bgp_snmp.c       return SNMP_IPADDRESS (peer-&gt;remote_id);</span>
<span class='curline'><a href='../S/619.html#L473'>peer</a>              473 bgpd/bgp_snmp.c       return SNMP_INTEGER (peer-&gt;status);</span>
<span class='curline'><a href='../S/619.html#L479'>peer</a>              479 bgpd/bgp_snmp.c       if (CHECK_FLAG (peer-&gt;flags, PEER_FLAG_SHUTDOWN))</span>
<span class='curline'><a href='../S/619.html#L488'>peer</a>              488 bgpd/bgp_snmp.c       if (peer-&gt;su_local)</span>
<span class='curline'><a href='../S/619.html#L489'>peer</a>              489 bgpd/bgp_snmp.c 	return SNMP_IPADDRESS (peer-&gt;su_local-&gt;sin.sin_addr);</span>
<span class='curline'><a href='../S/619.html#L494'>peer</a>              494 bgpd/bgp_snmp.c       if (peer-&gt;su_local)</span>
<span class='curline'><a href='../S/619.html#L495'>peer</a>              495 bgpd/bgp_snmp.c 	return SNMP_INTEGER (ntohs (peer-&gt;su_local-&gt;sin.sin_port));</span>
<span class='curline'><a href='../S/619.html#L500'>peer</a>              500 bgpd/bgp_snmp.c       if (peer-&gt;su_remote)</span>
<span class='curline'><a href='../S/619.html#L501'>peer</a>              501 bgpd/bgp_snmp.c 	return SNMP_IPADDRESS (peer-&gt;su_remote-&gt;sin.sin_addr);</span>
<span class='curline'><a href='../S/619.html#L506'>peer</a>              506 bgpd/bgp_snmp.c       if (peer-&gt;su_remote)</span>
<span class='curline'><a href='../S/619.html#L507'>peer</a>              507 bgpd/bgp_snmp.c 	return SNMP_INTEGER (ntohs (peer-&gt;su_remote-&gt;sin.sin_port));</span>
<span class='curline'><a href='../S/619.html#L512'>peer</a>              512 bgpd/bgp_snmp.c       return SNMP_INTEGER (peer-&gt;as);</span>
<span class='curline'><a href='../S/619.html#L515'>peer</a>              515 bgpd/bgp_snmp.c       return SNMP_INTEGER (peer-&gt;update_in);</span>
<span class='curline'><a href='../S/619.html#L518'>peer</a>              518 bgpd/bgp_snmp.c       return SNMP_INTEGER (peer-&gt;update_out);</span>
<span class='curline'><a href='../S/619.html#L521'>peer</a>              521 bgpd/bgp_snmp.c       return SNMP_INTEGER (peer-&gt;open_in + peer-&gt;update_in</span>
<span class='curline'><a href='../S/619.html#L522'>peer</a>              522 bgpd/bgp_snmp.c 			   + peer-&gt;keepalive_in + peer-&gt;notify_in</span>
<span class='curline'><a href='../S/619.html#L523'>peer</a>              523 bgpd/bgp_snmp.c 			   + peer-&gt;refresh_in + peer-&gt;dynamic_cap_in);</span>
<span class='curline'><a href='../S/619.html#L526'>peer</a>              526 bgpd/bgp_snmp.c       return SNMP_INTEGER (peer-&gt;open_out + peer-&gt;update_out</span>
<span class='curline'><a href='../S/619.html#L527'>peer</a>              527 bgpd/bgp_snmp.c 			   + peer-&gt;keepalive_out + peer-&gt;notify_out</span>
<span class='curline'><a href='../S/619.html#L528'>peer</a>              528 bgpd/bgp_snmp.c 			   + peer-&gt;refresh_out + peer-&gt;dynamic_cap_out);</span>
<span class='curline'><a href='../S/619.html#L533'>peer</a>              533 bgpd/bgp_snmp.c 	lasterror[0] = peer-&gt;notify.code;</span>
<span class='curline'><a href='../S/619.html#L534'>peer</a>              534 bgpd/bgp_snmp.c 	lasterror[1] = peer-&gt;notify.subcode;</span>
<span class='curline'><a href='../S/619.html#L540'>peer</a>              540 bgpd/bgp_snmp.c       return SNMP_INTEGER (peer-&gt;established);</span>
<span class='curline'><a href='../S/619.html#L543'>peer</a>              543 bgpd/bgp_snmp.c       if (peer-&gt;uptime == 0)</span>
<span class='curline'><a href='../S/619.html#L546'>peer</a>              546 bgpd/bgp_snmp.c 	return SNMP_INTEGER (bgp_clock () - peer-&gt;uptime);</span>
<span class='curline'><a href='../S/619.html#L550'>peer</a>              550 bgpd/bgp_snmp.c       return SNMP_INTEGER (peer-&gt;v_connect);</span>
<span class='curline'><a href='../S/619.html#L553'>peer</a>              553 bgpd/bgp_snmp.c       return SNMP_INTEGER (peer-&gt;v_holdtime);</span>
<span class='curline'><a href='../S/619.html#L556'>peer</a>              556 bgpd/bgp_snmp.c       return SNMP_INTEGER (peer-&gt;v_keepalive);</span>
<span class='curline'><a href='../S/619.html#L560'>peer</a>              560 bgpd/bgp_snmp.c       if (CHECK_FLAG (peer-&gt;config, PEER_CONFIG_TIMER))</span>
<span class='curline'><a href='../S/619.html#L561'>peer</a>              561 bgpd/bgp_snmp.c 	return SNMP_INTEGER (peer-&gt;holdtime);</span>
<span class='curline'><a href='../S/619.html#L563'>peer</a>              563 bgpd/bgp_snmp.c 	return SNMP_INTEGER (peer-&gt;v_holdtime);</span>
<span class='curline'><a href='../S/619.html#L567'>peer</a>              567 bgpd/bgp_snmp.c       if (CHECK_FLAG (peer-&gt;config, PEER_CONFIG_TIMER))</span>
<span class='curline'><a href='../S/619.html#L568'>peer</a>              568 bgpd/bgp_snmp.c 	return SNMP_INTEGER (peer-&gt;keepalive);</span>
<span class='curline'><a href='../S/619.html#L570'>peer</a>              570 bgpd/bgp_snmp.c 	return SNMP_INTEGER (peer-&gt;v_keepalive);</span>
<span class='curline'><a href='../S/619.html#L574'>peer</a>              574 bgpd/bgp_snmp.c       return SNMP_INTEGER (peer-&gt;v_asorig);</span>
<span class='curline'><a href='../S/619.html#L578'>peer</a>              578 bgpd/bgp_snmp.c       return SNMP_INTEGER (peer-&gt;v_routeadv);</span>
<span class='curline'><a href='../S/619.html#L581'>peer</a>              581 bgpd/bgp_snmp.c       if (peer-&gt;update_time == 0)</span>
<span class='curline'><a href='../S/619.html#L584'>peer</a>              584 bgpd/bgp_snmp.c 	return SNMP_INTEGER (bgp_clock () - peer-&gt;update_time);</span>
<span class='curline'><a href='../S/619.html#L663'>peer</a>              663 bgpd/bgp_snmp.c 	    if (sockunion_same (&amp;binfo-&gt;peer-&gt;su, &amp;su))</span>
<span class='curline'><a href='../S/619.html#L717'>peer</a>              717 bgpd/bgp_snmp.c 	      if (binfo-&gt;peer-&gt;su.sin.sin_family == AF_INET</span>
<span class='curline'><a href='../S/619.html#L719'>peer</a>              719 bgpd/bgp_snmp.c 		  &lt; ntohl (binfo-&gt;peer-&gt;su.sin.sin_addr.s_addr))</span>
<span class='curline'><a href='../S/619.html#L723'>peer</a>              723 bgpd/bgp_snmp.c 		      if (ntohl (binfo-&gt;peer-&gt;su.sin.sin_addr.s_addr) </span>
<span class='curline'><a href='../S/619.html#L724'>peer</a>              724 bgpd/bgp_snmp.c 			  &lt; ntohl (min-&gt;peer-&gt;su.sin.sin_addr.s_addr))</span>
<span class='curline'><a href='../S/619.html#L741'>peer</a>              741 bgpd/bgp_snmp.c 	      oid_copy_addr (offset, &amp;min-&gt;peer-&gt;su.sin.sin_addr, </span>
<span class='curline'><a href='../S/619.html#L782'>peer</a>              782 bgpd/bgp_snmp.c       return SNMP_IPADDRESS (binfo-&gt;peer-&gt;su.sin.sin_addr);</span>
<span class='curline'><a href='../S/619.html#L847'>peer</a>              847 bgpd/bgp_snmp.c bgpTrapEstablished (struct peer *peer)</span>
<span class='curline'><a href='../S/619.html#L853'>peer</a>              853 bgpd/bgp_snmp.c   ret = inet_aton (peer-&gt;host, &amp;addr);</span>
<span class='curline'><a href='../S/619.html#L868'>peer</a>              868 bgpd/bgp_snmp.c bgpTrapBackwardTransition (struct peer *peer)</span>
<span class='curline'><a href='../S/619.html#L874'>peer</a>              874 bgpd/bgp_snmp.c   ret = inet_aton (peer-&gt;host, &amp;addr);</span>
<span class='curline'><a href='../S/611.html#L25'>peer</a>               25 bgpd/bgp_snmp.h extern void bgpTrapEstablished (struct peer *);</span>
<span class='curline'><a href='../S/611.html#L26'>peer</a>               26 bgpd/bgp_snmp.h extern void bgpTrapBackwardTransition (struct peer *);</span>
<span class='curline'><a href='../S/646.html#L43'>peer</a>               43 bgpd/bgp_table.h   struct peer *owner;</span>
<span class='curline'><a href='../S/638.html#L95'>peer</a>               95 bgpd/bgp_vty.c static struct peer *</span>
<span class='curline'><a href='../S/638.html#L101'>peer</a>              101 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L112'>peer</a>              112 bgpd/bgp_vty.c   peer = peer_lookup (bgp, &amp;su);</span>
<span class='curline'><a href='../S/638.html#L113'>peer</a>              113 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L118'>peer</a>              118 bgpd/bgp_vty.c   return peer;</span>
<span class='curline'><a href='../S/638.html#L122'>peer</a>              122 bgpd/bgp_vty.c static struct peer *</span>
<span class='curline'><a href='../S/638.html#L128'>peer</a>              128 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L136'>peer</a>              136 bgpd/bgp_vty.c       peer = peer_lookup (bgp, &amp;su);</span>
<span class='curline'><a href='../S/638.html#L137'>peer</a>              137 bgpd/bgp_vty.c       if (peer)</span>
<span class='curline'><a href='../S/638.html#L138'>peer</a>              138 bgpd/bgp_vty.c 	return peer;</span>
<span class='curline'><a href='../S/638.html#L1482'>peer</a>             1482 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L1498'>peer</a>             1498 bgpd/bgp_vty.c       peer = peer_lookup (vty-&gt;index, &amp;su);</span>
<span class='curline'><a href='../S/638.html#L1499'>peer</a>             1499 bgpd/bgp_vty.c       if (peer)</span>
<span class='curline'><a href='../S/638.html#L1500'>peer</a>             1500 bgpd/bgp_vty.c         peer_delete (peer);</span>
<span class='curline'><a href='../S/638.html#L1566'>peer</a>             1566 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L1569'>peer</a>             1569 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, argv[0]);</span>
<span class='curline'><a href='../S/638.html#L1570'>peer</a>             1570 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L1573'>peer</a>             1573 bgpd/bgp_vty.c   ret = peer_local_as_set (peer, atoi (argv[1]), 0, 0);</span>
<span class='curline'><a href='../S/638.html#L1586'>peer</a>             1586 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L1589'>peer</a>             1589 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, argv[0]);</span>
<span class='curline'><a href='../S/638.html#L1590'>peer</a>             1590 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L1593'>peer</a>             1593 bgpd/bgp_vty.c   ret = peer_local_as_set (peer, atoi (argv[1]), 1, 0);</span>
<span class='curline'><a href='../S/638.html#L1607'>peer</a>             1607 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L1610'>peer</a>             1610 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, argv[0]);</span>
<span class='curline'><a href='../S/638.html#L1611'>peer</a>             1611 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L1614'>peer</a>             1614 bgpd/bgp_vty.c   ret = peer_local_as_set (peer, atoi (argv[1]), 1, 1);</span>
<span class='curline'><a href='../S/638.html#L1627'>peer</a>             1627 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L1630'>peer</a>             1630 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, argv[0]);</span>
<span class='curline'><a href='../S/638.html#L1631'>peer</a>             1631 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L1634'>peer</a>             1634 bgpd/bgp_vty.c   ret = peer_local_as_unset (peer);</span>
<span class='curline'><a href='../S/638.html#L1676'>peer</a>             1676 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L1679'>peer</a>             1679 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, argv[0]);</span>
<span class='curline'><a href='../S/638.html#L1680'>peer</a>             1680 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L1683'>peer</a>             1683 bgpd/bgp_vty.c   ret = peer_password_set (peer, argv[1]);</span>
<span class='curline'><a href='../S/638.html#L1695'>peer</a>             1695 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L1698'>peer</a>             1698 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, argv[0]);</span>
<span class='curline'><a href='../S/638.html#L1699'>peer</a>             1699 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L1702'>peer</a>             1702 bgpd/bgp_vty.c   ret = peer_password_unset (peer);</span>
<span class='curline'><a href='../S/638.html#L1713'>peer</a>             1713 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L1715'>peer</a>             1715 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, argv[0]);</span>
<span class='curline'><a href='../S/638.html#L1716'>peer</a>             1716 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L1719'>peer</a>             1719 bgpd/bgp_vty.c   peer_activate (peer, bgp_node_afi (vty), bgp_node_safi (vty));</span>
<span class='curline'><a href='../S/638.html#L1733'>peer</a>             1733 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L1736'>peer</a>             1736 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, argv[0]);</span>
<span class='curline'><a href='../S/638.html#L1737'>peer</a>             1737 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L1740'>peer</a>             1740 bgpd/bgp_vty.c   ret = peer_deactivate (peer, bgp_node_afi (vty), bgp_node_safi (vty));</span>
<span class='curline'><a href='../S/638.html#L1805'>peer</a>             1805 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L1810'>peer</a>             1810 bgpd/bgp_vty.c   peer = peer_lookup_vty (vty, argv[0]);</span>
<span class='curline'><a href='../S/638.html#L1811'>peer</a>             1811 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L1821'>peer</a>             1821 bgpd/bgp_vty.c   ret = peer_group_unbind (bgp, peer, group, bgp_node_afi (vty),</span>
<span class='curline'><a href='../S/638.html#L1832'>peer</a>             1832 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L1834'>peer</a>             1834 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L1835'>peer</a>             1835 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L1839'>peer</a>             1839 bgpd/bgp_vty.c     ret = peer_flag_set (peer, flag);</span>
<span class='curline'><a href='../S/638.html#L1841'>peer</a>             1841 bgpd/bgp_vty.c     ret = peer_flag_unset (peer, flag);</span>
<span class='curline'><a href='../S/638.html#L1977'>peer</a>             1977 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L1979'>peer</a>             1979 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, peer_str);</span>
<span class='curline'><a href='../S/638.html#L1980'>peer</a>             1980 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L1984'>peer</a>             1984 bgpd/bgp_vty.c     ret = peer_af_flag_set (peer, afi, safi, flag);</span>
<span class='curline'><a href='../S/638.html#L1986'>peer</a>             1986 bgpd/bgp_vty.c     ret = peer_af_flag_unset (peer, afi, safi, flag);</span>
<span class='curline'><a href='../S/638.html#L2224'>peer</a>             2224 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L2227'>peer</a>             2227 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, argv[0]);</span>
<span class='curline'><a href='../S/638.html#L2228'>peer</a>             2228 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L2255'>peer</a>             2255 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L2264'>peer</a>             2264 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, peer_str);</span>
<span class='curline'><a href='../S/638.html#L2265'>peer</a>             2265 bgpd/bgp_vty.c   if ( ! peer )</span>
<span class='curline'><a href='../S/638.html#L2269'>peer</a>             2269 bgpd/bgp_vty.c   if ( CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_RSERVER_CLIENT) )</span>
<span class='curline'><a href='../S/638.html#L2272'>peer</a>             2272 bgpd/bgp_vty.c   if ( ! peer_rsclient_active (peer) )</span>
<span class='curline'><a href='../S/638.html#L2274'>peer</a>             2274 bgpd/bgp_vty.c       peer = peer_lock (peer); /* rsclient peer list reference */</span>
<span class='curline'><a href='../S/638.html#L2275'>peer</a>             2275 bgpd/bgp_vty.c       listnode_add_sort (bgp-&gt;rsclient, peer);</span>
<span class='curline'><a href='../S/638.html#L2279'>peer</a>             2279 bgpd/bgp_vty.c   ret = peer_af_flag_set (peer, afi, safi, PEER_FLAG_RSERVER_CLIENT);</span>
<span class='curline'><a href='../S/638.html#L2284'>peer</a>             2284 bgpd/bgp_vty.c           listnode_delete (bgp-&gt;rsclient, peer);</span>
<span class='curline'><a href='../S/638.html#L2285'>peer</a>             2285 bgpd/bgp_vty.c           peer_unlock (peer); /* rsclient peer list reference */</span>
<span class='curline'><a href='../S/638.html#L2291'>peer</a>             2291 bgpd/bgp_vty.c   peer-&gt;rib[afi][safi] = bgp_table_init (afi, safi);</span>
<span class='curline'><a href='../S/638.html#L2292'>peer</a>             2292 bgpd/bgp_vty.c   peer-&gt;rib[afi][safi]-&gt;type = BGP_TABLE_RSCLIENT;</span>
<span class='curline'><a href='../S/638.html#L2294'>peer</a>             2294 bgpd/bgp_vty.c   peer-&gt;rib[afi][safi]-&gt;owner = peer_lock (peer);</span>
<span class='curline'><a href='../S/638.html#L2297'>peer</a>             2297 bgpd/bgp_vty.c   bgp_check_local_routes_rsclient (peer, afi, safi);</span>
<span class='curline'><a href='../S/638.html#L2300'>peer</a>             2300 bgpd/bgp_vty.c   bgp_soft_reconfig_rsclient (peer, afi, safi);</span>
<span class='curline'><a href='../S/638.html#L2302'>peer</a>             2302 bgpd/bgp_vty.c   if (CHECK_FLAG(peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/638.html#L2304'>peer</a>             2304 bgpd/bgp_vty.c       group = peer-&gt;group;</span>
<span class='curline'><a href='../S/638.html#L2305'>peer</a>             2305 bgpd/bgp_vty.c       gfilter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/638.html#L2307'>peer</a>             2307 bgpd/bgp_vty.c       for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/638.html#L2309'>peer</a>             2309 bgpd/bgp_vty.c           pfilter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/638.html#L2313'>peer</a>             2313 bgpd/bgp_vty.c           ret = peer_af_flag_set (peer, afi, safi, PEER_FLAG_RSERVER_CLIENT);</span>
<span class='curline'><a href='../S/638.html#L2318'>peer</a>             2318 bgpd/bgp_vty.c           peer-&gt;rib[afi][safi] = group-&gt;conf-&gt;rib[afi][safi];</span>
<span class='curline'><a href='../S/638.html#L2351'>peer</a>             2351 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L2357'>peer</a>             2357 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, peer_str);</span>
<span class='curline'><a href='../S/638.html#L2358'>peer</a>             2358 bgpd/bgp_vty.c   if ( ! peer )</span>
<span class='curline'><a href='../S/638.html#L2362'>peer</a>             2362 bgpd/bgp_vty.c   if ( ! CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_RSERVER_CLIENT) )</span>
<span class='curline'><a href='../S/638.html#L2365'>peer</a>             2365 bgpd/bgp_vty.c   if (CHECK_FLAG(peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/638.html#L2367'>peer</a>             2367 bgpd/bgp_vty.c       group = peer-&gt;group;</span>
<span class='curline'><a href='../S/638.html#L2369'>peer</a>             2369 bgpd/bgp_vty.c       for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/638.html#L2371'>peer</a>             2371 bgpd/bgp_vty.c           ret = peer_af_flag_unset (peer, afi, safi, PEER_FLAG_RSERVER_CLIENT);</span>
<span class='curline'><a href='../S/638.html#L2375'>peer</a>             2375 bgpd/bgp_vty.c           peer-&gt;rib[afi][safi] = NULL;</span>
<span class='curline'><a href='../S/638.html#L2378'>peer</a>             2378 bgpd/bgp_vty.c         peer = group-&gt;conf;</span>
<span class='curline'><a href='../S/638.html#L2381'>peer</a>             2381 bgpd/bgp_vty.c   ret = peer_af_flag_unset (peer, afi, safi, PEER_FLAG_RSERVER_CLIENT);</span>
<span class='curline'><a href='../S/638.html#L2385'>peer</a>             2385 bgpd/bgp_vty.c   if ( ! peer_rsclient_active (peer) )</span>
<span class='curline'><a href='../S/638.html#L2387'>peer</a>             2387 bgpd/bgp_vty.c       bgp_clear_route (peer, afi, safi, BGP_CLEAR_ROUTE_MY_RSCLIENT);</span>
<span class='curline'><a href='../S/638.html#L2388'>peer</a>             2388 bgpd/bgp_vty.c       listnode_delete (bgp-&gt;rsclient, peer);</span>
<span class='curline'><a href='../S/638.html#L2389'>peer</a>             2389 bgpd/bgp_vty.c       peer_unlock (peer); /* peer bgp rsclient reference */</span>
<span class='curline'><a href='../S/638.html#L2392'>peer</a>             2392 bgpd/bgp_vty.c   bgp_table_finish (&amp;peer-&gt;rib[bgp_node_afi(vty)][bgp_node_safi(vty)]);</span>
<span class='curline'><a href='../S/638.html#L2810'>peer</a>             2810 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L2813'>peer</a>             2813 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L2814'>peer</a>             2814 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L2822'>peer</a>             2822 bgpd/bgp_vty.c   return bgp_vty_return (vty,  peer_ebgp_multihop_set (peer, ttl));</span>
<span class='curline'><a href='../S/638.html#L2828'>peer</a>             2828 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L2830'>peer</a>             2830 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L2831'>peer</a>             2831 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L2834'>peer</a>             2834 bgpd/bgp_vty.c   return bgp_vty_return (vty, peer_ebgp_multihop_unset (peer));</span>
<span class='curline'><a href='../S/638.html#L2926'>peer</a>             2926 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L2929'>peer</a>             2929 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, argv[0]);</span>
<span class='curline'><a href='../S/638.html#L2930'>peer</a>             2930 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L2938'>peer</a>             2938 bgpd/bgp_vty.c   peer_description_set (peer, str);</span>
<span class='curline'><a href='../S/638.html#L2953'>peer</a>             2953 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L2955'>peer</a>             2955 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, argv[0]);</span>
<span class='curline'><a href='../S/638.html#L2956'>peer</a>             2956 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L2959'>peer</a>             2959 bgpd/bgp_vty.c   peer_description_unset (peer);</span>
<span class='curline'><a href='../S/638.html#L2978'>peer</a>             2978 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L2980'>peer</a>             2980 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, peer_str);</span>
<span class='curline'><a href='../S/638.html#L2981'>peer</a>             2981 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L2990'>peer</a>             2990 bgpd/bgp_vty.c 	peer_update_source_addr_set (peer, &amp;su);</span>
<span class='curline'><a href='../S/638.html#L2992'>peer</a>             2992 bgpd/bgp_vty.c 	peer_update_source_if_set (peer, source_str);</span>
<span class='curline'><a href='../S/638.html#L2995'>peer</a>             2995 bgpd/bgp_vty.c     peer_update_source_unset (peer);</span>
<span class='curline'><a href='../S/638.html#L3034'>peer</a>             3034 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3036'>peer</a>             3036 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, peer_str);</span>
<span class='curline'><a href='../S/638.html#L3037'>peer</a>             3037 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3041'>peer</a>             3041 bgpd/bgp_vty.c     ret = peer_default_originate_set (peer, afi, safi, rmap);</span>
<span class='curline'><a href='../S/638.html#L3043'>peer</a>             3043 bgpd/bgp_vty.c     ret = peer_default_originate_unset (peer, afi, safi);</span>
<span class='curline'><a href='../S/638.html#L3100'>peer</a>             3100 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3104'>peer</a>             3104 bgpd/bgp_vty.c   peer = peer_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3105'>peer</a>             3105 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3118'>peer</a>             3118 bgpd/bgp_vty.c   peer_port_set (peer, port);</span>
<span class='curline'><a href='../S/638.html#L3161'>peer</a>             3161 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3164'>peer</a>             3164 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3165'>peer</a>             3165 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3170'>peer</a>             3170 bgpd/bgp_vty.c   ret = peer_weight_set (peer, weight);</span>
<span class='curline'><a href='../S/638.html#L3178'>peer</a>             3178 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3180'>peer</a>             3180 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3181'>peer</a>             3181 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3184'>peer</a>             3184 bgpd/bgp_vty.c   peer_weight_unset (peer);</span>
<span class='curline'><a href='../S/638.html#L3268'>peer</a>             3268 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3272'>peer</a>             3272 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3273'>peer</a>             3273 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3279'>peer</a>             3279 bgpd/bgp_vty.c   ret = peer_timers_set (peer, keepalive, holdtime);</span>
<span class='curline'><a href='../S/638.html#L3288'>peer</a>             3288 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3290'>peer</a>             3290 bgpd/bgp_vty.c   peer = peer_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3291'>peer</a>             3291 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3294'>peer</a>             3294 bgpd/bgp_vty.c   ret = peer_timers_unset (peer);</span>
<span class='curline'><a href='../S/638.html#L3327'>peer</a>             3327 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3330'>peer</a>             3330 bgpd/bgp_vty.c   peer = peer_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3331'>peer</a>             3331 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3336'>peer</a>             3336 bgpd/bgp_vty.c   ret = peer_timers_connect_set (peer, connect);</span>
<span class='curline'><a href='../S/638.html#L3345'>peer</a>             3345 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3347'>peer</a>             3347 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3348'>peer</a>             3348 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3351'>peer</a>             3351 bgpd/bgp_vty.c   ret = peer_timers_connect_unset (peer);</span>
<span class='curline'><a href='../S/638.html#L3395'>peer</a>             3395 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3398'>peer</a>             3398 bgpd/bgp_vty.c   peer = peer_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3399'>peer</a>             3399 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3406'>peer</a>             3406 bgpd/bgp_vty.c     ret = peer_advertise_interval_set (peer, routeadv);</span>
<span class='curline'><a href='../S/638.html#L3408'>peer</a>             3408 bgpd/bgp_vty.c     ret = peer_advertise_interval_unset (peer);</span>
<span class='curline'><a href='../S/638.html#L3449'>peer</a>             3449 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3451'>peer</a>             3451 bgpd/bgp_vty.c   peer = peer_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3452'>peer</a>             3452 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3456'>peer</a>             3456 bgpd/bgp_vty.c     ret = peer_interface_set (peer, str);</span>
<span class='curline'><a href='../S/638.html#L3458'>peer</a>             3458 bgpd/bgp_vty.c     ret = peer_interface_unset (peer);</span>
<span class='curline'><a href='../S/638.html#L3493'>peer</a>             3493 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3496'>peer</a>             3496 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3497'>peer</a>             3497 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3506'>peer</a>             3506 bgpd/bgp_vty.c   ret = peer_distribute_set (peer, afi, safi, direct, name_str);</span>
<span class='curline'><a href='../S/638.html#L3516'>peer</a>             3516 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3519'>peer</a>             3519 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3520'>peer</a>             3520 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3529'>peer</a>             3529 bgpd/bgp_vty.c   ret = peer_distribute_unset (peer, afi, safi, direct);</span>
<span class='curline'><a href='../S/638.html#L3574'>peer</a>             3574 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3577'>peer</a>             3577 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3578'>peer</a>             3578 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3587'>peer</a>             3587 bgpd/bgp_vty.c   ret = peer_prefix_list_set (peer, afi, safi, direct, name_str);</span>
<span class='curline'><a href='../S/638.html#L3597'>peer</a>             3597 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3600'>peer</a>             3600 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3601'>peer</a>             3601 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3610'>peer</a>             3610 bgpd/bgp_vty.c   ret = peer_prefix_list_unset (peer, afi, safi, direct);</span>
<span class='curline'><a href='../S/638.html#L3650'>peer</a>             3650 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3653'>peer</a>             3653 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3654'>peer</a>             3654 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3663'>peer</a>             3663 bgpd/bgp_vty.c   ret = peer_aslist_set (peer, afi, safi, direct, name_str);</span>
<span class='curline'><a href='../S/638.html#L3674'>peer</a>             3674 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3677'>peer</a>             3677 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3678'>peer</a>             3678 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3687'>peer</a>             3687 bgpd/bgp_vty.c   ret = peer_aslist_unset (peer, afi, safi, direct);</span>
<span class='curline'><a href='../S/638.html#L3728'>peer</a>             3728 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3731'>peer</a>             3731 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3732'>peer</a>             3732 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3745'>peer</a>             3745 bgpd/bgp_vty.c   ret = peer_route_map_set (peer, afi, safi, direct, name_str);</span>
<span class='curline'><a href='../S/638.html#L3755'>peer</a>             3755 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3758'>peer</a>             3758 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3759'>peer</a>             3759 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3772'>peer</a>             3772 bgpd/bgp_vty.c   ret = peer_route_map_unset (peer, afi, safi, direct);</span>
<span class='curline'><a href='../S/638.html#L3816'>peer</a>             3816 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3818'>peer</a>             3818 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3819'>peer</a>             3819 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3822'>peer</a>             3822 bgpd/bgp_vty.c   ret = peer_unsuppress_map_set (peer, afi, safi, name_str);</span>
<span class='curline'><a href='../S/638.html#L3833'>peer</a>             3833 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3835'>peer</a>             3835 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3836'>peer</a>             3836 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3839'>peer</a>             3839 bgpd/bgp_vty.c   ret = peer_unsuppress_map_unset (peer, afi, safi);</span>
<span class='curline'><a href='../S/638.html#L3876'>peer</a>             3876 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3881'>peer</a>             3881 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3882'>peer</a>             3882 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3896'>peer</a>             3896 bgpd/bgp_vty.c   ret = peer_maximum_prefix_set (peer, afi, safi, max, threshold, warning, restart);</span>
<span class='curline'><a href='../S/638.html#L3906'>peer</a>             3906 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L3908'>peer</a>             3908 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, ip_str);</span>
<span class='curline'><a href='../S/638.html#L3909'>peer</a>             3909 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L3912'>peer</a>             3912 bgpd/bgp_vty.c   ret = peer_maximum_prefix_unset (peer, afi, safi);</span>
<span class='curline'><a href='../S/638.html#L4088'>peer</a>             4088 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L4091'>peer</a>             4091 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, argv[0]);</span>
<span class='curline'><a href='../S/638.html#L4092'>peer</a>             4092 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L4100'>peer</a>             4100 bgpd/bgp_vty.c   ret = peer_allowas_in_set (peer, bgp_node_afi (vty), bgp_node_safi (vty),</span>
<span class='curline'><a href='../S/638.html#L4123'>peer</a>             4123 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L4125'>peer</a>             4125 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, argv[0]);</span>
<span class='curline'><a href='../S/638.html#L4126'>peer</a>             4126 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L4129'>peer</a>             4129 bgpd/bgp_vty.c   ret = peer_allowas_in_unset (peer, bgp_node_afi (vty), bgp_node_safi (vty));</span>
<span class='curline'><a href='../S/638.html#L4141'>peer</a>             4141 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L4144'>peer</a>             4144 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, argv[0]);</span>
<span class='curline'><a href='../S/638.html#L4145'>peer</a>             4145 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L4150'>peer</a>             4150 bgpd/bgp_vty.c   return bgp_vty_return (vty, peer_ttl_security_hops_set (peer, gtsm_hops));</span>
<span class='curline'><a href='../S/638.html#L4161'>peer</a>             4161 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L4163'>peer</a>             4163 bgpd/bgp_vty.c   peer = peer_and_group_lookup_vty (vty, argv[0]);</span>
<span class='curline'><a href='../S/638.html#L4164'>peer</a>             4164 bgpd/bgp_vty.c   if (! peer)</span>
<span class='curline'><a href='../S/638.html#L4167'>peer</a>             4167 bgpd/bgp_vty.c   return bgp_vty_return (vty, peer_ttl_security_hops_unset (peer));</span>
<span class='curline'><a href='../S/638.html#L4265'>peer</a>             4265 bgpd/bgp_vty.c bgp_clear_vty_error (struct vty *vty, struct peer *peer, afi_t afi,</span>
<span class='curline'><a href='../S/638.html#L4275'>peer</a>             4275 bgpd/bgp_vty.c 	       peer-&gt;host, VTY_NEWLINE);</span>
<span class='curline'><a href='../S/638.html#L4278'>peer</a>             4278 bgpd/bgp_vty.c       vty_out (vty, "%%BGP: Inbound soft reconfig for %s not possible as it%s      has neither refresh capability, nor inbound soft reconfig%s", peer-&gt;host, VTY_NEWLINE, VTY_NEWLINE);</span>
<span class='curline'><a href='../S/638.html#L4291'>peer</a>             4291 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L4297'>peer</a>             4297 bgpd/bgp_vty.c       for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/638.html#L4300'>peer</a>             4300 bgpd/bgp_vty.c 	    ret = peer_clear (peer);</span>
<span class='curline'><a href='../S/638.html#L4302'>peer</a>             4302 bgpd/bgp_vty.c 	    ret = peer_clear_soft (peer, afi, safi, stype);</span>
<span class='curline'><a href='../S/638.html#L4305'>peer</a>             4305 bgpd/bgp_vty.c 	    bgp_clear_vty_error (vty, peer, afi, safi, ret);</span>
<span class='curline'><a href='../S/638.html#L4323'>peer</a>             4323 bgpd/bgp_vty.c       peer = peer_lookup (bgp, &amp;su);</span>
<span class='curline'><a href='../S/638.html#L4324'>peer</a>             4324 bgpd/bgp_vty.c       if (! peer)</span>
<span class='curline'><a href='../S/638.html#L4331'>peer</a>             4331 bgpd/bgp_vty.c 	ret = peer_clear (peer);</span>
<span class='curline'><a href='../S/638.html#L4333'>peer</a>             4333 bgpd/bgp_vty.c 	ret = peer_clear_soft (peer, afi, safi, stype);</span>
<span class='curline'><a href='../S/638.html#L4336'>peer</a>             4336 bgpd/bgp_vty.c 	bgp_clear_vty_error (vty, peer, afi, safi, ret);</span>
<span class='curline'><a href='../S/638.html#L4353'>peer</a>             4353 bgpd/bgp_vty.c       for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/638.html#L4357'>peer</a>             4357 bgpd/bgp_vty.c 	      ret = peer_clear (peer);</span>
<span class='curline'><a href='../S/638.html#L4361'>peer</a>             4361 bgpd/bgp_vty.c 	  if (! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/638.html#L4364'>peer</a>             4364 bgpd/bgp_vty.c 	  ret = peer_clear_soft (peer, afi, safi, stype);</span>
<span class='curline'><a href='../S/638.html#L4367'>peer</a>             4367 bgpd/bgp_vty.c 	    bgp_clear_vty_error (vty, peer, afi, safi, ret);</span>
<span class='curline'><a href='../S/638.html#L4374'>peer</a>             4374 bgpd/bgp_vty.c       for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/638.html#L4376'>peer</a>             4376 bgpd/bgp_vty.c 	  if (peer-&gt;sort == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/638.html#L4380'>peer</a>             4380 bgpd/bgp_vty.c 	    ret = peer_clear (peer);</span>
<span class='curline'><a href='../S/638.html#L4382'>peer</a>             4382 bgpd/bgp_vty.c 	    ret = peer_clear_soft (peer, afi, safi, stype);</span>
<span class='curline'><a href='../S/638.html#L4385'>peer</a>             4385 bgpd/bgp_vty.c 	    bgp_clear_vty_error (vty, peer, afi, safi, ret);</span>
<span class='curline'><a href='../S/638.html#L4397'>peer</a>             4397 bgpd/bgp_vty.c       for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/638.html#L4399'>peer</a>             4399 bgpd/bgp_vty.c 	  if (peer-&gt;as != as) </span>
<span class='curline'><a href='../S/638.html#L4404'>peer</a>             4404 bgpd/bgp_vty.c 	    ret = peer_clear (peer);</span>
<span class='curline'><a href='../S/638.html#L4406'>peer</a>             4406 bgpd/bgp_vty.c 	    ret = peer_clear_soft (peer, afi, safi, stype);</span>
<span class='curline'><a href='../S/638.html#L4409'>peer</a>             4409 bgpd/bgp_vty.c 	    bgp_clear_vty_error (vty, peer, afi, safi, ret);</span>
<span class='curline'><a href='../S/638.html#L6864'>peer</a>             6864 bgpd/bgp_vty.c                          count * sizeof (struct peer)),</span>
<span class='curline'><a href='../S/638.html#L6896'>peer</a>             6896 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L6905'>peer</a>             6905 bgpd/bgp_vty.c   for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/638.html#L6907'>peer</a>             6907 bgpd/bgp_vty.c       if (peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/638.html#L6926'>peer</a>             6926 bgpd/bgp_vty.c               ents = listcount (bgp-&gt;peer);</span>
<span class='curline'><a href='../S/638.html#L6930'>peer</a>             6930 bgpd/bgp_vty.c                                      ents * sizeof (struct peer)),</span>
<span class='curline'><a href='../S/638.html#L6937'>peer</a>             6937 bgpd/bgp_vty.c                                        ents * sizeof (struct peer)),</span>
<span class='curline'><a href='../S/638.html#L6954'>peer</a>             6954 bgpd/bgp_vty.c 	  len = vty_out (vty, "%s", peer-&gt;host);</span>
<span class='curline'><a href='../S/638.html#L6964'>peer</a>             6964 bgpd/bgp_vty.c 		   peer-&gt;as,</span>
<span class='curline'><a href='../S/638.html#L6965'>peer</a>             6965 bgpd/bgp_vty.c 		   peer-&gt;open_in + peer-&gt;update_in + peer-&gt;keepalive_in</span>
<span class='curline'><a href='../S/638.html#L6966'>peer</a>             6966 bgpd/bgp_vty.c 		   + peer-&gt;notify_in + peer-&gt;refresh_in + peer-&gt;dynamic_cap_in,</span>
<span class='curline'><a href='../S/638.html#L6967'>peer</a>             6967 bgpd/bgp_vty.c 		   peer-&gt;open_out + peer-&gt;update_out + peer-&gt;keepalive_out</span>
<span class='curline'><a href='../S/638.html#L6968'>peer</a>             6968 bgpd/bgp_vty.c 		   + peer-&gt;notify_out + peer-&gt;refresh_out</span>
<span class='curline'><a href='../S/638.html#L6969'>peer</a>             6969 bgpd/bgp_vty.c 		   + peer-&gt;dynamic_cap_out,</span>
<span class='curline'><a href='../S/638.html#L6970'>peer</a>             6970 bgpd/bgp_vty.c 		   0, 0, (unsigned long) peer-&gt;obuf-&gt;count);</span>
<span class='curline'><a href='../S/638.html#L6973'>peer</a>             6973 bgpd/bgp_vty.c 		   peer_uptime (peer-&gt;uptime, timebuf, BGP_UPTIME_LEN));</span>
<span class='curline'><a href='../S/638.html#L6975'>peer</a>             6975 bgpd/bgp_vty.c 	  if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/638.html#L6977'>peer</a>             6977 bgpd/bgp_vty.c 	      vty_out (vty, " %8ld", peer-&gt;pcount[afi][safi]);</span>
<span class='curline'><a href='../S/638.html#L6981'>peer</a>             6981 bgpd/bgp_vty.c 	      if (CHECK_FLAG (peer-&gt;flags, PEER_FLAG_SHUTDOWN))</span>
<span class='curline'><a href='../S/638.html#L6983'>peer</a>             6983 bgpd/bgp_vty.c 	      else if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_PREFIX_OVERFLOW))</span>
<span class='curline'><a href='../S/638.html#L6986'>peer</a>             6986 bgpd/bgp_vty.c 		vty_out (vty, " %-11s", LOOKUP(bgp_status_msg, peer-&gt;status));</span>
<span class='curline'><a href='../S/638.html#L7275'>peer</a>             7275 bgpd/bgp_vty.c bgp_show_peer_afi_orf_cap (struct vty *vty, struct peer *p,</span>
<span class='curline'><a href='../S/638.html#L7310'>peer</a>             7310 bgpd/bgp_vty.c bgp_show_peer_afi (struct vty *vty, struct peer *p, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/638.html#L7517'>peer</a>             7517 bgpd/bgp_vty.c bgp_show_peer (struct vty *vty, struct peer *p)</span>
<span class='curline'><a href='../S/638.html#L7891'>peer</a>             7891 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L7894'>peer</a>             7894 bgpd/bgp_vty.c   for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/638.html#L7899'>peer</a>             7899 bgpd/bgp_vty.c 	  bgp_show_peer (vty, peer);</span>
<span class='curline'><a href='../S/638.html#L7902'>peer</a>             7902 bgpd/bgp_vty.c 	  if (sockunion_same (&amp;peer-&gt;su, su))</span>
<span class='curline'><a href='../S/638.html#L7905'>peer</a>             7905 bgpd/bgp_vty.c 	      bgp_show_peer (vty, peer);</span>
<span class='curline'><a href='../S/638.html#L8231'>peer</a>             8231 bgpd/bgp_vty.c bgp_write_rsclient_summary (struct vty *vty, struct peer *rsclient,</span>
<span class='curline'><a href='../S/638.html#L8237'>peer</a>             8237 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L8244'>peer</a>             8244 bgpd/bgp_vty.c       for (ALL_LIST_ELEMENTS (rsclient-&gt;group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/638.html#L8247'>peer</a>             8247 bgpd/bgp_vty.c           bgp_write_rsclient_summary (vty, peer, afi, safi);</span>
<span class='curline'><a href='../S/638.html#L8302'>peer</a>             8302 bgpd/bgp_vty.c   struct peer *peer;</span>
<span class='curline'><a href='../S/638.html#L8309'>peer</a>             8309 bgpd/bgp_vty.c   for (ALL_LIST_ELEMENTS (bgp-&gt;rsclient, node, nnode, peer))</span>
<span class='curline'><a href='../S/638.html#L8311'>peer</a>             8311 bgpd/bgp_vty.c       if (peer-&gt;afc[afi][safi] &amp;&amp;</span>
<span class='curline'><a href='../S/638.html#L8312'>peer</a>             8312 bgpd/bgp_vty.c          CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_RSERVER_CLIENT))</span>
<span class='curline'><a href='../S/638.html#L8327'>peer</a>             8327 bgpd/bgp_vty.c          count += bgp_write_rsclient_summary (vty, peer, afi, safi);</span>
<span class='curline'><a href='../S/654.html#L154'>peer</a>              154 bgpd/bgp_zebra.c     struct peer *peer;</span>
<span class='curline'><a href='../S/654.html#L162'>peer</a>              162 bgpd/bgp_zebra.c 	for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/654.html#L164'>peer</a>              164 bgpd/bgp_zebra.c 	    if (peer-&gt;ttl != 1)</span>
<span class='curline'><a href='../S/654.html#L167'>peer</a>              167 bgpd/bgp_zebra.c 	    if (peer-&gt;su.sa.sa_family == AF_INET)</span>
<span class='curline'><a href='../S/654.html#L168'>peer</a>              168 bgpd/bgp_zebra.c 	      peer_if = if_lookup_by_ipv4 (&amp;peer-&gt;su.sin.sin_addr);</span>
<span class='curline'><a href='../S/654.html#L173'>peer</a>              173 bgpd/bgp_zebra.c 	      BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/654.html#L539'>peer</a>              539 bgpd/bgp_zebra.c 		 struct bgp_nexthop *nexthop, struct peer *peer)</span>
<span class='curline'><a href='../S/654.html#L561'>peer</a>              561 bgpd/bgp_zebra.c 	  if (peer-&gt;ifname)</span>
<span class='curline'><a href='../S/654.html#L562'>peer</a>              562 bgpd/bgp_zebra.c 	    ifp = if_lookup_by_index (if_nametoindex (peer-&gt;ifname));</span>
<span class='curline'><a href='../S/654.html#L596'>peer</a>              596 bgpd/bgp_zebra.c       if (peer-&gt;local_id.s_addr)</span>
<span class='curline'><a href='../S/654.html#L597'>peer</a>              597 bgpd/bgp_zebra.c 	nexthop-&gt;v4 = peer-&gt;local_id;</span>
<span class='curline'><a href='../S/654.html#L628'>peer</a>              628 bgpd/bgp_zebra.c     peer-&gt;shared_network = 1;</span>
<span class='curline'><a href='../S/654.html#L630'>peer</a>              630 bgpd/bgp_zebra.c     peer-&gt;shared_network = 0;</span>
<span class='curline'><a href='../S/654.html#L654'>peer</a>              654 bgpd/bgp_zebra.c   struct peer *peer;</span>
<span class='curline'><a href='../S/654.html#L665'>peer</a>              665 bgpd/bgp_zebra.c   peer = info-&gt;peer;</span>
<span class='curline'><a href='../S/654.html#L667'>peer</a>              667 bgpd/bgp_zebra.c   if (peer-&gt;sort == BGP_PEER_IBGP || peer-&gt;sort == BGP_PEER_CONFED)</span>
<span class='curline'><a href='../S/654.html#L673'>peer</a>              673 bgpd/bgp_zebra.c   if ((peer-&gt;sort == BGP_PEER_EBGP &amp;&amp; peer-&gt;ttl != 1)</span>
<span class='curline'><a href='../S/654.html#L674'>peer</a>              674 bgpd/bgp_zebra.c       || CHECK_FLAG (peer-&gt;flags, PEER_FLAG_DISABLE_CONNECTED_CHECK))</span>
<span class='curline'><a href='../S/654.html#L766'>peer</a>              766 bgpd/bgp_zebra.c 	      &amp;&amp; peer-&gt;su_remote-&gt;sa.sa_family == AF_INET6)</span>
<span class='curline'><a href='../S/654.html#L767'>peer</a>              767 bgpd/bgp_zebra.c 	    nexthop = &amp;peer-&gt;su_remote-&gt;sin6.sin6_addr;</span>
<span class='curline'><a href='../S/654.html#L771'>peer</a>              771 bgpd/bgp_zebra.c 	  if (info-&gt;peer-&gt;nexthop.ifp)</span>
<span class='curline'><a href='../S/654.html#L772'>peer</a>              772 bgpd/bgp_zebra.c 	    ifindex = info-&gt;peer-&gt;nexthop.ifp-&gt;ifindex;</span>
<span class='curline'><a href='../S/654.html#L780'>peer</a>              780 bgpd/bgp_zebra.c 	  if (info-&gt;peer-&gt;ifname)</span>
<span class='curline'><a href='../S/654.html#L781'>peer</a>              781 bgpd/bgp_zebra.c 	    ifindex = if_nametoindex (info-&gt;peer-&gt;ifname);</span>
<span class='curline'><a href='../S/654.html#L782'>peer</a>              782 bgpd/bgp_zebra.c 	  else if (info-&gt;peer-&gt;nexthop.ifp)</span>
<span class='curline'><a href='../S/654.html#L783'>peer</a>              783 bgpd/bgp_zebra.c 	    ifindex = info-&gt;peer-&gt;nexthop.ifp-&gt;ifindex;</span>
<span class='curline'><a href='../S/654.html#L820'>peer</a>              820 bgpd/bgp_zebra.c   struct peer *peer;</span>
<span class='curline'><a href='../S/654.html#L828'>peer</a>              828 bgpd/bgp_zebra.c   peer = info-&gt;peer;</span>
<span class='curline'><a href='../S/654.html#L831'>peer</a>              831 bgpd/bgp_zebra.c   if (peer-&gt;sort == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/654.html#L837'>peer</a>              837 bgpd/bgp_zebra.c   if ((peer-&gt;sort == BGP_PEER_EBGP &amp;&amp; peer-&gt;ttl != 1)</span>
<span class='curline'><a href='../S/654.html#L838'>peer</a>              838 bgpd/bgp_zebra.c       || CHECK_FLAG (peer-&gt;flags, PEER_FLAG_DISABLE_CONNECTED_CHECK))</span>
<span class='curline'><a href='../S/654.html#L893'>peer</a>              893 bgpd/bgp_zebra.c 	  if (info-&gt;peer-&gt;nexthop.ifp)</span>
<span class='curline'><a href='../S/654.html#L894'>peer</a>              894 bgpd/bgp_zebra.c 	    ifindex = info-&gt;peer-&gt;nexthop.ifp-&gt;ifindex;</span>
<span class='curline'><a href='../S/654.html#L901'>peer</a>              901 bgpd/bgp_zebra.c 	if (info-&gt;peer-&gt;ifname)</span>
<span class='curline'><a href='../S/654.html#L902'>peer</a>              902 bgpd/bgp_zebra.c 	  ifindex = if_nametoindex (info-&gt;peer-&gt;ifname);</span>
<span class='curline'><a href='../S/610.html#L163'>peer</a>              163 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L174'>peer</a>              174 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L176'>peer</a>              176 bgpd/bgpd.c          IPV4_ADDR_COPY (&amp;peer-&gt;local_id, id);</span>
<span class='curline'><a href='../S/610.html#L178'>peer</a>              178 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L180'>peer</a>              180 bgpd/bgpd.c             peer-&gt;last_reset = PEER_DOWN_RID_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L181'>peer</a>              181 bgpd/bgpd.c             bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L192'>peer</a>              192 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L203'>peer</a>              203 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L205'>peer</a>              205 bgpd/bgpd.c          if (peer-&gt;sort != BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L208'>peer</a>              208 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L210'>peer</a>              210 bgpd/bgpd.c             peer-&gt;last_reset = PEER_DOWN_CLID_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L211'>peer</a>              211 bgpd/bgpd.c             bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L221'>peer</a>              221 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L231'>peer</a>              231 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L233'>peer</a>              233 bgpd/bgpd.c          if (peer-&gt;sort != BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L236'>peer</a>              236 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L238'>peer</a>              238 bgpd/bgpd.c             peer-&gt;last_reset = PEER_DOWN_CLID_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L239'>peer</a>              239 bgpd/bgpd.c             bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L281'>peer</a>              281 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L296'>peer</a>              296 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L302'>peer</a>              302 bgpd/bgpd.c    	  if (peer_sort (peer) == BGP_PEER_EBGP)</span>
<span class='curline'><a href='../S/610.html#L304'>peer</a>              304 bgpd/bgpd.c    	      peer-&gt;local_as = as;</span>
<span class='curline'><a href='../S/610.html#L305'>peer</a>              305 bgpd/bgpd.c    	      if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L307'>peer</a>              307 bgpd/bgpd.c                     peer-&gt;last_reset = PEER_DOWN_CONFED_ID_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L308'>peer</a>              308 bgpd/bgpd.c                     bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L313'>peer</a>              313 bgpd/bgpd.c    		BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L320'>peer</a>              320 bgpd/bgpd.c    	  if (peer_sort (peer) != BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L323'>peer</a>              323 bgpd/bgpd.c    	      if (peer_sort (peer) == BGP_PEER_EBGP)</span>
<span class='curline'><a href='../S/610.html#L324'>peer</a>              324 bgpd/bgpd.c    		peer-&gt;local_as = as;</span>
<span class='curline'><a href='../S/610.html#L325'>peer</a>              325 bgpd/bgpd.c    	      if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L327'>peer</a>              327 bgpd/bgpd.c                     peer-&gt;last_reset = PEER_DOWN_CONFED_ID_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L328'>peer</a>              328 bgpd/bgpd.c                     bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L332'>peer</a>              332 bgpd/bgpd.c    		BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L342'>peer</a>              342 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L348'>peer</a>              348 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L351'>peer</a>              351 bgpd/bgpd.c          if (peer_sort (peer) != BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L353'>peer</a>              353 bgpd/bgpd.c    	  peer-&gt;local_as = bgp-&gt;as;</span>
<span class='curline'><a href='../S/610.html#L354'>peer</a>              354 bgpd/bgpd.c    	  if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L356'>peer</a>              356 bgpd/bgpd.c                 peer-&gt;last_reset = PEER_DOWN_CONFED_ID_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L357'>peer</a>              357 bgpd/bgpd.c                 bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L362'>peer</a>              362 bgpd/bgpd.c    	    BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L388'>peer</a>              388 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L413'>peer</a>              413 bgpd/bgpd.c          for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L415'>peer</a>              415 bgpd/bgpd.c    	  if (peer-&gt;as == as)</span>
<span class='curline'><a href='../S/610.html#L417'>peer</a>              417 bgpd/bgpd.c    	      peer-&gt;local_as = bgp-&gt;as;</span>
<span class='curline'><a href='../S/610.html#L418'>peer</a>              418 bgpd/bgpd.c    	      if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L420'>peer</a>              420 bgpd/bgpd.c                     peer-&gt;last_reset = PEER_DOWN_CONFED_PEER_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L421'>peer</a>              421 bgpd/bgpd.c                     bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L425'>peer</a>              425 bgpd/bgpd.c    	        BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L438'>peer</a>              438 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L469'>peer</a>              469 bgpd/bgpd.c          for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L471'>peer</a>              471 bgpd/bgpd.c    	  if (peer-&gt;as == as)</span>
<span class='curline'><a href='../S/610.html#L473'>peer</a>              473 bgpd/bgpd.c    	      peer-&gt;local_as = bgp-&gt;confed_id;</span>
<span class='curline'><a href='../S/610.html#L474'>peer</a>              474 bgpd/bgpd.c    	      if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L476'>peer</a>              476 bgpd/bgpd.c                     peer-&gt;last_reset = PEER_DOWN_CONFED_PEER_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L477'>peer</a>              477 bgpd/bgpd.c                     bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L481'>peer</a>              481 bgpd/bgpd.c    		BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L516'>peer</a>              516 bgpd/bgpd.c    peer_rsclient_active (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L523'>peer</a>              523 bgpd/bgpd.c          if (CHECK_FLAG(peer-&gt;af_flags[i][j], PEER_FLAG_RSERVER_CLIENT)</span>
<span class='curline'><a href='../S/610.html#L524'>peer</a>              524 bgpd/bgpd.c                &amp;&amp; ! peer-&gt;af_group[i][j])</span>
<span class='curline'><a href='../S/610.html#L531'>peer</a>              531 bgpd/bgpd.c    peer_cmp (struct peer *p1, struct peer *p2)</span>
<span class='curline'><a href='../S/610.html#L537'>peer</a>              537 bgpd/bgpd.c    peer_af_flag_check (struct peer *peer, afi_t afi, safi_t safi, u_int32_t flag)</span>
<span class='curline'><a href='../S/610.html#L539'>peer</a>              539 bgpd/bgpd.c      return CHECK_FLAG (peer-&gt;af_flags[afi][safi], flag);</span>
<span class='curline'><a href='../S/610.html#L544'>peer</a>              544 bgpd/bgpd.c    peer_af_flag_reset (struct peer *peer, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/610.html#L550'>peer</a>              550 bgpd/bgpd.c      filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L587'>peer</a>              587 bgpd/bgpd.c      peer-&gt;af_flags[afi][safi] = 0;</span>
<span class='curline'><a href='../S/610.html#L590'>peer</a>              590 bgpd/bgpd.c      peer-&gt;af_sflags[afi][safi] = 0;</span>
<span class='curline'><a href='../S/610.html#L593'>peer</a>              593 bgpd/bgpd.c      peer-&gt;af_cap[afi][safi] = 0;</span>
<span class='curline'><a href='../S/610.html#L596'>peer</a>              596 bgpd/bgpd.c      peer-&gt;orf_plist[afi][safi] = NULL;</span>
<span class='curline'><a href='../S/610.html#L597'>peer</a>              597 bgpd/bgpd.c      sprintf (orf_name, "%s.%d.%d", peer-&gt;host, afi, safi);</span>
<span class='curline'><a href='../S/610.html#L603'>peer</a>              603 bgpd/bgpd.c          SET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_SEND_COMMUNITY);</span>
<span class='curline'><a href='../S/610.html#L604'>peer</a>              604 bgpd/bgpd.c          SET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_SEND_EXT_COMMUNITY);</span>
<span class='curline'><a href='../S/610.html#L608'>peer</a>              608 bgpd/bgpd.c      if (peer-&gt;default_rmap[afi][safi].name)</span>
<span class='curline'><a href='../S/610.html#L609'>peer</a>              609 bgpd/bgpd.c        free (peer-&gt;default_rmap[afi][safi].name);</span>
<span class='curline'><a href='../S/610.html#L610'>peer</a>              610 bgpd/bgpd.c      peer-&gt;default_rmap[afi][safi].name = NULL;</span>
<span class='curline'><a href='../S/610.html#L611'>peer</a>              611 bgpd/bgpd.c      peer-&gt;default_rmap[afi][safi].map = NULL;</span>
<span class='curline'><a href='../S/610.html#L614'>peer</a>              614 bgpd/bgpd.c      peer-&gt;pmax[afi][safi] = 0;</span>
<span class='curline'><a href='../S/610.html#L615'>peer</a>              615 bgpd/bgpd.c      peer-&gt;pmax_threshold[afi][safi] = MAXIMUM_PREFIX_THRESHOLD_DEFAULT;</span>
<span class='curline'><a href='../S/610.html#L620'>peer</a>              620 bgpd/bgpd.c    peer_global_config_reset (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L622'>peer</a>              622 bgpd/bgpd.c      peer-&gt;weight = 0;</span>
<span class='curline'><a href='../S/610.html#L623'>peer</a>              623 bgpd/bgpd.c      peer-&gt;change_local_as = 0;</span>
<span class='curline'><a href='../S/610.html#L624'>peer</a>              624 bgpd/bgpd.c      peer-&gt;ttl = (peer_sort (peer) == BGP_PEER_IBGP ? 255 : 1);</span>
<span class='curline'><a href='../S/610.html#L625'>peer</a>              625 bgpd/bgpd.c      if (peer-&gt;update_source)</span>
<span class='curline'><a href='../S/610.html#L627'>peer</a>              627 bgpd/bgpd.c          sockunion_free (peer-&gt;update_source);</span>
<span class='curline'><a href='../S/610.html#L628'>peer</a>              628 bgpd/bgpd.c          peer-&gt;update_source = NULL;</span>
<span class='curline'><a href='../S/610.html#L630'>peer</a>              630 bgpd/bgpd.c      if (peer-&gt;update_if)</span>
<span class='curline'><a href='../S/610.html#L632'>peer</a>              632 bgpd/bgpd.c          XFREE (MTYPE_PEER_UPDATE_SOURCE, peer-&gt;update_if);</span>
<span class='curline'><a href='../S/610.html#L633'>peer</a>              633 bgpd/bgpd.c          peer-&gt;update_if = NULL;</span>
<span class='curline'><a href='../S/610.html#L636'>peer</a>              636 bgpd/bgpd.c      if (peer_sort (peer) == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L637'>peer</a>              637 bgpd/bgpd.c        peer-&gt;v_routeadv = BGP_DEFAULT_IBGP_ROUTEADV;</span>
<span class='curline'><a href='../S/610.html#L639'>peer</a>              639 bgpd/bgpd.c        peer-&gt;v_routeadv = BGP_DEFAULT_EBGP_ROUTEADV;</span>
<span class='curline'><a href='../S/610.html#L641'>peer</a>              641 bgpd/bgpd.c      peer-&gt;flags = 0;</span>
<span class='curline'><a href='../S/610.html#L642'>peer</a>              642 bgpd/bgpd.c      peer-&gt;config = 0;</span>
<span class='curline'><a href='../S/610.html#L643'>peer</a>              643 bgpd/bgpd.c      peer-&gt;holdtime = 0;</span>
<span class='curline'><a href='../S/610.html#L644'>peer</a>              644 bgpd/bgpd.c      peer-&gt;keepalive = 0;</span>
<span class='curline'><a href='../S/610.html#L645'>peer</a>              645 bgpd/bgpd.c      peer-&gt;connect = 0;</span>
<span class='curline'><a href='../S/610.html#L646'>peer</a>              646 bgpd/bgpd.c      peer-&gt;v_connect = BGP_DEFAULT_CONNECT_RETRY;</span>
<span class='curline'><a href='../S/610.html#L651'>peer</a>              651 bgpd/bgpd.c    peer_calc_sort (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L655'>peer</a>              655 bgpd/bgpd.c      bgp = peer-&gt;bgp;</span>
<span class='curline'><a href='../S/610.html#L658'>peer</a>              658 bgpd/bgpd.c      if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L660'>peer</a>              660 bgpd/bgpd.c          if (peer-&gt;as)</span>
<span class='curline'><a href='../S/610.html#L661'>peer</a>              661 bgpd/bgpd.c    	return (bgp-&gt;as == peer-&gt;as ? BGP_PEER_IBGP : BGP_PEER_EBGP);</span>
<span class='curline'><a href='../S/610.html#L664'>peer</a>              664 bgpd/bgpd.c    	  struct peer *peer1;</span>
<span class='curline'><a href='../S/610.html#L665'>peer</a>              665 bgpd/bgpd.c    	  peer1 = listnode_head (peer-&gt;group-&gt;peer);</span>
<span class='curline'><a href='../S/610.html#L676'>peer</a>              676 bgpd/bgpd.c          if (peer-&gt;local_as == 0)</span>
<span class='curline'><a href='../S/610.html#L679'>peer</a>              679 bgpd/bgpd.c          if (peer-&gt;local_as == peer-&gt;as)</span>
<span class='curline'><a href='../S/610.html#L681'>peer</a>              681 bgpd/bgpd.c    	  if (peer-&gt;local_as == bgp-&gt;confed_id)</span>
<span class='curline'><a href='../S/610.html#L687'>peer</a>              687 bgpd/bgpd.c          if (bgp_confederation_peers_check (bgp, peer-&gt;as))</span>
<span class='curline'><a href='../S/610.html#L694'>peer</a>              694 bgpd/bgpd.c          return (peer-&gt;local_as == 0</span>
<span class='curline'><a href='../S/610.html#L695'>peer</a>              695 bgpd/bgpd.c    	      ? BGP_PEER_INTERNAL : peer-&gt;local_as == peer-&gt;as</span>
<span class='curline'><a href='../S/610.html#L702'>peer</a>              702 bgpd/bgpd.c    peer_sort (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L704'>peer</a>              704 bgpd/bgpd.c      peer-&gt;sort = peer_calc_sort (peer);</span>
<span class='curline'><a href='../S/610.html#L705'>peer</a>              705 bgpd/bgpd.c      return peer-&gt;sort;</span>
<span class='curline'><a href='../S/610.html#L709'>peer</a>              709 bgpd/bgpd.c    peer_free (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L711'>peer</a>              711 bgpd/bgpd.c      assert (peer-&gt;status == Deleted);</span>
<span class='curline'><a href='../S/610.html#L713'>peer</a>              713 bgpd/bgpd.c      bgp_unlock(peer-&gt;bgp);</span>
<span class='curline'><a href='../S/610.html#L718'>peer</a>              718 bgpd/bgpd.c      bgp_timer_set (peer);</span>
<span class='curline'><a href='../S/610.html#L719'>peer</a>              719 bgpd/bgpd.c      BGP_READ_OFF (peer-&gt;t_read);</span>
<span class='curline'><a href='../S/610.html#L720'>peer</a>              720 bgpd/bgpd.c      BGP_WRITE_OFF (peer-&gt;t_write);</span>
<span class='curline'><a href='../S/610.html#L721'>peer</a>              721 bgpd/bgpd.c      BGP_EVENT_FLUSH (peer);</span>
<span class='curline'><a href='../S/610.html#L723'>peer</a>              723 bgpd/bgpd.c      if (peer-&gt;desc)</span>
<span class='curline'><a href='../S/610.html#L724'>peer</a>              724 bgpd/bgpd.c        XFREE (MTYPE_PEER_DESC, peer-&gt;desc);</span>
<span class='curline'><a href='../S/610.html#L727'>peer</a>              727 bgpd/bgpd.c      if (peer-&gt;host)</span>
<span class='curline'><a href='../S/610.html#L728'>peer</a>              728 bgpd/bgpd.c        XFREE (MTYPE_BGP_PEER_HOST, peer-&gt;host);</span>
<span class='curline'><a href='../S/610.html#L731'>peer</a>              731 bgpd/bgpd.c      if (peer-&gt;update_source)</span>
<span class='curline'><a href='../S/610.html#L732'>peer</a>              732 bgpd/bgpd.c        sockunion_free (peer-&gt;update_source);</span>
<span class='curline'><a href='../S/610.html#L734'>peer</a>              734 bgpd/bgpd.c      if (peer-&gt;update_if)</span>
<span class='curline'><a href='../S/610.html#L735'>peer</a>              735 bgpd/bgpd.c        XFREE (MTYPE_PEER_UPDATE_SOURCE, peer-&gt;update_if);</span>
<span class='curline'><a href='../S/610.html#L737'>peer</a>              737 bgpd/bgpd.c      if (peer-&gt;clear_node_queue)</span>
<span class='curline'><a href='../S/610.html#L738'>peer</a>              738 bgpd/bgpd.c        work_queue_free (peer-&gt;clear_node_queue);</span>
<span class='curline'><a href='../S/610.html#L740'>peer</a>              740 bgpd/bgpd.c      bgp_sync_delete (peer);</span>
<span class='curline'><a href='../S/610.html#L741'>peer</a>              741 bgpd/bgpd.c      memset (peer, 0, sizeof (struct peer));</span>
<span class='curline'><a href='../S/610.html#L743'>peer</a>              743 bgpd/bgpd.c      XFREE (MTYPE_BGP_PEER, peer);</span>
<span class='curline'><a href='../S/610.html#L747'>peer</a>              747 bgpd/bgpd.c    struct peer *</span>
<span class='curline'><a href='../S/610.html#L748'>peer</a>              748 bgpd/bgpd.c    peer_lock (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L750'>peer</a>              750 bgpd/bgpd.c      assert (peer &amp;&amp; (peer-&gt;lock &gt;= 0));</span>
<span class='curline'><a href='../S/610.html#L752'>peer</a>              752 bgpd/bgpd.c      peer-&gt;lock++;</span>
<span class='curline'><a href='../S/610.html#L754'>peer</a>              754 bgpd/bgpd.c      return peer;</span>
<span class='curline'><a href='../S/610.html#L760'>peer</a>              760 bgpd/bgpd.c    struct peer *</span>
<span class='curline'><a href='../S/610.html#L761'>peer</a>              761 bgpd/bgpd.c    peer_unlock (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L763'>peer</a>              763 bgpd/bgpd.c      assert (peer &amp;&amp; (peer-&gt;lock &gt; 0));</span>
<span class='curline'><a href='../S/610.html#L765'>peer</a>              765 bgpd/bgpd.c      peer-&gt;lock--;</span>
<span class='curline'><a href='../S/610.html#L767'>peer</a>              767 bgpd/bgpd.c      if (peer-&gt;lock == 0)</span>
<span class='curline'><a href='../S/610.html#L773'>peer</a>              773 bgpd/bgpd.c          peer_free (peer);</span>
<span class='curline'><a href='../S/610.html#L778'>peer</a>              778 bgpd/bgpd.c      if (peer-&gt;lock == 1)</span>
<span class='curline'><a href='../S/610.html#L785'>peer</a>              785 bgpd/bgpd.c      return peer;</span>
<span class='curline'><a href='../S/610.html#L789'>peer</a>              789 bgpd/bgpd.c    static struct peer *</span>
<span class='curline'><a href='../S/610.html#L794'>peer</a>              794 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L803'>peer</a>              803 bgpd/bgpd.c      peer = XCALLOC (MTYPE_BGP_PEER, sizeof (struct peer));</span>
<span class='curline'><a href='../S/610.html#L806'>peer</a>              806 bgpd/bgpd.c      peer-&gt;fd = -1;</span>
<span class='curline'><a href='../S/610.html#L807'>peer</a>              807 bgpd/bgpd.c      peer-&gt;v_start = BGP_INIT_START_TIMER;</span>
<span class='curline'><a href='../S/610.html#L808'>peer</a>              808 bgpd/bgpd.c      peer-&gt;v_connect = BGP_DEFAULT_CONNECT_RETRY;</span>
<span class='curline'><a href='../S/610.html#L809'>peer</a>              809 bgpd/bgpd.c      peer-&gt;v_asorig = BGP_DEFAULT_ASORIGINATE;</span>
<span class='curline'><a href='../S/610.html#L810'>peer</a>              810 bgpd/bgpd.c      peer-&gt;status = Idle;</span>
<span class='curline'><a href='../S/610.html#L811'>peer</a>              811 bgpd/bgpd.c      peer-&gt;ostatus = Idle;</span>
<span class='curline'><a href='../S/610.html#L812'>peer</a>              812 bgpd/bgpd.c      peer-&gt;weight = 0;</span>
<span class='curline'><a href='../S/610.html#L813'>peer</a>              813 bgpd/bgpd.c      peer-&gt;password = NULL;</span>
<span class='curline'><a href='../S/610.html#L814'>peer</a>              814 bgpd/bgpd.c      peer-&gt;bgp = bgp;</span>
<span class='curline'><a href='../S/610.html#L815'>peer</a>              815 bgpd/bgpd.c      peer = peer_lock (peer); /* initial reference */</span>
<span class='curline'><a href='../S/610.html#L824'>peer</a>              824 bgpd/bgpd.c    	    SET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_SEND_COMMUNITY);</span>
<span class='curline'><a href='../S/610.html#L825'>peer</a>              825 bgpd/bgpd.c    	    SET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_SEND_EXT_COMMUNITY);</span>
<span class='curline'><a href='../S/610.html#L827'>peer</a>              827 bgpd/bgpd.c    	peer-&gt;orf_plist[afi][safi] = NULL;</span>
<span class='curline'><a href='../S/610.html#L829'>peer</a>              829 bgpd/bgpd.c      SET_FLAG (peer-&gt;sflags, PEER_STATUS_CAPABILITY_OPEN);</span>
<span class='curline'><a href='../S/610.html#L832'>peer</a>              832 bgpd/bgpd.c      peer-&gt;ibuf = stream_new (BGP_MAX_PACKET_SIZE);</span>
<span class='curline'><a href='../S/610.html#L833'>peer</a>              833 bgpd/bgpd.c      peer-&gt;obuf = stream_fifo_new ();</span>
<span class='curline'><a href='../S/610.html#L834'>peer</a>              834 bgpd/bgpd.c      peer-&gt;work = stream_new (BGP_MAX_PACKET_SIZE);</span>
<span class='curline'><a href='../S/610.html#L836'>peer</a>              836 bgpd/bgpd.c      bgp_sync_init (peer);</span>
<span class='curline'><a href='../S/610.html#L840'>peer</a>              840 bgpd/bgpd.c      peer-&gt;port = (sp == NULL) ? BGP_PORT_DEFAULT : ntohs (sp-&gt;s_port);</span>
<span class='curline'><a href='../S/610.html#L842'>peer</a>              842 bgpd/bgpd.c      return peer;</span>
<span class='curline'><a href='../S/610.html#L846'>peer</a>              846 bgpd/bgpd.c    static struct peer *</span>
<span class='curline'><a href='../S/610.html#L851'>peer</a>              851 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L854'>peer</a>              854 bgpd/bgpd.c      peer = peer_new (bgp);</span>
<span class='curline'><a href='../S/610.html#L855'>peer</a>              855 bgpd/bgpd.c      peer-&gt;su = *su;</span>
<span class='curline'><a href='../S/610.html#L856'>peer</a>              856 bgpd/bgpd.c      peer-&gt;local_as = local_as;</span>
<span class='curline'><a href='../S/610.html#L857'>peer</a>              857 bgpd/bgpd.c      peer-&gt;as = remote_as;</span>
<span class='curline'><a href='../S/610.html#L858'>peer</a>              858 bgpd/bgpd.c      peer-&gt;local_id = bgp-&gt;router_id;</span>
<span class='curline'><a href='../S/610.html#L859'>peer</a>              859 bgpd/bgpd.c      peer-&gt;v_holdtime = bgp-&gt;default_holdtime;</span>
<span class='curline'><a href='../S/610.html#L860'>peer</a>              860 bgpd/bgpd.c      peer-&gt;v_keepalive = bgp-&gt;default_keepalive;</span>
<span class='curline'><a href='../S/610.html#L861'>peer</a>              861 bgpd/bgpd.c      if (peer_sort (peer) == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L862'>peer</a>              862 bgpd/bgpd.c        peer-&gt;v_routeadv = BGP_DEFAULT_IBGP_ROUTEADV;</span>
<span class='curline'><a href='../S/610.html#L864'>peer</a>              864 bgpd/bgpd.c        peer-&gt;v_routeadv = BGP_DEFAULT_EBGP_ROUTEADV;</span>
<span class='curline'><a href='../S/610.html#L866'>peer</a>              866 bgpd/bgpd.c      peer = peer_lock (peer); /* bgp peer list reference */</span>
<span class='curline'><a href='../S/610.html#L867'>peer</a>              867 bgpd/bgpd.c      listnode_add_sort (bgp-&gt;peer, peer);</span>
<span class='curline'><a href='../S/610.html#L869'>peer</a>              869 bgpd/bgpd.c      active = peer_active (peer);</span>
<span class='curline'><a href='../S/610.html#L872'>peer</a>              872 bgpd/bgpd.c        peer-&gt;afc[afi][safi] = 1;</span>
<span class='curline'><a href='../S/610.html#L875'>peer</a>              875 bgpd/bgpd.c      peer-&gt;readtime = peer-&gt;resettime = bgp_clock ();</span>
<span class='curline'><a href='../S/610.html#L878'>peer</a>              878 bgpd/bgpd.c      peer-&gt;ttl = (peer-&gt;sort == BGP_PEER_IBGP) ? 255 : 1;</span>
<span class='curline'><a href='../S/610.html#L882'>peer</a>              882 bgpd/bgpd.c      peer-&gt;host = XSTRDUP (MTYPE_BGP_PEER_HOST, buf);</span>
<span class='curline'><a href='../S/610.html#L885'>peer</a>              885 bgpd/bgpd.c      if (! active &amp;&amp; peer_active (peer))</span>
<span class='curline'><a href='../S/610.html#L886'>peer</a>              886 bgpd/bgpd.c        bgp_timer_set (peer);</span>
<span class='curline'><a href='../S/610.html#L888'>peer</a>              888 bgpd/bgpd.c      return peer;</span>
<span class='curline'><a href='../S/610.html#L892'>peer</a>              892 bgpd/bgpd.c    struct peer *</span>
<span class='curline'><a href='../S/610.html#L895'>peer</a>              895 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L897'>peer</a>              897 bgpd/bgpd.c      peer = peer_new (bgp);</span>
<span class='curline'><a href='../S/610.html#L899'>peer</a>              899 bgpd/bgpd.c      peer = peer_lock (peer); /* bgp peer list reference */</span>
<span class='curline'><a href='../S/610.html#L900'>peer</a>              900 bgpd/bgpd.c      listnode_add_sort (bgp-&gt;peer, peer);</span>
<span class='curline'><a href='../S/610.html#L902'>peer</a>              902 bgpd/bgpd.c      return peer;</span>
<span class='curline'><a href='../S/610.html#L907'>peer</a>              907 bgpd/bgpd.c    peer_as_change (struct peer *peer, as_t as)</span>
<span class='curline'><a href='../S/610.html#L912'>peer</a>              912 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L914'>peer</a>              914 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L916'>peer</a>              916 bgpd/bgpd.c             peer-&gt;last_reset = PEER_DOWN_REMOTE_AS_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L917'>peer</a>              917 bgpd/bgpd.c             bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L921'>peer</a>              921 bgpd/bgpd.c    	BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L923'>peer</a>              923 bgpd/bgpd.c      type = peer_sort (peer);</span>
<span class='curline'><a href='../S/610.html#L924'>peer</a>              924 bgpd/bgpd.c      peer-&gt;as = as;</span>
<span class='curline'><a href='../S/610.html#L926'>peer</a>              926 bgpd/bgpd.c      if (bgp_config_check (peer-&gt;bgp, BGP_CONFIG_CONFEDERATION)</span>
<span class='curline'><a href='../S/610.html#L927'>peer</a>              927 bgpd/bgpd.c          &amp;&amp; ! bgp_confederation_peers_check (peer-&gt;bgp, as)</span>
<span class='curline'><a href='../S/610.html#L928'>peer</a>              928 bgpd/bgpd.c          &amp;&amp; peer-&gt;bgp-&gt;as != as)</span>
<span class='curline'><a href='../S/610.html#L929'>peer</a>              929 bgpd/bgpd.c        peer-&gt;local_as = peer-&gt;bgp-&gt;confed_id;</span>
<span class='curline'><a href='../S/610.html#L931'>peer</a>              931 bgpd/bgpd.c        peer-&gt;local_as = peer-&gt;bgp-&gt;as;</span>
<span class='curline'><a href='../S/610.html#L934'>peer</a>              934 bgpd/bgpd.c      if (peer_sort (peer) == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L935'>peer</a>              935 bgpd/bgpd.c        peer-&gt;v_routeadv = BGP_DEFAULT_IBGP_ROUTEADV;</span>
<span class='curline'><a href='../S/610.html#L937'>peer</a>              937 bgpd/bgpd.c        peer-&gt;v_routeadv = BGP_DEFAULT_EBGP_ROUTEADV;</span>
<span class='curline'><a href='../S/610.html#L940'>peer</a>              940 bgpd/bgpd.c      if (peer_sort (peer) == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L941'>peer</a>              941 bgpd/bgpd.c        peer-&gt;ttl = 255;</span>
<span class='curline'><a href='../S/610.html#L943'>peer</a>              943 bgpd/bgpd.c        peer-&gt;ttl = 1;</span>
<span class='curline'><a href='../S/610.html#L946'>peer</a>              946 bgpd/bgpd.c      if (peer_sort (peer) != BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L948'>peer</a>              948 bgpd/bgpd.c          UNSET_FLAG (peer-&gt;af_flags[AFI_IP][SAFI_UNICAST],</span>
<span class='curline'><a href='../S/610.html#L950'>peer</a>              950 bgpd/bgpd.c          UNSET_FLAG (peer-&gt;af_flags[AFI_IP][SAFI_MULTICAST],</span>
<span class='curline'><a href='../S/610.html#L952'>peer</a>              952 bgpd/bgpd.c          UNSET_FLAG (peer-&gt;af_flags[AFI_IP][SAFI_MPLS_VPN],</span>
<span class='curline'><a href='../S/610.html#L954'>peer</a>              954 bgpd/bgpd.c          UNSET_FLAG (peer-&gt;af_flags[AFI_IP6][SAFI_UNICAST],</span>
<span class='curline'><a href='../S/610.html#L956'>peer</a>              956 bgpd/bgpd.c          UNSET_FLAG (peer-&gt;af_flags[AFI_IP6][SAFI_MULTICAST],</span>
<span class='curline'><a href='../S/610.html#L961'>peer</a>              961 bgpd/bgpd.c      if (peer_sort (peer) != BGP_PEER_EBGP)</span>
<span class='curline'><a href='../S/610.html#L963'>peer</a>              963 bgpd/bgpd.c          peer-&gt;change_local_as = 0;</span>
<span class='curline'><a href='../S/610.html#L964'>peer</a>              964 bgpd/bgpd.c          UNSET_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_NO_PREPEND);</span>
<span class='curline'><a href='../S/610.html#L965'>peer</a>              965 bgpd/bgpd.c          UNSET_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_REPLACE_AS);</span>
<span class='curline'><a href='../S/610.html#L975'>peer</a>              975 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L978'>peer</a>              978 bgpd/bgpd.c      peer = peer_lookup (bgp, su);</span>
<span class='curline'><a href='../S/610.html#L980'>peer</a>              980 bgpd/bgpd.c      if (peer)</span>
<span class='curline'><a href='../S/610.html#L983'>peer</a>              983 bgpd/bgpd.c          if (peer-&gt;group)</span>
<span class='curline'><a href='../S/610.html#L985'>peer</a>              985 bgpd/bgpd.c    	  if (peer-&gt;group-&gt;conf-&gt;as)</span>
<span class='curline'><a href='../S/610.html#L988'>peer</a>              988 bgpd/bgpd.c    	      *as = peer-&gt;group-&gt;conf-&gt;as;</span>
<span class='curline'><a href='../S/610.html#L991'>peer</a>              991 bgpd/bgpd.c    	  if (peer_sort (peer-&gt;group-&gt;conf) == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L995'>peer</a>              995 bgpd/bgpd.c    		  *as = peer-&gt;as;</span>
<span class='curline'><a href='../S/610.html#L1003'>peer</a>             1003 bgpd/bgpd.c    		  *as = peer-&gt;as;</span>
<span class='curline'><a href='../S/610.html#L1010'>peer</a>             1010 bgpd/bgpd.c          if (peer-&gt;as != *as)</span>
<span class='curline'><a href='../S/610.html#L1011'>peer</a>             1011 bgpd/bgpd.c    	peer_as_change (peer, *as);</span>
<span class='curline'><a href='../S/610.html#L1030'>peer</a>             1030 bgpd/bgpd.c    	peer = peer_create (su, bgp, local_as, *as, 0, 0); </span>
<span class='curline'><a href='../S/610.html#L1032'>peer</a>             1032 bgpd/bgpd.c    	peer = peer_create (su, bgp, local_as, *as, afi, safi); </span>
<span class='curline'><a href='../S/610.html#L1040'>peer</a>             1040 bgpd/bgpd.c    peer_activate (struct peer *peer, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/610.html#L1044'>peer</a>             1044 bgpd/bgpd.c      if (peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L1048'>peer</a>             1048 bgpd/bgpd.c      if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L1049'>peer</a>             1049 bgpd/bgpd.c        peer-&gt;afc[afi][safi] = 1;</span>
<span class='curline'><a href='../S/610.html#L1052'>peer</a>             1052 bgpd/bgpd.c          active = peer_active (peer);</span>
<span class='curline'><a href='../S/610.html#L1054'>peer</a>             1054 bgpd/bgpd.c          peer-&gt;afc[afi][safi] = 1;</span>
<span class='curline'><a href='../S/610.html#L1056'>peer</a>             1056 bgpd/bgpd.c          if (! active &amp;&amp; peer_active (peer))</span>
<span class='curline'><a href='../S/610.html#L1057'>peer</a>             1057 bgpd/bgpd.c    	bgp_timer_set (peer);</span>
<span class='curline'><a href='../S/610.html#L1060'>peer</a>             1060 bgpd/bgpd.c    	  if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L1062'>peer</a>             1062 bgpd/bgpd.c    	      if (CHECK_FLAG (peer-&gt;cap, PEER_CAP_DYNAMIC_RCV))</span>
<span class='curline'><a href='../S/610.html#L1064'>peer</a>             1064 bgpd/bgpd.c    		  peer-&gt;afc_adv[afi][safi] = 1;</span>
<span class='curline'><a href='../S/610.html#L1065'>peer</a>             1065 bgpd/bgpd.c    		  bgp_capability_send (peer, afi, safi,</span>
<span class='curline'><a href='../S/610.html#L1068'>peer</a>             1068 bgpd/bgpd.c    		  if (peer-&gt;afc_recv[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L1070'>peer</a>             1070 bgpd/bgpd.c    		      peer-&gt;afc_nego[afi][safi] = 1;</span>
<span class='curline'><a href='../S/610.html#L1071'>peer</a>             1071 bgpd/bgpd.c    		      bgp_announce_route (peer, afi, safi);</span>
<span class='curline'><a href='../S/610.html#L1076'>peer</a>             1076 bgpd/bgpd.c                     peer-&gt;last_reset = PEER_DOWN_AF_ACTIVATE;</span>
<span class='curline'><a href='../S/610.html#L1077'>peer</a>             1077 bgpd/bgpd.c                     bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L1087'>peer</a>             1087 bgpd/bgpd.c    peer_deactivate (struct peer *peer, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/610.html#L1090'>peer</a>             1090 bgpd/bgpd.c      struct peer *peer1;</span>
<span class='curline'><a href='../S/610.html#L1093'>peer</a>             1093 bgpd/bgpd.c      if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L1095'>peer</a>             1095 bgpd/bgpd.c          group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L1097'>peer</a>             1097 bgpd/bgpd.c          for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer1))</span>
<span class='curline'><a href='../S/610.html#L1105'>peer</a>             1105 bgpd/bgpd.c          if (peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L1109'>peer</a>             1109 bgpd/bgpd.c      if (! peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L1113'>peer</a>             1113 bgpd/bgpd.c      peer-&gt;afc[afi][safi] = 0;</span>
<span class='curline'><a href='../S/610.html#L1114'>peer</a>             1114 bgpd/bgpd.c      peer_af_flag_reset (peer, afi, safi);</span>
<span class='curline'><a href='../S/610.html#L1116'>peer</a>             1116 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L1118'>peer</a>             1118 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L1120'>peer</a>             1120 bgpd/bgpd.c    	  if (CHECK_FLAG (peer-&gt;cap, PEER_CAP_DYNAMIC_RCV))</span>
<span class='curline'><a href='../S/610.html#L1122'>peer</a>             1122 bgpd/bgpd.c    	      peer-&gt;afc_adv[afi][safi] = 0;</span>
<span class='curline'><a href='../S/610.html#L1123'>peer</a>             1123 bgpd/bgpd.c    	      peer-&gt;afc_nego[afi][safi] = 0;</span>
<span class='curline'><a href='../S/610.html#L1125'>peer</a>             1125 bgpd/bgpd.c    	      if (peer_active_nego (peer))</span>
<span class='curline'><a href='../S/610.html#L1127'>peer</a>             1127 bgpd/bgpd.c    		  bgp_capability_send (peer, afi, safi,</span>
<span class='curline'><a href='../S/610.html#L1130'>peer</a>             1130 bgpd/bgpd.c    		  bgp_clear_route (peer, afi, safi, BGP_CLEAR_ROUTE_NORMAL);</span>
<span class='curline'><a href='../S/610.html#L1131'>peer</a>             1131 bgpd/bgpd.c    		  peer-&gt;pcount[afi][safi] = 0;</span>
<span class='curline'><a href='../S/610.html#L1135'>peer</a>             1135 bgpd/bgpd.c                     peer-&gt;last_reset = PEER_DOWN_NEIGHBOR_DELETE;</span>
<span class='curline'><a href='../S/610.html#L1136'>peer</a>             1136 bgpd/bgpd.c                     bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L1142'>peer</a>             1142 bgpd/bgpd.c                 peer-&gt;last_reset = PEER_DOWN_NEIGHBOR_DELETE;</span>
<span class='curline'><a href='../S/610.html#L1143'>peer</a>             1143 bgpd/bgpd.c                 bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L1152'>peer</a>             1152 bgpd/bgpd.c    peer_nsf_stop (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L1157'>peer</a>             1157 bgpd/bgpd.c      UNSET_FLAG (peer-&gt;sflags, PEER_STATUS_NSF_WAIT);</span>
<span class='curline'><a href='../S/610.html#L1158'>peer</a>             1158 bgpd/bgpd.c      UNSET_FLAG (peer-&gt;sflags, PEER_STATUS_NSF_MODE);</span>
<span class='curline'><a href='../S/610.html#L1162'>peer</a>             1162 bgpd/bgpd.c          peer-&gt;nsf[afi][safi] = 0;</span>
<span class='curline'><a href='../S/610.html#L1164'>peer</a>             1164 bgpd/bgpd.c      if (peer-&gt;t_gr_restart)</span>
<span class='curline'><a href='../S/610.html#L1166'>peer</a>             1166 bgpd/bgpd.c          BGP_TIMER_OFF (peer-&gt;t_gr_restart);</span>
<span class='curline'><a href='../S/610.html#L1168'>peer</a>             1168 bgpd/bgpd.c    	zlog_debug ("%s graceful restart timer stopped", peer-&gt;host);</span>
<span class='curline'><a href='../S/610.html#L1170'>peer</a>             1170 bgpd/bgpd.c      if (peer-&gt;t_gr_stale)</span>
<span class='curline'><a href='../S/610.html#L1172'>peer</a>             1172 bgpd/bgpd.c          BGP_TIMER_OFF (peer-&gt;t_gr_stale);</span>
<span class='curline'><a href='../S/610.html#L1174'>peer</a>             1174 bgpd/bgpd.c    	zlog_debug ("%s graceful restart stalepath timer stopped", peer-&gt;host);</span>
<span class='curline'><a href='../S/610.html#L1176'>peer</a>             1176 bgpd/bgpd.c      bgp_clear_route_all (peer);</span>
<span class='curline'><a href='../S/610.html#L1191'>peer</a>             1191 bgpd/bgpd.c    peer_delete (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L1200'>peer</a>             1200 bgpd/bgpd.c      assert (peer-&gt;status != Deleted);</span>
<span class='curline'><a href='../S/610.html#L1202'>peer</a>             1202 bgpd/bgpd.c      bgp = peer-&gt;bgp;</span>
<span class='curline'><a href='../S/610.html#L1204'>peer</a>             1204 bgpd/bgpd.c      if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_NSF_WAIT))</span>
<span class='curline'><a href='../S/610.html#L1205'>peer</a>             1205 bgpd/bgpd.c        peer_nsf_stop (peer);</span>
<span class='curline'><a href='../S/610.html#L1209'>peer</a>             1209 bgpd/bgpd.c      if (peer-&gt;group)</span>
<span class='curline'><a href='../S/610.html#L1211'>peer</a>             1211 bgpd/bgpd.c          if ((pn = listnode_lookup (peer-&gt;group-&gt;peer, peer)))</span>
<span class='curline'><a href='../S/610.html#L1213'>peer</a>             1213 bgpd/bgpd.c              peer = peer_unlock (peer); /* group-&gt;peer list reference */</span>
<span class='curline'><a href='../S/610.html#L1214'>peer</a>             1214 bgpd/bgpd.c              list_delete_node (peer-&gt;group-&gt;peer, pn);</span>
<span class='curline'><a href='../S/610.html#L1216'>peer</a>             1216 bgpd/bgpd.c          peer-&gt;group = NULL;</span>
<span class='curline'><a href='../S/610.html#L1223'>peer</a>             1223 bgpd/bgpd.c      peer-&gt;last_reset = PEER_DOWN_NEIGHBOR_DELETE;</span>
<span class='curline'><a href='../S/610.html#L1224'>peer</a>             1224 bgpd/bgpd.c      bgp_stop (peer);</span>
<span class='curline'><a href='../S/610.html#L1225'>peer</a>             1225 bgpd/bgpd.c      bgp_fsm_change_status (peer, Deleted);</span>
<span class='curline'><a href='../S/610.html#L1228'>peer</a>             1228 bgpd/bgpd.c      if (peer-&gt;password)</span>
<span class='curline'><a href='../S/610.html#L1230'>peer</a>             1230 bgpd/bgpd.c          XFREE (MTYPE_PEER_PASSWORD, peer-&gt;password);</span>
<span class='curline'><a href='../S/610.html#L1231'>peer</a>             1231 bgpd/bgpd.c          peer-&gt;password = NULL;</span>
<span class='curline'><a href='../S/610.html#L1233'>peer</a>             1233 bgpd/bgpd.c          if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L1234'>peer</a>             1234 bgpd/bgpd.c    	bgp_md5_set (peer);</span>
<span class='curline'><a href='../S/610.html#L1237'>peer</a>             1237 bgpd/bgpd.c      bgp_timer_set (peer); /* stops all timers for Deleted */</span>
<span class='curline'><a href='../S/610.html#L1240'>peer</a>             1240 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP)</span>
<span class='curline'><a href='../S/610.html#L1241'>peer</a>             1241 bgpd/bgpd.c          &amp;&amp; (pn = listnode_lookup (bgp-&gt;peer, peer)))</span>
<span class='curline'><a href='../S/610.html#L1243'>peer</a>             1243 bgpd/bgpd.c          peer_unlock (peer); /* bgp peer list reference */</span>
<span class='curline'><a href='../S/610.html#L1244'>peer</a>             1244 bgpd/bgpd.c          list_delete_node (bgp-&gt;peer, pn);</span>
<span class='curline'><a href='../S/610.html#L1247'>peer</a>             1247 bgpd/bgpd.c      if (peer_rsclient_active (peer)</span>
<span class='curline'><a href='../S/610.html#L1248'>peer</a>             1248 bgpd/bgpd.c          &amp;&amp; (pn = listnode_lookup (bgp-&gt;rsclient, peer)))</span>
<span class='curline'><a href='../S/610.html#L1250'>peer</a>             1250 bgpd/bgpd.c          peer_unlock (peer); /* rsclient list reference */</span>
<span class='curline'><a href='../S/610.html#L1256'>peer</a>             1256 bgpd/bgpd.c              if (CHECK_FLAG(peer-&gt;af_flags[afi][safi],</span>
<span class='curline'><a href='../S/610.html#L1258'>peer</a>             1258 bgpd/bgpd.c                bgp_clear_route (peer, afi, safi, BGP_CLEAR_ROUTE_MY_RSCLIENT);</span>
<span class='curline'><a href='../S/610.html#L1265'>peer</a>             1265 bgpd/bgpd.c          if (peer-&gt;rib[afi][safi] &amp;&amp; ! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L1266'>peer</a>             1266 bgpd/bgpd.c            bgp_table_finish (&amp;peer-&gt;rib[afi][safi]);</span>
<span class='curline'><a href='../S/610.html#L1269'>peer</a>             1269 bgpd/bgpd.c      if (peer-&gt;ibuf)</span>
<span class='curline'><a href='../S/610.html#L1270'>peer</a>             1270 bgpd/bgpd.c        stream_free (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/610.html#L1271'>peer</a>             1271 bgpd/bgpd.c      if (peer-&gt;obuf)</span>
<span class='curline'><a href='../S/610.html#L1272'>peer</a>             1272 bgpd/bgpd.c        stream_fifo_free (peer-&gt;obuf);</span>
<span class='curline'><a href='../S/610.html#L1273'>peer</a>             1273 bgpd/bgpd.c      if (peer-&gt;work)</span>
<span class='curline'><a href='../S/610.html#L1274'>peer</a>             1274 bgpd/bgpd.c        stream_free (peer-&gt;work);</span>
<span class='curline'><a href='../S/610.html#L1275'>peer</a>             1275 bgpd/bgpd.c      peer-&gt;obuf = NULL;</span>
<span class='curline'><a href='../S/610.html#L1276'>peer</a>             1276 bgpd/bgpd.c      peer-&gt;work = peer-&gt;ibuf = NULL;</span>
<span class='curline'><a href='../S/610.html#L1279'>peer</a>             1279 bgpd/bgpd.c      if (peer-&gt;su_local)</span>
<span class='curline'><a href='../S/610.html#L1280'>peer</a>             1280 bgpd/bgpd.c        sockunion_free (peer-&gt;su_local);</span>
<span class='curline'><a href='../S/610.html#L1281'>peer</a>             1281 bgpd/bgpd.c      if (peer-&gt;su_remote)</span>
<span class='curline'><a href='../S/610.html#L1282'>peer</a>             1282 bgpd/bgpd.c        sockunion_free (peer-&gt;su_remote);</span>
<span class='curline'><a href='../S/610.html#L1283'>peer</a>             1283 bgpd/bgpd.c      peer-&gt;su_local = peer-&gt;su_remote = NULL;</span>
<span class='curline'><a href='../S/610.html#L1289'>peer</a>             1289 bgpd/bgpd.c    	filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L1314'>peer</a>             1314 bgpd/bgpd.c    	if (peer-&gt;default_rmap[afi][safi].name)</span>
<span class='curline'><a href='../S/610.html#L1315'>peer</a>             1315 bgpd/bgpd.c    	  free (peer-&gt;default_rmap[afi][safi].name);</span>
<span class='curline'><a href='../S/610.html#L1318'>peer</a>             1318 bgpd/bgpd.c            peer-&gt;default_rmap[afi][safi].name = NULL;</span>
<span class='curline'><a href='../S/610.html#L1321'>peer</a>             1321 bgpd/bgpd.c      peer_unlock (peer); /* initial reference */</span>
<span class='curline'><a href='../S/610.html#L1334'>peer</a>             1334 bgpd/bgpd.c    peer_group_active (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L1336'>peer</a>             1336 bgpd/bgpd.c      if (peer-&gt;af_group[AFI_IP][SAFI_UNICAST]</span>
<span class='curline'><a href='../S/610.html#L1337'>peer</a>             1337 bgpd/bgpd.c          || peer-&gt;af_group[AFI_IP][SAFI_MULTICAST]</span>
<span class='curline'><a href='../S/610.html#L1338'>peer</a>             1338 bgpd/bgpd.c          || peer-&gt;af_group[AFI_IP][SAFI_MPLS_VPN]</span>
<span class='curline'><a href='../S/610.html#L1339'>peer</a>             1339 bgpd/bgpd.c          || peer-&gt;af_group[AFI_IP6][SAFI_UNICAST]</span>
<span class='curline'><a href='../S/610.html#L1340'>peer</a>             1340 bgpd/bgpd.c          || peer-&gt;af_group[AFI_IP6][SAFI_MULTICAST])</span>
<span class='curline'><a href='../S/610.html#L1385'>peer</a>             1385 bgpd/bgpd.c      group-&gt;peer = list_new ();</span>
<span class='curline'><a href='../S/610.html#L1407'>peer</a>             1407 bgpd/bgpd.c    peer_group2peer_config_copy (struct peer_group *group, struct peer *peer,</span>
<span class='curline'><a href='../S/610.html#L1412'>peer</a>             1412 bgpd/bgpd.c      struct peer *conf;</span>
<span class='curline'><a href='../S/610.html#L1417'>peer</a>             1417 bgpd/bgpd.c      pfilter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L1422'>peer</a>             1422 bgpd/bgpd.c        peer-&gt;as = conf-&gt;as;</span>
<span class='curline'><a href='../S/610.html#L1426'>peer</a>             1426 bgpd/bgpd.c        peer-&gt;change_local_as = conf-&gt;change_local_as;</span>
<span class='curline'><a href='../S/610.html#L1429'>peer</a>             1429 bgpd/bgpd.c      peer-&gt;ttl = conf-&gt;ttl;</span>
<span class='curline'><a href='../S/610.html#L1432'>peer</a>             1432 bgpd/bgpd.c      peer-&gt;gtsm_hops = conf-&gt;gtsm_hops;</span>
<span class='curline'><a href='../S/610.html#L1435'>peer</a>             1435 bgpd/bgpd.c      peer-&gt;weight = conf-&gt;weight;</span>
<span class='curline'><a href='../S/610.html#L1438'>peer</a>             1438 bgpd/bgpd.c      peer-&gt;flags = conf-&gt;flags;</span>
<span class='curline'><a href='../S/610.html#L1440'>peer</a>             1440 bgpd/bgpd.c      peer-&gt;af_flags[afi][safi] = conf-&gt;af_flags[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L1442'>peer</a>             1442 bgpd/bgpd.c      peer-&gt;config = conf-&gt;config;</span>
<span class='curline'><a href='../S/610.html#L1445'>peer</a>             1445 bgpd/bgpd.c      peer-&gt;holdtime = conf-&gt;holdtime;</span>
<span class='curline'><a href='../S/610.html#L1446'>peer</a>             1446 bgpd/bgpd.c      peer-&gt;keepalive = conf-&gt;keepalive;</span>
<span class='curline'><a href='../S/610.html#L1447'>peer</a>             1447 bgpd/bgpd.c      peer-&gt;connect = conf-&gt;connect;</span>
<span class='curline'><a href='../S/610.html#L1449'>peer</a>             1449 bgpd/bgpd.c        peer-&gt;v_connect = conf-&gt;connect;</span>
<span class='curline'><a href='../S/610.html#L1451'>peer</a>             1451 bgpd/bgpd.c        peer-&gt;v_connect = BGP_DEFAULT_CONNECT_RETRY;</span>
<span class='curline'><a href='../S/610.html#L1454'>peer</a>             1454 bgpd/bgpd.c      if (peer_sort (peer) == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L1455'>peer</a>             1455 bgpd/bgpd.c        peer-&gt;v_routeadv = BGP_DEFAULT_IBGP_ROUTEADV;</span>
<span class='curline'><a href='../S/610.html#L1457'>peer</a>             1457 bgpd/bgpd.c        peer-&gt;v_routeadv = BGP_DEFAULT_EBGP_ROUTEADV;</span>
<span class='curline'><a href='../S/610.html#L1460'>peer</a>             1460 bgpd/bgpd.c      if (conf-&gt;password &amp;&amp; !peer-&gt;password)</span>
<span class='curline'><a href='../S/610.html#L1461'>peer</a>             1461 bgpd/bgpd.c        peer-&gt;password =  XSTRDUP (MTYPE_PEER_PASSWORD, conf-&gt;password);</span>
<span class='curline'><a href='../S/610.html#L1463'>peer</a>             1463 bgpd/bgpd.c      bgp_md5_set (peer);</span>
<span class='curline'><a href='../S/610.html#L1466'>peer</a>             1466 bgpd/bgpd.c      peer-&gt;pmax[afi][safi] = conf-&gt;pmax[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L1467'>peer</a>             1467 bgpd/bgpd.c      peer-&gt;pmax_threshold[afi][safi] = conf-&gt;pmax_threshold[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L1468'>peer</a>             1468 bgpd/bgpd.c      peer-&gt;pmax_restart[afi][safi] = conf-&gt;pmax_restart[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L1471'>peer</a>             1471 bgpd/bgpd.c      peer-&gt;allowas_in[afi][safi] = conf-&gt;allowas_in[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L1477'>peer</a>             1477 bgpd/bgpd.c          peer-&gt;rib[afi][safi] = group-&gt;conf-&gt;rib[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L1504'>peer</a>             1504 bgpd/bgpd.c          if (peer-&gt;default_rmap[afi][safi].name)</span>
<span class='curline'><a href='../S/610.html#L1505'>peer</a>             1505 bgpd/bgpd.c    	free (peer-&gt;default_rmap[afi][safi].name);</span>
<span class='curline'><a href='../S/610.html#L1506'>peer</a>             1506 bgpd/bgpd.c          peer-&gt;default_rmap[afi][safi].name = strdup (conf-&gt;default_rmap[afi][safi].name);</span>
<span class='curline'><a href='../S/610.html#L1507'>peer</a>             1507 bgpd/bgpd.c          peer-&gt;default_rmap[afi][safi].map = conf-&gt;default_rmap[afi][safi].map;</span>
<span class='curline'><a href='../S/610.html#L1513'>peer</a>             1513 bgpd/bgpd.c          if (peer-&gt;update_source)</span>
<span class='curline'><a href='../S/610.html#L1514'>peer</a>             1514 bgpd/bgpd.c    	sockunion_free (peer-&gt;update_source);</span>
<span class='curline'><a href='../S/610.html#L1515'>peer</a>             1515 bgpd/bgpd.c          if (peer-&gt;update_if)</span>
<span class='curline'><a href='../S/610.html#L1517'>peer</a>             1517 bgpd/bgpd.c    	  XFREE (MTYPE_PEER_UPDATE_SOURCE, peer-&gt;update_if);</span>
<span class='curline'><a href='../S/610.html#L1518'>peer</a>             1518 bgpd/bgpd.c    	  peer-&gt;update_if = NULL;</span>
<span class='curline'><a href='../S/610.html#L1520'>peer</a>             1520 bgpd/bgpd.c          peer-&gt;update_source = sockunion_dup (conf-&gt;update_source);</span>
<span class='curline'><a href='../S/610.html#L1524'>peer</a>             1524 bgpd/bgpd.c          if (peer-&gt;update_if)</span>
<span class='curline'><a href='../S/610.html#L1525'>peer</a>             1525 bgpd/bgpd.c    	XFREE (MTYPE_PEER_UPDATE_SOURCE, peer-&gt;update_if);</span>
<span class='curline'><a href='../S/610.html#L1526'>peer</a>             1526 bgpd/bgpd.c          if (peer-&gt;update_source)</span>
<span class='curline'><a href='../S/610.html#L1528'>peer</a>             1528 bgpd/bgpd.c    	  sockunion_free (peer-&gt;update_source);</span>
<span class='curline'><a href='../S/610.html#L1529'>peer</a>             1529 bgpd/bgpd.c    	  peer-&gt;update_source = NULL;</span>
<span class='curline'><a href='../S/610.html#L1531'>peer</a>             1531 bgpd/bgpd.c          peer-&gt;update_if = XSTRDUP (MTYPE_PEER_UPDATE_SOURCE, conf-&gt;update_if);</span>
<span class='curline'><a href='../S/610.html#L1666'>peer</a>             1666 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L1680'>peer</a>             1680 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L1682'>peer</a>             1682 bgpd/bgpd.c          if (peer-&gt;as != *as)</span>
<span class='curline'><a href='../S/610.html#L1683'>peer</a>             1683 bgpd/bgpd.c    	peer_as_change (peer, *as);</span>
<span class='curline'><a href='../S/610.html#L1693'>peer</a>             1693 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L1698'>peer</a>             1698 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L1700'>peer</a>             1700 bgpd/bgpd.c          peer-&gt;group = NULL;</span>
<span class='curline'><a href='../S/610.html#L1701'>peer</a>             1701 bgpd/bgpd.c          peer_delete (peer);</span>
<span class='curline'><a href='../S/610.html#L1703'>peer</a>             1703 bgpd/bgpd.c      list_delete (group-&gt;peer);</span>
<span class='curline'><a href='../S/610.html#L1722'>peer</a>             1722 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L1728'>peer</a>             1728 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L1730'>peer</a>             1730 bgpd/bgpd.c          peer-&gt;group = NULL;</span>
<span class='curline'><a href='../S/610.html#L1731'>peer</a>             1731 bgpd/bgpd.c          peer_delete (peer);</span>
<span class='curline'><a href='../S/610.html#L1733'>peer</a>             1733 bgpd/bgpd.c      list_delete_all_node (group-&gt;peer);</span>
<span class='curline'><a href='../S/610.html#L1745'>peer</a>             1745 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L1753'>peer</a>             1753 bgpd/bgpd.c      peer = peer_lookup (bgp, su);</span>
<span class='curline'><a href='../S/610.html#L1756'>peer</a>             1756 bgpd/bgpd.c      if (! peer)</span>
<span class='curline'><a href='../S/610.html#L1761'>peer</a>             1761 bgpd/bgpd.c          peer = peer_create (su, bgp, bgp-&gt;as, group-&gt;conf-&gt;as, afi, safi);</span>
<span class='curline'><a href='../S/610.html#L1762'>peer</a>             1762 bgpd/bgpd.c          peer-&gt;group = group;</span>
<span class='curline'><a href='../S/610.html#L1763'>peer</a>             1763 bgpd/bgpd.c          peer-&gt;af_group[afi][safi] = 1;</span>
<span class='curline'><a href='../S/610.html#L1765'>peer</a>             1765 bgpd/bgpd.c          peer = peer_lock (peer); /* group-&gt;peer list reference */</span>
<span class='curline'><a href='../S/610.html#L1766'>peer</a>             1766 bgpd/bgpd.c          listnode_add (group-&gt;peer, peer);</span>
<span class='curline'><a href='../S/610.html#L1767'>peer</a>             1767 bgpd/bgpd.c          peer_group2peer_config_copy (group, peer, afi, safi);</span>
<span class='curline'><a href='../S/610.html#L1773'>peer</a>             1773 bgpd/bgpd.c      if (peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L1775'>peer</a>             1775 bgpd/bgpd.c          if (strcmp (peer-&gt;group-&gt;name, group-&gt;name) != 0)</span>
<span class='curline'><a href='../S/610.html#L1782'>peer</a>             1782 bgpd/bgpd.c      if (peer_group_active (peer)</span>
<span class='curline'><a href='../S/610.html#L1783'>peer</a>             1783 bgpd/bgpd.c          &amp;&amp; strcmp (peer-&gt;group-&gt;name, group-&gt;name) != 0)</span>
<span class='curline'><a href='../S/610.html#L1789'>peer</a>             1789 bgpd/bgpd.c    	  &amp;&amp; peer_sort (group-&gt;conf) != peer_sort (peer))</span>
<span class='curline'><a href='../S/610.html#L1792'>peer</a>             1792 bgpd/bgpd.c    	    *as = peer-&gt;as;</span>
<span class='curline'><a href='../S/610.html#L1800'>peer</a>             1800 bgpd/bgpd.c      peer-&gt;af_group[afi][safi] = 1;</span>
<span class='curline'><a href='../S/610.html#L1801'>peer</a>             1801 bgpd/bgpd.c      peer-&gt;afc[afi][safi] = 1;</span>
<span class='curline'><a href='../S/610.html#L1802'>peer</a>             1802 bgpd/bgpd.c      if (! peer-&gt;group)</span>
<span class='curline'><a href='../S/610.html#L1804'>peer</a>             1804 bgpd/bgpd.c          peer-&gt;group = group;</span>
<span class='curline'><a href='../S/610.html#L1806'>peer</a>             1806 bgpd/bgpd.c          peer = peer_lock (peer); /* group-&gt;peer list reference */</span>
<span class='curline'><a href='../S/610.html#L1807'>peer</a>             1807 bgpd/bgpd.c          listnode_add (group-&gt;peer, peer);</span>
<span class='curline'><a href='../S/610.html#L1810'>peer</a>             1810 bgpd/bgpd.c        assert (group &amp;&amp; peer-&gt;group == group);</span>
<span class='curline'><a href='../S/610.html#L1828'>peer</a>             1828 bgpd/bgpd.c    	  UNSET_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_NO_PREPEND);</span>
<span class='curline'><a href='../S/610.html#L1829'>peer</a>             1829 bgpd/bgpd.c    	  UNSET_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_REPLACE_AS);</span>
<span class='curline'><a href='../S/610.html#L1833'>peer</a>             1833 bgpd/bgpd.c      if (CHECK_FLAG(peer-&gt;af_flags[afi][safi], PEER_FLAG_RSERVER_CLIENT))</span>
<span class='curline'><a href='../S/610.html#L1840'>peer</a>             1840 bgpd/bgpd.c          if (! peer_rsclient_active (peer)</span>
<span class='curline'><a href='../S/610.html#L1841'>peer</a>             1841 bgpd/bgpd.c              &amp;&amp; (pn = listnode_lookup (bgp-&gt;rsclient, peer)))</span>
<span class='curline'><a href='../S/610.html#L1843'>peer</a>             1843 bgpd/bgpd.c              peer_unlock (peer); /* peer rsclient reference */</span>
<span class='curline'><a href='../S/610.html#L1847'>peer</a>             1847 bgpd/bgpd.c              bgp_clear_route (peer, afi, safi, BGP_CLEAR_ROUTE_MY_RSCLIENT);</span>
<span class='curline'><a href='../S/610.html#L1850'>peer</a>             1850 bgpd/bgpd.c          bgp_table_finish (&amp;peer-&gt;rib[afi][safi]);</span>
<span class='curline'><a href='../S/610.html#L1853'>peer</a>             1853 bgpd/bgpd.c          if (peer-&gt;filter[afi][safi].map[RMAP_IMPORT].name)</span>
<span class='curline'><a href='../S/610.html#L1855'>peer</a>             1855 bgpd/bgpd.c              free (peer-&gt;filter[afi][safi].map[RMAP_IMPORT].name);</span>
<span class='curline'><a href='../S/610.html#L1856'>peer</a>             1856 bgpd/bgpd.c              peer-&gt;filter[afi][safi].map[RMAP_IMPORT].name = NULL;</span>
<span class='curline'><a href='../S/610.html#L1857'>peer</a>             1857 bgpd/bgpd.c              peer-&gt;filter[afi][safi].map[RMAP_IMPORT].map = NULL;</span>
<span class='curline'><a href='../S/610.html#L1862'>peer</a>             1862 bgpd/bgpd.c                  &amp;&amp; peer-&gt;filter[afi][safi].map[RMAP_EXPORT].name)</span>
<span class='curline'><a href='../S/610.html#L1864'>peer</a>             1864 bgpd/bgpd.c              free (peer-&gt;filter[afi][safi].map[RMAP_EXPORT].name);</span>
<span class='curline'><a href='../S/610.html#L1865'>peer</a>             1865 bgpd/bgpd.c              peer-&gt;filter[afi][safi].map[RMAP_EXPORT].name = NULL;</span>
<span class='curline'><a href='../S/610.html#L1866'>peer</a>             1866 bgpd/bgpd.c              peer-&gt;filter[afi][safi].map[RMAP_EXPORT].map = NULL;</span>
<span class='curline'><a href='../S/610.html#L1870'>peer</a>             1870 bgpd/bgpd.c      peer_group2peer_config_copy (group, peer, afi, safi);</span>
<span class='curline'><a href='../S/610.html#L1872'>peer</a>             1872 bgpd/bgpd.c      if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L1874'>peer</a>             1874 bgpd/bgpd.c          peer-&gt;last_reset = PEER_DOWN_RMAP_BIND;</span>
<span class='curline'><a href='../S/610.html#L1875'>peer</a>             1875 bgpd/bgpd.c          bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L1879'>peer</a>             1879 bgpd/bgpd.c        BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L1885'>peer</a>             1885 bgpd/bgpd.c    peer_group_unbind (struct bgp *bgp, struct peer *peer,</span>
<span class='curline'><a href='../S/610.html#L1888'>peer</a>             1888 bgpd/bgpd.c      if (! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L1891'>peer</a>             1891 bgpd/bgpd.c      if (group != peer-&gt;group)</span>
<span class='curline'><a href='../S/610.html#L1894'>peer</a>             1894 bgpd/bgpd.c      peer-&gt;af_group[afi][safi] = 0;</span>
<span class='curline'><a href='../S/610.html#L1895'>peer</a>             1895 bgpd/bgpd.c      peer-&gt;afc[afi][safi] = 0;</span>
<span class='curline'><a href='../S/610.html#L1896'>peer</a>             1896 bgpd/bgpd.c      peer_af_flag_reset (peer, afi, safi);</span>
<span class='curline'><a href='../S/610.html#L1898'>peer</a>             1898 bgpd/bgpd.c      if (peer-&gt;rib[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L1899'>peer</a>             1899 bgpd/bgpd.c        peer-&gt;rib[afi][safi] = NULL;</span>
<span class='curline'><a href='../S/610.html#L1901'>peer</a>             1901 bgpd/bgpd.c      if (! peer_group_active (peer))</span>
<span class='curline'><a href='../S/610.html#L1903'>peer</a>             1903 bgpd/bgpd.c          assert (listnode_lookup (group-&gt;peer, peer));</span>
<span class='curline'><a href='../S/610.html#L1904'>peer</a>             1904 bgpd/bgpd.c          peer_unlock (peer); /* peer group list reference */</span>
<span class='curline'><a href='../S/610.html#L1905'>peer</a>             1905 bgpd/bgpd.c          listnode_delete (group-&gt;peer, peer);</span>
<span class='curline'><a href='../S/610.html#L1906'>peer</a>             1906 bgpd/bgpd.c          peer-&gt;group = NULL;</span>
<span class='curline'><a href='../S/610.html#L1909'>peer</a>             1909 bgpd/bgpd.c    	  peer_delete (peer);</span>
<span class='curline'><a href='../S/610.html#L1912'>peer</a>             1912 bgpd/bgpd.c          peer_global_config_reset (peer);</span>
<span class='curline'><a href='../S/610.html#L1915'>peer</a>             1915 bgpd/bgpd.c      if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L1917'>peer</a>             1917 bgpd/bgpd.c          peer-&gt;last_reset = PEER_DOWN_RMAP_UNBIND;</span>
<span class='curline'><a href='../S/610.html#L1918'>peer</a>             1918 bgpd/bgpd.c          bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L1922'>peer</a>             1922 bgpd/bgpd.c        BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L1942'>peer</a>             1942 bgpd/bgpd.c      bgp-&gt;peer = list_new ();</span>
<span class='curline'><a href='../S/610.html#L1943'>peer</a>             1943 bgpd/bgpd.c      bgp-&gt;peer-&gt;cmp = (int (*)(void *, void *)) peer_cmp;</span>
<span class='curline'><a href='../S/610.html#L2081'>peer</a>             2081 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L2097'>peer</a>             2097 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, next, peer))</span>
<span class='curline'><a href='../S/610.html#L2098'>peer</a>             2098 bgpd/bgpd.c        peer_delete (peer);</span>
<span class='curline'><a href='../S/610.html#L2145'>peer</a>             2145 bgpd/bgpd.c      list_delete (bgp-&gt;peer);</span>
<span class='curline'><a href='../S/610.html#L2164'>peer</a>             2164 bgpd/bgpd.c    struct peer *</span>
<span class='curline'><a href='../S/610.html#L2167'>peer</a>             2167 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L2172'>peer</a>             2172 bgpd/bgpd.c          for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L2173'>peer</a>             2173 bgpd/bgpd.c            if (sockunion_same (&amp;peer-&gt;su, su)</span>
<span class='curline'><a href='../S/610.html#L2174'>peer</a>             2174 bgpd/bgpd.c                &amp;&amp; ! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_ACCEPT_PEER))</span>
<span class='curline'><a href='../S/610.html#L2175'>peer</a>             2175 bgpd/bgpd.c              return peer;</span>
<span class='curline'><a href='../S/610.html#L2182'>peer</a>             2182 bgpd/bgpd.c            for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L2183'>peer</a>             2183 bgpd/bgpd.c              if (sockunion_same (&amp;peer-&gt;su, su)</span>
<span class='curline'><a href='../S/610.html#L2184'>peer</a>             2184 bgpd/bgpd.c                  &amp;&amp; ! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_ACCEPT_PEER))</span>
<span class='curline'><a href='../S/610.html#L2185'>peer</a>             2185 bgpd/bgpd.c                return peer;</span>
<span class='curline'><a href='../S/610.html#L2190'>peer</a>             2190 bgpd/bgpd.c    struct peer *</span>
<span class='curline'><a href='../S/610.html#L2194'>peer</a>             2194 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L2204'>peer</a>             2204 bgpd/bgpd.c          for (ALL_LIST_ELEMENTS_RO (bgp-&gt;peer, node, peer))</span>
<span class='curline'><a href='../S/610.html#L2206'>peer</a>             2206 bgpd/bgpd.c              if (sockunion_same (&amp;peer-&gt;su, su)</span>
<span class='curline'><a href='../S/610.html#L2207'>peer</a>             2207 bgpd/bgpd.c                  &amp;&amp; ! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_ACCEPT_PEER))</span>
<span class='curline'><a href='../S/610.html#L2209'>peer</a>             2209 bgpd/bgpd.c                  if (peer-&gt;as == remote_as</span>
<span class='curline'><a href='../S/610.html#L2210'>peer</a>             2210 bgpd/bgpd.c                      &amp;&amp; peer-&gt;remote_id.s_addr == remote_id-&gt;s_addr)</span>
<span class='curline'><a href='../S/610.html#L2211'>peer</a>             2211 bgpd/bgpd.c                    return peer;</span>
<span class='curline'><a href='../S/610.html#L2212'>peer</a>             2212 bgpd/bgpd.c                  if (peer-&gt;as == remote_as)</span>
<span class='curline'><a href='../S/610.html#L2217'>peer</a>             2217 bgpd/bgpd.c          for (ALL_LIST_ELEMENTS_RO (bgp-&gt;peer, node, peer))</span>
<span class='curline'><a href='../S/610.html#L2219'>peer</a>             2219 bgpd/bgpd.c              if (sockunion_same (&amp;peer-&gt;su, su)</span>
<span class='curline'><a href='../S/610.html#L2220'>peer</a>             2220 bgpd/bgpd.c                  &amp;&amp;  ! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_ACCEPT_PEER))</span>
<span class='curline'><a href='../S/610.html#L2222'>peer</a>             2222 bgpd/bgpd.c                  if (peer-&gt;as == remote_as</span>
<span class='curline'><a href='../S/610.html#L2223'>peer</a>             2223 bgpd/bgpd.c                      &amp;&amp; peer-&gt;remote_id.s_addr == 0)</span>
<span class='curline'><a href='../S/610.html#L2224'>peer</a>             2224 bgpd/bgpd.c                    return peer;</span>
<span class='curline'><a href='../S/610.html#L2225'>peer</a>             2225 bgpd/bgpd.c                  if (peer-&gt;as == remote_as)</span>
<span class='curline'><a href='../S/610.html#L2235'>peer</a>             2235 bgpd/bgpd.c    peer_active (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L2237'>peer</a>             2237 bgpd/bgpd.c      if (peer-&gt;afc[AFI_IP][SAFI_UNICAST]</span>
<span class='curline'><a href='../S/610.html#L2238'>peer</a>             2238 bgpd/bgpd.c          || peer-&gt;afc[AFI_IP][SAFI_MULTICAST]</span>
<span class='curline'><a href='../S/610.html#L2239'>peer</a>             2239 bgpd/bgpd.c          || peer-&gt;afc[AFI_IP][SAFI_MPLS_VPN]</span>
<span class='curline'><a href='../S/610.html#L2240'>peer</a>             2240 bgpd/bgpd.c          || peer-&gt;afc[AFI_IP6][SAFI_UNICAST]</span>
<span class='curline'><a href='../S/610.html#L2241'>peer</a>             2241 bgpd/bgpd.c          || peer-&gt;afc[AFI_IP6][SAFI_MULTICAST])</span>
<span class='curline'><a href='../S/610.html#L2248'>peer</a>             2248 bgpd/bgpd.c    peer_active_nego (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L2250'>peer</a>             2250 bgpd/bgpd.c      if (peer-&gt;afc_nego[AFI_IP][SAFI_UNICAST]</span>
<span class='curline'><a href='../S/610.html#L2251'>peer</a>             2251 bgpd/bgpd.c          || peer-&gt;afc_nego[AFI_IP][SAFI_MULTICAST]</span>
<span class='curline'><a href='../S/610.html#L2252'>peer</a>             2252 bgpd/bgpd.c          || peer-&gt;afc_nego[AFI_IP][SAFI_MPLS_VPN]</span>
<span class='curline'><a href='../S/610.html#L2253'>peer</a>             2253 bgpd/bgpd.c          || peer-&gt;afc_nego[AFI_IP6][SAFI_UNICAST]</span>
<span class='curline'><a href='../S/610.html#L2254'>peer</a>             2254 bgpd/bgpd.c          || peer-&gt;afc_nego[AFI_IP6][SAFI_MULTICAST])</span>
<span class='curline'><a href='../S/610.html#L2269'>peer</a>             2269 bgpd/bgpd.c    peer_change_action (struct peer *peer, afi_t afi, safi_t safi,</span>
<span class='curline'><a href='../S/610.html#L2272'>peer</a>             2272 bgpd/bgpd.c      if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L2276'>peer</a>             2276 bgpd/bgpd.c        bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L2280'>peer</a>             2280 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;cap, PEER_CAP_REFRESH_OLD_RCV)</span>
<span class='curline'><a href='../S/610.html#L2281'>peer</a>             2281 bgpd/bgpd.c    	  || CHECK_FLAG (peer-&gt;cap, PEER_CAP_REFRESH_NEW_RCV))</span>
<span class='curline'><a href='../S/610.html#L2282'>peer</a>             2282 bgpd/bgpd.c    	bgp_route_refresh_send (peer, afi, safi, 0, 0, 0);</span>
<span class='curline'><a href='../S/610.html#L2284'>peer</a>             2284 bgpd/bgpd.c    	bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L2288'>peer</a>             2288 bgpd/bgpd.c        bgp_announce_route (peer, afi, safi);</span>
<span class='curline'><a href='../S/610.html#L2388'>peer</a>             2388 bgpd/bgpd.c    peer_flag_modify_action (struct peer *peer, u_int32_t flag)</span>
<span class='curline'><a href='../S/610.html#L2392'>peer</a>             2392 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;flags, flag))</span>
<span class='curline'><a href='../S/610.html#L2394'>peer</a>             2394 bgpd/bgpd.c    	  if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_NSF_WAIT))</span>
<span class='curline'><a href='../S/610.html#L2395'>peer</a>             2395 bgpd/bgpd.c    	    peer_nsf_stop (peer);</span>
<span class='curline'><a href='../S/610.html#L2397'>peer</a>             2397 bgpd/bgpd.c    	  UNSET_FLAG (peer-&gt;sflags, PEER_STATUS_PREFIX_OVERFLOW);</span>
<span class='curline'><a href='../S/610.html#L2398'>peer</a>             2398 bgpd/bgpd.c    	  if (peer-&gt;t_pmax_restart)</span>
<span class='curline'><a href='../S/610.html#L2400'>peer</a>             2400 bgpd/bgpd.c    	      BGP_TIMER_OFF (peer-&gt;t_pmax_restart);</span>
<span class='curline'><a href='../S/610.html#L2403'>peer</a>             2403 bgpd/bgpd.c    			    peer-&gt;host);</span>
<span class='curline'><a href='../S/610.html#L2406'>peer</a>             2406 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_NSF_WAIT))</span>
<span class='curline'><a href='../S/610.html#L2407'>peer</a>             2407 bgpd/bgpd.c    	peer_nsf_stop (peer);</span>
<span class='curline'><a href='../S/610.html#L2409'>peer</a>             2409 bgpd/bgpd.c    	  if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L2410'>peer</a>             2410 bgpd/bgpd.c    	    bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L2413'>peer</a>             2413 bgpd/bgpd.c    	    BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L2417'>peer</a>             2417 bgpd/bgpd.c    	  peer-&gt;v_start = BGP_INIT_START_TIMER;</span>
<span class='curline'><a href='../S/610.html#L2418'>peer</a>             2418 bgpd/bgpd.c    	  BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L2421'>peer</a>             2421 bgpd/bgpd.c      else if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L2424'>peer</a>             2424 bgpd/bgpd.c    	peer-&gt;last_reset = PEER_DOWN_CAPABILITY_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L2426'>peer</a>             2426 bgpd/bgpd.c    	peer-&gt;last_reset = PEER_DOWN_PASSIVE_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L2428'>peer</a>             2428 bgpd/bgpd.c    	peer-&gt;last_reset = PEER_DOWN_MULTIHOP_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L2430'>peer</a>             2430 bgpd/bgpd.c          bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L2434'>peer</a>             2434 bgpd/bgpd.c        BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L2439'>peer</a>             2439 bgpd/bgpd.c    peer_flag_modify (struct peer *peer, u_int32_t flag, int set)</span>
<span class='curline'><a href='../S/610.html#L2457'>peer</a>             2457 bgpd/bgpd.c      if (action.not_for_member &amp;&amp; peer_group_active (peer))</span>
<span class='curline'><a href='../S/610.html#L2462'>peer</a>             2462 bgpd/bgpd.c      if (! set &amp;&amp; peer_group_active (peer))</span>
<span class='curline'><a href='../S/610.html#L2463'>peer</a>             2463 bgpd/bgpd.c        if (CHECK_FLAG (peer-&gt;group-&gt;conf-&gt;flags, flag))</span>
<span class='curline'><a href='../S/610.html#L2473'>peer</a>             2473 bgpd/bgpd.c          &amp;&amp; CHECK_FLAG (peer-&gt;flags | flag, PEER_FLAG_STRICT_CAP_MATCH)</span>
<span class='curline'><a href='../S/610.html#L2474'>peer</a>             2474 bgpd/bgpd.c          &amp;&amp; CHECK_FLAG (peer-&gt;flags | flag, PEER_FLAG_OVERRIDE_CAPABILITY))</span>
<span class='curline'><a href='../S/610.html#L2477'>peer</a>             2477 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L2479'>peer</a>             2479 bgpd/bgpd.c          if (set &amp;&amp; CHECK_FLAG (peer-&gt;flags, flag) == flag)</span>
<span class='curline'><a href='../S/610.html#L2481'>peer</a>             2481 bgpd/bgpd.c          if (! set &amp;&amp; ! CHECK_FLAG (peer-&gt;flags, flag))</span>
<span class='curline'><a href='../S/610.html#L2486'>peer</a>             2486 bgpd/bgpd.c        SET_FLAG (peer-&gt;flags, flag);</span>
<span class='curline'><a href='../S/610.html#L2488'>peer</a>             2488 bgpd/bgpd.c        UNSET_FLAG (peer-&gt;flags, flag);</span>
<span class='curline'><a href='../S/610.html#L2490'>peer</a>             2490 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L2493'>peer</a>             2493 bgpd/bgpd.c    	peer_flag_modify_action (peer, flag);</span>
<span class='curline'><a href='../S/610.html#L2499'>peer</a>             2499 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L2501'>peer</a>             2501 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L2503'>peer</a>             2503 bgpd/bgpd.c          if (set &amp;&amp; CHECK_FLAG (peer-&gt;flags, flag) == flag)</span>
<span class='curline'><a href='../S/610.html#L2506'>peer</a>             2506 bgpd/bgpd.c          if (! set &amp;&amp; ! CHECK_FLAG (peer-&gt;flags, flag))</span>
<span class='curline'><a href='../S/610.html#L2510'>peer</a>             2510 bgpd/bgpd.c    	SET_FLAG (peer-&gt;flags, flag);</span>
<span class='curline'><a href='../S/610.html#L2512'>peer</a>             2512 bgpd/bgpd.c    	UNSET_FLAG (peer-&gt;flags, flag);</span>
<span class='curline'><a href='../S/610.html#L2515'>peer</a>             2515 bgpd/bgpd.c    	peer_flag_modify_action (peer, flag);</span>
<span class='curline'><a href='../S/610.html#L2521'>peer</a>             2521 bgpd/bgpd.c    peer_flag_set (struct peer *peer, u_int32_t flag)</span>
<span class='curline'><a href='../S/610.html#L2523'>peer</a>             2523 bgpd/bgpd.c      return peer_flag_modify (peer, flag, 1);</span>
<span class='curline'><a href='../S/610.html#L2527'>peer</a>             2527 bgpd/bgpd.c    peer_flag_unset (struct peer *peer, u_int32_t flag)</span>
<span class='curline'><a href='../S/610.html#L2529'>peer</a>             2529 bgpd/bgpd.c      return peer_flag_modify (peer, flag, 0);</span>
<span class='curline'><a href='../S/610.html#L2533'>peer</a>             2533 bgpd/bgpd.c    peer_is_group_member (struct peer *peer, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/610.html#L2535'>peer</a>             2535 bgpd/bgpd.c      if (peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L2541'>peer</a>             2541 bgpd/bgpd.c    peer_af_flag_modify (struct peer *peer, afi_t afi, safi_t safi, u_int32_t flag,</span>
<span class='curline'><a href='../S/610.html#L2560'>peer</a>             2560 bgpd/bgpd.c      if (! peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L2564'>peer</a>             2564 bgpd/bgpd.c      if (action.not_for_member &amp;&amp; peer_is_group_member (peer, afi, safi))</span>
<span class='curline'><a href='../S/610.html#L2569'>peer</a>             2569 bgpd/bgpd.c          &amp;&amp; peer_sort (peer) != BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L2574'>peer</a>             2574 bgpd/bgpd.c          &amp;&amp; peer_sort (peer) == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L2579'>peer</a>             2579 bgpd/bgpd.c      if (! set &amp;&amp; peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L2580'>peer</a>             2580 bgpd/bgpd.c        if (CHECK_FLAG (peer-&gt;group-&gt;conf-&gt;af_flags[afi][safi], flag))</span>
<span class='curline'><a href='../S/610.html#L2584'>peer</a>             2584 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L2586'>peer</a>             2586 bgpd/bgpd.c          if (set &amp;&amp; CHECK_FLAG (peer-&gt;af_flags[afi][safi], flag) == flag)</span>
<span class='curline'><a href='../S/610.html#L2588'>peer</a>             2588 bgpd/bgpd.c          if (! set &amp;&amp; ! CHECK_FLAG (peer-&gt;af_flags[afi][safi], flag))</span>
<span class='curline'><a href='../S/610.html#L2593'>peer</a>             2593 bgpd/bgpd.c        SET_FLAG (peer-&gt;af_flags[afi][safi], flag);</span>
<span class='curline'><a href='../S/610.html#L2595'>peer</a>             2595 bgpd/bgpd.c        UNSET_FLAG (peer-&gt;af_flags[afi][safi], flag);</span>
<span class='curline'><a href='../S/610.html#L2598'>peer</a>             2598 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP)</span>
<span class='curline'><a href='../S/610.html#L2599'>peer</a>             2599 bgpd/bgpd.c          &amp;&amp; peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L2602'>peer</a>             2602 bgpd/bgpd.c    	bgp_clear_adj_in (peer, afi, safi);</span>
<span class='curline'><a href='../S/610.html#L2606'>peer</a>             2606 bgpd/bgpd.c               peer-&gt;last_reset = PEER_DOWN_RR_CLIENT_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L2608'>peer</a>             2608 bgpd/bgpd.c               peer-&gt;last_reset = PEER_DOWN_RS_CLIENT_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L2610'>peer</a>             2610 bgpd/bgpd.c               peer-&gt;last_reset = PEER_DOWN_CAPABILITY_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L2612'>peer</a>             2612 bgpd/bgpd.c               peer-&gt;last_reset = PEER_DOWN_CAPABILITY_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L2614'>peer</a>             2614 bgpd/bgpd.c             peer_change_action (peer, afi, safi, action.type);</span>
<span class='curline'><a href='../S/610.html#L2620'>peer</a>             2620 bgpd/bgpd.c      if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L2622'>peer</a>             2622 bgpd/bgpd.c          group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L2624'>peer</a>             2624 bgpd/bgpd.c          for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L2626'>peer</a>             2626 bgpd/bgpd.c    	  if (! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L2629'>peer</a>             2629 bgpd/bgpd.c    	  if (set &amp;&amp; CHECK_FLAG (peer-&gt;af_flags[afi][safi], flag) == flag)</span>
<span class='curline'><a href='../S/610.html#L2632'>peer</a>             2632 bgpd/bgpd.c    	  if (! set &amp;&amp; ! CHECK_FLAG (peer-&gt;af_flags[afi][safi], flag))</span>
<span class='curline'><a href='../S/610.html#L2636'>peer</a>             2636 bgpd/bgpd.c    	    SET_FLAG (peer-&gt;af_flags[afi][safi], flag);</span>
<span class='curline'><a href='../S/610.html#L2638'>peer</a>             2638 bgpd/bgpd.c    	    UNSET_FLAG (peer-&gt;af_flags[afi][safi], flag);</span>
<span class='curline'><a href='../S/610.html#L2640'>peer</a>             2640 bgpd/bgpd.c    	  if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L2643'>peer</a>             2643 bgpd/bgpd.c    		bgp_clear_adj_in (peer, afi, safi);</span>
<span class='curline'><a href='../S/610.html#L2647'>peer</a>             2647 bgpd/bgpd.c                       peer-&gt;last_reset = PEER_DOWN_RR_CLIENT_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L2649'>peer</a>             2649 bgpd/bgpd.c                       peer-&gt;last_reset = PEER_DOWN_RS_CLIENT_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L2651'>peer</a>             2651 bgpd/bgpd.c                       peer-&gt;last_reset = PEER_DOWN_CAPABILITY_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L2653'>peer</a>             2653 bgpd/bgpd.c                       peer-&gt;last_reset = PEER_DOWN_CAPABILITY_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L2655'>peer</a>             2655 bgpd/bgpd.c                     peer_change_action (peer, afi, safi, action.type);</span>
<span class='curline'><a href='../S/610.html#L2664'>peer</a>             2664 bgpd/bgpd.c    peer_af_flag_set (struct peer *peer, afi_t afi, safi_t safi, u_int32_t flag)</span>
<span class='curline'><a href='../S/610.html#L2666'>peer</a>             2666 bgpd/bgpd.c      return peer_af_flag_modify (peer, afi, safi, flag, 1);</span>
<span class='curline'><a href='../S/610.html#L2670'>peer</a>             2670 bgpd/bgpd.c    peer_af_flag_unset (struct peer *peer, afi_t afi, safi_t safi, u_int32_t flag)</span>
<span class='curline'><a href='../S/610.html#L2672'>peer</a>             2672 bgpd/bgpd.c      return peer_af_flag_modify (peer, afi, safi, flag, 0);</span>
<span class='curline'><a href='../S/610.html#L2677'>peer</a>             2677 bgpd/bgpd.c    peer_ebgp_multihop_set (struct peer *peer, int ttl)</span>
<span class='curline'><a href='../S/610.html#L2681'>peer</a>             2681 bgpd/bgpd.c      struct peer *peer1;</span>
<span class='curline'><a href='../S/610.html#L2683'>peer</a>             2683 bgpd/bgpd.c      if (peer-&gt;sort == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L2689'>peer</a>             2689 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L2691'>peer</a>             2691 bgpd/bgpd.c              group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L2695'>peer</a>             2695 bgpd/bgpd.c              for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer1))</span>
<span class='curline'><a href='../S/610.html#L2706'>peer</a>             2706 bgpd/bgpd.c              if (peer-&gt;gtsm_hops != 0)</span>
<span class='curline'><a href='../S/610.html#L2711'>peer</a>             2711 bgpd/bgpd.c      peer-&gt;ttl = ttl;</span>
<span class='curline'><a href='../S/610.html#L2713'>peer</a>             2713 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L2715'>peer</a>             2715 bgpd/bgpd.c          if (peer-&gt;fd &gt;= 0 &amp;&amp; peer-&gt;sort != BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L2716'>peer</a>             2716 bgpd/bgpd.c    	sockopt_ttl (peer-&gt;su.sa.sa_family, peer-&gt;fd, peer-&gt;ttl);</span>
<span class='curline'><a href='../S/610.html#L2720'>peer</a>             2720 bgpd/bgpd.c          group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L2721'>peer</a>             2721 bgpd/bgpd.c          for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L2723'>peer</a>             2723 bgpd/bgpd.c    	  if (peer-&gt;sort == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L2726'>peer</a>             2726 bgpd/bgpd.c    	  peer-&gt;ttl = group-&gt;conf-&gt;ttl;</span>
<span class='curline'><a href='../S/610.html#L2728'>peer</a>             2728 bgpd/bgpd.c    	  if (peer-&gt;fd &gt;= 0)</span>
<span class='curline'><a href='../S/610.html#L2729'>peer</a>             2729 bgpd/bgpd.c    	    sockopt_ttl (peer-&gt;su.sa.sa_family, peer-&gt;fd, peer-&gt;ttl);</span>
<span class='curline'><a href='../S/610.html#L2736'>peer</a>             2736 bgpd/bgpd.c    peer_ebgp_multihop_unset (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L2741'>peer</a>             2741 bgpd/bgpd.c      if (peer-&gt;sort == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L2744'>peer</a>             2744 bgpd/bgpd.c      if (peer-&gt;gtsm_hops != 0 &amp;&amp; peer-&gt;ttl != MAXTTL)</span>
<span class='curline'><a href='../S/610.html#L2747'>peer</a>             2747 bgpd/bgpd.c      if (peer_group_active (peer))</span>
<span class='curline'><a href='../S/610.html#L2748'>peer</a>             2748 bgpd/bgpd.c        peer-&gt;ttl = peer-&gt;group-&gt;conf-&gt;ttl;</span>
<span class='curline'><a href='../S/610.html#L2750'>peer</a>             2750 bgpd/bgpd.c        peer-&gt;ttl = 1;</span>
<span class='curline'><a href='../S/610.html#L2752'>peer</a>             2752 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L2754'>peer</a>             2754 bgpd/bgpd.c          if (peer-&gt;fd &gt;= 0 &amp;&amp; peer-&gt;sort != BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L2755'>peer</a>             2755 bgpd/bgpd.c    	sockopt_ttl (peer-&gt;su.sa.sa_family, peer-&gt;fd, peer-&gt;ttl);</span>
<span class='curline'><a href='../S/610.html#L2759'>peer</a>             2759 bgpd/bgpd.c          group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L2760'>peer</a>             2760 bgpd/bgpd.c          for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L2762'>peer</a>             2762 bgpd/bgpd.c    	  if (peer-&gt;sort == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L2765'>peer</a>             2765 bgpd/bgpd.c    	  peer-&gt;ttl = 1;</span>
<span class='curline'><a href='../S/610.html#L2767'>peer</a>             2767 bgpd/bgpd.c    	  if (peer-&gt;fd &gt;= 0)</span>
<span class='curline'><a href='../S/610.html#L2768'>peer</a>             2768 bgpd/bgpd.c    	    sockopt_ttl (peer-&gt;su.sa.sa_family, peer-&gt;fd, peer-&gt;ttl);</span>
<span class='curline'><a href='../S/610.html#L2776'>peer</a>             2776 bgpd/bgpd.c    peer_description_set (struct peer *peer, char *desc)</span>
<span class='curline'><a href='../S/610.html#L2778'>peer</a>             2778 bgpd/bgpd.c      if (peer-&gt;desc)</span>
<span class='curline'><a href='../S/610.html#L2779'>peer</a>             2779 bgpd/bgpd.c        XFREE (MTYPE_PEER_DESC, peer-&gt;desc);</span>
<span class='curline'><a href='../S/610.html#L2781'>peer</a>             2781 bgpd/bgpd.c      peer-&gt;desc = XSTRDUP (MTYPE_PEER_DESC, desc);</span>
<span class='curline'><a href='../S/610.html#L2787'>peer</a>             2787 bgpd/bgpd.c    peer_description_unset (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L2789'>peer</a>             2789 bgpd/bgpd.c      if (peer-&gt;desc)</span>
<span class='curline'><a href='../S/610.html#L2790'>peer</a>             2790 bgpd/bgpd.c        XFREE (MTYPE_PEER_DESC, peer-&gt;desc);</span>
<span class='curline'><a href='../S/610.html#L2792'>peer</a>             2792 bgpd/bgpd.c      peer-&gt;desc = NULL;</span>
<span class='curline'><a href='../S/610.html#L2799'>peer</a>             2799 bgpd/bgpd.c    peer_update_source_if_set (struct peer *peer, const char *ifname)</span>
<span class='curline'><a href='../S/610.html#L2804'>peer</a>             2804 bgpd/bgpd.c      if (peer-&gt;update_if)</span>
<span class='curline'><a href='../S/610.html#L2806'>peer</a>             2806 bgpd/bgpd.c          if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP)</span>
<span class='curline'><a href='../S/610.html#L2807'>peer</a>             2807 bgpd/bgpd.c    	  &amp;&amp; strcmp (peer-&gt;update_if, ifname) == 0)</span>
<span class='curline'><a href='../S/610.html#L2810'>peer</a>             2810 bgpd/bgpd.c          XFREE (MTYPE_PEER_UPDATE_SOURCE, peer-&gt;update_if);</span>
<span class='curline'><a href='../S/610.html#L2811'>peer</a>             2811 bgpd/bgpd.c          peer-&gt;update_if = NULL;</span>
<span class='curline'><a href='../S/610.html#L2814'>peer</a>             2814 bgpd/bgpd.c      if (peer-&gt;update_source)</span>
<span class='curline'><a href='../S/610.html#L2816'>peer</a>             2816 bgpd/bgpd.c          sockunion_free (peer-&gt;update_source);</span>
<span class='curline'><a href='../S/610.html#L2817'>peer</a>             2817 bgpd/bgpd.c          peer-&gt;update_source = NULL;</span>
<span class='curline'><a href='../S/610.html#L2820'>peer</a>             2820 bgpd/bgpd.c      peer-&gt;update_if = XSTRDUP (MTYPE_PEER_UPDATE_SOURCE, ifname);</span>
<span class='curline'><a href='../S/610.html#L2822'>peer</a>             2822 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L2824'>peer</a>             2824 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L2826'>peer</a>             2826 bgpd/bgpd.c             peer-&gt;last_reset = PEER_DOWN_UPDATE_SOURCE_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L2827'>peer</a>             2827 bgpd/bgpd.c             bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L2831'>peer</a>             2831 bgpd/bgpd.c    	BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L2836'>peer</a>             2836 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L2837'>peer</a>             2837 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L2839'>peer</a>             2839 bgpd/bgpd.c          if (peer-&gt;update_if)</span>
<span class='curline'><a href='../S/610.html#L2841'>peer</a>             2841 bgpd/bgpd.c    	  if (strcmp (peer-&gt;update_if, ifname) == 0)</span>
<span class='curline'><a href='../S/610.html#L2844'>peer</a>             2844 bgpd/bgpd.c    	  XFREE (MTYPE_PEER_UPDATE_SOURCE, peer-&gt;update_if);</span>
<span class='curline'><a href='../S/610.html#L2845'>peer</a>             2845 bgpd/bgpd.c    	  peer-&gt;update_if = NULL;</span>
<span class='curline'><a href='../S/610.html#L2848'>peer</a>             2848 bgpd/bgpd.c          if (peer-&gt;update_source)</span>
<span class='curline'><a href='../S/610.html#L2850'>peer</a>             2850 bgpd/bgpd.c    	  sockunion_free (peer-&gt;update_source);</span>
<span class='curline'><a href='../S/610.html#L2851'>peer</a>             2851 bgpd/bgpd.c    	  peer-&gt;update_source = NULL;</span>
<span class='curline'><a href='../S/610.html#L2854'>peer</a>             2854 bgpd/bgpd.c          peer-&gt;update_if = XSTRDUP (MTYPE_PEER_UPDATE_SOURCE, ifname);</span>
<span class='curline'><a href='../S/610.html#L2856'>peer</a>             2856 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L2858'>peer</a>             2858 bgpd/bgpd.c             peer-&gt;last_reset = PEER_DOWN_UPDATE_SOURCE_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L2859'>peer</a>             2859 bgpd/bgpd.c             bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L2863'>peer</a>             2863 bgpd/bgpd.c    	BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L2869'>peer</a>             2869 bgpd/bgpd.c    peer_update_source_addr_set (struct peer *peer, union sockunion *su)</span>
<span class='curline'><a href='../S/610.html#L2874'>peer</a>             2874 bgpd/bgpd.c      if (peer-&gt;update_source)</span>
<span class='curline'><a href='../S/610.html#L2876'>peer</a>             2876 bgpd/bgpd.c          if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP)</span>
<span class='curline'><a href='../S/610.html#L2877'>peer</a>             2877 bgpd/bgpd.c    	  &amp;&amp; sockunion_cmp (peer-&gt;update_source, su) == 0)</span>
<span class='curline'><a href='../S/610.html#L2879'>peer</a>             2879 bgpd/bgpd.c          sockunion_free (peer-&gt;update_source);</span>
<span class='curline'><a href='../S/610.html#L2880'>peer</a>             2880 bgpd/bgpd.c          peer-&gt;update_source = NULL;</span>
<span class='curline'><a href='../S/610.html#L2883'>peer</a>             2883 bgpd/bgpd.c      if (peer-&gt;update_if)</span>
<span class='curline'><a href='../S/610.html#L2885'>peer</a>             2885 bgpd/bgpd.c          XFREE (MTYPE_PEER_UPDATE_SOURCE, peer-&gt;update_if);</span>
<span class='curline'><a href='../S/610.html#L2886'>peer</a>             2886 bgpd/bgpd.c          peer-&gt;update_if = NULL;</span>
<span class='curline'><a href='../S/610.html#L2889'>peer</a>             2889 bgpd/bgpd.c      peer-&gt;update_source = sockunion_dup (su);</span>
<span class='curline'><a href='../S/610.html#L2891'>peer</a>             2891 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L2893'>peer</a>             2893 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L2895'>peer</a>             2895 bgpd/bgpd.c             peer-&gt;last_reset = PEER_DOWN_UPDATE_SOURCE_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L2896'>peer</a>             2896 bgpd/bgpd.c             bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L2900'>peer</a>             2900 bgpd/bgpd.c    	BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L2905'>peer</a>             2905 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L2906'>peer</a>             2906 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L2908'>peer</a>             2908 bgpd/bgpd.c          if (peer-&gt;update_source)</span>
<span class='curline'><a href='../S/610.html#L2910'>peer</a>             2910 bgpd/bgpd.c    	  if (sockunion_cmp (peer-&gt;update_source, su) == 0)</span>
<span class='curline'><a href='../S/610.html#L2912'>peer</a>             2912 bgpd/bgpd.c    	  sockunion_free (peer-&gt;update_source);</span>
<span class='curline'><a href='../S/610.html#L2913'>peer</a>             2913 bgpd/bgpd.c    	  peer-&gt;update_source = NULL;</span>
<span class='curline'><a href='../S/610.html#L2916'>peer</a>             2916 bgpd/bgpd.c          if (peer-&gt;update_if)</span>
<span class='curline'><a href='../S/610.html#L2918'>peer</a>             2918 bgpd/bgpd.c    	  XFREE (MTYPE_PEER_UPDATE_SOURCE, peer-&gt;update_if);</span>
<span class='curline'><a href='../S/610.html#L2919'>peer</a>             2919 bgpd/bgpd.c    	  peer-&gt;update_if = NULL;</span>
<span class='curline'><a href='../S/610.html#L2922'>peer</a>             2922 bgpd/bgpd.c          peer-&gt;update_source = sockunion_dup (su);</span>
<span class='curline'><a href='../S/610.html#L2924'>peer</a>             2924 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L2926'>peer</a>             2926 bgpd/bgpd.c             peer-&gt;last_reset = PEER_DOWN_UPDATE_SOURCE_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L2927'>peer</a>             2927 bgpd/bgpd.c             bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L2931'>peer</a>             2931 bgpd/bgpd.c    	BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L2937'>peer</a>             2937 bgpd/bgpd.c    peer_update_source_unset (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L2943'>peer</a>             2943 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP)</span>
<span class='curline'><a href='../S/610.html#L2944'>peer</a>             2944 bgpd/bgpd.c          &amp;&amp; ! peer-&gt;update_source</span>
<span class='curline'><a href='../S/610.html#L2945'>peer</a>             2945 bgpd/bgpd.c          &amp;&amp; ! peer-&gt;update_if)</span>
<span class='curline'><a href='../S/610.html#L2948'>peer</a>             2948 bgpd/bgpd.c      if (peer-&gt;update_source)</span>
<span class='curline'><a href='../S/610.html#L2950'>peer</a>             2950 bgpd/bgpd.c          sockunion_free (peer-&gt;update_source);</span>
<span class='curline'><a href='../S/610.html#L2951'>peer</a>             2951 bgpd/bgpd.c          peer-&gt;update_source = NULL;</span>
<span class='curline'><a href='../S/610.html#L2953'>peer</a>             2953 bgpd/bgpd.c      if (peer-&gt;update_if)</span>
<span class='curline'><a href='../S/610.html#L2955'>peer</a>             2955 bgpd/bgpd.c          XFREE (MTYPE_PEER_UPDATE_SOURCE, peer-&gt;update_if);</span>
<span class='curline'><a href='../S/610.html#L2956'>peer</a>             2956 bgpd/bgpd.c          peer-&gt;update_if = NULL;</span>
<span class='curline'><a href='../S/610.html#L2959'>peer</a>             2959 bgpd/bgpd.c      if (peer_group_active (peer))</span>
<span class='curline'><a href='../S/610.html#L2961'>peer</a>             2961 bgpd/bgpd.c          group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L2966'>peer</a>             2966 bgpd/bgpd.c    	  peer-&gt;update_source = su;</span>
<span class='curline'><a href='../S/610.html#L2969'>peer</a>             2969 bgpd/bgpd.c    	peer-&gt;update_if = </span>
<span class='curline'><a href='../S/610.html#L2973'>peer</a>             2973 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L2975'>peer</a>             2975 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L2977'>peer</a>             2977 bgpd/bgpd.c             peer-&gt;last_reset = PEER_DOWN_UPDATE_SOURCE_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L2978'>peer</a>             2978 bgpd/bgpd.c             bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L2982'>peer</a>             2982 bgpd/bgpd.c    	BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L2987'>peer</a>             2987 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L2988'>peer</a>             2988 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L2990'>peer</a>             2990 bgpd/bgpd.c          if (! peer-&gt;update_source &amp;&amp; ! peer-&gt;update_if)</span>
<span class='curline'><a href='../S/610.html#L2993'>peer</a>             2993 bgpd/bgpd.c          if (peer-&gt;update_source)</span>
<span class='curline'><a href='../S/610.html#L2995'>peer</a>             2995 bgpd/bgpd.c    	  sockunion_free (peer-&gt;update_source);</span>
<span class='curline'><a href='../S/610.html#L2996'>peer</a>             2996 bgpd/bgpd.c    	  peer-&gt;update_source = NULL;</span>
<span class='curline'><a href='../S/610.html#L2999'>peer</a>             2999 bgpd/bgpd.c          if (peer-&gt;update_if)</span>
<span class='curline'><a href='../S/610.html#L3001'>peer</a>             3001 bgpd/bgpd.c    	  XFREE (MTYPE_PEER_UPDATE_SOURCE, peer-&gt;update_if);</span>
<span class='curline'><a href='../S/610.html#L3002'>peer</a>             3002 bgpd/bgpd.c    	  peer-&gt;update_if = NULL;</span>
<span class='curline'><a href='../S/610.html#L3005'>peer</a>             3005 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L3007'>peer</a>             3007 bgpd/bgpd.c             peer-&gt;last_reset = PEER_DOWN_UPDATE_SOURCE_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L3008'>peer</a>             3008 bgpd/bgpd.c             bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L3012'>peer</a>             3012 bgpd/bgpd.c    	BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L3018'>peer</a>             3018 bgpd/bgpd.c    peer_default_originate_set (struct peer *peer, afi_t afi, safi_t safi,</span>
<span class='curline'><a href='../S/610.html#L3025'>peer</a>             3025 bgpd/bgpd.c      if (! peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L3029'>peer</a>             3029 bgpd/bgpd.c      if (peer_is_group_member (peer, afi, safi))</span>
<span class='curline'><a href='../S/610.html#L3032'>peer</a>             3032 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_DEFAULT_ORIGINATE)</span>
<span class='curline'><a href='../S/610.html#L3033'>peer</a>             3033 bgpd/bgpd.c          || (rmap &amp;&amp; ! peer-&gt;default_rmap[afi][safi].name)</span>
<span class='curline'><a href='../S/610.html#L3034'>peer</a>             3034 bgpd/bgpd.c          || (rmap &amp;&amp; strcmp (rmap, peer-&gt;default_rmap[afi][safi].name) != 0))</span>
<span class='curline'><a href='../S/610.html#L3036'>peer</a>             3036 bgpd/bgpd.c          SET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_DEFAULT_ORIGINATE);</span>
<span class='curline'><a href='../S/610.html#L3040'>peer</a>             3040 bgpd/bgpd.c    	  if (peer-&gt;default_rmap[afi][safi].name)</span>
<span class='curline'><a href='../S/610.html#L3041'>peer</a>             3041 bgpd/bgpd.c    	    free (peer-&gt;default_rmap[afi][safi].name);</span>
<span class='curline'><a href='../S/610.html#L3042'>peer</a>             3042 bgpd/bgpd.c    	  peer-&gt;default_rmap[afi][safi].name = strdup (rmap);</span>
<span class='curline'><a href='../S/610.html#L3043'>peer</a>             3043 bgpd/bgpd.c    	  peer-&gt;default_rmap[afi][safi].map = route_map_lookup_by_name (rmap);</span>
<span class='curline'><a href='../S/610.html#L3047'>peer</a>             3047 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L3049'>peer</a>             3049 bgpd/bgpd.c          if (peer-&gt;status == Established &amp;&amp; peer-&gt;afc_nego[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L3050'>peer</a>             3050 bgpd/bgpd.c    	bgp_default_originate (peer, afi, safi, 0);</span>
<span class='curline'><a href='../S/610.html#L3055'>peer</a>             3055 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L3056'>peer</a>             3056 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L3058'>peer</a>             3058 bgpd/bgpd.c          SET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_DEFAULT_ORIGINATE);</span>
<span class='curline'><a href='../S/610.html#L3062'>peer</a>             3062 bgpd/bgpd.c    	  if (peer-&gt;default_rmap[afi][safi].name)</span>
<span class='curline'><a href='../S/610.html#L3063'>peer</a>             3063 bgpd/bgpd.c    	    free (peer-&gt;default_rmap[afi][safi].name);</span>
<span class='curline'><a href='../S/610.html#L3064'>peer</a>             3064 bgpd/bgpd.c    	  peer-&gt;default_rmap[afi][safi].name = strdup (rmap);</span>
<span class='curline'><a href='../S/610.html#L3065'>peer</a>             3065 bgpd/bgpd.c    	  peer-&gt;default_rmap[afi][safi].map = route_map_lookup_by_name (rmap);</span>
<span class='curline'><a href='../S/610.html#L3068'>peer</a>             3068 bgpd/bgpd.c          if (peer-&gt;status == Established &amp;&amp; peer-&gt;afc_nego[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L3069'>peer</a>             3069 bgpd/bgpd.c    	bgp_default_originate (peer, afi, safi, 0);</span>
<span class='curline'><a href='../S/610.html#L3075'>peer</a>             3075 bgpd/bgpd.c    peer_default_originate_unset (struct peer *peer, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/610.html#L3081'>peer</a>             3081 bgpd/bgpd.c      if (! peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L3085'>peer</a>             3085 bgpd/bgpd.c      if (peer_is_group_member (peer, afi, safi))</span>
<span class='curline'><a href='../S/610.html#L3088'>peer</a>             3088 bgpd/bgpd.c      if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_DEFAULT_ORIGINATE))</span>
<span class='curline'><a href='../S/610.html#L3090'>peer</a>             3090 bgpd/bgpd.c          UNSET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_DEFAULT_ORIGINATE);</span>
<span class='curline'><a href='../S/610.html#L3092'>peer</a>             3092 bgpd/bgpd.c          if (peer-&gt;default_rmap[afi][safi].name)</span>
<span class='curline'><a href='../S/610.html#L3093'>peer</a>             3093 bgpd/bgpd.c    	free (peer-&gt;default_rmap[afi][safi].name);</span>
<span class='curline'><a href='../S/610.html#L3094'>peer</a>             3094 bgpd/bgpd.c          peer-&gt;default_rmap[afi][safi].name = NULL;</span>
<span class='curline'><a href='../S/610.html#L3095'>peer</a>             3095 bgpd/bgpd.c          peer-&gt;default_rmap[afi][safi].map = NULL;</span>
<span class='curline'><a href='../S/610.html#L3098'>peer</a>             3098 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L3100'>peer</a>             3100 bgpd/bgpd.c          if (peer-&gt;status == Established &amp;&amp; peer-&gt;afc_nego[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L3101'>peer</a>             3101 bgpd/bgpd.c    	bgp_default_originate (peer, afi, safi, 1);</span>
<span class='curline'><a href='../S/610.html#L3106'>peer</a>             3106 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L3107'>peer</a>             3107 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L3109'>peer</a>             3109 bgpd/bgpd.c          UNSET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_DEFAULT_ORIGINATE);</span>
<span class='curline'><a href='../S/610.html#L3111'>peer</a>             3111 bgpd/bgpd.c          if (peer-&gt;default_rmap[afi][safi].name)</span>
<span class='curline'><a href='../S/610.html#L3112'>peer</a>             3112 bgpd/bgpd.c    	free (peer-&gt;default_rmap[afi][safi].name);</span>
<span class='curline'><a href='../S/610.html#L3113'>peer</a>             3113 bgpd/bgpd.c          peer-&gt;default_rmap[afi][safi].name = NULL;</span>
<span class='curline'><a href='../S/610.html#L3114'>peer</a>             3114 bgpd/bgpd.c          peer-&gt;default_rmap[afi][safi].map = NULL;</span>
<span class='curline'><a href='../S/610.html#L3116'>peer</a>             3116 bgpd/bgpd.c          if (peer-&gt;status == Established &amp;&amp; peer-&gt;afc_nego[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L3117'>peer</a>             3117 bgpd/bgpd.c    	bgp_default_originate (peer, afi, safi, 1);</span>
<span class='curline'><a href='../S/610.html#L3123'>peer</a>             3123 bgpd/bgpd.c    peer_port_set (struct peer *peer, u_int16_t port)</span>
<span class='curline'><a href='../S/610.html#L3125'>peer</a>             3125 bgpd/bgpd.c      peer-&gt;port = port;</span>
<span class='curline'><a href='../S/610.html#L3130'>peer</a>             3130 bgpd/bgpd.c    peer_port_unset (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L3132'>peer</a>             3132 bgpd/bgpd.c      peer-&gt;port = BGP_PORT_DEFAULT;</span>
<span class='curline'><a href='../S/610.html#L3138'>peer</a>             3138 bgpd/bgpd.c    peer_weight_set (struct peer *peer, u_int16_t weight)</span>
<span class='curline'><a href='../S/610.html#L3143'>peer</a>             3143 bgpd/bgpd.c      SET_FLAG (peer-&gt;config, PEER_CONFIG_WEIGHT);</span>
<span class='curline'><a href='../S/610.html#L3144'>peer</a>             3144 bgpd/bgpd.c      peer-&gt;weight = weight;</span>
<span class='curline'><a href='../S/610.html#L3146'>peer</a>             3146 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L3150'>peer</a>             3150 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L3151'>peer</a>             3151 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L3153'>peer</a>             3153 bgpd/bgpd.c          peer-&gt;weight = group-&gt;conf-&gt;weight;</span>
<span class='curline'><a href='../S/610.html#L3159'>peer</a>             3159 bgpd/bgpd.c    peer_weight_unset (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L3165'>peer</a>             3165 bgpd/bgpd.c      if (peer_group_active (peer))</span>
<span class='curline'><a href='../S/610.html#L3166'>peer</a>             3166 bgpd/bgpd.c        peer-&gt;weight = peer-&gt;group-&gt;conf-&gt;weight;</span>
<span class='curline'><a href='../S/610.html#L3168'>peer</a>             3168 bgpd/bgpd.c        peer-&gt;weight = 0;</span>
<span class='curline'><a href='../S/610.html#L3170'>peer</a>             3170 bgpd/bgpd.c      UNSET_FLAG (peer-&gt;config, PEER_CONFIG_WEIGHT);</span>
<span class='curline'><a href='../S/610.html#L3172'>peer</a>             3172 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L3176'>peer</a>             3176 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L3177'>peer</a>             3177 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L3179'>peer</a>             3179 bgpd/bgpd.c          peer-&gt;weight = 0;</span>
<span class='curline'><a href='../S/610.html#L3185'>peer</a>             3185 bgpd/bgpd.c    peer_timers_set (struct peer *peer, u_int32_t keepalive, u_int32_t holdtime)</span>
<span class='curline'><a href='../S/610.html#L3191'>peer</a>             3191 bgpd/bgpd.c      if (peer_group_active (peer))</span>
<span class='curline'><a href='../S/610.html#L3207'>peer</a>             3207 bgpd/bgpd.c      SET_FLAG (peer-&gt;config, PEER_CONFIG_TIMER);</span>
<span class='curline'><a href='../S/610.html#L3208'>peer</a>             3208 bgpd/bgpd.c      peer-&gt;holdtime = holdtime;</span>
<span class='curline'><a href='../S/610.html#L3209'>peer</a>             3209 bgpd/bgpd.c      peer-&gt;keepalive = (keepalive &lt; holdtime / 3 ? keepalive : holdtime / 3);</span>
<span class='curline'><a href='../S/610.html#L3211'>peer</a>             3211 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L3215'>peer</a>             3215 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L3216'>peer</a>             3216 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L3218'>peer</a>             3218 bgpd/bgpd.c          SET_FLAG (peer-&gt;config, PEER_CONFIG_TIMER);</span>
<span class='curline'><a href='../S/610.html#L3219'>peer</a>             3219 bgpd/bgpd.c          peer-&gt;holdtime = group-&gt;conf-&gt;holdtime;</span>
<span class='curline'><a href='../S/610.html#L3220'>peer</a>             3220 bgpd/bgpd.c          peer-&gt;keepalive = group-&gt;conf-&gt;keepalive;</span>
<span class='curline'><a href='../S/610.html#L3226'>peer</a>             3226 bgpd/bgpd.c    peer_timers_unset (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L3231'>peer</a>             3231 bgpd/bgpd.c      if (peer_group_active (peer))</span>
<span class='curline'><a href='../S/610.html#L3235'>peer</a>             3235 bgpd/bgpd.c      UNSET_FLAG (peer-&gt;config, PEER_CONFIG_TIMER);</span>
<span class='curline'><a href='../S/610.html#L3236'>peer</a>             3236 bgpd/bgpd.c      peer-&gt;keepalive = 0;</span>
<span class='curline'><a href='../S/610.html#L3237'>peer</a>             3237 bgpd/bgpd.c      peer-&gt;holdtime = 0;</span>
<span class='curline'><a href='../S/610.html#L3239'>peer</a>             3239 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L3243'>peer</a>             3243 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L3244'>peer</a>             3244 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L3246'>peer</a>             3246 bgpd/bgpd.c          UNSET_FLAG (peer-&gt;config, PEER_CONFIG_TIMER);</span>
<span class='curline'><a href='../S/610.html#L3247'>peer</a>             3247 bgpd/bgpd.c          peer-&gt;holdtime = 0;</span>
<span class='curline'><a href='../S/610.html#L3248'>peer</a>             3248 bgpd/bgpd.c          peer-&gt;keepalive = 0;</span>
<span class='curline'><a href='../S/610.html#L3255'>peer</a>             3255 bgpd/bgpd.c    peer_timers_connect_set (struct peer *peer, u_int32_t connect)</span>
<span class='curline'><a href='../S/610.html#L3257'>peer</a>             3257 bgpd/bgpd.c      if (peer_group_active (peer))</span>
<span class='curline'><a href='../S/610.html#L3264'>peer</a>             3264 bgpd/bgpd.c      SET_FLAG (peer-&gt;config, PEER_CONFIG_CONNECT);</span>
<span class='curline'><a href='../S/610.html#L3265'>peer</a>             3265 bgpd/bgpd.c      peer-&gt;connect = connect;</span>
<span class='curline'><a href='../S/610.html#L3268'>peer</a>             3268 bgpd/bgpd.c      peer-&gt;v_connect = connect;</span>
<span class='curline'><a href='../S/610.html#L3274'>peer</a>             3274 bgpd/bgpd.c    peer_timers_connect_unset (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L3276'>peer</a>             3276 bgpd/bgpd.c      if (peer_group_active (peer))</span>
<span class='curline'><a href='../S/610.html#L3280'>peer</a>             3280 bgpd/bgpd.c      UNSET_FLAG (peer-&gt;config, PEER_CONFIG_CONNECT);</span>
<span class='curline'><a href='../S/610.html#L3281'>peer</a>             3281 bgpd/bgpd.c      peer-&gt;connect = 0;</span>
<span class='curline'><a href='../S/610.html#L3284'>peer</a>             3284 bgpd/bgpd.c      peer-&gt;v_connect = BGP_DEFAULT_CONNECT_RETRY;</span>
<span class='curline'><a href='../S/610.html#L3290'>peer</a>             3290 bgpd/bgpd.c    peer_advertise_interval_set (struct peer *peer, u_int32_t routeadv)</span>
<span class='curline'><a href='../S/610.html#L3292'>peer</a>             3292 bgpd/bgpd.c      if (peer_group_active (peer))</span>
<span class='curline'><a href='../S/610.html#L3298'>peer</a>             3298 bgpd/bgpd.c      SET_FLAG (peer-&gt;config, PEER_CONFIG_ROUTEADV);</span>
<span class='curline'><a href='../S/610.html#L3299'>peer</a>             3299 bgpd/bgpd.c      peer-&gt;routeadv = routeadv;</span>
<span class='curline'><a href='../S/610.html#L3300'>peer</a>             3300 bgpd/bgpd.c      peer-&gt;v_routeadv = routeadv;</span>
<span class='curline'><a href='../S/610.html#L3306'>peer</a>             3306 bgpd/bgpd.c    peer_advertise_interval_unset (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L3308'>peer</a>             3308 bgpd/bgpd.c      if (peer_group_active (peer))</span>
<span class='curline'><a href='../S/610.html#L3311'>peer</a>             3311 bgpd/bgpd.c      UNSET_FLAG (peer-&gt;config, PEER_CONFIG_ROUTEADV);</span>
<span class='curline'><a href='../S/610.html#L3312'>peer</a>             3312 bgpd/bgpd.c      peer-&gt;routeadv = 0;</span>
<span class='curline'><a href='../S/610.html#L3314'>peer</a>             3314 bgpd/bgpd.c      if (peer-&gt;sort == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L3315'>peer</a>             3315 bgpd/bgpd.c        peer-&gt;v_routeadv = BGP_DEFAULT_IBGP_ROUTEADV;</span>
<span class='curline'><a href='../S/610.html#L3317'>peer</a>             3317 bgpd/bgpd.c        peer-&gt;v_routeadv = BGP_DEFAULT_EBGP_ROUTEADV;</span>
<span class='curline'><a href='../S/610.html#L3324'>peer</a>             3324 bgpd/bgpd.c    peer_interface_set (struct peer *peer, const char *str)</span>
<span class='curline'><a href='../S/610.html#L3326'>peer</a>             3326 bgpd/bgpd.c      if (peer-&gt;ifname)</span>
<span class='curline'><a href='../S/610.html#L3327'>peer</a>             3327 bgpd/bgpd.c        free (peer-&gt;ifname);</span>
<span class='curline'><a href='../S/610.html#L3328'>peer</a>             3328 bgpd/bgpd.c      peer-&gt;ifname = strdup (str);</span>
<span class='curline'><a href='../S/610.html#L3334'>peer</a>             3334 bgpd/bgpd.c    peer_interface_unset (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L3336'>peer</a>             3336 bgpd/bgpd.c      if (peer-&gt;ifname)</span>
<span class='curline'><a href='../S/610.html#L3337'>peer</a>             3337 bgpd/bgpd.c        free (peer-&gt;ifname);</span>
<span class='curline'><a href='../S/610.html#L3338'>peer</a>             3338 bgpd/bgpd.c      peer-&gt;ifname = NULL;</span>
<span class='curline'><a href='../S/610.html#L3345'>peer</a>             3345 bgpd/bgpd.c    peer_allowas_in_set (struct peer *peer, afi_t afi, safi_t safi, int allow_num)</span>
<span class='curline'><a href='../S/610.html#L3353'>peer</a>             3353 bgpd/bgpd.c      if (peer-&gt;allowas_in[afi][safi] != allow_num)</span>
<span class='curline'><a href='../S/610.html#L3355'>peer</a>             3355 bgpd/bgpd.c          peer-&gt;allowas_in[afi][safi] = allow_num;</span>
<span class='curline'><a href='../S/610.html#L3356'>peer</a>             3356 bgpd/bgpd.c          SET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_ALLOWAS_IN);</span>
<span class='curline'><a href='../S/610.html#L3357'>peer</a>             3357 bgpd/bgpd.c          peer_change_action (peer, afi, safi, peer_change_reset_in);</span>
<span class='curline'><a href='../S/610.html#L3360'>peer</a>             3360 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L3363'>peer</a>             3363 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L3364'>peer</a>             3364 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L3366'>peer</a>             3366 bgpd/bgpd.c          if (peer-&gt;allowas_in[afi][safi] != allow_num)</span>
<span class='curline'><a href='../S/610.html#L3368'>peer</a>             3368 bgpd/bgpd.c    	  peer-&gt;allowas_in[afi][safi] = allow_num;</span>
<span class='curline'><a href='../S/610.html#L3369'>peer</a>             3369 bgpd/bgpd.c    	  SET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_ALLOWAS_IN);</span>
<span class='curline'><a href='../S/610.html#L3370'>peer</a>             3370 bgpd/bgpd.c    	  peer_change_action (peer, afi, safi, peer_change_reset_in);</span>
<span class='curline'><a href='../S/610.html#L3378'>peer</a>             3378 bgpd/bgpd.c    peer_allowas_in_unset (struct peer *peer, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/610.html#L3383'>peer</a>             3383 bgpd/bgpd.c      if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_ALLOWAS_IN))</span>
<span class='curline'><a href='../S/610.html#L3385'>peer</a>             3385 bgpd/bgpd.c          peer-&gt;allowas_in[afi][safi] = 0;</span>
<span class='curline'><a href='../S/610.html#L3386'>peer</a>             3386 bgpd/bgpd.c          peer_af_flag_unset (peer, afi, safi, PEER_FLAG_ALLOWAS_IN);</span>
<span class='curline'><a href='../S/610.html#L3389'>peer</a>             3389 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L3392'>peer</a>             3392 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L3393'>peer</a>             3393 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L3395'>peer</a>             3395 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_ALLOWAS_IN))</span>
<span class='curline'><a href='../S/610.html#L3397'>peer</a>             3397 bgpd/bgpd.c    	  peer-&gt;allowas_in[afi][safi] = 0;</span>
<span class='curline'><a href='../S/610.html#L3398'>peer</a>             3398 bgpd/bgpd.c    	  peer_af_flag_unset (peer, afi, safi, PEER_FLAG_ALLOWAS_IN);</span>
<span class='curline'><a href='../S/610.html#L3405'>peer</a>             3405 bgpd/bgpd.c    peer_local_as_set (struct peer *peer, as_t as, int no_prepend, int replace_as)</span>
<span class='curline'><a href='../S/610.html#L3407'>peer</a>             3407 bgpd/bgpd.c      struct bgp *bgp = peer-&gt;bgp;</span>
<span class='curline'><a href='../S/610.html#L3411'>peer</a>             3411 bgpd/bgpd.c      if (peer_sort (peer) != BGP_PEER_EBGP</span>
<span class='curline'><a href='../S/610.html#L3412'>peer</a>             3412 bgpd/bgpd.c          &amp;&amp; peer_sort (peer) != BGP_PEER_INTERNAL)</span>
<span class='curline'><a href='../S/610.html#L3418'>peer</a>             3418 bgpd/bgpd.c      if (peer_group_active (peer))</span>
<span class='curline'><a href='../S/610.html#L3421'>peer</a>             3421 bgpd/bgpd.c      if (peer-&gt;as == as)</span>
<span class='curline'><a href='../S/610.html#L3424'>peer</a>             3424 bgpd/bgpd.c      if (peer-&gt;change_local_as == as &amp;&amp;</span>
<span class='curline'><a href='../S/610.html#L3425'>peer</a>             3425 bgpd/bgpd.c          ((CHECK_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_NO_PREPEND) &amp;&amp; no_prepend)</span>
<span class='curline'><a href='../S/610.html#L3426'>peer</a>             3426 bgpd/bgpd.c           || (! CHECK_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_NO_PREPEND) &amp;&amp; ! no_prepend)) &amp;&amp;</span>
<span class='curline'><a href='../S/610.html#L3427'>peer</a>             3427 bgpd/bgpd.c          ((CHECK_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_REPLACE_AS) &amp;&amp; replace_as)</span>
<span class='curline'><a href='../S/610.html#L3428'>peer</a>             3428 bgpd/bgpd.c           || (! CHECK_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_REPLACE_AS) &amp;&amp; ! replace_as)))</span>
<span class='curline'><a href='../S/610.html#L3431'>peer</a>             3431 bgpd/bgpd.c      peer-&gt;change_local_as = as;</span>
<span class='curline'><a href='../S/610.html#L3433'>peer</a>             3433 bgpd/bgpd.c        SET_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_NO_PREPEND);</span>
<span class='curline'><a href='../S/610.html#L3435'>peer</a>             3435 bgpd/bgpd.c        UNSET_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_NO_PREPEND);</span>
<span class='curline'><a href='../S/610.html#L3438'>peer</a>             3438 bgpd/bgpd.c        SET_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_REPLACE_AS);</span>
<span class='curline'><a href='../S/610.html#L3440'>peer</a>             3440 bgpd/bgpd.c        UNSET_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_REPLACE_AS);</span>
<span class='curline'><a href='../S/610.html#L3442'>peer</a>             3442 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L3444'>peer</a>             3444 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L3446'>peer</a>             3446 bgpd/bgpd.c             peer-&gt;last_reset = PEER_DOWN_LOCAL_AS_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L3447'>peer</a>             3447 bgpd/bgpd.c             bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L3451'>peer</a>             3451 bgpd/bgpd.c            BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L3456'>peer</a>             3456 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L3457'>peer</a>             3457 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L3459'>peer</a>             3459 bgpd/bgpd.c          peer-&gt;change_local_as = as;</span>
<span class='curline'><a href='../S/610.html#L3461'>peer</a>             3461 bgpd/bgpd.c    	SET_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_NO_PREPEND);</span>
<span class='curline'><a href='../S/610.html#L3463'>peer</a>             3463 bgpd/bgpd.c    	UNSET_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_NO_PREPEND);</span>
<span class='curline'><a href='../S/610.html#L3466'>peer</a>             3466 bgpd/bgpd.c            SET_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_REPLACE_AS);</span>
<span class='curline'><a href='../S/610.html#L3468'>peer</a>             3468 bgpd/bgpd.c            UNSET_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_REPLACE_AS);</span>
<span class='curline'><a href='../S/610.html#L3470'>peer</a>             3470 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L3472'>peer</a>             3472 bgpd/bgpd.c             peer-&gt;last_reset = PEER_DOWN_LOCAL_AS_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L3473'>peer</a>             3473 bgpd/bgpd.c             bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L3477'>peer</a>             3477 bgpd/bgpd.c            BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L3484'>peer</a>             3484 bgpd/bgpd.c    peer_local_as_unset (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L3489'>peer</a>             3489 bgpd/bgpd.c      if (peer_group_active (peer))</span>
<span class='curline'><a href='../S/610.html#L3492'>peer</a>             3492 bgpd/bgpd.c      if (! peer-&gt;change_local_as)</span>
<span class='curline'><a href='../S/610.html#L3495'>peer</a>             3495 bgpd/bgpd.c      peer-&gt;change_local_as = 0;</span>
<span class='curline'><a href='../S/610.html#L3496'>peer</a>             3496 bgpd/bgpd.c      UNSET_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_NO_PREPEND);</span>
<span class='curline'><a href='../S/610.html#L3497'>peer</a>             3497 bgpd/bgpd.c      UNSET_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_REPLACE_AS);</span>
<span class='curline'><a href='../S/610.html#L3499'>peer</a>             3499 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L3501'>peer</a>             3501 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L3503'>peer</a>             3503 bgpd/bgpd.c             peer-&gt;last_reset = PEER_DOWN_LOCAL_AS_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L3504'>peer</a>             3504 bgpd/bgpd.c             bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L3508'>peer</a>             3508 bgpd/bgpd.c            BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L3513'>peer</a>             3513 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L3514'>peer</a>             3514 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L3516'>peer</a>             3516 bgpd/bgpd.c          peer-&gt;change_local_as = 0;</span>
<span class='curline'><a href='../S/610.html#L3517'>peer</a>             3517 bgpd/bgpd.c          UNSET_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_NO_PREPEND);</span>
<span class='curline'><a href='../S/610.html#L3518'>peer</a>             3518 bgpd/bgpd.c          UNSET_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_REPLACE_AS);</span>
<span class='curline'><a href='../S/610.html#L3520'>peer</a>             3520 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L3522'>peer</a>             3522 bgpd/bgpd.c             peer-&gt;last_reset = PEER_DOWN_LOCAL_AS_CHANGE;</span>
<span class='curline'><a href='../S/610.html#L3523'>peer</a>             3523 bgpd/bgpd.c             bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L3527'>peer</a>             3527 bgpd/bgpd.c            BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L3534'>peer</a>             3534 bgpd/bgpd.c    peer_password_set (struct peer *peer, const char *password)</span>
<span class='curline'><a href='../S/610.html#L3543'>peer</a>             3543 bgpd/bgpd.c      if (peer-&gt;password &amp;&amp; strcmp (peer-&gt;password, password) == 0</span>
<span class='curline'><a href='../S/610.html#L3544'>peer</a>             3544 bgpd/bgpd.c          &amp;&amp; ! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L3547'>peer</a>             3547 bgpd/bgpd.c      if (peer-&gt;password)</span>
<span class='curline'><a href='../S/610.html#L3548'>peer</a>             3548 bgpd/bgpd.c        XFREE (MTYPE_PEER_PASSWORD, peer-&gt;password);</span>
<span class='curline'><a href='../S/610.html#L3550'>peer</a>             3550 bgpd/bgpd.c      peer-&gt;password = XSTRDUP (MTYPE_PEER_PASSWORD, password);</span>
<span class='curline'><a href='../S/610.html#L3552'>peer</a>             3552 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L3554'>peer</a>             3554 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L3555'>peer</a>             3555 bgpd/bgpd.c              bgp_notify_send (peer, BGP_NOTIFY_CEASE, BGP_NOTIFY_CEASE_CONFIG_CHANGE);</span>
<span class='curline'><a href='../S/610.html#L3557'>peer</a>             3557 bgpd/bgpd.c            BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L3559'>peer</a>             3559 bgpd/bgpd.c          return (bgp_md5_set (peer) &gt;= 0) ? BGP_SUCCESS : BGP_ERR_TCPSIG_FAILED;</span>
<span class='curline'><a href='../S/610.html#L3562'>peer</a>             3562 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (peer-&gt;group-&gt;peer, nn, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L3564'>peer</a>             3564 bgpd/bgpd.c          if (peer-&gt;password &amp;&amp; strcmp (peer-&gt;password, password) == 0)</span>
<span class='curline'><a href='../S/610.html#L3567'>peer</a>             3567 bgpd/bgpd.c          if (peer-&gt;password)</span>
<span class='curline'><a href='../S/610.html#L3568'>peer</a>             3568 bgpd/bgpd.c            XFREE (MTYPE_PEER_PASSWORD, peer-&gt;password);</span>
<span class='curline'><a href='../S/610.html#L3570'>peer</a>             3570 bgpd/bgpd.c          peer-&gt;password = XSTRDUP(MTYPE_PEER_PASSWORD, password);</span>
<span class='curline'><a href='../S/610.html#L3572'>peer</a>             3572 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L3573'>peer</a>             3573 bgpd/bgpd.c            bgp_notify_send (peer, BGP_NOTIFY_CEASE, BGP_NOTIFY_CEASE_CONFIG_CHANGE);</span>
<span class='curline'><a href='../S/610.html#L3575'>peer</a>             3575 bgpd/bgpd.c            BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L3577'>peer</a>             3577 bgpd/bgpd.c          if (bgp_md5_set (peer) &lt; 0)</span>
<span class='curline'><a href='../S/610.html#L3585'>peer</a>             3585 bgpd/bgpd.c    peer_password_unset (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L3589'>peer</a>             3589 bgpd/bgpd.c      if (!peer-&gt;password</span>
<span class='curline'><a href='../S/610.html#L3590'>peer</a>             3590 bgpd/bgpd.c          &amp;&amp; !CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L3593'>peer</a>             3593 bgpd/bgpd.c      if (!CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L3595'>peer</a>             3595 bgpd/bgpd.c          if (peer_group_active (peer)</span>
<span class='curline'><a href='../S/610.html#L3596'>peer</a>             3596 bgpd/bgpd.c    	  &amp;&amp; peer-&gt;group-&gt;conf-&gt;password</span>
<span class='curline'><a href='../S/610.html#L3597'>peer</a>             3597 bgpd/bgpd.c    	  &amp;&amp; strcmp (peer-&gt;group-&gt;conf-&gt;password, peer-&gt;password) == 0)</span>
<span class='curline'><a href='../S/610.html#L3600'>peer</a>             3600 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L3601'>peer</a>             3601 bgpd/bgpd.c            bgp_notify_send (peer, BGP_NOTIFY_CEASE, BGP_NOTIFY_CEASE_CONFIG_CHANGE);</span>
<span class='curline'><a href='../S/610.html#L3603'>peer</a>             3603 bgpd/bgpd.c            BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L3605'>peer</a>             3605 bgpd/bgpd.c          if (peer-&gt;password)</span>
<span class='curline'><a href='../S/610.html#L3606'>peer</a>             3606 bgpd/bgpd.c            XFREE (MTYPE_PEER_PASSWORD, peer-&gt;password);</span>
<span class='curline'><a href='../S/610.html#L3608'>peer</a>             3608 bgpd/bgpd.c          peer-&gt;password = NULL;</span>
<span class='curline'><a href='../S/610.html#L3610'>peer</a>             3610 bgpd/bgpd.c          bgp_md5_set (peer);</span>
<span class='curline'><a href='../S/610.html#L3615'>peer</a>             3615 bgpd/bgpd.c      XFREE (MTYPE_PEER_PASSWORD, peer-&gt;password);</span>
<span class='curline'><a href='../S/610.html#L3616'>peer</a>             3616 bgpd/bgpd.c      peer-&gt;password = NULL;</span>
<span class='curline'><a href='../S/610.html#L3618'>peer</a>             3618 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (peer-&gt;group-&gt;peer, nn, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L3620'>peer</a>             3620 bgpd/bgpd.c          if (!peer-&gt;password)</span>
<span class='curline'><a href='../S/610.html#L3623'>peer</a>             3623 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L3624'>peer</a>             3624 bgpd/bgpd.c            bgp_notify_send (peer, BGP_NOTIFY_CEASE, BGP_NOTIFY_CEASE_CONFIG_CHANGE);</span>
<span class='curline'><a href='../S/610.html#L3626'>peer</a>             3626 bgpd/bgpd.c            BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L3628'>peer</a>             3628 bgpd/bgpd.c          XFREE (MTYPE_PEER_PASSWORD, peer-&gt;password);</span>
<span class='curline'><a href='../S/610.html#L3629'>peer</a>             3629 bgpd/bgpd.c          peer-&gt;password = NULL;</span>
<span class='curline'><a href='../S/610.html#L3631'>peer</a>             3631 bgpd/bgpd.c          bgp_md5_set (peer);</span>
<span class='curline'><a href='../S/610.html#L3639'>peer</a>             3639 bgpd/bgpd.c    peer_distribute_set (struct peer *peer, afi_t afi, safi_t safi, int direct, </span>
<span class='curline'><a href='../S/610.html#L3646'>peer</a>             3646 bgpd/bgpd.c      if (! peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L3652'>peer</a>             3652 bgpd/bgpd.c      if (direct == FILTER_OUT &amp;&amp; peer_is_group_member (peer, afi, safi))</span>
<span class='curline'><a href='../S/610.html#L3655'>peer</a>             3655 bgpd/bgpd.c      filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L3665'>peer</a>             3665 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L3668'>peer</a>             3668 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L3669'>peer</a>             3669 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L3671'>peer</a>             3671 bgpd/bgpd.c          filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L3673'>peer</a>             3673 bgpd/bgpd.c          if (! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L3686'>peer</a>             3686 bgpd/bgpd.c    peer_distribute_unset (struct peer *peer, afi_t afi, safi_t safi, int direct)</span>
<span class='curline'><a href='../S/610.html#L3693'>peer</a>             3693 bgpd/bgpd.c      if (! peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L3699'>peer</a>             3699 bgpd/bgpd.c      if (direct == FILTER_OUT &amp;&amp; peer_is_group_member (peer, afi, safi))</span>
<span class='curline'><a href='../S/610.html#L3702'>peer</a>             3702 bgpd/bgpd.c      filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L3705'>peer</a>             3705 bgpd/bgpd.c      if (peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L3707'>peer</a>             3707 bgpd/bgpd.c          gfilter = &amp;peer-&gt;group-&gt;conf-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L3724'>peer</a>             3724 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L3727'>peer</a>             3727 bgpd/bgpd.c        group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L3728'>peer</a>             3728 bgpd/bgpd.c        for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L3730'>peer</a>             3730 bgpd/bgpd.c    	filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L3732'>peer</a>             3732 bgpd/bgpd.c    	if (! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L3754'>peer</a>             3754 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L3760'>peer</a>             3760 bgpd/bgpd.c          for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L3765'>peer</a>             3765 bgpd/bgpd.c    		filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L3799'>peer</a>             3799 bgpd/bgpd.c    peer_prefix_list_set (struct peer *peer, afi_t afi, safi_t safi, int direct, </span>
<span class='curline'><a href='../S/610.html#L3806'>peer</a>             3806 bgpd/bgpd.c      if (! peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L3812'>peer</a>             3812 bgpd/bgpd.c      if (direct == FILTER_OUT &amp;&amp; peer_is_group_member (peer, afi, safi))</span>
<span class='curline'><a href='../S/610.html#L3815'>peer</a>             3815 bgpd/bgpd.c      filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L3825'>peer</a>             3825 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L3828'>peer</a>             3828 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L3829'>peer</a>             3829 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L3831'>peer</a>             3831 bgpd/bgpd.c          filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L3833'>peer</a>             3833 bgpd/bgpd.c          if (! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L3845'>peer</a>             3845 bgpd/bgpd.c    peer_prefix_list_unset (struct peer *peer, afi_t afi, safi_t safi, int direct)</span>
<span class='curline'><a href='../S/610.html#L3852'>peer</a>             3852 bgpd/bgpd.c      if (! peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L3858'>peer</a>             3858 bgpd/bgpd.c      if (direct == FILTER_OUT &amp;&amp; peer_is_group_member (peer, afi, safi))</span>
<span class='curline'><a href='../S/610.html#L3861'>peer</a>             3861 bgpd/bgpd.c      filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L3864'>peer</a>             3864 bgpd/bgpd.c      if (peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L3866'>peer</a>             3866 bgpd/bgpd.c          gfilter = &amp;peer-&gt;group-&gt;conf-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L3883'>peer</a>             3883 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L3886'>peer</a>             3886 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L3887'>peer</a>             3887 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L3889'>peer</a>             3889 bgpd/bgpd.c          filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L3891'>peer</a>             3891 bgpd/bgpd.c          if (! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L3910'>peer</a>             3910 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L3919'>peer</a>             3919 bgpd/bgpd.c          for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L3924'>peer</a>             3924 bgpd/bgpd.c    		filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L3957'>peer</a>             3957 bgpd/bgpd.c    peer_aslist_set (struct peer *peer, afi_t afi, safi_t safi, int direct,</span>
<span class='curline'><a href='../S/610.html#L3964'>peer</a>             3964 bgpd/bgpd.c      if (! peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L3970'>peer</a>             3970 bgpd/bgpd.c      if (direct == FILTER_OUT &amp;&amp; peer_is_group_member (peer, afi, safi))</span>
<span class='curline'><a href='../S/610.html#L3973'>peer</a>             3973 bgpd/bgpd.c      filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L3980'>peer</a>             3980 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L3983'>peer</a>             3983 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L3984'>peer</a>             3984 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L3986'>peer</a>             3986 bgpd/bgpd.c          filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L3988'>peer</a>             3988 bgpd/bgpd.c          if (! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4000'>peer</a>             4000 bgpd/bgpd.c    peer_aslist_unset (struct peer *peer,afi_t afi, safi_t safi, int direct)</span>
<span class='curline'><a href='../S/610.html#L4007'>peer</a>             4007 bgpd/bgpd.c      if (! peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4013'>peer</a>             4013 bgpd/bgpd.c      if (direct == FILTER_OUT &amp;&amp; peer_is_group_member (peer, afi, safi))</span>
<span class='curline'><a href='../S/610.html#L4016'>peer</a>             4016 bgpd/bgpd.c      filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L4019'>peer</a>             4019 bgpd/bgpd.c      if (peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4021'>peer</a>             4021 bgpd/bgpd.c          gfilter = &amp;peer-&gt;group-&gt;conf-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L4038'>peer</a>             4038 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L4041'>peer</a>             4041 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L4042'>peer</a>             4042 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L4044'>peer</a>             4044 bgpd/bgpd.c          filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L4046'>peer</a>             4046 bgpd/bgpd.c          if (! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4067'>peer</a>             4067 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L4073'>peer</a>             4073 bgpd/bgpd.c          for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L4078'>peer</a>             4078 bgpd/bgpd.c    		filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L4112'>peer</a>             4112 bgpd/bgpd.c    peer_route_map_set (struct peer *peer, afi_t afi, safi_t safi, int direct, </span>
<span class='curline'><a href='../S/610.html#L4119'>peer</a>             4119 bgpd/bgpd.c      if (! peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4127'>peer</a>             4127 bgpd/bgpd.c          &amp;&amp; peer_is_group_member (peer, afi, safi))</span>
<span class='curline'><a href='../S/610.html#L4130'>peer</a>             4130 bgpd/bgpd.c      filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L4138'>peer</a>             4138 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L4141'>peer</a>             4141 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L4142'>peer</a>             4142 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L4144'>peer</a>             4144 bgpd/bgpd.c          filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L4146'>peer</a>             4146 bgpd/bgpd.c          if (! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4159'>peer</a>             4159 bgpd/bgpd.c    peer_route_map_unset (struct peer *peer, afi_t afi, safi_t safi, int direct)</span>
<span class='curline'><a href='../S/610.html#L4166'>peer</a>             4166 bgpd/bgpd.c      if (! peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4174'>peer</a>             4174 bgpd/bgpd.c          &amp;&amp; peer_is_group_member (peer, afi, safi))</span>
<span class='curline'><a href='../S/610.html#L4177'>peer</a>             4177 bgpd/bgpd.c      filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L4180'>peer</a>             4180 bgpd/bgpd.c      if (peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4182'>peer</a>             4182 bgpd/bgpd.c          gfilter = &amp;peer-&gt;group-&gt;conf-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L4199'>peer</a>             4199 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L4202'>peer</a>             4202 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L4203'>peer</a>             4203 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L4205'>peer</a>             4205 bgpd/bgpd.c          filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L4207'>peer</a>             4207 bgpd/bgpd.c          if (! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4220'>peer</a>             4220 bgpd/bgpd.c    peer_unsuppress_map_set (struct peer *peer, afi_t afi, safi_t safi, </span>
<span class='curline'><a href='../S/610.html#L4227'>peer</a>             4227 bgpd/bgpd.c      if (! peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4230'>peer</a>             4230 bgpd/bgpd.c      if (peer_is_group_member (peer, afi, safi))</span>
<span class='curline'><a href='../S/610.html#L4233'>peer</a>             4233 bgpd/bgpd.c      filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L4241'>peer</a>             4241 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L4244'>peer</a>             4244 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L4245'>peer</a>             4245 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L4247'>peer</a>             4247 bgpd/bgpd.c          filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L4249'>peer</a>             4249 bgpd/bgpd.c          if (! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4262'>peer</a>             4262 bgpd/bgpd.c    peer_unsuppress_map_unset (struct peer *peer, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/610.html#L4268'>peer</a>             4268 bgpd/bgpd.c      if (! peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4271'>peer</a>             4271 bgpd/bgpd.c      if (peer_is_group_member (peer, afi, safi))</span>
<span class='curline'><a href='../S/610.html#L4274'>peer</a>             4274 bgpd/bgpd.c      filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L4281'>peer</a>             4281 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L4284'>peer</a>             4284 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L4285'>peer</a>             4285 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L4287'>peer</a>             4287 bgpd/bgpd.c          filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L4289'>peer</a>             4289 bgpd/bgpd.c          if (! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4301'>peer</a>             4301 bgpd/bgpd.c    peer_maximum_prefix_set (struct peer *peer, afi_t afi, safi_t safi,</span>
<span class='curline'><a href='../S/610.html#L4308'>peer</a>             4308 bgpd/bgpd.c      if (! peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4311'>peer</a>             4311 bgpd/bgpd.c      SET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MAX_PREFIX);</span>
<span class='curline'><a href='../S/610.html#L4312'>peer</a>             4312 bgpd/bgpd.c      peer-&gt;pmax[afi][safi] = max;</span>
<span class='curline'><a href='../S/610.html#L4313'>peer</a>             4313 bgpd/bgpd.c      peer-&gt;pmax_threshold[afi][safi] = threshold;</span>
<span class='curline'><a href='../S/610.html#L4314'>peer</a>             4314 bgpd/bgpd.c      peer-&gt;pmax_restart[afi][safi] = restart;</span>
<span class='curline'><a href='../S/610.html#L4316'>peer</a>             4316 bgpd/bgpd.c        SET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MAX_PREFIX_WARNING);</span>
<span class='curline'><a href='../S/610.html#L4318'>peer</a>             4318 bgpd/bgpd.c        UNSET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MAX_PREFIX_WARNING);</span>
<span class='curline'><a href='../S/610.html#L4320'>peer</a>             4320 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L4323'>peer</a>             4323 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L4324'>peer</a>             4324 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L4326'>peer</a>             4326 bgpd/bgpd.c          if (! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4329'>peer</a>             4329 bgpd/bgpd.c          SET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MAX_PREFIX);</span>
<span class='curline'><a href='../S/610.html#L4330'>peer</a>             4330 bgpd/bgpd.c          peer-&gt;pmax[afi][safi] = max;</span>
<span class='curline'><a href='../S/610.html#L4331'>peer</a>             4331 bgpd/bgpd.c          peer-&gt;pmax_threshold[afi][safi] = threshold;</span>
<span class='curline'><a href='../S/610.html#L4332'>peer</a>             4332 bgpd/bgpd.c          peer-&gt;pmax_restart[afi][safi] = restart;</span>
<span class='curline'><a href='../S/610.html#L4334'>peer</a>             4334 bgpd/bgpd.c    	SET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MAX_PREFIX_WARNING);</span>
<span class='curline'><a href='../S/610.html#L4336'>peer</a>             4336 bgpd/bgpd.c    	UNSET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MAX_PREFIX_WARNING);</span>
<span class='curline'><a href='../S/610.html#L4342'>peer</a>             4342 bgpd/bgpd.c    peer_maximum_prefix_unset (struct peer *peer, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/610.html#L4347'>peer</a>             4347 bgpd/bgpd.c      if (! peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4351'>peer</a>             4351 bgpd/bgpd.c      if (peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4353'>peer</a>             4353 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;group-&gt;conf-&gt;af_flags[afi][safi],</span>
<span class='curline'><a href='../S/610.html#L4355'>peer</a>             4355 bgpd/bgpd.c    	SET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MAX_PREFIX);</span>
<span class='curline'><a href='../S/610.html#L4357'>peer</a>             4357 bgpd/bgpd.c    	UNSET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MAX_PREFIX);</span>
<span class='curline'><a href='../S/610.html#L4359'>peer</a>             4359 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;group-&gt;conf-&gt;af_flags[afi][safi],</span>
<span class='curline'><a href='../S/610.html#L4361'>peer</a>             4361 bgpd/bgpd.c    	SET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MAX_PREFIX_WARNING);</span>
<span class='curline'><a href='../S/610.html#L4363'>peer</a>             4363 bgpd/bgpd.c    	UNSET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MAX_PREFIX_WARNING);</span>
<span class='curline'><a href='../S/610.html#L4365'>peer</a>             4365 bgpd/bgpd.c          peer-&gt;pmax[afi][safi] = peer-&gt;group-&gt;conf-&gt;pmax[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L4366'>peer</a>             4366 bgpd/bgpd.c          peer-&gt;pmax_threshold[afi][safi] = peer-&gt;group-&gt;conf-&gt;pmax_threshold[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L4367'>peer</a>             4367 bgpd/bgpd.c          peer-&gt;pmax_restart[afi][safi] = peer-&gt;group-&gt;conf-&gt;pmax_restart[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L4371'>peer</a>             4371 bgpd/bgpd.c      UNSET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MAX_PREFIX);</span>
<span class='curline'><a href='../S/610.html#L4372'>peer</a>             4372 bgpd/bgpd.c      UNSET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MAX_PREFIX_WARNING);</span>
<span class='curline'><a href='../S/610.html#L4373'>peer</a>             4373 bgpd/bgpd.c      peer-&gt;pmax[afi][safi] = 0;</span>
<span class='curline'><a href='../S/610.html#L4374'>peer</a>             4374 bgpd/bgpd.c      peer-&gt;pmax_threshold[afi][safi] = 0;</span>
<span class='curline'><a href='../S/610.html#L4375'>peer</a>             4375 bgpd/bgpd.c      peer-&gt;pmax_restart[afi][safi] = 0;</span>
<span class='curline'><a href='../S/610.html#L4377'>peer</a>             4377 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L4380'>peer</a>             4380 bgpd/bgpd.c      group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L4381'>peer</a>             4381 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L4383'>peer</a>             4383 bgpd/bgpd.c          if (! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4386'>peer</a>             4386 bgpd/bgpd.c          UNSET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MAX_PREFIX);</span>
<span class='curline'><a href='../S/610.html#L4387'>peer</a>             4387 bgpd/bgpd.c          UNSET_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MAX_PREFIX_WARNING);</span>
<span class='curline'><a href='../S/610.html#L4388'>peer</a>             4388 bgpd/bgpd.c          peer-&gt;pmax[afi][safi] = 0;</span>
<span class='curline'><a href='../S/610.html#L4389'>peer</a>             4389 bgpd/bgpd.c          peer-&gt;pmax_threshold[afi][safi] = 0;</span>
<span class='curline'><a href='../S/610.html#L4390'>peer</a>             4390 bgpd/bgpd.c          peer-&gt;pmax_restart[afi][safi] = 0;</span>
<span class='curline'><a href='../S/610.html#L4397'>peer</a>             4397 bgpd/bgpd.c    peer_ttl_security_hops_set (struct peer *peer, int gtsm_hops)</span>
<span class='curline'><a href='../S/610.html#L4401'>peer</a>             4401 bgpd/bgpd.c      struct peer *peer1;</span>
<span class='curline'><a href='../S/610.html#L4404'>peer</a>             4404 bgpd/bgpd.c      zlog_debug ("peer_ttl_security_hops_set: set gtsm_hops to %d for %s", gtsm_hops, peer-&gt;host);</span>
<span class='curline'><a href='../S/610.html#L4406'>peer</a>             4406 bgpd/bgpd.c      if (peer-&gt;sort == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L4417'>peer</a>             4417 bgpd/bgpd.c      if (peer-&gt;gtsm_hops == 0) {</span>
<span class='curline'><a href='../S/610.html#L4418'>peer</a>             4418 bgpd/bgpd.c        if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L4420'>peer</a>             4420 bgpd/bgpd.c            group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L4424'>peer</a>             4424 bgpd/bgpd.c            for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer1))</span>
<span class='curline'><a href='../S/610.html#L4435'>peer</a>             4435 bgpd/bgpd.c            if (peer-&gt;ttl != 1)</span>
<span class='curline'><a href='../S/610.html#L4439'>peer</a>             4439 bgpd/bgpd.c        ret = peer_ebgp_multihop_set (peer, MAXTTL);</span>
<span class='curline'><a href='../S/610.html#L4444'>peer</a>             4444 bgpd/bgpd.c      peer-&gt;gtsm_hops = gtsm_hops;</span>
<span class='curline'><a href='../S/610.html#L4446'>peer</a>             4446 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L4448'>peer</a>             4448 bgpd/bgpd.c          if (peer-&gt;fd &gt;= 0 &amp;&amp; peer-&gt;sort != BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L4449'>peer</a>             4449 bgpd/bgpd.c    	sockopt_minttl (peer-&gt;su.sa.sa_family, peer-&gt;fd, MAXTTL + 1 - gtsm_hops);</span>
<span class='curline'><a href='../S/610.html#L4453'>peer</a>             4453 bgpd/bgpd.c          group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L4454'>peer</a>             4454 bgpd/bgpd.c          for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L4456'>peer</a>             4456 bgpd/bgpd.c    	  if (peer-&gt;sort == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L4459'>peer</a>             4459 bgpd/bgpd.c    	  peer-&gt;gtsm_hops = group-&gt;conf-&gt;gtsm_hops;</span>
<span class='curline'><a href='../S/610.html#L4466'>peer</a>             4466 bgpd/bgpd.c    	  if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L4468'>peer</a>             4468 bgpd/bgpd.c    	      if (peer-&gt;fd &gt;= 0 &amp;&amp; peer-&gt;gtsm_hops != 0)</span>
<span class='curline'><a href='../S/610.html#L4469'>peer</a>             4469 bgpd/bgpd.c    		sockopt_minttl (peer-&gt;su.sa.sa_family, peer-&gt;fd,</span>
<span class='curline'><a href='../S/610.html#L4470'>peer</a>             4470 bgpd/bgpd.c    				MAXTTL + 1 - peer-&gt;gtsm_hops);</span>
<span class='curline'><a href='../S/610.html#L4472'>peer</a>             4472 bgpd/bgpd.c    	  else if (peer-&gt;status &lt; Established)</span>
<span class='curline'><a href='../S/610.html#L4475'>peer</a>             4475 bgpd/bgpd.c    		zlog_debug ("%s Min-ttl changed", peer-&gt;host);</span>
<span class='curline'><a href='../S/610.html#L4476'>peer</a>             4476 bgpd/bgpd.c    	      BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L4485'>peer</a>             4485 bgpd/bgpd.c    peer_ttl_security_hops_unset (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L4489'>peer</a>             4489 bgpd/bgpd.c      struct peer *opeer;</span>
<span class='curline'><a href='../S/610.html#L4491'>peer</a>             4491 bgpd/bgpd.c      zlog_debug ("peer_ttl_security_hops_unset: set gtsm_hops to zero for %s", peer-&gt;host);</span>
<span class='curline'><a href='../S/610.html#L4493'>peer</a>             4493 bgpd/bgpd.c      if (peer-&gt;sort == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L4497'>peer</a>             4497 bgpd/bgpd.c      if (peer_group_active (peer))</span>
<span class='curline'><a href='../S/610.html#L4498'>peer</a>             4498 bgpd/bgpd.c        peer-&gt;gtsm_hops = peer-&gt;group-&gt;conf-&gt;gtsm_hops;</span>
<span class='curline'><a href='../S/610.html#L4500'>peer</a>             4500 bgpd/bgpd.c        peer-&gt;gtsm_hops = 0;</span>
<span class='curline'><a href='../S/610.html#L4502'>peer</a>             4502 bgpd/bgpd.c      opeer = peer;</span>
<span class='curline'><a href='../S/610.html#L4503'>peer</a>             4503 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L4505'>peer</a>             4505 bgpd/bgpd.c          if (peer-&gt;fd &gt;= 0 &amp;&amp; peer-&gt;sort != BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L4506'>peer</a>             4506 bgpd/bgpd.c    	sockopt_minttl (peer-&gt;su.sa.sa_family, peer-&gt;fd, 0);</span>
<span class='curline'><a href='../S/610.html#L4510'>peer</a>             4510 bgpd/bgpd.c          group = peer-&gt;group;</span>
<span class='curline'><a href='../S/610.html#L4511'>peer</a>             4511 bgpd/bgpd.c          for (ALL_LIST_ELEMENTS (group-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L4513'>peer</a>             4513 bgpd/bgpd.c    	  if (peer-&gt;sort == BGP_PEER_IBGP)</span>
<span class='curline'><a href='../S/610.html#L4516'>peer</a>             4516 bgpd/bgpd.c    	  peer-&gt;gtsm_hops = 0;</span>
<span class='curline'><a href='../S/610.html#L4518'>peer</a>             4518 bgpd/bgpd.c    	  if (peer-&gt;fd &gt;= 0)</span>
<span class='curline'><a href='../S/610.html#L4519'>peer</a>             4519 bgpd/bgpd.c    	    sockopt_minttl (peer-&gt;su.sa.sa_family, peer-&gt;fd, 0);</span>
<span class='curline'><a href='../S/610.html#L4527'>peer</a>             4527 bgpd/bgpd.c    peer_clear (struct peer *peer)</span>
<span class='curline'><a href='../S/610.html#L4529'>peer</a>             4529 bgpd/bgpd.c      if (! CHECK_FLAG (peer-&gt;flags, PEER_FLAG_SHUTDOWN))</span>
<span class='curline'><a href='../S/610.html#L4531'>peer</a>             4531 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_PREFIX_OVERFLOW))</span>
<span class='curline'><a href='../S/610.html#L4533'>peer</a>             4533 bgpd/bgpd.c    	  UNSET_FLAG (peer-&gt;sflags, PEER_STATUS_PREFIX_OVERFLOW);</span>
<span class='curline'><a href='../S/610.html#L4534'>peer</a>             4534 bgpd/bgpd.c    	  if (peer-&gt;t_pmax_restart)</span>
<span class='curline'><a href='../S/610.html#L4536'>peer</a>             4536 bgpd/bgpd.c    	      BGP_TIMER_OFF (peer-&gt;t_pmax_restart);</span>
<span class='curline'><a href='../S/610.html#L4539'>peer</a>             4539 bgpd/bgpd.c    			    peer-&gt;host);</span>
<span class='curline'><a href='../S/610.html#L4541'>peer</a>             4541 bgpd/bgpd.c    	  BGP_EVENT_ADD (peer, BGP_Start);</span>
<span class='curline'><a href='../S/610.html#L4545'>peer</a>             4545 bgpd/bgpd.c          peer-&gt;v_start = BGP_INIT_START_TIMER;</span>
<span class='curline'><a href='../S/610.html#L4546'>peer</a>             4546 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L4547'>peer</a>             4547 bgpd/bgpd.c    	bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/610.html#L4550'>peer</a>             4550 bgpd/bgpd.c            BGP_EVENT_ADD (peer, BGP_Stop);</span>
<span class='curline'><a href='../S/610.html#L4556'>peer</a>             4556 bgpd/bgpd.c    peer_clear_soft (struct peer *peer, afi_t afi, safi_t safi,</span>
<span class='curline'><a href='../S/610.html#L4559'>peer</a>             4559 bgpd/bgpd.c      if (peer-&gt;status != Established)</span>
<span class='curline'><a href='../S/610.html#L4562'>peer</a>             4562 bgpd/bgpd.c      if (! peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4567'>peer</a>             4567 bgpd/bgpd.c          if (! CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_RSERVER_CLIENT))</span>
<span class='curline'><a href='../S/610.html#L4569'>peer</a>             4569 bgpd/bgpd.c          bgp_check_local_routes_rsclient (peer, afi, safi);</span>
<span class='curline'><a href='../S/610.html#L4570'>peer</a>             4570 bgpd/bgpd.c          bgp_soft_reconfig_rsclient (peer, afi, safi);</span>
<span class='curline'><a href='../S/610.html#L4574'>peer</a>             4574 bgpd/bgpd.c        bgp_announce_route (peer, afi, safi);</span>
<span class='curline'><a href='../S/610.html#L4578'>peer</a>             4578 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_ORF_PREFIX_SM_ADV)</span>
<span class='curline'><a href='../S/610.html#L4579'>peer</a>             4579 bgpd/bgpd.c    	  &amp;&amp; (CHECK_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_ORF_PREFIX_RM_RCV)</span>
<span class='curline'><a href='../S/610.html#L4580'>peer</a>             4580 bgpd/bgpd.c    	      || CHECK_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_ORF_PREFIX_RM_OLD_RCV)))</span>
<span class='curline'><a href='../S/610.html#L4582'>peer</a>             4582 bgpd/bgpd.c    	  struct bgp_filter *filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L4585'>peer</a>             4585 bgpd/bgpd.c    	  if (CHECK_FLAG (peer-&gt;af_cap[afi][safi], PEER_CAP_ORF_PREFIX_RM_RCV))</span>
<span class='curline'><a href='../S/610.html#L4592'>peer</a>             4592 bgpd/bgpd.c    	      if (CHECK_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_ORF_PREFIX_SEND))</span>
<span class='curline'><a href='../S/610.html#L4593'>peer</a>             4593 bgpd/bgpd.c    		bgp_route_refresh_send (peer, afi, safi,</span>
<span class='curline'><a href='../S/610.html#L4595'>peer</a>             4595 bgpd/bgpd.c    	      bgp_route_refresh_send (peer, afi, safi, prefix_type,</span>
<span class='curline'><a href='../S/610.html#L4600'>peer</a>             4600 bgpd/bgpd.c    	      if (CHECK_FLAG (peer-&gt;af_sflags[afi][safi], PEER_STATUS_ORF_PREFIX_SEND))</span>
<span class='curline'><a href='../S/610.html#L4601'>peer</a>             4601 bgpd/bgpd.c    		bgp_route_refresh_send (peer, afi, safi,</span>
<span class='curline'><a href='../S/610.html#L4604'>peer</a>             4604 bgpd/bgpd.c    		bgp_route_refresh_send (peer, afi, safi, 0, 0, 0);</span>
<span class='curline'><a href='../S/610.html#L4615'>peer</a>             4615 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_SOFT_RECONFIG))</span>
<span class='curline'><a href='../S/610.html#L4616'>peer</a>             4616 bgpd/bgpd.c    	bgp_soft_reconfig_in (peer, afi, safi);</span>
<span class='curline'><a href='../S/610.html#L4621'>peer</a>             4621 bgpd/bgpd.c    	  if (CHECK_FLAG (peer-&gt;cap, PEER_CAP_REFRESH_OLD_RCV)</span>
<span class='curline'><a href='../S/610.html#L4622'>peer</a>             4622 bgpd/bgpd.c    	      || CHECK_FLAG (peer-&gt;cap, PEER_CAP_REFRESH_NEW_RCV))</span>
<span class='curline'><a href='../S/610.html#L4623'>peer</a>             4623 bgpd/bgpd.c    	    bgp_route_refresh_send (peer, afi, safi, 0, 0, 0);</span>
<span class='curline'><a href='../S/610.html#L4677'>peer</a>             4677 bgpd/bgpd.c    bgp_config_write_filter (struct vty *vty, struct peer *peer,</span>
<span class='curline'><a href='../S/610.html#L4686'>peer</a>             4686 bgpd/bgpd.c      addr = peer-&gt;host;</span>
<span class='curline'><a href='../S/610.html#L4687'>peer</a>             4687 bgpd/bgpd.c      filter = &amp;peer-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L4688'>peer</a>             4688 bgpd/bgpd.c      if (peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4689'>peer</a>             4689 bgpd/bgpd.c        gfilter = &amp;peer-&gt;group-&gt;conf-&gt;filter[afi][safi];</span>
<span class='curline'><a href='../S/610.html#L4749'>peer</a>             4749 bgpd/bgpd.c    		       struct peer *peer, afi_t afi, safi_t safi)</span>
<span class='curline'><a href='../S/610.html#L4751'>peer</a>             4751 bgpd/bgpd.c      struct peer *g_peer = NULL;</span>
<span class='curline'><a href='../S/610.html#L4755'>peer</a>             4755 bgpd/bgpd.c      addr = peer-&gt;host;</span>
<span class='curline'><a href='../S/610.html#L4756'>peer</a>             4756 bgpd/bgpd.c      if (peer_group_active (peer))</span>
<span class='curline'><a href='../S/610.html#L4757'>peer</a>             4757 bgpd/bgpd.c        g_peer = peer-&gt;group-&gt;conf;</span>
<span class='curline'><a href='../S/610.html#L4765'>peer</a>             4765 bgpd/bgpd.c          if (! peer_group_active (peer))</span>
<span class='curline'><a href='../S/610.html#L4767'>peer</a>             4767 bgpd/bgpd.c    	  if (CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_GROUP))</span>
<span class='curline'><a href='../S/610.html#L4770'>peer</a>             4770 bgpd/bgpd.c    	  if (peer-&gt;as)</span>
<span class='curline'><a href='../S/610.html#L4771'>peer</a>             4771 bgpd/bgpd.c    	    vty_out (vty, " neighbor %s remote-as %u%s", addr, peer-&gt;as,</span>
<span class='curline'><a href='../S/610.html#L4777'>peer</a>             4777 bgpd/bgpd.c    	    vty_out (vty, " neighbor %s remote-as %u%s", addr, peer-&gt;as,</span>
<span class='curline'><a href='../S/610.html#L4779'>peer</a>             4779 bgpd/bgpd.c    	  if (peer-&gt;af_group[AFI_IP][SAFI_UNICAST])</span>
<span class='curline'><a href='../S/610.html#L4781'>peer</a>             4781 bgpd/bgpd.c    		     peer-&gt;group-&gt;name, VTY_NEWLINE);</span>
<span class='curline'><a href='../S/610.html#L4785'>peer</a>             4785 bgpd/bgpd.c          if (peer-&gt;change_local_as)</span>
<span class='curline'><a href='../S/610.html#L4786'>peer</a>             4786 bgpd/bgpd.c    	if (! peer_group_active (peer))</span>
<span class='curline'><a href='../S/610.html#L4788'>peer</a>             4788 bgpd/bgpd.c    		   peer-&gt;change_local_as,</span>
<span class='curline'><a href='../S/610.html#L4789'>peer</a>             4789 bgpd/bgpd.c    		   CHECK_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_NO_PREPEND) ?</span>
<span class='curline'><a href='../S/610.html#L4791'>peer</a>             4791 bgpd/bgpd.c    		   CHECK_FLAG (peer-&gt;flags, PEER_FLAG_LOCAL_AS_REPLACE_AS) ?</span>
<span class='curline'><a href='../S/610.html#L4795'>peer</a>             4795 bgpd/bgpd.c          if (peer-&gt;desc)</span>
<span class='curline'><a href='../S/610.html#L4796'>peer</a>             4796 bgpd/bgpd.c    	vty_out (vty, " neighbor %s description %s%s", addr, peer-&gt;desc,</span>
<span class='curline'><a href='../S/610.html#L4800'>peer</a>             4800 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;flags, PEER_FLAG_SHUTDOWN))</span>
<span class='curline'><a href='../S/610.html#L4801'>peer</a>             4801 bgpd/bgpd.c            if (! peer_group_active (peer) ||</span>
<span class='curline'><a href='../S/610.html#L4806'>peer</a>             4806 bgpd/bgpd.c          if (peer-&gt;password)</span>
<span class='curline'><a href='../S/610.html#L4807'>peer</a>             4807 bgpd/bgpd.c    	if (!peer_group_active (peer)</span>
<span class='curline'><a href='../S/610.html#L4809'>peer</a>             4809 bgpd/bgpd.c    	    || strcmp (peer-&gt;password, g_peer-&gt;password) != 0)</span>
<span class='curline'><a href='../S/610.html#L4810'>peer</a>             4810 bgpd/bgpd.c    	  vty_out (vty, " neighbor %s password %s%s", addr, peer-&gt;password,</span>
<span class='curline'><a href='../S/610.html#L4814'>peer</a>             4814 bgpd/bgpd.c          if (peer-&gt;port != BGP_PORT_DEFAULT)</span>
<span class='curline'><a href='../S/610.html#L4815'>peer</a>             4815 bgpd/bgpd.c    	vty_out (vty, " neighbor %s port %d%s", addr, peer-&gt;port,</span>
<span class='curline'><a href='../S/610.html#L4819'>peer</a>             4819 bgpd/bgpd.c          if (peer-&gt;ifname)</span>
<span class='curline'><a href='../S/610.html#L4820'>peer</a>             4820 bgpd/bgpd.c    	vty_out (vty, " neighbor %s interface %s%s", addr, peer-&gt;ifname,</span>
<span class='curline'><a href='../S/610.html#L4824'>peer</a>             4824 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;flags, PEER_FLAG_PASSIVE))</span>
<span class='curline'><a href='../S/610.html#L4825'>peer</a>             4825 bgpd/bgpd.c            if (! peer_group_active (peer) ||</span>
<span class='curline'><a href='../S/610.html#L4830'>peer</a>             4830 bgpd/bgpd.c          if (peer-&gt;sort != BGP_PEER_IBGP &amp;&amp; peer-&gt;ttl != 1 &amp;&amp;</span>
<span class='curline'><a href='../S/610.html#L4831'>peer</a>             4831 bgpd/bgpd.c                       !(peer-&gt;gtsm_hops != 0 &amp;&amp; peer-&gt;ttl == MAXTTL))</span>
<span class='curline'><a href='../S/610.html#L4832'>peer</a>             4832 bgpd/bgpd.c            if (! peer_group_active (peer) ||</span>
<span class='curline'><a href='../S/610.html#L4833'>peer</a>             4833 bgpd/bgpd.c    	    g_peer-&gt;ttl != peer-&gt;ttl)</span>
<span class='curline'><a href='../S/610.html#L4834'>peer</a>             4834 bgpd/bgpd.c    	  vty_out (vty, " neighbor %s ebgp-multihop %d%s", addr, peer-&gt;ttl,</span>
<span class='curline'><a href='../S/610.html#L4838'>peer</a>             4838 bgpd/bgpd.c          if (peer-&gt;sort != BGP_PEER_IBGP &amp;&amp; peer-&gt;gtsm_hops != 0)</span>
<span class='curline'><a href='../S/610.html#L4839'>peer</a>             4839 bgpd/bgpd.c            if (! peer_group_active (peer) || g_peer-&gt;gtsm_hops != peer-&gt;gtsm_hops)</span>
<span class='curline'><a href='../S/610.html#L4841'>peer</a>             4841 bgpd/bgpd.c                       peer-&gt;gtsm_hops, VTY_NEWLINE);</span>
<span class='curline'><a href='../S/610.html#L4844'>peer</a>             4844 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;flags, PEER_FLAG_DISABLE_CONNECTED_CHECK))</span>
<span class='curline'><a href='../S/610.html#L4845'>peer</a>             4845 bgpd/bgpd.c    	if (! peer_group_active (peer) ||</span>
<span class='curline'><a href='../S/610.html#L4850'>peer</a>             4850 bgpd/bgpd.c          if (peer-&gt;update_if)</span>
<span class='curline'><a href='../S/610.html#L4851'>peer</a>             4851 bgpd/bgpd.c    	if (! peer_group_active (peer) || ! g_peer-&gt;update_if</span>
<span class='curline'><a href='../S/610.html#L4852'>peer</a>             4852 bgpd/bgpd.c    	    || strcmp (g_peer-&gt;update_if, peer-&gt;update_if) != 0)</span>
<span class='curline'><a href='../S/610.html#L4854'>peer</a>             4854 bgpd/bgpd.c    		   peer-&gt;update_if, VTY_NEWLINE);</span>
<span class='curline'><a href='../S/610.html#L4855'>peer</a>             4855 bgpd/bgpd.c          if (peer-&gt;update_source)</span>
<span class='curline'><a href='../S/610.html#L4856'>peer</a>             4856 bgpd/bgpd.c    	if (! peer_group_active (peer) || ! g_peer-&gt;update_source</span>
<span class='curline'><a href='../S/610.html#L4858'>peer</a>             4858 bgpd/bgpd.c    			      peer-&gt;update_source) != 0)</span>
<span class='curline'><a href='../S/610.html#L4860'>peer</a>             4860 bgpd/bgpd.c    		   sockunion2str (peer-&gt;update_source, buf, SU_ADDRSTRLEN),</span>
<span class='curline'><a href='../S/610.html#L4864'>peer</a>             4864 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;config, PEER_CONFIG_ROUTEADV))</span>
<span class='curline'><a href='../S/610.html#L4866'>peer</a>             4866 bgpd/bgpd.c    		 addr, peer-&gt;v_routeadv, VTY_NEWLINE); </span>
<span class='curline'><a href='../S/610.html#L4869'>peer</a>             4869 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;config, PEER_CONFIG_TIMER)</span>
<span class='curline'><a href='../S/610.html#L4870'>peer</a>             4870 bgpd/bgpd.c    	  &amp;&amp; ! peer_group_active (peer))</span>
<span class='curline'><a href='../S/610.html#L4872'>peer</a>             4872 bgpd/bgpd.c    	  peer-&gt;keepalive, peer-&gt;holdtime, VTY_NEWLINE);</span>
<span class='curline'><a href='../S/610.html#L4874'>peer</a>             4874 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;config, PEER_CONFIG_CONNECT))</span>
<span class='curline'><a href='../S/610.html#L4876'>peer</a>             4876 bgpd/bgpd.c    	  peer-&gt;connect, VTY_NEWLINE);</span>
<span class='curline'><a href='../S/610.html#L4879'>peer</a>             4879 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;config, PEER_CONFIG_WEIGHT))</span>
<span class='curline'><a href='../S/610.html#L4880'>peer</a>             4880 bgpd/bgpd.c            if (! peer_group_active (peer) ||</span>
<span class='curline'><a href='../S/610.html#L4881'>peer</a>             4881 bgpd/bgpd.c    	    g_peer-&gt;weight != peer-&gt;weight)</span>
<span class='curline'><a href='../S/610.html#L4882'>peer</a>             4882 bgpd/bgpd.c    	  vty_out (vty, " neighbor %s weight %d%s", addr, peer-&gt;weight,</span>
<span class='curline'><a href='../S/610.html#L4886'>peer</a>             4886 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;flags, PEER_FLAG_DYNAMIC_CAPABILITY))</span>
<span class='curline'><a href='../S/610.html#L4887'>peer</a>             4887 bgpd/bgpd.c            if (! peer_group_active (peer) ||</span>
<span class='curline'><a href='../S/610.html#L4893'>peer</a>             4893 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;flags, PEER_FLAG_DONT_CAPABILITY))</span>
<span class='curline'><a href='../S/610.html#L4894'>peer</a>             4894 bgpd/bgpd.c            if (! peer_group_active (peer) ||</span>
<span class='curline'><a href='../S/610.html#L4900'>peer</a>             4900 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;flags, PEER_FLAG_OVERRIDE_CAPABILITY))</span>
<span class='curline'><a href='../S/610.html#L4901'>peer</a>             4901 bgpd/bgpd.c            if (! peer_group_active (peer) ||</span>
<span class='curline'><a href='../S/610.html#L4907'>peer</a>             4907 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;flags, PEER_FLAG_STRICT_CAP_MATCH))</span>
<span class='curline'><a href='../S/610.html#L4908'>peer</a>             4908 bgpd/bgpd.c            if (! peer_group_active (peer) ||</span>
<span class='curline'><a href='../S/610.html#L4913'>peer</a>             4913 bgpd/bgpd.c          if (! peer-&gt;af_group[AFI_IP][SAFI_UNICAST])</span>
<span class='curline'><a href='../S/610.html#L4917'>peer</a>             4917 bgpd/bgpd.c    	      if (peer-&gt;afc[AFI_IP][SAFI_UNICAST])</span>
<span class='curline'><a href='../S/610.html#L4922'>peer</a>             4922 bgpd/bgpd.c    	      if (! peer-&gt;afc[AFI_IP][SAFI_UNICAST])</span>
<span class='curline'><a href='../S/610.html#L4935'>peer</a>             4935 bgpd/bgpd.c          if (peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4937'>peer</a>             4937 bgpd/bgpd.c    		 peer-&gt;group-&gt;name, VTY_NEWLINE);</span>
<span class='curline'><a href='../S/610.html#L4943'>peer</a>             4943 bgpd/bgpd.c      if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_ORF_PREFIX_SM)</span>
<span class='curline'><a href='../S/610.html#L4944'>peer</a>             4944 bgpd/bgpd.c          || CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_ORF_PREFIX_RM))</span>
<span class='curline'><a href='../S/610.html#L4945'>peer</a>             4945 bgpd/bgpd.c        if (! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4949'>peer</a>             4949 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_ORF_PREFIX_SM)</span>
<span class='curline'><a href='../S/610.html#L4950'>peer</a>             4950 bgpd/bgpd.c    	  &amp;&amp; CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_ORF_PREFIX_RM))</span>
<span class='curline'><a href='../S/610.html#L4952'>peer</a>             4952 bgpd/bgpd.c          else if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_ORF_PREFIX_SM))</span>
<span class='curline'><a href='../S/610.html#L4960'>peer</a>             4960 bgpd/bgpd.c      if (peer_af_flag_check (peer, afi, safi, PEER_FLAG_REFLECTOR_CLIENT)</span>
<span class='curline'><a href='../S/610.html#L4961'>peer</a>             4961 bgpd/bgpd.c          &amp;&amp; ! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4966'>peer</a>             4966 bgpd/bgpd.c      if (peer_af_flag_check (peer, afi, safi, PEER_FLAG_NEXTHOP_SELF)</span>
<span class='curline'><a href='../S/610.html#L4967'>peer</a>             4967 bgpd/bgpd.c          &amp;&amp; ! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4971'>peer</a>             4971 bgpd/bgpd.c      if (peer_af_flag_check (peer, afi, safi, PEER_FLAG_REMOVE_PRIVATE_AS)</span>
<span class='curline'><a href='../S/610.html#L4972'>peer</a>             4972 bgpd/bgpd.c          &amp;&amp; ! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4977'>peer</a>             4977 bgpd/bgpd.c      if (! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L4981'>peer</a>             4981 bgpd/bgpd.c    	  if (peer_af_flag_check (peer, afi, safi, PEER_FLAG_SEND_COMMUNITY)</span>
<span class='curline'><a href='../S/610.html#L4982'>peer</a>             4982 bgpd/bgpd.c    	      &amp;&amp; peer_af_flag_check (peer, afi, safi, PEER_FLAG_SEND_EXT_COMMUNITY))</span>
<span class='curline'><a href='../S/610.html#L4984'>peer</a>             4984 bgpd/bgpd.c    	  else if (peer_af_flag_check (peer, afi, safi, PEER_FLAG_SEND_EXT_COMMUNITY))	</span>
<span class='curline'><a href='../S/610.html#L4987'>peer</a>             4987 bgpd/bgpd.c    	  else if (peer_af_flag_check (peer, afi, safi, PEER_FLAG_SEND_COMMUNITY))</span>
<span class='curline'><a href='../S/610.html#L4992'>peer</a>             4992 bgpd/bgpd.c    	  if (! peer_af_flag_check (peer, afi, safi, PEER_FLAG_SEND_COMMUNITY)</span>
<span class='curline'><a href='../S/610.html#L4993'>peer</a>             4993 bgpd/bgpd.c    	      &amp;&amp; ! peer_af_flag_check (peer, afi, safi, PEER_FLAG_SEND_EXT_COMMUNITY))</span>
<span class='curline'><a href='../S/610.html#L4996'>peer</a>             4996 bgpd/bgpd.c    	  else if (! peer_af_flag_check (peer, afi, safi, PEER_FLAG_SEND_EXT_COMMUNITY))</span>
<span class='curline'><a href='../S/610.html#L4999'>peer</a>             4999 bgpd/bgpd.c    	  else if (! peer_af_flag_check (peer, afi, safi, PEER_FLAG_SEND_COMMUNITY))</span>
<span class='curline'><a href='../S/610.html#L5006'>peer</a>             5006 bgpd/bgpd.c      if (peer_af_flag_check (peer, afi, safi, PEER_FLAG_DEFAULT_ORIGINATE)</span>
<span class='curline'><a href='../S/610.html#L5007'>peer</a>             5007 bgpd/bgpd.c          &amp;&amp; ! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L5010'>peer</a>             5010 bgpd/bgpd.c          if (peer-&gt;default_rmap[afi][safi].name)</span>
<span class='curline'><a href='../S/610.html#L5011'>peer</a>             5011 bgpd/bgpd.c    	vty_out (vty, " route-map %s", peer-&gt;default_rmap[afi][safi].name);</span>
<span class='curline'><a href='../S/610.html#L5016'>peer</a>             5016 bgpd/bgpd.c      if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_SOFT_RECONFIG))</span>
<span class='curline'><a href='../S/610.html#L5017'>peer</a>             5017 bgpd/bgpd.c        if (! peer-&gt;af_group[afi][safi] ||</span>
<span class='curline'><a href='../S/610.html#L5023'>peer</a>             5023 bgpd/bgpd.c      if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MAX_PREFIX))</span>
<span class='curline'><a href='../S/610.html#L5024'>peer</a>             5024 bgpd/bgpd.c        if (! peer-&gt;af_group[afi][safi]</span>
<span class='curline'><a href='../S/610.html#L5025'>peer</a>             5025 bgpd/bgpd.c    	|| g_peer-&gt;pmax[afi][safi] != peer-&gt;pmax[afi][safi]</span>
<span class='curline'><a href='../S/610.html#L5026'>peer</a>             5026 bgpd/bgpd.c            || g_peer-&gt;pmax_threshold[afi][safi] != peer-&gt;pmax_threshold[afi][safi]</span>
<span class='curline'><a href='../S/610.html#L5028'>peer</a>             5028 bgpd/bgpd.c    	   != CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MAX_PREFIX_WARNING))</span>
<span class='curline'><a href='../S/610.html#L5030'>peer</a>             5030 bgpd/bgpd.c    	vty_out (vty, " neighbor %s maximum-prefix %ld", addr, peer-&gt;pmax[afi][safi]);</span>
<span class='curline'><a href='../S/610.html#L5031'>peer</a>             5031 bgpd/bgpd.c    	if (peer-&gt;pmax_threshold[afi][safi] != MAXIMUM_PREFIX_THRESHOLD_DEFAULT)</span>
<span class='curline'><a href='../S/610.html#L5032'>peer</a>             5032 bgpd/bgpd.c    	  vty_out (vty, " %d", peer-&gt;pmax_threshold[afi][safi]);</span>
<span class='curline'><a href='../S/610.html#L5033'>peer</a>             5033 bgpd/bgpd.c    	if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MAX_PREFIX_WARNING))</span>
<span class='curline'><a href='../S/610.html#L5035'>peer</a>             5035 bgpd/bgpd.c    	if (peer-&gt;pmax_restart[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L5036'>peer</a>             5036 bgpd/bgpd.c    	  vty_out (vty, " restart %d", peer-&gt;pmax_restart[afi][safi]);</span>
<span class='curline'><a href='../S/610.html#L5041'>peer</a>             5041 bgpd/bgpd.c      if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_RSERVER_CLIENT)</span>
<span class='curline'><a href='../S/610.html#L5042'>peer</a>             5042 bgpd/bgpd.c          &amp;&amp; ! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L5046'>peer</a>             5046 bgpd/bgpd.c      if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_NEXTHOP_LOCAL_UNCHANGED)</span>
<span class='curline'><a href='../S/610.html#L5047'>peer</a>             5047 bgpd/bgpd.c          &amp;&amp; ! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L5051'>peer</a>             5051 bgpd/bgpd.c      if (peer_af_flag_check (peer, afi, safi, PEER_FLAG_ALLOWAS_IN))</span>
<span class='curline'><a href='../S/610.html#L5052'>peer</a>             5052 bgpd/bgpd.c        if (! peer_group_active (peer)</span>
<span class='curline'><a href='../S/610.html#L5054'>peer</a>             5054 bgpd/bgpd.c    	|| peer-&gt;allowas_in[afi][safi] != g_peer-&gt;allowas_in[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L5056'>peer</a>             5056 bgpd/bgpd.c    	if (peer-&gt;allowas_in[afi][safi] == 3)</span>
<span class='curline'><a href='../S/610.html#L5060'>peer</a>             5060 bgpd/bgpd.c    		   peer-&gt;allowas_in[afi][safi], VTY_NEWLINE);</span>
<span class='curline'><a href='../S/610.html#L5064'>peer</a>             5064 bgpd/bgpd.c      bgp_config_write_filter (vty, peer, afi, safi);</span>
<span class='curline'><a href='../S/610.html#L5067'>peer</a>             5067 bgpd/bgpd.c      if ((CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_AS_PATH_UNCHANGED)</span>
<span class='curline'><a href='../S/610.html#L5068'>peer</a>             5068 bgpd/bgpd.c          || CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_NEXTHOP_UNCHANGED)</span>
<span class='curline'><a href='../S/610.html#L5069'>peer</a>             5069 bgpd/bgpd.c          || CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MED_UNCHANGED))</span>
<span class='curline'><a href='../S/610.html#L5070'>peer</a>             5070 bgpd/bgpd.c          &amp;&amp; ! peer-&gt;af_group[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L5072'>peer</a>             5072 bgpd/bgpd.c          if (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_AS_PATH_UNCHANGED)</span>
<span class='curline'><a href='../S/610.html#L5073'>peer</a>             5073 bgpd/bgpd.c              &amp;&amp; CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_NEXTHOP_UNCHANGED)</span>
<span class='curline'><a href='../S/610.html#L5074'>peer</a>             5074 bgpd/bgpd.c              &amp;&amp; CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MED_UNCHANGED))</span>
<span class='curline'><a href='../S/610.html#L5078'>peer</a>             5078 bgpd/bgpd.c    	     (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_AS_PATH_UNCHANGED)) ?</span>
<span class='curline'><a href='../S/610.html#L5080'>peer</a>             5080 bgpd/bgpd.c    	     (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_NEXTHOP_UNCHANGED)) ?</span>
<span class='curline'><a href='../S/610.html#L5082'>peer</a>             5082 bgpd/bgpd.c    	     (CHECK_FLAG (peer-&gt;af_flags[afi][safi], PEER_FLAG_MED_UNCHANGED)) ?</span>
<span class='curline'><a href='../S/610.html#L5126'>peer</a>             5126 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L5142'>peer</a>             5142 bgpd/bgpd.c      for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L5144'>peer</a>             5144 bgpd/bgpd.c          if (peer-&gt;afc[afi][safi])</span>
<span class='curline'><a href='../S/610.html#L5146'>peer</a>             5146 bgpd/bgpd.c    	  if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_ACCEPT_PEER))</span>
<span class='curline'><a href='../S/610.html#L5149'>peer</a>             5149 bgpd/bgpd.c    	      bgp_config_write_peer (vty, bgp, peer, afi, safi);</span>
<span class='curline'><a href='../S/610.html#L5168'>peer</a>             5168 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L5323'>peer</a>             5323 bgpd/bgpd.c          for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L5325'>peer</a>             5325 bgpd/bgpd.c    	  if (! CHECK_FLAG (peer-&gt;sflags, PEER_STATUS_ACCEPT_PEER))</span>
<span class='curline'><a href='../S/610.html#L5326'>peer</a>             5326 bgpd/bgpd.c    	    bgp_config_write_peer (vty, bgp, peer, AFI_IP, SAFI_UNICAST);</span>
<span class='curline'><a href='../S/610.html#L5416'>peer</a>             5416 bgpd/bgpd.c      struct peer *peer;</span>
<span class='curline'><a href='../S/610.html#L5421'>peer</a>             5421 bgpd/bgpd.c        for (ALL_LIST_ELEMENTS (bgp-&gt;peer, node, nnode, peer))</span>
<span class='curline'><a href='../S/610.html#L5422'>peer</a>             5422 bgpd/bgpd.c          if (peer-&gt;status == Established)</span>
<span class='curline'><a href='../S/610.html#L5423'>peer</a>             5423 bgpd/bgpd.c              bgp_notify_send (peer, BGP_NOTIFY_CEASE,</span>
<span class='curline'><a href='../S/608.html#L78'>peer</a>               78 bgpd/bgpd.h      struct peer *peer_self;</span>
<span class='curline'><a href='../S/608.html#L81'>peer</a>               81 bgpd/bgpd.h      struct list *peer;</span>
<span class='curline'><a href='../S/608.html#L184'>peer</a>              184 bgpd/bgpd.h      struct list *peer;</span>
<span class='curline'><a href='../S/608.html#L187'>peer</a>              187 bgpd/bgpd.h      struct peer *conf;</span>
<span class='curline'><a href='../S/608.html#L830'>peer</a>              830 bgpd/bgpd.h    		     struct bgp_nexthop *, struct peer *);</span>
<span class='curline'><a href='../S/608.html#L834'>peer</a>              834 bgpd/bgpd.h    extern struct peer *peer_lookup (struct bgp *, union sockunion *);</span>
<span class='curline'><a href='../S/608.html#L837'>peer</a>              837 bgpd/bgpd.h    extern struct peer *peer_lookup_with_open (union sockunion *, as_t, struct in_addr *,</span>
<span class='curline'><a href='../S/608.html#L839'>peer</a>              839 bgpd/bgpd.h    extern struct peer *peer_lock (struct peer *);</span>
<span class='curline'><a href='../S/608.html#L840'>peer</a>              840 bgpd/bgpd.h    extern struct peer *peer_unlock (struct peer *);</span>
<span class='curline'><a href='../S/608.html#L841'>peer</a>              841 bgpd/bgpd.h    extern bgp_peer_sort_t peer_sort (struct peer *peer);</span>
<span class='curline'><a href='../S/608.html#L842'>peer</a>              842 bgpd/bgpd.h    extern int peer_active (struct peer *);</span>
<span class='curline'><a href='../S/608.html#L843'>peer</a>              843 bgpd/bgpd.h    extern int peer_active_nego (struct peer *);</span>
<span class='curline'><a href='../S/608.html#L844'>peer</a>              844 bgpd/bgpd.h    extern struct peer *peer_create_accept (struct bgp *);</span>
<span class='curline'><a href='../S/608.html#L886'>peer</a>              886 bgpd/bgpd.h    extern int peer_rsclient_active (struct peer *);</span>
<span class='curline'><a href='../S/608.html#L890'>peer</a>              890 bgpd/bgpd.h    extern int peer_delete (struct peer *peer);</span>
<span class='curline'><a href='../S/608.html#L894'>peer</a>              894 bgpd/bgpd.h    extern int peer_activate (struct peer *, afi_t, safi_t);</span>
<span class='curline'><a href='../S/608.html#L895'>peer</a>              895 bgpd/bgpd.h    extern int peer_deactivate (struct peer *, afi_t, safi_t);</span>
<span class='curline'><a href='../S/608.html#L899'>peer</a>              899 bgpd/bgpd.h    extern int peer_group_unbind (struct bgp *, struct peer *, struct peer_group *,</span>
<span class='curline'><a href='../S/608.html#L902'>peer</a>              902 bgpd/bgpd.h    extern int peer_flag_set (struct peer *, u_int32_t);</span>
<span class='curline'><a href='../S/608.html#L903'>peer</a>              903 bgpd/bgpd.h    extern int peer_flag_unset (struct peer *, u_int32_t);</span>
<span class='curline'><a href='../S/608.html#L905'>peer</a>              905 bgpd/bgpd.h    extern int peer_af_flag_set (struct peer *, afi_t, safi_t, u_int32_t);</span>
<span class='curline'><a href='../S/608.html#L906'>peer</a>              906 bgpd/bgpd.h    extern int peer_af_flag_unset (struct peer *, afi_t, safi_t, u_int32_t);</span>
<span class='curline'><a href='../S/608.html#L907'>peer</a>              907 bgpd/bgpd.h    extern int peer_af_flag_check (struct peer *, afi_t, safi_t, u_int32_t);</span>
<span class='curline'><a href='../S/608.html#L909'>peer</a>              909 bgpd/bgpd.h    extern int peer_ebgp_multihop_set (struct peer *, int);</span>
<span class='curline'><a href='../S/608.html#L910'>peer</a>              910 bgpd/bgpd.h    extern int peer_ebgp_multihop_unset (struct peer *);</span>
<span class='curline'><a href='../S/608.html#L912'>peer</a>              912 bgpd/bgpd.h    extern int peer_description_set (struct peer *, char *);</span>
<span class='curline'><a href='../S/608.html#L913'>peer</a>              913 bgpd/bgpd.h    extern int peer_description_unset (struct peer *);</span>
<span class='curline'><a href='../S/608.html#L915'>peer</a>              915 bgpd/bgpd.h    extern int peer_update_source_if_set (struct peer *, const char *);</span>
<span class='curline'><a href='../S/608.html#L916'>peer</a>              916 bgpd/bgpd.h    extern int peer_update_source_addr_set (struct peer *, union sockunion *);</span>
<span class='curline'><a href='../S/608.html#L917'>peer</a>              917 bgpd/bgpd.h    extern int peer_update_source_unset (struct peer *);</span>
<span class='curline'><a href='../S/608.html#L919'>peer</a>              919 bgpd/bgpd.h    extern int peer_default_originate_set (struct peer *, afi_t, safi_t, const char *);</span>
<span class='curline'><a href='../S/608.html#L920'>peer</a>              920 bgpd/bgpd.h    extern int peer_default_originate_unset (struct peer *, afi_t, safi_t);</span>
<span class='curline'><a href='../S/608.html#L922'>peer</a>              922 bgpd/bgpd.h    extern int peer_port_set (struct peer *, u_int16_t);</span>
<span class='curline'><a href='../S/608.html#L923'>peer</a>              923 bgpd/bgpd.h    extern int peer_port_unset (struct peer *);</span>
<span class='curline'><a href='../S/608.html#L925'>peer</a>              925 bgpd/bgpd.h    extern int peer_weight_set (struct peer *, u_int16_t);</span>
<span class='curline'><a href='../S/608.html#L926'>peer</a>              926 bgpd/bgpd.h    extern int peer_weight_unset (struct peer *);</span>
<span class='curline'><a href='../S/608.html#L928'>peer</a>              928 bgpd/bgpd.h    extern int peer_timers_set (struct peer *, u_int32_t, u_int32_t);</span>
<span class='curline'><a href='../S/608.html#L929'>peer</a>              929 bgpd/bgpd.h    extern int peer_timers_unset (struct peer *);</span>
<span class='curline'><a href='../S/608.html#L931'>peer</a>              931 bgpd/bgpd.h    extern int peer_timers_connect_set (struct peer *, u_int32_t);</span>
<span class='curline'><a href='../S/608.html#L932'>peer</a>              932 bgpd/bgpd.h    extern int peer_timers_connect_unset (struct peer *);</span>
<span class='curline'><a href='../S/608.html#L934'>peer</a>              934 bgpd/bgpd.h    extern int peer_advertise_interval_set (struct peer *, u_int32_t);</span>
<span class='curline'><a href='../S/608.html#L935'>peer</a>              935 bgpd/bgpd.h    extern int peer_advertise_interval_unset (struct peer *);</span>
<span class='curline'><a href='../S/608.html#L937'>peer</a>              937 bgpd/bgpd.h    extern int peer_interface_set (struct peer *, const char *);</span>
<span class='curline'><a href='../S/608.html#L938'>peer</a>              938 bgpd/bgpd.h    extern int peer_interface_unset (struct peer *);</span>
<span class='curline'><a href='../S/608.html#L940'>peer</a>              940 bgpd/bgpd.h    extern int peer_distribute_set (struct peer *, afi_t, safi_t, int, const char *);</span>
<span class='curline'><a href='../S/608.html#L941'>peer</a>              941 bgpd/bgpd.h    extern int peer_distribute_unset (struct peer *, afi_t, safi_t, int);</span>
<span class='curline'><a href='../S/608.html#L943'>peer</a>              943 bgpd/bgpd.h    extern int peer_allowas_in_set (struct peer *, afi_t, safi_t, int);</span>
<span class='curline'><a href='../S/608.html#L944'>peer</a>              944 bgpd/bgpd.h    extern int peer_allowas_in_unset (struct peer *, afi_t, safi_t);</span>
<span class='curline'><a href='../S/608.html#L946'>peer</a>              946 bgpd/bgpd.h    extern int peer_local_as_set (struct peer *, as_t, int, int);</span>
<span class='curline'><a href='../S/608.html#L947'>peer</a>              947 bgpd/bgpd.h    extern int peer_local_as_unset (struct peer *);</span>
<span class='curline'><a href='../S/608.html#L949'>peer</a>              949 bgpd/bgpd.h    extern int peer_prefix_list_set (struct peer *, afi_t, safi_t, int, const char *);</span>
<span class='curline'><a href='../S/608.html#L950'>peer</a>              950 bgpd/bgpd.h    extern int peer_prefix_list_unset (struct peer *, afi_t, safi_t, int);</span>
<span class='curline'><a href='../S/608.html#L952'>peer</a>              952 bgpd/bgpd.h    extern int peer_aslist_set (struct peer *, afi_t, safi_t, int, const char *);</span>
<span class='curline'><a href='../S/608.html#L953'>peer</a>              953 bgpd/bgpd.h    extern int peer_aslist_unset (struct peer *,afi_t, safi_t, int);</span>
<span class='curline'><a href='../S/608.html#L955'>peer</a>              955 bgpd/bgpd.h    extern int peer_route_map_set (struct peer *, afi_t, safi_t, int, const char *);</span>
<span class='curline'><a href='../S/608.html#L956'>peer</a>              956 bgpd/bgpd.h    extern int peer_route_map_unset (struct peer *, afi_t, safi_t, int);</span>
<span class='curline'><a href='../S/608.html#L958'>peer</a>              958 bgpd/bgpd.h    extern int peer_unsuppress_map_set (struct peer *, afi_t, safi_t, const char *);</span>
<span class='curline'><a href='../S/608.html#L960'>peer</a>              960 bgpd/bgpd.h    extern int peer_password_set (struct peer *, const char *);</span>
<span class='curline'><a href='../S/608.html#L961'>peer</a>              961 bgpd/bgpd.h    extern int peer_password_unset (struct peer *);</span>
<span class='curline'><a href='../S/608.html#L963'>peer</a>              963 bgpd/bgpd.h    extern int peer_unsuppress_map_unset (struct peer *, afi_t, safi_t);</span>
<span class='curline'><a href='../S/608.html#L965'>peer</a>              965 bgpd/bgpd.h    extern int peer_maximum_prefix_set (struct peer *, afi_t, safi_t, u_int32_t, u_char, int, u_int16_t);</span>
<span class='curline'><a href='../S/608.html#L966'>peer</a>              966 bgpd/bgpd.h    extern int peer_maximum_prefix_unset (struct peer *, afi_t, safi_t);</span>
<span class='curline'><a href='../S/608.html#L968'>peer</a>              968 bgpd/bgpd.h    extern int peer_clear (struct peer *);</span>
<span class='curline'><a href='../S/608.html#L969'>peer</a>              969 bgpd/bgpd.h    extern int peer_clear_soft (struct peer *, afi_t, safi_t, enum bgp_clear_type);</span>
<span class='curline'><a href='../S/608.html#L971'>peer</a>              971 bgpd/bgpd.h    extern int peer_ttl_security_hops_set (struct peer *, int);</span>
<span class='curline'><a href='../S/608.html#L972'>peer</a>              972 bgpd/bgpd.h    extern int peer_ttl_security_hops_unset (struct peer *);</span>
<span class='curline'><a href='../S/449.html#L110'>peer</a>              110 ldpd/ldp_adj.c       e-&gt;p.peer-&gt;hellotime_send_timer) == MPLS_BOOL_FALSE) {</span>
<span class='curline'><a href='../S/449.html#L170'>peer</a>              170 ldpd/ldp_adj.c     e-&gt;p.peer-&gt;target_role == LDP_PASSIVE) {</span>
<span class='curline'><a href='../S/449.html#L174'>peer</a>              174 ldpd/ldp_adj.c     ldp_peer_send_stop(g, e-&gt;p.peer);</span>
<span class='curline'><a href='../S/446.html#L540'>peer</a>              540 ldpd/ldp_cfg.c           ldp_peer *peer = NULL;</span>
<span class='curline'><a href='../S/446.html#L542'>peer</a>              542 ldpd/ldp_cfg.c           if (ldp_global_find_peer_index(global, e-&gt;sub_index, &amp;peer) !=</span>
<span class='curline'><a href='../S/446.html#L551'>peer</a>              551 ldpd/ldp_cfg.c           ldp_entity_add_peer(entity, peer);</span>
<span class='curline'><a href='../S/446.html#L1050'>peer</a>             1050 ldpd/ldp_cfg.c   ldp_peer *peer = NULL;</span>
<span class='curline'><a href='../S/446.html#L1059'>peer</a>             1059 ldpd/ldp_cfg.c   if (ldp_global_find_peer_index(global, p-&gt;index, &amp;peer) != MPLS_SUCCESS)</span>
<span class='curline'><a href='../S/446.html#L1063'>peer</a>             1063 ldpd/ldp_cfg.c     p-&gt;label_space = peer-&gt;label_space;</span>
<span class='curline'><a href='../S/446.html#L1066'>peer</a>             1066 ldpd/ldp_cfg.c     p-&gt;target_role = peer-&gt;target_role;</span>
<span class='curline'><a href='../S/446.html#L1069'>peer</a>             1069 ldpd/ldp_cfg.c     memcpy(&amp;p-&gt;dest.addr, &amp;peer-&gt;dest.addr, sizeof(mpls_inet_addr));</span>
<span class='curline'><a href='../S/446.html#L1072'>peer</a>             1072 ldpd/ldp_cfg.c     p-&gt;entity_index = peer-&gt;entity-&gt;index;</span>
<span class='curline'><a href='../S/446.html#L1075'>peer</a>             1075 ldpd/ldp_cfg.c     p-&gt;oper_state = peer-&gt;oper_state;</span>
<span class='curline'><a href='../S/446.html#L1078'>peer</a>             1078 ldpd/ldp_cfg.c     strncpy(p-&gt;peer_name, peer-&gt;peer_name, MPLS_MAX_IF_NAME);</span>
<span class='curline'><a href='../S/446.html#L1094'>peer</a>             1094 ldpd/ldp_cfg.c   ldp_peer *peer = NULL;</span>
<span class='curline'><a href='../S/446.html#L1109'>peer</a>             1109 ldpd/ldp_cfg.c     switch ((r = ldp_global_find_peer_index(g, index, &amp;peer))) {</span>
<span class='curline'><a href='../S/446.html#L1124'>peer</a>             1124 ldpd/ldp_cfg.c     p-&gt;index = peer-&gt;index;</span>
<span class='curline'><a href='../S/446.html#L1143'>peer</a>             1143 ldpd/ldp_cfg.c   ldp_peer *peer = NULL;</span>
<span class='curline'><a href='../S/446.html#L1153'>peer</a>             1153 ldpd/ldp_cfg.c     if ((peer = ldp_peer_create()) == NULL) {</span>
<span class='curline'><a href='../S/446.html#L1156'>peer</a>             1156 ldpd/ldp_cfg.c     p-&gt;index = peer-&gt;index;</span>
<span class='curline'><a href='../S/446.html#L1157'>peer</a>             1157 ldpd/ldp_cfg.c     _ldp_global_add_peer(global, peer);</span>
<span class='curline'><a href='../S/446.html#L1159'>peer</a>             1159 ldpd/ldp_cfg.c     ldp_global_find_peer_index(global, p-&gt;index, &amp;peer);</span>
<span class='curline'><a href='../S/446.html#L1162'>peer</a>             1162 ldpd/ldp_cfg.c   if (peer == NULL) {</span>
<span class='curline'><a href='../S/446.html#L1167'>peer</a>             1167 ldpd/ldp_cfg.c   if ((ldp_peer_is_active(peer) == MPLS_BOOL_TRUE) &amp;&amp; (flag &amp; LDP_PEER_CFG_WHEN_DOWN)) {</span>
<span class='curline'><a href='../S/446.html#L1174'>peer</a>             1174 ldpd/ldp_cfg.c     if (peer-&gt;entity != NULL) {</span>
<span class='curline'><a href='../S/446.html#L1181'>peer</a>             1181 ldpd/ldp_cfg.c     _ldp_global_del_peer(global, peer);</span>
<span class='curline'><a href='../S/446.html#L1187'>peer</a>             1187 ldpd/ldp_cfg.c     peer-&gt;label_space = p-&gt;label_space;</span>
<span class='curline'><a href='../S/446.html#L1190'>peer</a>             1190 ldpd/ldp_cfg.c     peer-&gt;target_role = p-&gt;target_role;</span>
<span class='curline'><a href='../S/446.html#L1193'>peer</a>             1193 ldpd/ldp_cfg.c     memcpy(&amp;peer-&gt;dest.addr, &amp;p-&gt;dest.addr, sizeof(mpls_inet_addr));</span>
<span class='curline'><a href='../S/446.html#L1199'>peer</a>             1199 ldpd/ldp_cfg.c     strncpy(peer-&gt;peer_name, p-&gt;peer_name, MPLS_MAX_IF_NAME);</span>
<span class='curline'><a href='../S/386.html#L95'>peer</a>               95 ldpd/ldp_entity.c         return e-&gt;p.peer-&gt;label_space;</span>
<span class='curline'><a href='../S/386.html#L120'>peer</a>              120 ldpd/ldp_entity.c         if (e-&gt;p.peer)</span>
<span class='curline'><a href='../S/386.html#L161'>peer</a>              161 ldpd/ldp_entity.c       retval = ldp_peer_startup(g, e-&gt;p.peer);</span>
<span class='curline'><a href='../S/386.html#L196'>peer</a>              196 ldpd/ldp_entity.c       if (ldp_peer_shutdown(g, e-&gt;p.peer) != MPLS_SUCCESS) {</span>
<span class='curline'><a href='../S/386.html#L252'>peer</a>              252 ldpd/ldp_entity.c   e-&gt;p.peer = p;</span>
<span class='curline'><a href='../S/386.html#L259'>peer</a>              259 ldpd/ldp_entity.c   MPLS_ASSERT(e &amp;&amp; e-&gt;entity_type == LDP_INDIRECT &amp;&amp; e-&gt;p.peer);</span>
<span class='curline'><a href='../S/386.html#L260'>peer</a>              260 ldpd/ldp_entity.c   _ldp_peer_del_entity(e-&gt;p.peer);</span>
<span class='curline'><a href='../S/386.html#L261'>peer</a>              261 ldpd/ldp_entity.c   MPLS_REFCNT_RELEASE(e-&gt;p.peer, ldp_peer_delete);</span>
<span class='curline'><a href='../S/386.html#L262'>peer</a>              262 ldpd/ldp_entity.c   e-&gt;p.peer = NULL;</span>
<span class='curline'><a href='../S/350.html#L325'>peer</a>              325 ldpd/ldp_fec.c   ldp_session *peer = NULL;</span>
<span class='curline'><a href='../S/350.html#L356'>peer</a>              356 ldpd/ldp_fec.c   peer = MPLS_LIST_HEAD(&amp;g-&gt;session);</span>
<span class='curline'><a href='../S/350.html#L357'>peer</a>              357 ldpd/ldp_fec.c   while (peer != NULL) {        /* FEC.1 */</span>
<span class='curline'><a href='../S/350.html#L358'>peer</a>              358 ldpd/ldp_fec.c     if ((peer-&gt;state != LDP_STATE_OPERATIONAL) ||</span>
<span class='curline'><a href='../S/350.html#L359'>peer</a>              359 ldpd/ldp_fec.c       (nh_session &amp;&amp; peer-&gt;index == nh_session-&gt;index)) {</span>
<span class='curline'><a href='../S/350.html#L363'>peer</a>              363 ldpd/ldp_fec.c     if ((us_attr = ldp_attr_find_upstream_state2(g, peer, f,</span>
<span class='curline'><a href='../S/350.html#L375'>peer</a>              375 ldpd/ldp_fec.c     if (peer-&gt;oper_distribution_mode == LDP_DISTRIBUTION_UNSOLICITED) {</span>
<span class='curline'><a href='../S/350.html#L378'>peer</a>              378 ldpd/ldp_fec.c           ldp_attr_find_upstream_state2(g, peer, f, LDP_LSP_STATE_REQ_RECV);</span>
<span class='curline'><a href='../S/350.html#L381'>peer</a>              381 ldpd/ldp_fec.c         if (ldp_label_mapping_with_xc(g, peer, f, &amp;us_attr, ds_attr) !=</span>
<span class='curline'><a href='../S/350.html#L403'>peer</a>              403 ldpd/ldp_fec.c           if (ldp_label_mapping_with_xc(g, peer, f, &amp;us_attr, ds_attr) !=</span>
<span class='curline'><a href='../S/350.html#L411'>peer</a>              411 ldpd/ldp_fec.c     peer = MPLS_LIST_NEXT(&amp;g-&gt;session, peer, _global);</span>
<span class='curline'><a href='../S/350.html#L443'>peer</a>              443 ldpd/ldp_fec.c   ldp_session *peer = NULL;</span>
<span class='curline'><a href='../S/350.html#L549'>peer</a>              549 ldpd/ldp_fec.c   peer = MPLS_LIST_HEAD(&amp;g-&gt;session);</span>
<span class='curline'><a href='../S/350.html#L550'>peer</a>              550 ldpd/ldp_fec.c   while (peer) {</span>
<span class='curline'><a href='../S/350.html#L551'>peer</a>              551 ldpd/ldp_fec.c     if (peer-&gt;state == LDP_STATE_OPERATIONAL) {</span>
<span class='curline'><a href='../S/350.html#L552'>peer</a>              552 ldpd/ldp_fec.c       us_attr = ldp_attr_find_upstream_state2(g, peer, f,</span>
<span class='curline'><a href='../S/350.html#L555'>peer</a>              555 ldpd/ldp_fec.c         if (ldp_label_withdraw_send(g, peer, us_attr, LDP_NOTIF_NONE) !=</span>
<span class='curline'><a href='../S/350.html#L562'>peer</a>              562 ldpd/ldp_fec.c     peer = MPLS_LIST_NEXT(&amp;g-&gt;session, peer, _global);</span>
<span class='curline'><a href='../S/410.html#L107'>peer</a>              107 ldpd/ldp_global.c     MPLS_LIST_INIT(&amp;g-&gt;peer, ldp_peer);</span>
<span class='curline'><a href='../S/410.html#L444'>peer</a>              444 ldpd/ldp_global.c   pp = MPLS_LIST_HEAD(&amp;g-&gt;peer);</span>
<span class='curline'><a href='../S/410.html#L447'>peer</a>              447 ldpd/ldp_global.c       MPLS_LIST_INSERT_BEFORE(&amp;g-&gt;peer, pp, p, _global);</span>
<span class='curline'><a href='../S/410.html#L450'>peer</a>              450 ldpd/ldp_global.c     pp = MPLS_LIST_NEXT(&amp;g-&gt;peer, pp, _global);</span>
<span class='curline'><a href='../S/410.html#L452'>peer</a>              452 ldpd/ldp_global.c   MPLS_LIST_ADD_TAIL(&amp;g-&gt;peer, p, _global, ldp_peer);</span>
<span class='curline'><a href='../S/410.html#L458'>peer</a>              458 ldpd/ldp_global.c   MPLS_LIST_REMOVE(&amp;g-&gt;peer, p, _global);</span>
<span class='curline'><a href='../S/410.html#L875'>peer</a>              875 ldpd/ldp_global.c   p = MPLS_LIST_HEAD(&amp;g-&gt;peer);</span>
<span class='curline'><a href='../S/410.html#L883'>peer</a>              883 ldpd/ldp_global.c     p = MPLS_LIST_NEXT(&amp;g-&gt;peer, p, _global);</span>
<span class='curline'><a href='../S/410.html#L917'>peer</a>              917 ldpd/ldp_global.c   ldp_peer ** peer)</span>
<span class='curline'><a href='../S/410.html#L925'>peer</a>              925 ldpd/ldp_global.c     p = MPLS_LIST_TAIL(&amp;g-&gt;peer);</span>
<span class='curline'><a href='../S/410.html#L927'>peer</a>              927 ldpd/ldp_global.c       *peer = NULL;</span>
<span class='curline'><a href='../S/410.html#L931'>peer</a>              931 ldpd/ldp_global.c     p = MPLS_LIST_HEAD(&amp;g-&gt;peer);</span>
<span class='curline'><a href='../S/410.html#L934'>peer</a>              934 ldpd/ldp_global.c         *peer = p;</span>
<span class='curline'><a href='../S/410.html#L937'>peer</a>              937 ldpd/ldp_global.c       p = MPLS_LIST_NEXT(&amp;g-&gt;peer, p, _global);</span>
<span class='curline'><a href='../S/410.html#L940'>peer</a>              940 ldpd/ldp_global.c   *peer = NULL;</span>
<span class='curline'><a href='../S/443.html#L36'>peer</a>               36 ldpd/ldp_global.h   uint32_t index, ldp_peer ** peer);</span>
<span class='curline'><a href='../S/369.html#L89'>peer</a>               89 ldpd/ldp_hello.c       MPLS_ASSERT(e-&gt;p.peer != NULL);</span>
<span class='curline'><a href='../S/369.html#L90'>peer</a>               90 ldpd/ldp_hello.c       hello = &amp;e-&gt;p.peer-&gt;hello;</span>
<span class='curline'><a href='../S/369.html#L91'>peer</a>               91 ldpd/ldp_hello.c       oper_duration = &amp;e-&gt;p.peer-&gt;hellotime_send_timer_duration;</span>
<span class='curline'><a href='../S/369.html#L92'>peer</a>               92 ldpd/ldp_hello.c       timer = &amp;e-&gt;p.peer-&gt;hellotime_send_timer;</span>
<span class='curline'><a href='../S/369.html#L94'>peer</a>               94 ldpd/ldp_hello.c       if (e-&gt;p.peer-&gt;target_role == LDP_ACTIVE) {</span>
<span class='curline'><a href='../S/354.html#L672'>peer</a>              672 ldpd/ldp_label_mapping.c   ldp_session *peer = NULL;</span>
<span class='curline'><a href='../S/354.html#L950'>peer</a>              950 ldpd/ldp_label_mapping.c   peer = MPLS_LIST_HEAD(&amp;g-&gt;session);</span>
<span class='curline'><a href='../S/354.html#L951'>peer</a>              951 ldpd/ldp_label_mapping.c   while (peer) {					/* LMp.17 */</span>
<span class='curline'><a href='../S/354.html#L953'>peer</a>              953 ldpd/ldp_label_mapping.c     if (peer-&gt;state != LDP_STATE_OPERATIONAL) {</span>
<span class='curline'><a href='../S/354.html#L966'>peer</a>              966 ldpd/ldp_label_mapping.c     if ((us_list = ldp_attr_find_upstream_all2(g, peer, f))) {	/* LMp.23 */</span>
<span class='curline'><a href='../S/354.html#L979'>peer</a>              979 ldpd/ldp_label_mapping.c             r_attr-&gt;fecTlv.fecElArray[0].addressEl.preLen, peer-&gt;session_name);</span>
<span class='curline'><a href='../S/354.html#L1001'>peer</a>             1001 ldpd/ldp_label_mapping.c     if ((peer-&gt;oper_distribution_mode == LDP_DISTRIBUTION_UNSOLICITED) &amp;&amp;</span>
<span class='curline'><a href='../S/354.html#L1010'>peer</a>             1010 ldpd/ldp_label_mapping.c         if (ldp_attr_find_downstream_state2(g, peer, f,</span>
<span class='curline'><a href='../S/354.html#L1016'>peer</a>             1016 ldpd/ldp_label_mapping.c           if (ldp_label_request_for_xc(g, peer, &amp;f-&gt;info, NULL, &amp;ds_temp) !=</span>
<span class='curline'><a href='../S/354.html#L1029'>peer</a>             1029 ldpd/ldp_label_mapping.c         if (ldp_label_mapping_with_xc(g, peer, f, &amp;us_attr, ds_attr) !=</span>
<span class='curline'><a href='../S/354.html#L1045'>peer</a>             1045 ldpd/ldp_label_mapping.c     while ((us_temp = ldp_attr_find_upstream_state2(g, peer, f,</span>
<span class='curline'><a href='../S/354.html#L1048'>peer</a>             1048 ldpd/ldp_label_mapping.c       if (peer-&gt;oper_distribution_mode == LDP_DISTRIBUTION_UNSOLICITED) {</span>
<span class='curline'><a href='../S/354.html#L1050'>peer</a>             1050 ldpd/ldp_label_mapping.c           if (ldp_attr_find_downstream_state2(g, peer, f,</span>
<span class='curline'><a href='../S/354.html#L1056'>peer</a>             1056 ldpd/ldp_label_mapping.c             if (ldp_label_request_for_xc(g, peer, &amp;f-&gt;info, us_temp,</span>
<span class='curline'><a href='../S/354.html#L1063'>peer</a>             1063 ldpd/ldp_label_mapping.c           if (ldp_label_mapping_with_xc(g, peer, f, &amp;us_temp,</span>
<span class='curline'><a href='../S/354.html#L1070'>peer</a>             1070 ldpd/ldp_label_mapping.c         if ((us_list = ldp_attr_find_upstream_all2(g, peer, f))) {</span>
<span class='curline'><a href='../S/354.html#L1075'>peer</a>             1075 ldpd/ldp_label_mapping.c                 if (ldp_attr_find_downstream_state2(g, peer, f,</span>
<span class='curline'><a href='../S/354.html#L1081'>peer</a>             1081 ldpd/ldp_label_mapping.c                   if (ldp_label_request_for_xc(g, peer, &amp;f-&gt;info, us_temp,</span>
<span class='curline'><a href='../S/354.html#L1088'>peer</a>             1088 ldpd/ldp_label_mapping.c                 if (ldp_label_mapping_with_xc(g, peer, f, &amp;us_temp,</span>
<span class='curline'><a href='../S/354.html#L1109'>peer</a>             1109 ldpd/ldp_label_mapping.c     peer = MPLS_LIST_NEXT(&amp;g-&gt;session, peer, _global);</span>
<span class='curline'><a href='../S/375.html#L71'>peer</a>               71 ldpd/ldp_mesg.c       MPLS_ASSERT(e-&gt;p.peer != NULL);</span>
<span class='curline'><a href='../S/375.html#L72'>peer</a>               72 ldpd/ldp_mesg.c       dest = &amp;e-&gt;p.peer-&gt;dest;</span>
<span class='curline'><a href='../S/375.html#L73'>peer</a>               73 ldpd/ldp_mesg.c       buf = e-&gt;p.peer-&gt;tx_buffer;</span>
<span class='curline'><a href='../S/375.html#L74'>peer</a>               74 ldpd/ldp_mesg.c       label_space = e-&gt;p.peer-&gt;label_space;</span>
<span class='curline'><a href='../S/365.html#L16'>peer</a>               16 ldpd/ldp_remote_peer.c     		rp-&gt;peer.dest.if_handle = 0;</span>
<span class='curline'><a href='../S/365.html#L18'>peer</a>               18 ldpd/ldp_remote_peer.c     		if (!mpls_dest_compare(&amp;rp-&gt;peer.dest,dest)) {</span>
<span class='curline'><a href='../S/365.html#L49'>peer</a>               49 ldpd/ldp_remote_peer.c     strncpy(rp-&gt;peer.peer_name,dest_name,IFNAMSIZ);</span>
<span class='curline'><a href='../S/365.html#L50'>peer</a>               50 ldpd/ldp_remote_peer.c     rp-&gt;peer.label_space = 0;</span>
<span class='curline'><a href='../S/365.html#L51'>peer</a>               51 ldpd/ldp_remote_peer.c     memcpy(&amp;rp-&gt;peer.dest,dest,sizeof(struct mpls_dest));</span>
<span class='curline'><a href='../S/365.html#L53'>peer</a>               53 ldpd/ldp_remote_peer.c     ldp_cfg_peer_set(rp-&gt;ldp-&gt;h, &amp;rp-&gt;peer, LDP_CFG_ADD |</span>
<span class='curline'><a href='../S/365.html#L56'>peer</a>               56 ldpd/ldp_remote_peer.c     rp-&gt;entity.sub_index = rp-&gt;peer.index;</span>
<span class='curline'><a href='../S/365.html#L66'>peer</a>               66 ldpd/ldp_remote_peer.c     ldp_cfg_peer_get(rp-&gt;ldp-&gt;h, &amp;rp-&gt;peer, 0xFFFFFFFF);</span>
<span class='curline'><a href='../S/365.html#L77'>peer</a>               77 ldpd/ldp_remote_peer.c 	ldp_cfg_peer_set(rp-&gt;ldp-&gt;h, &amp;rp-&gt;peer, LDP_CFG_DEL);</span>
<span class='curline'><a href='../S/365.html#L80'>peer</a>               80 ldpd/ldp_remote_peer.c     rp-&gt;peer.index = 0;</span>
<span class='curline'><a href='../S/365.html#L84'>peer</a>               84 ldpd/ldp_remote_peer.c     if (!rp-&gt;peer.index) {</span>
<span class='curline'><a href='../S/365.html#L95'>peer</a>               95 ldpd/ldp_remote_peer.c     if (!rp-&gt;peer.index) {</span>
<span class='curline'><a href='../S/382.html#L9'>peer</a>                9 ldpd/ldp_remote_peer.h     ldp_peer peer;</span>
<span class='curline'><a href='../S/423.html#L378'>peer</a>              378 ldpd/ldp_state_machine.c           ldp_peer *peer = NULL;</span>
<span class='curline'><a href='../S/423.html#L379'>peer</a>              379 ldpd/ldp_state_machine.c           if ((peer = ldp_global_find_peer_addr(g, &amp;addr))) {</span>
<span class='curline'><a href='../S/423.html#L380'>peer</a>              380 ldpd/ldp_state_machine.c             entity = ldp_peer_get_entity(peer);</span>
<span class='curline'><a href='../S/423.html#L381'>peer</a>              381 ldpd/ldp_state_machine.c             oper_state = peer-&gt;oper_state;</span>
<span class='curline'><a href='../S/409.html#L227'>peer</a>              227 ldpd/ldp_struct.h   struct ldp_peer_list peer;</span>
<span class='curline'><a href='../S/409.html#L300'>peer</a>              300 ldpd/ldp_struct.h     struct ldp_peer *peer;</span>
<span class='curline'><a href='../S/358.html#L972'>peer</a>              972 ldpd/ldp_vty.c   ldp_peer peer;</span>
<span class='curline'><a href='../S/358.html#L982'>peer</a>              982 ldpd/ldp_vty.c         Addresses bound to peer LDP Ident:</span>
<span class='curline'><a href='../S/358.html#L1009'>peer</a>             1009 ldpd/ldp_vty.c           peer.index = e.sub_index;</span>
<span class='curline'><a href='../S/358.html#L1010'>peer</a>             1010 ldpd/ldp_vty.c           ldp_cfg_peer_get(ldp-&gt;h,&amp;peer,0xFFFFFFFF);</span>
<span class='curline'><a href='../S/358.html#L1011'>peer</a>             1011 ldpd/ldp_vty.c           label_space = peer.label_space;</span>
<span class='curline'><a href='../S/358.html#L1055'>peer</a>             1055 ldpd/ldp_vty.c         vty_out(vty, "%s ", peer.peer_name);</span>
<span class='curline'><a href='../S/358.html#L1145'>peer</a>             1145 ldpd/ldp_vty.c   ldp_peer peer;</span>
<span class='curline'><a href='../S/358.html#L1205'>peer</a>             1205 ldpd/ldp_vty.c     peer.index = 0;</span>
<span class='curline'><a href='../S/358.html#L1206'>peer</a>             1206 ldpd/ldp_vty.c     while (ldp_cfg_peer_getnext(ldp-&gt;h, &amp;peer, 0xFFFFFFFF) ==</span>
<span class='curline'><a href='../S/358.html#L1210'>peer</a>             1210 ldpd/ldp_vty.c       dst.s_addr = htonl(peer.dest.addr.u.ipv4);</span>
<span class='curline'><a href='../S/358.html#L1213'>peer</a>             1213 ldpd/ldp_vty.c         if (peer.entity_index == adj.entity_index) {</span>
<span class='curline'><a href='../S/358.html#L1988'>peer</a>             1988 ldpd/ldp_vty.c       addr.s_addr = htonl(rp-&gt;peer.dest.addr.u.ipv4);</span>
<span class='curline'><a href='../S/850.html#L225'>peer</a>              225 mplsadmd/libnetlink.c int rtnl_talk(struct rtnl_handle *rtnl, struct nlmsghdr *n, pid_t peer,</span>
<span class='curline'><a href='../S/850.html#L245'>peer</a>              245 mplsadmd/libnetlink.c 	nladdr.nl_pid = peer;</span>
<span class='curline'><a href='../S/850.html#L296'>peer</a>              296 mplsadmd/libnetlink.c 			if (nladdr.nl_pid != peer ||</span>
<span class='curline'><a href='../S/848.html#L12'>peer</a>               12 mplsadmd/libnetlink.h 	struct sockaddr_nl	peer;</span>
<span class='curline'><a href='../S/848.html#L29'>peer</a>               29 mplsadmd/libnetlink.h extern int rtnl_talk(struct rtnl_handle *rtnl, struct nlmsghdr *n, pid_t peer,</span>
<span class='curline'><a href='../S/588.html#L43'>peer</a>               43 ripd/rip_peer.c rip_peer_free (struct rip_peer *peer)</span>
<span class='curline'><a href='../S/588.html#L45'>peer</a>               45 ripd/rip_peer.c   XFREE (MTYPE_RIP_PEER, peer);</span>
<span class='curline'><a href='../S/588.html#L51'>peer</a>               51 ripd/rip_peer.c   struct rip_peer *peer;</span>
<span class='curline'><a href='../S/588.html#L54'>peer</a>               54 ripd/rip_peer.c   for (ALL_LIST_ELEMENTS (peer_list, node, nnode, peer))</span>
<span class='curline'><a href='../S/588.html#L56'>peer</a>               56 ripd/rip_peer.c       if (IPV4_ADDR_SAME (&amp;peer-&gt;addr, addr))</span>
<span class='curline'><a href='../S/588.html#L57'>peer</a>               57 ripd/rip_peer.c 	return peer;</span>
<span class='curline'><a href='../S/588.html#L65'>peer</a>               65 ripd/rip_peer.c   struct rip_peer *peer;</span>
<span class='curline'><a href='../S/588.html#L68'>peer</a>               68 ripd/rip_peer.c   for (ALL_LIST_ELEMENTS (peer_list, node, nnode, peer))</span>
<span class='curline'><a href='../S/588.html#L70'>peer</a>               70 ripd/rip_peer.c       if (htonl (peer-&gt;addr.s_addr) &gt; htonl (addr-&gt;s_addr))</span>
<span class='curline'><a href='../S/588.html#L71'>peer</a>               71 ripd/rip_peer.c 	return peer;</span>
<span class='curline'><a href='../S/588.html#L80'>peer</a>               80 ripd/rip_peer.c   struct rip_peer *peer;</span>
<span class='curline'><a href='../S/588.html#L82'>peer</a>               82 ripd/rip_peer.c   peer = THREAD_ARG (t);</span>
<span class='curline'><a href='../S/588.html#L83'>peer</a>               83 ripd/rip_peer.c   listnode_delete (peer_list, peer);</span>
<span class='curline'><a href='../S/588.html#L84'>peer</a>               84 ripd/rip_peer.c   rip_peer_free (peer);</span>
<span class='curline'><a href='../S/588.html#L93'>peer</a>               93 ripd/rip_peer.c   struct rip_peer *peer;</span>
<span class='curline'><a href='../S/588.html#L95'>peer</a>               95 ripd/rip_peer.c   peer = rip_peer_lookup (addr);</span>
<span class='curline'><a href='../S/588.html#L97'>peer</a>               97 ripd/rip_peer.c   if (peer)</span>
<span class='curline'><a href='../S/588.html#L99'>peer</a>               99 ripd/rip_peer.c       if (peer-&gt;t_timeout)</span>
<span class='curline'><a href='../S/588.html#L100'>peer</a>              100 ripd/rip_peer.c 	thread_cancel (peer-&gt;t_timeout);</span>
<span class='curline'><a href='../S/588.html#L104'>peer</a>              104 ripd/rip_peer.c       peer = rip_peer_new ();</span>
<span class='curline'><a href='../S/588.html#L105'>peer</a>              105 ripd/rip_peer.c       peer-&gt;addr = *addr;</span>
<span class='curline'><a href='../S/588.html#L106'>peer</a>              106 ripd/rip_peer.c       listnode_add_sort (peer_list, peer);</span>
<span class='curline'><a href='../S/588.html#L110'>peer</a>              110 ripd/rip_peer.c   peer-&gt;t_timeout = thread_add_timer (master, rip_peer_timeout, peer,</span>
<span class='curline'><a href='../S/588.html#L114'>peer</a>              114 ripd/rip_peer.c   time (&amp;peer-&gt;uptime);</span>
<span class='curline'><a href='../S/588.html#L116'>peer</a>              116 ripd/rip_peer.c   return peer;</span>
<span class='curline'><a href='../S/588.html#L122'>peer</a>              122 ripd/rip_peer.c   struct rip_peer *peer;</span>
<span class='curline'><a href='../S/588.html#L123'>peer</a>              123 ripd/rip_peer.c   peer = rip_peer_get (&amp;from-&gt;sin_addr);</span>
<span class='curline'><a href='../S/588.html#L124'>peer</a>              124 ripd/rip_peer.c   peer-&gt;version = version;</span>
<span class='curline'><a href='../S/588.html#L130'>peer</a>              130 ripd/rip_peer.c   struct rip_peer *peer;</span>
<span class='curline'><a href='../S/588.html#L131'>peer</a>              131 ripd/rip_peer.c   peer = rip_peer_get (&amp;from-&gt;sin_addr);</span>
<span class='curline'><a href='../S/588.html#L132'>peer</a>              132 ripd/rip_peer.c   peer-&gt;recv_badroutes++;</span>
<span class='curline'><a href='../S/588.html#L138'>peer</a>              138 ripd/rip_peer.c   struct rip_peer *peer;</span>
<span class='curline'><a href='../S/588.html#L139'>peer</a>              139 ripd/rip_peer.c   peer = rip_peer_get (&amp;from-&gt;sin_addr);</span>
<span class='curline'><a href='../S/588.html#L140'>peer</a>              140 ripd/rip_peer.c   peer-&gt;recv_badpackets++;</span>
<span class='curline'><a href='../S/588.html#L145'>peer</a>              145 ripd/rip_peer.c rip_peer_uptime (struct rip_peer *peer, char *buf, size_t len)</span>
<span class='curline'><a href='../S/588.html#L151'>peer</a>              151 ripd/rip_peer.c   if (peer-&gt;uptime == 0)</span>
<span class='curline'><a href='../S/588.html#L159'>peer</a>              159 ripd/rip_peer.c   uptime -= peer-&gt;uptime;</span>
<span class='curline'><a href='../S/588.html#L181'>peer</a>              181 ripd/rip_peer.c   struct rip_peer *peer;</span>
<span class='curline'><a href='../S/588.html#L186'>peer</a>              186 ripd/rip_peer.c   for (ALL_LIST_ELEMENTS (peer_list, node, nnode, peer))</span>
<span class='curline'><a href='../S/588.html#L188'>peer</a>              188 ripd/rip_peer.c       vty_out (vty, "    %-16s %9d %9d %9d   %s%s", inet_ntoa (peer-&gt;addr),</span>
<span class='curline'><a href='../S/588.html#L189'>peer</a>              189 ripd/rip_peer.c 	       peer-&gt;recv_badpackets, peer-&gt;recv_badroutes,</span>
<span class='curline'><a href='../S/588.html#L191'>peer</a>              191 ripd/rip_peer.c 	       rip_peer_uptime (peer, timebuf, RIP_UPTIME_LEN),</span>
<span class='curline'><a href='../S/589.html#L286'>peer</a>              286 ripd/rip_snmp.c   struct rip_peer *peer;</span>
<span class='curline'><a href='../S/589.html#L296'>peer</a>              296 ripd/rip_snmp.c       peer = rip_peer_lookup (addr);</span>
<span class='curline'><a href='../S/589.html#L298'>peer</a>              298 ripd/rip_snmp.c       if (peer-&gt;domain == name[v-&gt;namelen + sizeof (struct in_addr)])</span>
<span class='curline'><a href='../S/589.html#L299'>peer</a>              299 ripd/rip_snmp.c 	return peer;</span>
<span class='curline'><a href='../S/589.html#L311'>peer</a>              311 ripd/rip_snmp.c       peer = rip_peer_lookup (addr);</span>
<span class='curline'><a href='../S/589.html#L312'>peer</a>              312 ripd/rip_snmp.c       if (peer)</span>
<span class='curline'><a href='../S/589.html#L315'>peer</a>              315 ripd/rip_snmp.c 	      (peer-&gt;domain &gt; name[v-&gt;namelen + sizeof (struct in_addr)]))</span>
<span class='curline'><a href='../S/589.html#L317'>peer</a>              317 ripd/rip_snmp.c 	      oid_copy_addr (name + v-&gt;namelen, &amp;peer-&gt;addr,</span>
<span class='curline'><a href='../S/589.html#L319'>peer</a>              319 ripd/rip_snmp.c 	      name[v-&gt;namelen + sizeof (struct in_addr)] = peer-&gt;domain;</span>
<span class='curline'><a href='../S/589.html#L321'>peer</a>              321 ripd/rip_snmp.c 	      return peer;</span>
<span class='curline'><a href='../S/589.html#L324'>peer</a>              324 ripd/rip_snmp.c       peer = rip_peer_lookup_next (addr);</span>
<span class='curline'><a href='../S/589.html#L326'>peer</a>              326 ripd/rip_snmp.c       if (! peer)</span>
<span class='curline'><a href='../S/589.html#L329'>peer</a>              329 ripd/rip_snmp.c       oid_copy_addr (name + v-&gt;namelen, &amp;peer-&gt;addr,</span>
<span class='curline'><a href='../S/589.html#L331'>peer</a>              331 ripd/rip_snmp.c       name[v-&gt;namelen + sizeof (struct in_addr)] = peer-&gt;domain;</span>
<span class='curline'><a href='../S/589.html#L334'>peer</a>              334 ripd/rip_snmp.c       return peer;</span>
<span class='curline'><a href='../S/589.html#L527'>peer</a>              527 ripd/rip_snmp.c   struct rip_peer *peer;</span>
<span class='curline'><a href='../S/589.html#L536'>peer</a>              536 ripd/rip_snmp.c   peer = rip2PeerLookup (v, name, length, &amp;addr, exact);</span>
<span class='curline'><a href='../S/589.html#L537'>peer</a>              537 ripd/rip_snmp.c   if (! peer)</span>
<span class='curline'><a href='../S/589.html#L544'>peer</a>              544 ripd/rip_snmp.c       return (u_char *) &amp;peer-&gt;addr;</span>
<span class='curline'><a href='../S/589.html#L558'>peer</a>              558 ripd/rip_snmp.c       uptime = peer-&gt;uptime; /* now - snmp_agent_startup - peer-&gt;uptime */</span>
<span class='curline'><a href='../S/589.html#L566'>peer</a>              566 ripd/rip_snmp.c       version = peer-&gt;version;</span>
<span class='curline'><a href='../S/589.html#L571'>peer</a>              571 ripd/rip_snmp.c       return (u_char *) &amp;peer-&gt;recv_badpackets;</span>
<span class='curline'><a href='../S/589.html#L575'>peer</a>              575 ripd/rip_snmp.c       return (u_char *) &amp;peer-&gt;recv_badroutes;</span>
<span class='curline'><a href='../S/101.html#L49'>peer</a>               49 ripngd/ripng_peer.c ripng_peer_free (struct ripng_peer *peer)</span>
<span class='curline'><a href='../S/101.html#L51'>peer</a>               51 ripngd/ripng_peer.c   XFREE (MTYPE_RIPNG_PEER, peer);</span>
<span class='curline'><a href='../S/101.html#L57'>peer</a>               57 ripngd/ripng_peer.c   struct ripng_peer *peer;</span>
<span class='curline'><a href='../S/101.html#L60'>peer</a>               60 ripngd/ripng_peer.c   for (ALL_LIST_ELEMENTS (peer_list, node, nnode, peer))</span>
<span class='curline'><a href='../S/101.html#L62'>peer</a>               62 ripngd/ripng_peer.c       if (IPV6_ADDR_SAME (&amp;peer-&gt;addr, addr))</span>
<span class='curline'><a href='../S/101.html#L63'>peer</a>               63 ripngd/ripng_peer.c 	return peer;</span>
<span class='curline'><a href='../S/101.html#L71'>peer</a>               71 ripngd/ripng_peer.c   struct ripng_peer *peer;</span>
<span class='curline'><a href='../S/101.html#L74'>peer</a>               74 ripngd/ripng_peer.c   for (ALL_LIST_ELEMENTS (peer_list, node, nnode, peer))</span>
<span class='curline'><a href='../S/101.html#L76'>peer</a>               76 ripngd/ripng_peer.c       if (addr6_cmp(&amp;peer-&gt;addr, addr) &gt; 0) </span>
<span class='curline'><a href='../S/101.html#L77'>peer</a>               77 ripngd/ripng_peer.c 	return peer;</span>
<span class='curline'><a href='../S/101.html#L88'>peer</a>               88 ripngd/ripng_peer.c   struct ripng_peer *peer;</span>
<span class='curline'><a href='../S/101.html#L90'>peer</a>               90 ripngd/ripng_peer.c   peer = THREAD_ARG (t);</span>
<span class='curline'><a href='../S/101.html#L91'>peer</a>               91 ripngd/ripng_peer.c   listnode_delete (peer_list, peer);</span>
<span class='curline'><a href='../S/101.html#L92'>peer</a>               92 ripngd/ripng_peer.c   ripng_peer_free (peer);</span>
<span class='curline'><a href='../S/101.html#L101'>peer</a>              101 ripngd/ripng_peer.c   struct ripng_peer *peer;</span>
<span class='curline'><a href='../S/101.html#L103'>peer</a>              103 ripngd/ripng_peer.c   peer = ripng_peer_lookup (addr);</span>
<span class='curline'><a href='../S/101.html#L105'>peer</a>              105 ripngd/ripng_peer.c   if (peer)</span>
<span class='curline'><a href='../S/101.html#L107'>peer</a>              107 ripngd/ripng_peer.c       if (peer-&gt;t_timeout)</span>
<span class='curline'><a href='../S/101.html#L108'>peer</a>              108 ripngd/ripng_peer.c 	thread_cancel (peer-&gt;t_timeout);</span>
<span class='curline'><a href='../S/101.html#L112'>peer</a>              112 ripngd/ripng_peer.c       peer = ripng_peer_new ();</span>
<span class='curline'><a href='../S/101.html#L113'>peer</a>              113 ripngd/ripng_peer.c       peer-&gt;addr = *addr; /* XXX */</span>
<span class='curline'><a href='../S/101.html#L114'>peer</a>              114 ripngd/ripng_peer.c       listnode_add_sort (peer_list, peer);</span>
<span class='curline'><a href='../S/101.html#L118'>peer</a>              118 ripngd/ripng_peer.c   peer-&gt;t_timeout = thread_add_timer (master, ripng_peer_timeout, peer,</span>
<span class='curline'><a href='../S/101.html#L122'>peer</a>              122 ripngd/ripng_peer.c   time (&amp;peer-&gt;uptime);</span>
<span class='curline'><a href='../S/101.html#L124'>peer</a>              124 ripngd/ripng_peer.c   return peer;</span>
<span class='curline'><a href='../S/101.html#L130'>peer</a>              130 ripngd/ripng_peer.c   struct ripng_peer *peer;</span>
<span class='curline'><a href='../S/101.html#L131'>peer</a>              131 ripngd/ripng_peer.c   peer = ripng_peer_get (&amp;from-&gt;sin6_addr);</span>
<span class='curline'><a href='../S/101.html#L132'>peer</a>              132 ripngd/ripng_peer.c   peer-&gt;version = version;</span>
<span class='curline'><a href='../S/101.html#L138'>peer</a>              138 ripngd/ripng_peer.c   struct ripng_peer *peer;</span>
<span class='curline'><a href='../S/101.html#L139'>peer</a>              139 ripngd/ripng_peer.c   peer = ripng_peer_get (&amp;from-&gt;sin6_addr);</span>
<span class='curline'><a href='../S/101.html#L140'>peer</a>              140 ripngd/ripng_peer.c   peer-&gt;recv_badroutes++;</span>
<span class='curline'><a href='../S/101.html#L146'>peer</a>              146 ripngd/ripng_peer.c   struct ripng_peer *peer;</span>
<span class='curline'><a href='../S/101.html#L147'>peer</a>              147 ripngd/ripng_peer.c   peer = ripng_peer_get (&amp;from-&gt;sin6_addr);</span>
<span class='curline'><a href='../S/101.html#L148'>peer</a>              148 ripngd/ripng_peer.c   peer-&gt;recv_badpackets++;</span>
<span class='curline'><a href='../S/101.html#L153'>peer</a>              153 ripngd/ripng_peer.c ripng_peer_uptime (struct ripng_peer *peer, char *buf, size_t len)</span>
<span class='curline'><a href='../S/101.html#L159'>peer</a>              159 ripngd/ripng_peer.c   if (peer-&gt;uptime == 0)</span>
<span class='curline'><a href='../S/101.html#L167'>peer</a>              167 ripngd/ripng_peer.c   uptime -= peer-&gt;uptime;</span>
<span class='curline'><a href='../S/101.html#L189'>peer</a>              189 ripngd/ripng_peer.c   struct ripng_peer *peer;</span>
<span class='curline'><a href='../S/101.html#L194'>peer</a>              194 ripngd/ripng_peer.c   for (ALL_LIST_ELEMENTS (peer_list, node, nnode, peer))</span>
<span class='curline'><a href='../S/101.html#L196'>peer</a>              196 ripngd/ripng_peer.c       vty_out (vty, "    %s %s%14s %10d %10d %10d      %s%s", inet6_ntoa (peer-&gt;addr),</span>
<span class='curline'><a href='../S/101.html#L198'>peer</a>              198 ripngd/ripng_peer.c 	       peer-&gt;recv_badpackets, peer-&gt;recv_badroutes,</span>
<span class='curline'><a href='../S/101.html#L200'>peer</a>              200 ripngd/ripng_peer.c 	       ripng_peer_uptime (peer, timebuf, RIPNG_UPTIME_LEN),</span>
<span class='curline'><a href='../S/90.html#L1212'>peer</a>             1212 tests/aspath_test.c   struct peer peer = { 0 };</span>
<span class='curline'><a href='../S/90.html#L1221'>peer</a>             1221 tests/aspath_test.c   peer.ibuf = stream_new (BGP_MAX_PACKET_SIZE);</span>
<span class='curline'><a href='../S/90.html#L1222'>peer</a>             1222 tests/aspath_test.c   peer.obuf = stream_fifo_new ();</span>
<span class='curline'><a href='../S/90.html#L1223'>peer</a>             1223 tests/aspath_test.c   peer.bgp = &amp;bgp;</span>
<span class='curline'><a href='../S/90.html#L1224'>peer</a>             1224 tests/aspath_test.c   peer.host = (char *)"none";</span>
<span class='curline'><a href='../S/90.html#L1225'>peer</a>             1225 tests/aspath_test.c   peer.fd = -1;</span>
<span class='curline'><a href='../S/90.html#L1226'>peer</a>             1226 tests/aspath_test.c   peer.cap = t-&gt;cap;</span>
<span class='curline'><a href='../S/90.html#L1228'>peer</a>             1228 tests/aspath_test.c   stream_write (peer.ibuf, t-&gt;attrheader, t-&gt;len);</span>
<span class='curline'><a href='../S/90.html#L1229'>peer</a>             1229 tests/aspath_test.c   datalen = aspath_put (peer.ibuf, asp, t-&gt;as4 == AS4_DATA);</span>
<span class='curline'><a href='../S/90.html#L1234'>peer</a>             1234 tests/aspath_test.c       stream_write (peer.ibuf, dummyaspath, sizeof (dummyaspath));</span>
<span class='curline'><a href='../S/90.html#L1235'>peer</a>             1235 tests/aspath_test.c       stream_write (peer.ibuf, t-&gt;old_segment-&gt;asdata, t-&gt;old_segment-&gt;len);</span>
<span class='curline'><a href='../S/90.html#L1239'>peer</a>             1239 tests/aspath_test.c   ret = bgp_attr_parse (&amp;peer, &amp;attr, t-&gt;len + datalen, NULL, NULL);</span>
<span class='curline'><a href='../S/78.html#L502'>peer</a>              502 tests/bgp_capability_test.c parse_test (struct peer *peer, struct test_segment *t, int type)</span>
<span class='curline'><a href='../S/78.html#L511'>peer</a>              511 tests/bgp_capability_test.c   stream_reset (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/78.html#L512'>peer</a>              512 tests/bgp_capability_test.c   stream_put (peer-&gt;ibuf, NULL, RANDOM_FUZZ);</span>
<span class='curline'><a href='../S/78.html#L513'>peer</a>              513 tests/bgp_capability_test.c   stream_set_getp (peer-&gt;ibuf, RANDOM_FUZZ);</span>
<span class='curline'><a href='../S/78.html#L518'>peer</a>              518 tests/bgp_capability_test.c         stream_putc (peer-&gt;ibuf, BGP_OPEN_OPT_CAP);</span>
<span class='curline'><a href='../S/78.html#L519'>peer</a>              519 tests/bgp_capability_test.c         stream_putc (peer-&gt;ibuf, t-&gt;len);</span>
<span class='curline'><a href='../S/78.html#L528'>peer</a>              528 tests/bgp_capability_test.c   stream_write (peer-&gt;ibuf, t-&gt;data, t-&gt;len);</span>
<span class='curline'><a href='../S/78.html#L539'>peer</a>              539 tests/bgp_capability_test.c         as4 = peek_for_as4_capability (peer, len);</span>
<span class='curline'><a href='../S/78.html#L542'>peer</a>              542 tests/bgp_capability_test.c         assert (stream_get_getp (peer-&gt;ibuf) == RANDOM_FUZZ);</span>
<span class='curline'><a href='../S/78.html#L544'>peer</a>              544 tests/bgp_capability_test.c         ret = bgp_open_option_parse (peer, len, &amp;capability);</span>
<span class='curline'><a href='../S/78.html#L547'>peer</a>              547 tests/bgp_capability_test.c         ret = bgp_capability_receive (peer, t-&gt;len);</span>
<span class='curline'><a href='../S/78.html#L563'>peer</a>              563 tests/bgp_capability_test.c               peer-&gt;afc_recv[t-&gt;afi][safi],</span>
<span class='curline'><a href='../S/78.html#L564'>peer</a>              564 tests/bgp_capability_test.c               peer-&gt;afc_nego[t-&gt;afi][safi]);</span>
<span class='curline'><a href='../S/78.html#L569'>peer</a>              569 tests/bgp_capability_test.c           if (!peer-&gt;afc_recv[t-&gt;afi][safi])</span>
<span class='curline'><a href='../S/78.html#L571'>peer</a>              571 tests/bgp_capability_test.c           if (!peer-&gt;afc_nego[t-&gt;afi][safi])</span>
<span class='curline'><a href='../S/78.html#L605'>peer</a>              605 tests/bgp_capability_test.c   struct peer *peer;</span>
<span class='curline'><a href='../S/78.html#L629'>peer</a>              629 tests/bgp_capability_test.c   peer = peer_create_accept (bgp);</span>
<span class='curline'><a href='../S/78.html#L630'>peer</a>              630 tests/bgp_capability_test.c   peer-&gt;host = (char *) "foo";</span>
<span class='curline'><a href='../S/78.html#L635'>peer</a>              635 tests/bgp_capability_test.c         peer-&gt;afc[i][j] = 1;</span>
<span class='curline'><a href='../S/78.html#L636'>peer</a>              636 tests/bgp_capability_test.c         peer-&gt;afc_adv[i][j] = 1;</span>
<span class='curline'><a href='../S/78.html#L641'>peer</a>              641 tests/bgp_capability_test.c     parse_test (peer, &amp;mp_segments[i++], CAPABILITY);</span>
<span class='curline'><a href='../S/78.html#L648'>peer</a>              648 tests/bgp_capability_test.c     parse_test (peer, &amp;test_segments[i++], CAPABILITY);</span>
<span class='curline'><a href='../S/78.html#L652'>peer</a>              652 tests/bgp_capability_test.c     parse_test (peer, &amp;misc_segments[i++], CAPABILITY);</span>
<span class='curline'><a href='../S/78.html#L656'>peer</a>              656 tests/bgp_capability_test.c     parse_test (peer, &amp;opt_params[i++], OPT_PARAM);</span>
<span class='curline'><a href='../S/78.html#L658'>peer</a>              658 tests/bgp_capability_test.c   SET_FLAG (peer-&gt;cap, PEER_CAP_DYNAMIC_ADV);</span>
<span class='curline'><a href='../S/78.html#L659'>peer</a>              659 tests/bgp_capability_test.c   peer-&gt;status = Established;</span>
<span class='curline'><a href='../S/78.html#L663'>peer</a>              663 tests/bgp_capability_test.c     parse_test (peer, &amp;dynamic_cap_msgs[i++], DYNCAP);</span>
<span class='curline'><a href='../S/79.html#L435'>peer</a>              435 tests/bgp_mp_attr_test.c parse_test (struct peer *peer, struct test_segment *t, int type)</span>
<span class='curline'><a href='../S/79.html#L442'>peer</a>              442 tests/bgp_mp_attr_test.c     .peer = peer,</span>
<span class='curline'><a href='../S/79.html#L448'>peer</a>              448 tests/bgp_mp_attr_test.c     .startp = BGP_INPUT_PNT (peer),</span>
<span class='curline'><a href='../S/79.html#L452'>peer</a>              452 tests/bgp_mp_attr_test.c   stream_reset (peer-&gt;ibuf);</span>
<span class='curline'><a href='../S/79.html#L453'>peer</a>              453 tests/bgp_mp_attr_test.c   stream_put (peer-&gt;ibuf, NULL, RANDOM_FUZZ);</span>
<span class='curline'><a href='../S/79.html#L454'>peer</a>              454 tests/bgp_mp_attr_test.c   stream_set_getp (peer-&gt;ibuf, RANDOM_FUZZ);</span>
<span class='curline'><a href='../S/79.html#L456'>peer</a>              456 tests/bgp_mp_attr_test.c   stream_write (peer-&gt;ibuf, t-&gt;data, t-&gt;len);</span>
<span class='curline'><a href='../S/79.html#L475'>peer</a>              475 tests/bgp_mp_attr_test.c               peer-&gt;afc_recv[t-&gt;afi][safi],</span>
<span class='curline'><a href='../S/79.html#L476'>peer</a>              476 tests/bgp_mp_attr_test.c               peer-&gt;afc_nego[t-&gt;afi][safi]);</span>
<span class='curline'><a href='../S/79.html#L502'>peer</a>              502 tests/bgp_mp_attr_test.c   struct peer *peer;</span>
<span class='curline'><a href='../S/79.html#L526'>peer</a>              526 tests/bgp_mp_attr_test.c   peer = peer_create_accept (bgp);</span>
<span class='curline'><a href='../S/79.html#L527'>peer</a>              527 tests/bgp_mp_attr_test.c   peer-&gt;host = "foo";</span>
<span class='curline'><a href='../S/79.html#L532'>peer</a>              532 tests/bgp_mp_attr_test.c         peer-&gt;afc[i][j] = 1;</span>
<span class='curline'><a href='../S/79.html#L533'>peer</a>              533 tests/bgp_mp_attr_test.c         peer-&gt;afc_adv[i][j] = 1;</span>
<span class='curline'><a href='../S/79.html#L538'>peer</a>              538 tests/bgp_mp_attr_test.c     parse_test (peer, &amp;mp_reach_segments[i++], BGP_ATTR_MP_REACH_NLRI);</span>
<span class='curline'><a href='../S/79.html#L542'>peer</a>              542 tests/bgp_mp_attr_test.c     parse_test (peer, &amp;mp_unreach_segments[i++], BGP_ATTR_MP_UNREACH_NLRI);</span>
<span class='curline'><a href='../S/73.html#L100'>peer</a>              100 tests/bgp_mpath_test.c   bgp-&gt;peer = list_new ();</span>
<span class='curline'><a href='../S/73.html#L197'>peer</a>              197 tests/bgp_mpath_test.c struct peer test_mp_list_peer[] = {</span>
<span class='curline'><a href='../S/73.html#L204'>peer</a>              204 tests/bgp_mpath_test.c int test_mp_list_peer_count = sizeof (test_mp_list_peer)/ sizeof (struct peer);</span>
<span class='curline'><a href='../S/73.html#L207'>peer</a>              207 tests/bgp_mpath_test.c   { .peer = &amp;test_mp_list_peer[0], .attr = &amp;test_mp_list_attr[0] },</span>
<span class='curline'><a href='../S/73.html#L208'>peer</a>              208 tests/bgp_mpath_test.c   { .peer = &amp;test_mp_list_peer[1], .attr = &amp;test_mp_list_attr[1] },</span>
<span class='curline'><a href='../S/73.html#L209'>peer</a>              209 tests/bgp_mpath_test.c   { .peer = &amp;test_mp_list_peer[2], .attr = &amp;test_mp_list_attr[1] },</span>
<span class='curline'><a href='../S/73.html#L210'>peer</a>              210 tests/bgp_mpath_test.c   { .peer = &amp;test_mp_list_peer[3], .attr = &amp;test_mp_list_attr[2] },</span>
<span class='curline'><a href='../S/73.html#L211'>peer</a>              211 tests/bgp_mpath_test.c   { .peer = &amp;test_mp_list_peer[4], .attr = &amp;test_mp_list_attr[3] },</span>
</pre>
</body>
</html>
